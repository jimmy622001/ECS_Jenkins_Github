{"check_type": "terraform", "results": {"passed_checks": [{"check_id": "CKV_AWS_41", "bc_check_id": "BC_AWS_SECRETS_5", "check_name": "Ensure no hard coded AWS access key and secret key exists in provider", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[12, "provider \"aws\" {\n"], [13, "  region = var.aws_region\n"], [14, "\n"], [15, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\main.tf", "repo_file_path": "/main.tf", "file_line_range": [12, 15], "resource": "module.ecs_jenkins_github.aws.default", "evaluations": null, "check_class": "checkov.terraform.checks.provider.aws.credentials", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\environments\\prod\\main.tf", "caller_file_line_range": [1, 26], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-5", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\main.tf"}, {"check_id": "CKV_AWS_41", "bc_check_id": "BC_AWS_SECRETS_5", "check_name": "Ensure no hard coded AWS access key and secret key exists in provider", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[12, "provider \"aws\" {\n"], [13, "  region = var.aws_region\n"], [14, "\n"], [15, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\main.tf", "repo_file_path": "/main.tf", "file_line_range": [12, 15], "resource": "module.ecs_jenkins_github_dr.aws.default", "evaluations": null, "check_class": "checkov.terraform.checks.provider.aws.credentials", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\environments\\dr-pilot-light\\main.tf", "caller_file_line_range": [1, 28], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-5", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\main.tf"}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[2, "resource \"aws_security_group\" \"jenkins_sg\" {\n"], [3, "  name        = \"${var.project}-${var.environment}-jenkins-sg\"\n"], [4, "  description = \"Security group for Jenkins server\"\n"], [5, "  vpc_id      = var.vpc_id\n"], [6, "\n"], [7, "  ingress {\n"], [8, "    description = \"SSH access\"\n"], [9, "    from_port   = 22\n"], [10, "    to_port     = 22\n"], [11, "    protocol    = \"tcp\"\n"], [12, "    cidr_blocks = var.ssh_allowed_cidr\n"], [13, "  }\n"], [14, "\n"], [15, "  ingress {\n"], [16, "    description = \"Jenkins web interface\"\n"], [17, "    from_port   = 8080\n"], [18, "    to_port     = 8080\n"], [19, "    protocol    = \"tcp\"\n"], [20, "    cidr_blocks = var.web_allowed_cidr\n"], [21, "  }\n"], [22, "\n"], [23, "  egress {\n"], [24, "    from_port   = 0\n"], [25, "    to_port     = 0\n"], [26, "    protocol    = \"-1\"\n"], [27, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [28, "  }\n"], [29, "\n"], [30, "  tags = {\n"], [31, "    Name        = \"${var.project}-${var.environment}-jenkins-sg\"\n"], [32, "    Environment = var.environment\n"], [33, "    Project     = var.project\n"], [34, "  }\n"], [35, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [2, 35], "resource": "module.ecs_jenkins_github.module.cicd.aws_security_group.jenkins_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-sg", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-2", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_260", "bc_check_id": "BC_AWS_NETWORKING_67", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[2, "resource \"aws_security_group\" \"jenkins_sg\" {\n"], [3, "  name        = \"${var.project}-${var.environment}-jenkins-sg\"\n"], [4, "  description = \"Security group for Jenkins server\"\n"], [5, "  vpc_id      = var.vpc_id\n"], [6, "\n"], [7, "  ingress {\n"], [8, "    description = \"SSH access\"\n"], [9, "    from_port   = 22\n"], [10, "    to_port     = 22\n"], [11, "    protocol    = \"tcp\"\n"], [12, "    cidr_blocks = var.ssh_allowed_cidr\n"], [13, "  }\n"], [14, "\n"], [15, "  ingress {\n"], [16, "    description = \"Jenkins web interface\"\n"], [17, "    from_port   = 8080\n"], [18, "    to_port     = 8080\n"], [19, "    protocol    = \"tcp\"\n"], [20, "    cidr_blocks = var.web_allowed_cidr\n"], [21, "  }\n"], [22, "\n"], [23, "  egress {\n"], [24, "    from_port   = 0\n"], [25, "    to_port     = 0\n"], [26, "    protocol    = \"-1\"\n"], [27, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [28, "  }\n"], [29, "\n"], [30, "  tags = {\n"], [31, "    Name        = \"${var.project}-${var.environment}-jenkins-sg\"\n"], [32, "    Environment = var.environment\n"], [33, "    Project     = var.project\n"], [34, "  }\n"], [35, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [2, 35], "resource": "module.ecs_jenkins_github.module.cicd.aws_security_group.jenkins_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress80", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-sg", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_277", "bc_check_id": "BC_AWS_NETWORKING_78", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[2, "resource \"aws_security_group\" \"jenkins_sg\" {\n"], [3, "  name        = \"${var.project}-${var.environment}-jenkins-sg\"\n"], [4, "  description = \"Security group for Jenkins server\"\n"], [5, "  vpc_id      = var.vpc_id\n"], [6, "\n"], [7, "  ingress {\n"], [8, "    description = \"SSH access\"\n"], [9, "    from_port   = 22\n"], [10, "    to_port     = 22\n"], [11, "    protocol    = \"tcp\"\n"], [12, "    cidr_blocks = var.ssh_allowed_cidr\n"], [13, "  }\n"], [14, "\n"], [15, "  ingress {\n"], [16, "    description = \"Jenkins web interface\"\n"], [17, "    from_port   = 8080\n"], [18, "    to_port     = 8080\n"], [19, "    protocol    = \"tcp\"\n"], [20, "    cidr_blocks = var.web_allowed_cidr\n"], [21, "  }\n"], [22, "\n"], [23, "  egress {\n"], [24, "    from_port   = 0\n"], [25, "    to_port     = 0\n"], [26, "    protocol    = \"-1\"\n"], [27, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [28, "  }\n"], [29, "\n"], [30, "  tags = {\n"], [31, "    Name        = \"${var.project}-${var.environment}-jenkins-sg\"\n"], [32, "    Environment = var.environment\n"], [33, "    Project     = var.project\n"], [34, "  }\n"], [35, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [2, 35], "resource": "module.ecs_jenkins_github.module.cicd.aws_security_group.jenkins_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngressAny", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-sg", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-group-does-not-allow-all-traffic-on-all-ports", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_46", "bc_check_id": "BC_AWS_SECRETS_1", "check_name": "Ensure no hard-coded secrets exist in EC2 user data", "check_result": {"result": "PASSED", "evaluated_keys": ["user_data"]}, "code_block": [[38, "resource \"aws_launch_template\" \"jenkins\" {\n"], [39, "  name_prefix            = \"${var.project}-${var.environment}-jenkins-\"\n"], [40, "  image_id               = data.aws_ami.amazon_linux_2.id\n"], [41, "  instance_type          = var.instance_type\n"], [42, "  vpc_security_group_ids = [aws_security_group.jenkins_sg.id]\n"], [43, "  key_name               = var.key_name\n"], [44, "\n"], [45, "  iam_instance_profile {\n"], [46, "    name = aws_iam_instance_profile.jenkins_profile.name\n"], [47, "  }\n"], [48, "\n"], [49, "  user_data = base64encode(<<-EOF\n"], [50, "    #!/bin/bash\n"], [51, "    sudo yum update -y\n"], [52, "    sudo amazon-linux-extras install java-openjdk11 -y\n"], [53, "    sudo yum install -y jenkins git docker\n"], [54, "    sudo systemctl start jenkins\n"], [55, "    sudo systemctl enable jenkins\n"], [56, "    sudo systemctl start docker\n"], [57, "    sudo systemctl enable docker\n"], [58, "    sudo usermod -aG docker jenkins\n"], [59, "    sudo systemctl restart jenkins\n"], [60, "\n"], [61, "    # Install AWS CLI\n"], [62, "    curl \"https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip\" -o \"awscliv2.zip\"\n"], [63, "    unzip awscliv2.zip\n"], [64, "    sudo ./aws/install\n"], [65, "\n"], [66, "    # Install Terraform\n"], [67, "    TERRAFORM_VERSION=\"1.0.0\"\n"], [68, "    wget https://releases.hashicorp.com/terraform/$${TERRAFORM_VERSION}/terraform_$${TERRAFORM_VERSION}_linux_amd64.zip\n"], [69, "    unzip terraform_$${TERRAFORM_VERSION}_linux_amd64.zip\n"], [70, "    sudo mv terraform /usr/local/bin/\n"], [71, "\n"], [72, "    # Install SSM Agent\n"], [73, "    sudo yum install -y https://s3.amazonaws.com/ec2-downloads-windows/SSMAgent/latest/linux_amd64/amazon-ssm-agent.rpm\n"], [74, "    sudo systemctl enable amazon-ssm-agent\n"], [75, "    sudo systemctl start amazon-ssm-agent\n"], [76, "  EOF\n"], [77, "  )\n"], [78, "\n"], [79, "  block_device_mappings {\n"], [80, "    device_name = \"/dev/xvda\"\n"], [81, "    ebs {\n"], [82, "      volume_size           = 30\n"], [83, "      volume_type           = \"gp3\"\n"], [84, "      delete_on_termination = true\n"], [85, "      encrypted             = true\n"], [86, "    }\n"], [87, "  }\n"], [88, "\n"], [89, "  metadata_options {\n"], [90, "    http_endpoint               = \"enabled\"\n"], [91, "    http_tokens                 = \"required\" # IMDSv2 required for better security\n"], [92, "    http_put_response_hop_limit = 1\n"], [93, "  }\n"], [94, "\n"], [95, "  monitoring {\n"], [96, "    enabled = true\n"], [97, "  }\n"], [98, "\n"], [99, "  tag_specifications {\n"], [100, "    resource_type = \"instance\"\n"], [101, "    tags = {\n"], [102, "      Name        = \"${var.project}-${var.environment}-jenkins\"\n"], [103, "      Environment = var.environment\n"], [104, "      Project     = var.project\n"], [105, "      ManagedBy   = \"Terraform\"\n"], [106, "    }\n"], [107, "  }\n"], [108, "\n"], [109, "  tag_specifications {\n"], [110, "    resource_type = \"volume\"\n"], [111, "    tags = {\n"], [112, "      Name        = \"${var.project}-${var.environment}-jenkins-volume\"\n"], [113, "      Environment = var.environment\n"], [114, "      Project     = var.project\n"], [115, "    }\n"], [116, "  }\n"], [117, "\n"], [118, "  lifecycle {\n"], [119, "    create_before_destroy = true\n"], [120, "  }\n"], [121, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [38, 121], "resource": "module.ecs_jenkins_github.module.cicd.aws_launch_template.jenkins", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2Credentials", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-1", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_88", "bc_check_id": "BC_AWS_PUBLIC_12", "check_name": "EC2 instance should not have public IP.", "check_result": {"result": "PASSED", "evaluated_keys": ["network_interfaces/[0]/associate_public_ip_address"]}, "code_block": [[38, "resource \"aws_launch_template\" \"jenkins\" {\n"], [39, "  name_prefix            = \"${var.project}-${var.environment}-jenkins-\"\n"], [40, "  image_id               = data.aws_ami.amazon_linux_2.id\n"], [41, "  instance_type          = var.instance_type\n"], [42, "  vpc_security_group_ids = [aws_security_group.jenkins_sg.id]\n"], [43, "  key_name               = var.key_name\n"], [44, "\n"], [45, "  iam_instance_profile {\n"], [46, "    name = aws_iam_instance_profile.jenkins_profile.name\n"], [47, "  }\n"], [48, "\n"], [49, "  user_data = base64encode(<<-EOF\n"], [50, "    #!/bin/bash\n"], [51, "    sudo yum update -y\n"], [52, "    sudo amazon-linux-extras install java-openjdk11 -y\n"], [53, "    sudo yum install -y jenkins git docker\n"], [54, "    sudo systemctl start jenkins\n"], [55, "    sudo systemctl enable jenkins\n"], [56, "    sudo systemctl start docker\n"], [57, "    sudo systemctl enable docker\n"], [58, "    sudo usermod -aG docker jenkins\n"], [59, "    sudo systemctl restart jenkins\n"], [60, "\n"], [61, "    # Install AWS CLI\n"], [62, "    curl \"https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip\" -o \"awscliv2.zip\"\n"], [63, "    unzip awscliv2.zip\n"], [64, "    sudo ./aws/install\n"], [65, "\n"], [66, "    # Install Terraform\n"], [67, "    TERRAFORM_VERSION=\"1.0.0\"\n"], [68, "    wget https://releases.hashicorp.com/terraform/$${TERRAFORM_VERSION}/terraform_$${TERRAFORM_VERSION}_linux_amd64.zip\n"], [69, "    unzip terraform_$${TERRAFORM_VERSION}_linux_amd64.zip\n"], [70, "    sudo mv terraform /usr/local/bin/\n"], [71, "\n"], [72, "    # Install SSM Agent\n"], [73, "    sudo yum install -y https://s3.amazonaws.com/ec2-downloads-windows/SSMAgent/latest/linux_amd64/amazon-ssm-agent.rpm\n"], [74, "    sudo systemctl enable amazon-ssm-agent\n"], [75, "    sudo systemctl start amazon-ssm-agent\n"], [76, "  EOF\n"], [77, "  )\n"], [78, "\n"], [79, "  block_device_mappings {\n"], [80, "    device_name = \"/dev/xvda\"\n"], [81, "    ebs {\n"], [82, "      volume_size           = 30\n"], [83, "      volume_type           = \"gp3\"\n"], [84, "      delete_on_termination = true\n"], [85, "      encrypted             = true\n"], [86, "    }\n"], [87, "  }\n"], [88, "\n"], [89, "  metadata_options {\n"], [90, "    http_endpoint               = \"enabled\"\n"], [91, "    http_tokens                 = \"required\" # IMDSv2 required for better security\n"], [92, "    http_put_response_hop_limit = 1\n"], [93, "  }\n"], [94, "\n"], [95, "  monitoring {\n"], [96, "    enabled = true\n"], [97, "  }\n"], [98, "\n"], [99, "  tag_specifications {\n"], [100, "    resource_type = \"instance\"\n"], [101, "    tags = {\n"], [102, "      Name        = \"${var.project}-${var.environment}-jenkins\"\n"], [103, "      Environment = var.environment\n"], [104, "      Project     = var.project\n"], [105, "      ManagedBy   = \"Terraform\"\n"], [106, "    }\n"], [107, "  }\n"], [108, "\n"], [109, "  tag_specifications {\n"], [110, "    resource_type = \"volume\"\n"], [111, "    tags = {\n"], [112, "      Name        = \"${var.project}-${var.environment}-jenkins-volume\"\n"], [113, "      Environment = var.environment\n"], [114, "      Project     = var.project\n"], [115, "    }\n"], [116, "  }\n"], [117, "\n"], [118, "  lifecycle {\n"], [119, "    create_before_destroy = true\n"], [120, "  }\n"], [121, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [38, 121], "resource": "module.ecs_jenkins_github.module.cicd.aws_launch_template.jenkins", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2PublicIP", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-12", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_79", "bc_check_id": "BC_AWS_GENERAL_31", "check_name": "Ensure Instance Metadata Service Version 1 is not enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["metadata_options/[0]/http_tokens"]}, "code_block": [[38, "resource \"aws_launch_template\" \"jenkins\" {\n"], [39, "  name_prefix            = \"${var.project}-${var.environment}-jenkins-\"\n"], [40, "  image_id               = data.aws_ami.amazon_linux_2.id\n"], [41, "  instance_type          = var.instance_type\n"], [42, "  vpc_security_group_ids = [aws_security_group.jenkins_sg.id]\n"], [43, "  key_name               = var.key_name\n"], [44, "\n"], [45, "  iam_instance_profile {\n"], [46, "    name = aws_iam_instance_profile.jenkins_profile.name\n"], [47, "  }\n"], [48, "\n"], [49, "  user_data = base64encode(<<-EOF\n"], [50, "    #!/bin/bash\n"], [51, "    sudo yum update -y\n"], [52, "    sudo amazon-linux-extras install java-openjdk11 -y\n"], [53, "    sudo yum install -y jenkins git docker\n"], [54, "    sudo systemctl start jenkins\n"], [55, "    sudo systemctl enable jenkins\n"], [56, "    sudo systemctl start docker\n"], [57, "    sudo systemctl enable docker\n"], [58, "    sudo usermod -aG docker jenkins\n"], [59, "    sudo systemctl restart jenkins\n"], [60, "\n"], [61, "    # Install AWS CLI\n"], [62, "    curl \"https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip\" -o \"awscliv2.zip\"\n"], [63, "    unzip awscliv2.zip\n"], [64, "    sudo ./aws/install\n"], [65, "\n"], [66, "    # Install Terraform\n"], [67, "    TERRAFORM_VERSION=\"1.0.0\"\n"], [68, "    wget https://releases.hashicorp.com/terraform/$${TERRAFORM_VERSION}/terraform_$${TERRAFORM_VERSION}_linux_amd64.zip\n"], [69, "    unzip terraform_$${TERRAFORM_VERSION}_linux_amd64.zip\n"], [70, "    sudo mv terraform /usr/local/bin/\n"], [71, "\n"], [72, "    # Install SSM Agent\n"], [73, "    sudo yum install -y https://s3.amazonaws.com/ec2-downloads-windows/SSMAgent/latest/linux_amd64/amazon-ssm-agent.rpm\n"], [74, "    sudo systemctl enable amazon-ssm-agent\n"], [75, "    sudo systemctl start amazon-ssm-agent\n"], [76, "  EOF\n"], [77, "  )\n"], [78, "\n"], [79, "  block_device_mappings {\n"], [80, "    device_name = \"/dev/xvda\"\n"], [81, "    ebs {\n"], [82, "      volume_size           = 30\n"], [83, "      volume_type           = \"gp3\"\n"], [84, "      delete_on_termination = true\n"], [85, "      encrypted             = true\n"], [86, "    }\n"], [87, "  }\n"], [88, "\n"], [89, "  metadata_options {\n"], [90, "    http_endpoint               = \"enabled\"\n"], [91, "    http_tokens                 = \"required\" # IMDSv2 required for better security\n"], [92, "    http_put_response_hop_limit = 1\n"], [93, "  }\n"], [94, "\n"], [95, "  monitoring {\n"], [96, "    enabled = true\n"], [97, "  }\n"], [98, "\n"], [99, "  tag_specifications {\n"], [100, "    resource_type = \"instance\"\n"], [101, "    tags = {\n"], [102, "      Name        = \"${var.project}-${var.environment}-jenkins\"\n"], [103, "      Environment = var.environment\n"], [104, "      Project     = var.project\n"], [105, "      ManagedBy   = \"Terraform\"\n"], [106, "    }\n"], [107, "  }\n"], [108, "\n"], [109, "  tag_specifications {\n"], [110, "    resource_type = \"volume\"\n"], [111, "    tags = {\n"], [112, "      Name        = \"${var.project}-${var.environment}-jenkins-volume\"\n"], [113, "      Environment = var.environment\n"], [114, "      Project     = var.project\n"], [115, "    }\n"], [116, "  }\n"], [117, "\n"], [118, "  lifecycle {\n"], [119, "    create_before_destroy = true\n"], [120, "  }\n"], [121, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [38, 121], "resource": "module.ecs_jenkins_github.module.cicd.aws_launch_template.jenkins", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IMDSv1Disabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-31", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_341", "bc_check_id": "BC_AWS_GENERAL_244", "check_name": "Ensure Launch template should not have a metadata response hop limit greater than 1", "check_result": {"result": "PASSED", "evaluated_keys": ["metadata_options/[0]/http_put_response_hop_limit"]}, "code_block": [[38, "resource \"aws_launch_template\" \"jenkins\" {\n"], [39, "  name_prefix            = \"${var.project}-${var.environment}-jenkins-\"\n"], [40, "  image_id               = data.aws_ami.amazon_linux_2.id\n"], [41, "  instance_type          = var.instance_type\n"], [42, "  vpc_security_group_ids = [aws_security_group.jenkins_sg.id]\n"], [43, "  key_name               = var.key_name\n"], [44, "\n"], [45, "  iam_instance_profile {\n"], [46, "    name = aws_iam_instance_profile.jenkins_profile.name\n"], [47, "  }\n"], [48, "\n"], [49, "  user_data = base64encode(<<-EOF\n"], [50, "    #!/bin/bash\n"], [51, "    sudo yum update -y\n"], [52, "    sudo amazon-linux-extras install java-openjdk11 -y\n"], [53, "    sudo yum install -y jenkins git docker\n"], [54, "    sudo systemctl start jenkins\n"], [55, "    sudo systemctl enable jenkins\n"], [56, "    sudo systemctl start docker\n"], [57, "    sudo systemctl enable docker\n"], [58, "    sudo usermod -aG docker jenkins\n"], [59, "    sudo systemctl restart jenkins\n"], [60, "\n"], [61, "    # Install AWS CLI\n"], [62, "    curl \"https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip\" -o \"awscliv2.zip\"\n"], [63, "    unzip awscliv2.zip\n"], [64, "    sudo ./aws/install\n"], [65, "\n"], [66, "    # Install Terraform\n"], [67, "    TERRAFORM_VERSION=\"1.0.0\"\n"], [68, "    wget https://releases.hashicorp.com/terraform/$${TERRAFORM_VERSION}/terraform_$${TERRAFORM_VERSION}_linux_amd64.zip\n"], [69, "    unzip terraform_$${TERRAFORM_VERSION}_linux_amd64.zip\n"], [70, "    sudo mv terraform /usr/local/bin/\n"], [71, "\n"], [72, "    # Install SSM Agent\n"], [73, "    sudo yum install -y https://s3.amazonaws.com/ec2-downloads-windows/SSMAgent/latest/linux_amd64/amazon-ssm-agent.rpm\n"], [74, "    sudo systemctl enable amazon-ssm-agent\n"], [75, "    sudo systemctl start amazon-ssm-agent\n"], [76, "  EOF\n"], [77, "  )\n"], [78, "\n"], [79, "  block_device_mappings {\n"], [80, "    device_name = \"/dev/xvda\"\n"], [81, "    ebs {\n"], [82, "      volume_size           = 30\n"], [83, "      volume_type           = \"gp3\"\n"], [84, "      delete_on_termination = true\n"], [85, "      encrypted             = true\n"], [86, "    }\n"], [87, "  }\n"], [88, "\n"], [89, "  metadata_options {\n"], [90, "    http_endpoint               = \"enabled\"\n"], [91, "    http_tokens                 = \"required\" # IMDSv2 required for better security\n"], [92, "    http_put_response_hop_limit = 1\n"], [93, "  }\n"], [94, "\n"], [95, "  monitoring {\n"], [96, "    enabled = true\n"], [97, "  }\n"], [98, "\n"], [99, "  tag_specifications {\n"], [100, "    resource_type = \"instance\"\n"], [101, "    tags = {\n"], [102, "      Name        = \"${var.project}-${var.environment}-jenkins\"\n"], [103, "      Environment = var.environment\n"], [104, "      Project     = var.project\n"], [105, "      ManagedBy   = \"Terraform\"\n"], [106, "    }\n"], [107, "  }\n"], [108, "\n"], [109, "  tag_specifications {\n"], [110, "    resource_type = \"volume\"\n"], [111, "    tags = {\n"], [112, "      Name        = \"${var.project}-${var.environment}-jenkins-volume\"\n"], [113, "      Environment = var.environment\n"], [114, "      Project     = var.project\n"], [115, "    }\n"], [116, "  }\n"], [117, "\n"], [118, "  lifecycle {\n"], [119, "    create_before_destroy = true\n"], [120, "  }\n"], [121, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [38, 121], "resource": "module.ecs_jenkins_github.module.cicd.aws_launch_template.jenkins", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LaunchTemplateMetadataHop", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-341", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_315", "bc_check_id": "BC_AWS_GENERAL_226", "check_name": "Ensure EC2 Auto Scaling groups use EC2 launch templates", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[124, "resource \"aws_autoscaling_group\" \"jenkins\" {\n"], [125, "  name                = \"${var.project}-${var.environment}-jenkins-asg\"\n"], [126, "  vpc_zone_identifier = [var.subnet_id] # Using only one subnet for Jenkins\n"], [127, "  min_size            = 1\n"], [128, "  max_size            = 1\n"], [129, "  desired_capacity    = 1\n"], [130, "\n"], [131, "  launch_template {\n"], [132, "    id      = aws_launch_template.jenkins.id\n"], [133, "    version = \"$Latest\"\n"], [134, "  }\n"], [135, "\n"], [136, "  health_check_type         = \"EC2\"\n"], [137, "  health_check_grace_period = 300\n"], [138, "  termination_policies      = [\"OldestLaunchTemplate\"]\n"], [139, "  wait_for_capacity_timeout = \"10m\"\n"], [140, "\n"], [141, "  # Ensure we create new instances before destroying old ones\n"], [142, "  instance_refresh {\n"], [143, "    strategy = \"Rolling\"\n"], [144, "    preferences {\n"], [145, "      min_healthy_percentage = 100\n"], [146, "      instance_warmup        = 300\n"], [147, "    }\n"], [148, "  }\n"], [149, "\n"], [150, "  lifecycle {\n"], [151, "    create_before_destroy = true\n"], [152, "    ignore_changes        = [desired_capacity]\n"], [153, "  }\n"], [154, "\n"], [155, "  tag {\n"], [156, "    key                 = \"Name\"\n"], [157, "    value               = \"${var.project}-${var.environment}-jenkins\"\n"], [158, "    propagate_at_launch = true\n"], [159, "  }\n"], [160, "\n"], [161, "  tag {\n"], [162, "    key                 = \"Environment\"\n"], [163, "    value               = var.environment\n"], [164, "    propagate_at_launch = true\n"], [165, "  }\n"], [166, "\n"], [167, "  tag {\n"], [168, "    key                 = \"Project\"\n"], [169, "    value               = var.project\n"], [170, "    propagate_at_launch = true\n"], [171, "  }\n"], [172, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [124, 172], "resource": "module.ecs_jenkins_github.module.cicd.aws_autoscaling_group.jenkins", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.AutoScalingLaunchTemplate", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-315", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_153", "bc_check_id": "BC_AWS_GENERAL_82", "check_name": "Autoscaling groups should supply tags to launch configurations", "check_result": {"result": "PASSED", "evaluated_keys": ["tag", "tags"]}, "code_block": [[124, "resource \"aws_autoscaling_group\" \"jenkins\" {\n"], [125, "  name                = \"${var.project}-${var.environment}-jenkins-asg\"\n"], [126, "  vpc_zone_identifier = [var.subnet_id] # Using only one subnet for Jenkins\n"], [127, "  min_size            = 1\n"], [128, "  max_size            = 1\n"], [129, "  desired_capacity    = 1\n"], [130, "\n"], [131, "  launch_template {\n"], [132, "    id      = aws_launch_template.jenkins.id\n"], [133, "    version = \"$Latest\"\n"], [134, "  }\n"], [135, "\n"], [136, "  health_check_type         = \"EC2\"\n"], [137, "  health_check_grace_period = 300\n"], [138, "  termination_policies      = [\"OldestLaunchTemplate\"]\n"], [139, "  wait_for_capacity_timeout = \"10m\"\n"], [140, "\n"], [141, "  # Ensure we create new instances before destroying old ones\n"], [142, "  instance_refresh {\n"], [143, "    strategy = \"Rolling\"\n"], [144, "    preferences {\n"], [145, "      min_healthy_percentage = 100\n"], [146, "      instance_warmup        = 300\n"], [147, "    }\n"], [148, "  }\n"], [149, "\n"], [150, "  lifecycle {\n"], [151, "    create_before_destroy = true\n"], [152, "    ignore_changes        = [desired_capacity]\n"], [153, "  }\n"], [154, "\n"], [155, "  tag {\n"], [156, "    key                 = \"Name\"\n"], [157, "    value               = \"${var.project}-${var.environment}-jenkins\"\n"], [158, "    propagate_at_launch = true\n"], [159, "  }\n"], [160, "\n"], [161, "  tag {\n"], [162, "    key                 = \"Environment\"\n"], [163, "    value               = var.environment\n"], [164, "    propagate_at_launch = true\n"], [165, "  }\n"], [166, "\n"], [167, "  tag {\n"], [168, "    key                 = \"Project\"\n"], [169, "    value               = var.project\n"], [170, "    propagate_at_launch = true\n"], [171, "  }\n"], [172, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [124, 172], "resource": "module.ecs_jenkins_github.module.cicd.aws_autoscaling_group.jenkins", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.AutoScalingTagging", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/autoscaling-groups-should-supply-tags-to-launch-configurations", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_328", "bc_check_id": "BC_AWS_NETWORKING_89", "check_name": "Ensure that ALB is configured with defensive or strictest desync mitigation mode", "check_result": {"result": "PASSED", "evaluated_keys": ["desync_mitigation_mode"]}, "code_block": [[175, "resource \"aws_lb\" \"jenkins_nlb\" {\n"], [176, "  name               = \"${var.project}-${var.environment}-jenkins-nlb\"\n"], [177, "  internal           = false\n"], [178, "  load_balancer_type = \"network\"\n"], [179, "  subnets            = [var.subnet_id]\n"], [180, "\n"], [181, "  tags = {\n"], [182, "    Name        = \"${var.project}-${var.environment}-jenkins-nlb\"\n"], [183, "    Environment = var.environment\n"], [184, "    Project     = var.project\n"], [185, "  }\n"], [186, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [175, 186], "resource": "module.ecs_jenkins_github.module.cicd.aws_lb.jenkins_nlb", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ALBDesyncMode", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-nlb", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-328", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_2", "bc_check_id": "BC_AWS_NETWORKING_29", "check_name": "Ensure ALB protocol is HTTPS", "check_result": {"result": "PASSED", "evaluated_keys": ["protocol"]}, "code_block": [[219, "resource \"aws_lb_listener\" \"jenkins\" {\n"], [220, "  load_balancer_arn = aws_lb.jenkins_nlb.arn\n"], [221, "  port              = 80\n"], [222, "  protocol          = \"TCP\"\n"], [223, "\n"], [224, "  default_action {\n"], [225, "    type             = \"forward\"\n"], [226, "    target_group_arn = aws_lb_target_group.jenkins.arn\n"], [227, "  }\n"], [228, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [219, 228], "resource": "module.ecs_jenkins_github.module.cicd.aws_lb_listener.jenkins", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ALBListenerHTTPS", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-29", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_337", "bc_check_id": "BC_AWS_GENERAL_242", "check_name": "Ensure SSM parameters are using KMS CMK", "check_result": {"result": "PASSED", "evaluated_keys": ["key_id"]}, "code_block": [[248, "resource \"aws_ssm_parameter\" \"jenkins_url\" {\n"], [249, "  name        = \"/${var.project}/${var.environment}/jenkins-url\"\n"], [250, "  description = \"Jenkins URL\"\n"], [251, "  type        = \"String\"\n"], [252, "  value       = \"http://${aws_lb.jenkins_nlb.dns_name}\"\n"], [253, "\n"], [254, "  tags = {\n"], [255, "    Name        = \"${var.project}-${var.environment}-jenkins-url\"\n"], [256, "    Environment = var.environment\n"], [257, "    Project     = var.project\n"], [258, "  }\n"], [259, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [248, 259], "resource": "module.ecs_jenkins_github.module.cicd.aws_ssm_parameter.jenkins_url", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SSMParameterUsesCMK", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-url", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-337", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_386", "bc_check_id": "BC_AWS_GENERAL_271", "check_name": "Reduce potential for WhoAMI cloud image name confusion attack", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[237, "data \"aws_ami\" \"amazon_linux_2\" {\n"], [238, "  most_recent = true\n"], [239, "  owners      = [\"amazon\"]\n"], [240, "\n"], [241, "  filter {\n"], [242, "    name   = \"name\"\n"], [243, "    values = [\"amzn2-ami-hvm-*-x86_64-gp2\"]\n"], [244, "  }\n"], [245, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [237, 245], "resource": "module.ecs_jenkins_github.module.cicd.aws_ami.amazon_linux_2", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.WhoAMI", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-supply-chain-policies/bc-aws-386", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[2, "resource \"aws_security_group\" \"jenkins_sg\" {\n"], [3, "  name        = \"${var.project}-${var.environment}-jenkins-sg\"\n"], [4, "  description = \"Security group for Jenkins server\"\n"], [5, "  vpc_id      = var.vpc_id\n"], [6, "\n"], [7, "  ingress {\n"], [8, "    description = \"SSH access\"\n"], [9, "    from_port   = 22\n"], [10, "    to_port     = 22\n"], [11, "    protocol    = \"tcp\"\n"], [12, "    cidr_blocks = var.ssh_allowed_cidr\n"], [13, "  }\n"], [14, "\n"], [15, "  ingress {\n"], [16, "    description = \"Jenkins web interface\"\n"], [17, "    from_port   = 8080\n"], [18, "    to_port     = 8080\n"], [19, "    protocol    = \"tcp\"\n"], [20, "    cidr_blocks = var.web_allowed_cidr\n"], [21, "  }\n"], [22, "\n"], [23, "  egress {\n"], [24, "    from_port   = 0\n"], [25, "    to_port     = 0\n"], [26, "    protocol    = \"-1\"\n"], [27, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [28, "  }\n"], [29, "\n"], [30, "  tags = {\n"], [31, "    Name        = \"${var.project}-${var.environment}-jenkins-sg\"\n"], [32, "    Environment = var.environment\n"], [33, "    Project     = var.project\n"], [34, "  }\n"], [35, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [2, 35], "resource": "module.ecs_jenkins_github_dr.module.cicd.aws_security_group.jenkins_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-sg", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-2", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_260", "bc_check_id": "BC_AWS_NETWORKING_67", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[2, "resource \"aws_security_group\" \"jenkins_sg\" {\n"], [3, "  name        = \"${var.project}-${var.environment}-jenkins-sg\"\n"], [4, "  description = \"Security group for Jenkins server\"\n"], [5, "  vpc_id      = var.vpc_id\n"], [6, "\n"], [7, "  ingress {\n"], [8, "    description = \"SSH access\"\n"], [9, "    from_port   = 22\n"], [10, "    to_port     = 22\n"], [11, "    protocol    = \"tcp\"\n"], [12, "    cidr_blocks = var.ssh_allowed_cidr\n"], [13, "  }\n"], [14, "\n"], [15, "  ingress {\n"], [16, "    description = \"Jenkins web interface\"\n"], [17, "    from_port   = 8080\n"], [18, "    to_port     = 8080\n"], [19, "    protocol    = \"tcp\"\n"], [20, "    cidr_blocks = var.web_allowed_cidr\n"], [21, "  }\n"], [22, "\n"], [23, "  egress {\n"], [24, "    from_port   = 0\n"], [25, "    to_port     = 0\n"], [26, "    protocol    = \"-1\"\n"], [27, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [28, "  }\n"], [29, "\n"], [30, "  tags = {\n"], [31, "    Name        = \"${var.project}-${var.environment}-jenkins-sg\"\n"], [32, "    Environment = var.environment\n"], [33, "    Project     = var.project\n"], [34, "  }\n"], [35, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [2, 35], "resource": "module.ecs_jenkins_github_dr.module.cicd.aws_security_group.jenkins_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress80", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-sg", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_277", "bc_check_id": "BC_AWS_NETWORKING_78", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[2, "resource \"aws_security_group\" \"jenkins_sg\" {\n"], [3, "  name        = \"${var.project}-${var.environment}-jenkins-sg\"\n"], [4, "  description = \"Security group for Jenkins server\"\n"], [5, "  vpc_id      = var.vpc_id\n"], [6, "\n"], [7, "  ingress {\n"], [8, "    description = \"SSH access\"\n"], [9, "    from_port   = 22\n"], [10, "    to_port     = 22\n"], [11, "    protocol    = \"tcp\"\n"], [12, "    cidr_blocks = var.ssh_allowed_cidr\n"], [13, "  }\n"], [14, "\n"], [15, "  ingress {\n"], [16, "    description = \"Jenkins web interface\"\n"], [17, "    from_port   = 8080\n"], [18, "    to_port     = 8080\n"], [19, "    protocol    = \"tcp\"\n"], [20, "    cidr_blocks = var.web_allowed_cidr\n"], [21, "  }\n"], [22, "\n"], [23, "  egress {\n"], [24, "    from_port   = 0\n"], [25, "    to_port     = 0\n"], [26, "    protocol    = \"-1\"\n"], [27, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [28, "  }\n"], [29, "\n"], [30, "  tags = {\n"], [31, "    Name        = \"${var.project}-${var.environment}-jenkins-sg\"\n"], [32, "    Environment = var.environment\n"], [33, "    Project     = var.project\n"], [34, "  }\n"], [35, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [2, 35], "resource": "module.ecs_jenkins_github_dr.module.cicd.aws_security_group.jenkins_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngressAny", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-sg", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-group-does-not-allow-all-traffic-on-all-ports", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_46", "bc_check_id": "BC_AWS_SECRETS_1", "check_name": "Ensure no hard-coded secrets exist in EC2 user data", "check_result": {"result": "PASSED", "evaluated_keys": ["user_data"]}, "code_block": [[38, "resource \"aws_launch_template\" \"jenkins\" {\n"], [39, "  name_prefix            = \"${var.project}-${var.environment}-jenkins-\"\n"], [40, "  image_id               = data.aws_ami.amazon_linux_2.id\n"], [41, "  instance_type          = var.instance_type\n"], [42, "  vpc_security_group_ids = [aws_security_group.jenkins_sg.id]\n"], [43, "  key_name               = var.key_name\n"], [44, "\n"], [45, "  iam_instance_profile {\n"], [46, "    name = aws_iam_instance_profile.jenkins_profile.name\n"], [47, "  }\n"], [48, "\n"], [49, "  user_data = base64encode(<<-EOF\n"], [50, "    #!/bin/bash\n"], [51, "    sudo yum update -y\n"], [52, "    sudo amazon-linux-extras install java-openjdk11 -y\n"], [53, "    sudo yum install -y jenkins git docker\n"], [54, "    sudo systemctl start jenkins\n"], [55, "    sudo systemctl enable jenkins\n"], [56, "    sudo systemctl start docker\n"], [57, "    sudo systemctl enable docker\n"], [58, "    sudo usermod -aG docker jenkins\n"], [59, "    sudo systemctl restart jenkins\n"], [60, "\n"], [61, "    # Install AWS CLI\n"], [62, "    curl \"https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip\" -o \"awscliv2.zip\"\n"], [63, "    unzip awscliv2.zip\n"], [64, "    sudo ./aws/install\n"], [65, "\n"], [66, "    # Install Terraform\n"], [67, "    TERRAFORM_VERSION=\"1.0.0\"\n"], [68, "    wget https://releases.hashicorp.com/terraform/$${TERRAFORM_VERSION}/terraform_$${TERRAFORM_VERSION}_linux_amd64.zip\n"], [69, "    unzip terraform_$${TERRAFORM_VERSION}_linux_amd64.zip\n"], [70, "    sudo mv terraform /usr/local/bin/\n"], [71, "\n"], [72, "    # Install SSM Agent\n"], [73, "    sudo yum install -y https://s3.amazonaws.com/ec2-downloads-windows/SSMAgent/latest/linux_amd64/amazon-ssm-agent.rpm\n"], [74, "    sudo systemctl enable amazon-ssm-agent\n"], [75, "    sudo systemctl start amazon-ssm-agent\n"], [76, "  EOF\n"], [77, "  )\n"], [78, "\n"], [79, "  block_device_mappings {\n"], [80, "    device_name = \"/dev/xvda\"\n"], [81, "    ebs {\n"], [82, "      volume_size           = 30\n"], [83, "      volume_type           = \"gp3\"\n"], [84, "      delete_on_termination = true\n"], [85, "      encrypted             = true\n"], [86, "    }\n"], [87, "  }\n"], [88, "\n"], [89, "  metadata_options {\n"], [90, "    http_endpoint               = \"enabled\"\n"], [91, "    http_tokens                 = \"required\" # IMDSv2 required for better security\n"], [92, "    http_put_response_hop_limit = 1\n"], [93, "  }\n"], [94, "\n"], [95, "  monitoring {\n"], [96, "    enabled = true\n"], [97, "  }\n"], [98, "\n"], [99, "  tag_specifications {\n"], [100, "    resource_type = \"instance\"\n"], [101, "    tags = {\n"], [102, "      Name        = \"${var.project}-${var.environment}-jenkins\"\n"], [103, "      Environment = var.environment\n"], [104, "      Project     = var.project\n"], [105, "      ManagedBy   = \"Terraform\"\n"], [106, "    }\n"], [107, "  }\n"], [108, "\n"], [109, "  tag_specifications {\n"], [110, "    resource_type = \"volume\"\n"], [111, "    tags = {\n"], [112, "      Name        = \"${var.project}-${var.environment}-jenkins-volume\"\n"], [113, "      Environment = var.environment\n"], [114, "      Project     = var.project\n"], [115, "    }\n"], [116, "  }\n"], [117, "\n"], [118, "  lifecycle {\n"], [119, "    create_before_destroy = true\n"], [120, "  }\n"], [121, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [38, 121], "resource": "module.ecs_jenkins_github_dr.module.cicd.aws_launch_template.jenkins", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2Credentials", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-1", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_88", "bc_check_id": "BC_AWS_PUBLIC_12", "check_name": "EC2 instance should not have public IP.", "check_result": {"result": "PASSED", "evaluated_keys": ["network_interfaces/[0]/associate_public_ip_address"]}, "code_block": [[38, "resource \"aws_launch_template\" \"jenkins\" {\n"], [39, "  name_prefix            = \"${var.project}-${var.environment}-jenkins-\"\n"], [40, "  image_id               = data.aws_ami.amazon_linux_2.id\n"], [41, "  instance_type          = var.instance_type\n"], [42, "  vpc_security_group_ids = [aws_security_group.jenkins_sg.id]\n"], [43, "  key_name               = var.key_name\n"], [44, "\n"], [45, "  iam_instance_profile {\n"], [46, "    name = aws_iam_instance_profile.jenkins_profile.name\n"], [47, "  }\n"], [48, "\n"], [49, "  user_data = base64encode(<<-EOF\n"], [50, "    #!/bin/bash\n"], [51, "    sudo yum update -y\n"], [52, "    sudo amazon-linux-extras install java-openjdk11 -y\n"], [53, "    sudo yum install -y jenkins git docker\n"], [54, "    sudo systemctl start jenkins\n"], [55, "    sudo systemctl enable jenkins\n"], [56, "    sudo systemctl start docker\n"], [57, "    sudo systemctl enable docker\n"], [58, "    sudo usermod -aG docker jenkins\n"], [59, "    sudo systemctl restart jenkins\n"], [60, "\n"], [61, "    # Install AWS CLI\n"], [62, "    curl \"https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip\" -o \"awscliv2.zip\"\n"], [63, "    unzip awscliv2.zip\n"], [64, "    sudo ./aws/install\n"], [65, "\n"], [66, "    # Install Terraform\n"], [67, "    TERRAFORM_VERSION=\"1.0.0\"\n"], [68, "    wget https://releases.hashicorp.com/terraform/$${TERRAFORM_VERSION}/terraform_$${TERRAFORM_VERSION}_linux_amd64.zip\n"], [69, "    unzip terraform_$${TERRAFORM_VERSION}_linux_amd64.zip\n"], [70, "    sudo mv terraform /usr/local/bin/\n"], [71, "\n"], [72, "    # Install SSM Agent\n"], [73, "    sudo yum install -y https://s3.amazonaws.com/ec2-downloads-windows/SSMAgent/latest/linux_amd64/amazon-ssm-agent.rpm\n"], [74, "    sudo systemctl enable amazon-ssm-agent\n"], [75, "    sudo systemctl start amazon-ssm-agent\n"], [76, "  EOF\n"], [77, "  )\n"], [78, "\n"], [79, "  block_device_mappings {\n"], [80, "    device_name = \"/dev/xvda\"\n"], [81, "    ebs {\n"], [82, "      volume_size           = 30\n"], [83, "      volume_type           = \"gp3\"\n"], [84, "      delete_on_termination = true\n"], [85, "      encrypted             = true\n"], [86, "    }\n"], [87, "  }\n"], [88, "\n"], [89, "  metadata_options {\n"], [90, "    http_endpoint               = \"enabled\"\n"], [91, "    http_tokens                 = \"required\" # IMDSv2 required for better security\n"], [92, "    http_put_response_hop_limit = 1\n"], [93, "  }\n"], [94, "\n"], [95, "  monitoring {\n"], [96, "    enabled = true\n"], [97, "  }\n"], [98, "\n"], [99, "  tag_specifications {\n"], [100, "    resource_type = \"instance\"\n"], [101, "    tags = {\n"], [102, "      Name        = \"${var.project}-${var.environment}-jenkins\"\n"], [103, "      Environment = var.environment\n"], [104, "      Project     = var.project\n"], [105, "      ManagedBy   = \"Terraform\"\n"], [106, "    }\n"], [107, "  }\n"], [108, "\n"], [109, "  tag_specifications {\n"], [110, "    resource_type = \"volume\"\n"], [111, "    tags = {\n"], [112, "      Name        = \"${var.project}-${var.environment}-jenkins-volume\"\n"], [113, "      Environment = var.environment\n"], [114, "      Project     = var.project\n"], [115, "    }\n"], [116, "  }\n"], [117, "\n"], [118, "  lifecycle {\n"], [119, "    create_before_destroy = true\n"], [120, "  }\n"], [121, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [38, 121], "resource": "module.ecs_jenkins_github_dr.module.cicd.aws_launch_template.jenkins", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2PublicIP", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-12", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_79", "bc_check_id": "BC_AWS_GENERAL_31", "check_name": "Ensure Instance Metadata Service Version 1 is not enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["metadata_options/[0]/http_tokens"]}, "code_block": [[38, "resource \"aws_launch_template\" \"jenkins\" {\n"], [39, "  name_prefix            = \"${var.project}-${var.environment}-jenkins-\"\n"], [40, "  image_id               = data.aws_ami.amazon_linux_2.id\n"], [41, "  instance_type          = var.instance_type\n"], [42, "  vpc_security_group_ids = [aws_security_group.jenkins_sg.id]\n"], [43, "  key_name               = var.key_name\n"], [44, "\n"], [45, "  iam_instance_profile {\n"], [46, "    name = aws_iam_instance_profile.jenkins_profile.name\n"], [47, "  }\n"], [48, "\n"], [49, "  user_data = base64encode(<<-EOF\n"], [50, "    #!/bin/bash\n"], [51, "    sudo yum update -y\n"], [52, "    sudo amazon-linux-extras install java-openjdk11 -y\n"], [53, "    sudo yum install -y jenkins git docker\n"], [54, "    sudo systemctl start jenkins\n"], [55, "    sudo systemctl enable jenkins\n"], [56, "    sudo systemctl start docker\n"], [57, "    sudo systemctl enable docker\n"], [58, "    sudo usermod -aG docker jenkins\n"], [59, "    sudo systemctl restart jenkins\n"], [60, "\n"], [61, "    # Install AWS CLI\n"], [62, "    curl \"https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip\" -o \"awscliv2.zip\"\n"], [63, "    unzip awscliv2.zip\n"], [64, "    sudo ./aws/install\n"], [65, "\n"], [66, "    # Install Terraform\n"], [67, "    TERRAFORM_VERSION=\"1.0.0\"\n"], [68, "    wget https://releases.hashicorp.com/terraform/$${TERRAFORM_VERSION}/terraform_$${TERRAFORM_VERSION}_linux_amd64.zip\n"], [69, "    unzip terraform_$${TERRAFORM_VERSION}_linux_amd64.zip\n"], [70, "    sudo mv terraform /usr/local/bin/\n"], [71, "\n"], [72, "    # Install SSM Agent\n"], [73, "    sudo yum install -y https://s3.amazonaws.com/ec2-downloads-windows/SSMAgent/latest/linux_amd64/amazon-ssm-agent.rpm\n"], [74, "    sudo systemctl enable amazon-ssm-agent\n"], [75, "    sudo systemctl start amazon-ssm-agent\n"], [76, "  EOF\n"], [77, "  )\n"], [78, "\n"], [79, "  block_device_mappings {\n"], [80, "    device_name = \"/dev/xvda\"\n"], [81, "    ebs {\n"], [82, "      volume_size           = 30\n"], [83, "      volume_type           = \"gp3\"\n"], [84, "      delete_on_termination = true\n"], [85, "      encrypted             = true\n"], [86, "    }\n"], [87, "  }\n"], [88, "\n"], [89, "  metadata_options {\n"], [90, "    http_endpoint               = \"enabled\"\n"], [91, "    http_tokens                 = \"required\" # IMDSv2 required for better security\n"], [92, "    http_put_response_hop_limit = 1\n"], [93, "  }\n"], [94, "\n"], [95, "  monitoring {\n"], [96, "    enabled = true\n"], [97, "  }\n"], [98, "\n"], [99, "  tag_specifications {\n"], [100, "    resource_type = \"instance\"\n"], [101, "    tags = {\n"], [102, "      Name        = \"${var.project}-${var.environment}-jenkins\"\n"], [103, "      Environment = var.environment\n"], [104, "      Project     = var.project\n"], [105, "      ManagedBy   = \"Terraform\"\n"], [106, "    }\n"], [107, "  }\n"], [108, "\n"], [109, "  tag_specifications {\n"], [110, "    resource_type = \"volume\"\n"], [111, "    tags = {\n"], [112, "      Name        = \"${var.project}-${var.environment}-jenkins-volume\"\n"], [113, "      Environment = var.environment\n"], [114, "      Project     = var.project\n"], [115, "    }\n"], [116, "  }\n"], [117, "\n"], [118, "  lifecycle {\n"], [119, "    create_before_destroy = true\n"], [120, "  }\n"], [121, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [38, 121], "resource": "module.ecs_jenkins_github_dr.module.cicd.aws_launch_template.jenkins", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IMDSv1Disabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-31", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_341", "bc_check_id": "BC_AWS_GENERAL_244", "check_name": "Ensure Launch template should not have a metadata response hop limit greater than 1", "check_result": {"result": "PASSED", "evaluated_keys": ["metadata_options/[0]/http_put_response_hop_limit"]}, "code_block": [[38, "resource \"aws_launch_template\" \"jenkins\" {\n"], [39, "  name_prefix            = \"${var.project}-${var.environment}-jenkins-\"\n"], [40, "  image_id               = data.aws_ami.amazon_linux_2.id\n"], [41, "  instance_type          = var.instance_type\n"], [42, "  vpc_security_group_ids = [aws_security_group.jenkins_sg.id]\n"], [43, "  key_name               = var.key_name\n"], [44, "\n"], [45, "  iam_instance_profile {\n"], [46, "    name = aws_iam_instance_profile.jenkins_profile.name\n"], [47, "  }\n"], [48, "\n"], [49, "  user_data = base64encode(<<-EOF\n"], [50, "    #!/bin/bash\n"], [51, "    sudo yum update -y\n"], [52, "    sudo amazon-linux-extras install java-openjdk11 -y\n"], [53, "    sudo yum install -y jenkins git docker\n"], [54, "    sudo systemctl start jenkins\n"], [55, "    sudo systemctl enable jenkins\n"], [56, "    sudo systemctl start docker\n"], [57, "    sudo systemctl enable docker\n"], [58, "    sudo usermod -aG docker jenkins\n"], [59, "    sudo systemctl restart jenkins\n"], [60, "\n"], [61, "    # Install AWS CLI\n"], [62, "    curl \"https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip\" -o \"awscliv2.zip\"\n"], [63, "    unzip awscliv2.zip\n"], [64, "    sudo ./aws/install\n"], [65, "\n"], [66, "    # Install Terraform\n"], [67, "    TERRAFORM_VERSION=\"1.0.0\"\n"], [68, "    wget https://releases.hashicorp.com/terraform/$${TERRAFORM_VERSION}/terraform_$${TERRAFORM_VERSION}_linux_amd64.zip\n"], [69, "    unzip terraform_$${TERRAFORM_VERSION}_linux_amd64.zip\n"], [70, "    sudo mv terraform /usr/local/bin/\n"], [71, "\n"], [72, "    # Install SSM Agent\n"], [73, "    sudo yum install -y https://s3.amazonaws.com/ec2-downloads-windows/SSMAgent/latest/linux_amd64/amazon-ssm-agent.rpm\n"], [74, "    sudo systemctl enable amazon-ssm-agent\n"], [75, "    sudo systemctl start amazon-ssm-agent\n"], [76, "  EOF\n"], [77, "  )\n"], [78, "\n"], [79, "  block_device_mappings {\n"], [80, "    device_name = \"/dev/xvda\"\n"], [81, "    ebs {\n"], [82, "      volume_size           = 30\n"], [83, "      volume_type           = \"gp3\"\n"], [84, "      delete_on_termination = true\n"], [85, "      encrypted             = true\n"], [86, "    }\n"], [87, "  }\n"], [88, "\n"], [89, "  metadata_options {\n"], [90, "    http_endpoint               = \"enabled\"\n"], [91, "    http_tokens                 = \"required\" # IMDSv2 required for better security\n"], [92, "    http_put_response_hop_limit = 1\n"], [93, "  }\n"], [94, "\n"], [95, "  monitoring {\n"], [96, "    enabled = true\n"], [97, "  }\n"], [98, "\n"], [99, "  tag_specifications {\n"], [100, "    resource_type = \"instance\"\n"], [101, "    tags = {\n"], [102, "      Name        = \"${var.project}-${var.environment}-jenkins\"\n"], [103, "      Environment = var.environment\n"], [104, "      Project     = var.project\n"], [105, "      ManagedBy   = \"Terraform\"\n"], [106, "    }\n"], [107, "  }\n"], [108, "\n"], [109, "  tag_specifications {\n"], [110, "    resource_type = \"volume\"\n"], [111, "    tags = {\n"], [112, "      Name        = \"${var.project}-${var.environment}-jenkins-volume\"\n"], [113, "      Environment = var.environment\n"], [114, "      Project     = var.project\n"], [115, "    }\n"], [116, "  }\n"], [117, "\n"], [118, "  lifecycle {\n"], [119, "    create_before_destroy = true\n"], [120, "  }\n"], [121, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [38, 121], "resource": "module.ecs_jenkins_github_dr.module.cicd.aws_launch_template.jenkins", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LaunchTemplateMetadataHop", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-341", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_315", "bc_check_id": "BC_AWS_GENERAL_226", "check_name": "Ensure EC2 Auto Scaling groups use EC2 launch templates", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[124, "resource \"aws_autoscaling_group\" \"jenkins\" {\n"], [125, "  name                = \"${var.project}-${var.environment}-jenkins-asg\"\n"], [126, "  vpc_zone_identifier = [var.subnet_id] # Using only one subnet for Jenkins\n"], [127, "  min_size            = 1\n"], [128, "  max_size            = 1\n"], [129, "  desired_capacity    = 1\n"], [130, "\n"], [131, "  launch_template {\n"], [132, "    id      = aws_launch_template.jenkins.id\n"], [133, "    version = \"$Latest\"\n"], [134, "  }\n"], [135, "\n"], [136, "  health_check_type         = \"EC2\"\n"], [137, "  health_check_grace_period = 300\n"], [138, "  termination_policies      = [\"OldestLaunchTemplate\"]\n"], [139, "  wait_for_capacity_timeout = \"10m\"\n"], [140, "\n"], [141, "  # Ensure we create new instances before destroying old ones\n"], [142, "  instance_refresh {\n"], [143, "    strategy = \"Rolling\"\n"], [144, "    preferences {\n"], [145, "      min_healthy_percentage = 100\n"], [146, "      instance_warmup        = 300\n"], [147, "    }\n"], [148, "  }\n"], [149, "\n"], [150, "  lifecycle {\n"], [151, "    create_before_destroy = true\n"], [152, "    ignore_changes        = [desired_capacity]\n"], [153, "  }\n"], [154, "\n"], [155, "  tag {\n"], [156, "    key                 = \"Name\"\n"], [157, "    value               = \"${var.project}-${var.environment}-jenkins\"\n"], [158, "    propagate_at_launch = true\n"], [159, "  }\n"], [160, "\n"], [161, "  tag {\n"], [162, "    key                 = \"Environment\"\n"], [163, "    value               = var.environment\n"], [164, "    propagate_at_launch = true\n"], [165, "  }\n"], [166, "\n"], [167, "  tag {\n"], [168, "    key                 = \"Project\"\n"], [169, "    value               = var.project\n"], [170, "    propagate_at_launch = true\n"], [171, "  }\n"], [172, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [124, 172], "resource": "module.ecs_jenkins_github_dr.module.cicd.aws_autoscaling_group.jenkins", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.AutoScalingLaunchTemplate", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-315", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_153", "bc_check_id": "BC_AWS_GENERAL_82", "check_name": "Autoscaling groups should supply tags to launch configurations", "check_result": {"result": "PASSED", "evaluated_keys": ["tag", "tags"]}, "code_block": [[124, "resource \"aws_autoscaling_group\" \"jenkins\" {\n"], [125, "  name                = \"${var.project}-${var.environment}-jenkins-asg\"\n"], [126, "  vpc_zone_identifier = [var.subnet_id] # Using only one subnet for Jenkins\n"], [127, "  min_size            = 1\n"], [128, "  max_size            = 1\n"], [129, "  desired_capacity    = 1\n"], [130, "\n"], [131, "  launch_template {\n"], [132, "    id      = aws_launch_template.jenkins.id\n"], [133, "    version = \"$Latest\"\n"], [134, "  }\n"], [135, "\n"], [136, "  health_check_type         = \"EC2\"\n"], [137, "  health_check_grace_period = 300\n"], [138, "  termination_policies      = [\"OldestLaunchTemplate\"]\n"], [139, "  wait_for_capacity_timeout = \"10m\"\n"], [140, "\n"], [141, "  # Ensure we create new instances before destroying old ones\n"], [142, "  instance_refresh {\n"], [143, "    strategy = \"Rolling\"\n"], [144, "    preferences {\n"], [145, "      min_healthy_percentage = 100\n"], [146, "      instance_warmup        = 300\n"], [147, "    }\n"], [148, "  }\n"], [149, "\n"], [150, "  lifecycle {\n"], [151, "    create_before_destroy = true\n"], [152, "    ignore_changes        = [desired_capacity]\n"], [153, "  }\n"], [154, "\n"], [155, "  tag {\n"], [156, "    key                 = \"Name\"\n"], [157, "    value               = \"${var.project}-${var.environment}-jenkins\"\n"], [158, "    propagate_at_launch = true\n"], [159, "  }\n"], [160, "\n"], [161, "  tag {\n"], [162, "    key                 = \"Environment\"\n"], [163, "    value               = var.environment\n"], [164, "    propagate_at_launch = true\n"], [165, "  }\n"], [166, "\n"], [167, "  tag {\n"], [168, "    key                 = \"Project\"\n"], [169, "    value               = var.project\n"], [170, "    propagate_at_launch = true\n"], [171, "  }\n"], [172, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [124, 172], "resource": "module.ecs_jenkins_github_dr.module.cicd.aws_autoscaling_group.jenkins", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.AutoScalingTagging", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/autoscaling-groups-should-supply-tags-to-launch-configurations", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_328", "bc_check_id": "BC_AWS_NETWORKING_89", "check_name": "Ensure that ALB is configured with defensive or strictest desync mitigation mode", "check_result": {"result": "PASSED", "evaluated_keys": ["desync_mitigation_mode"]}, "code_block": [[175, "resource \"aws_lb\" \"jenkins_nlb\" {\n"], [176, "  name               = \"${var.project}-${var.environment}-jenkins-nlb\"\n"], [177, "  internal           = false\n"], [178, "  load_balancer_type = \"network\"\n"], [179, "  subnets            = [var.subnet_id]\n"], [180, "\n"], [181, "  tags = {\n"], [182, "    Name        = \"${var.project}-${var.environment}-jenkins-nlb\"\n"], [183, "    Environment = var.environment\n"], [184, "    Project     = var.project\n"], [185, "  }\n"], [186, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [175, 186], "resource": "module.ecs_jenkins_github_dr.module.cicd.aws_lb.jenkins_nlb", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ALBDesyncMode", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-nlb", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-328", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_2", "bc_check_id": "BC_AWS_NETWORKING_29", "check_name": "Ensure ALB protocol is HTTPS", "check_result": {"result": "PASSED", "evaluated_keys": ["protocol"]}, "code_block": [[219, "resource \"aws_lb_listener\" \"jenkins\" {\n"], [220, "  load_balancer_arn = aws_lb.jenkins_nlb.arn\n"], [221, "  port              = 80\n"], [222, "  protocol          = \"TCP\"\n"], [223, "\n"], [224, "  default_action {\n"], [225, "    type             = \"forward\"\n"], [226, "    target_group_arn = aws_lb_target_group.jenkins.arn\n"], [227, "  }\n"], [228, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [219, 228], "resource": "module.ecs_jenkins_github_dr.module.cicd.aws_lb_listener.jenkins", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ALBListenerHTTPS", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-29", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_337", "bc_check_id": "BC_AWS_GENERAL_242", "check_name": "Ensure SSM parameters are using KMS CMK", "check_result": {"result": "PASSED", "evaluated_keys": ["key_id"]}, "code_block": [[248, "resource \"aws_ssm_parameter\" \"jenkins_url\" {\n"], [249, "  name        = \"/${var.project}/${var.environment}/jenkins-url\"\n"], [250, "  description = \"Jenkins URL\"\n"], [251, "  type        = \"String\"\n"], [252, "  value       = \"http://${aws_lb.jenkins_nlb.dns_name}\"\n"], [253, "\n"], [254, "  tags = {\n"], [255, "    Name        = \"${var.project}-${var.environment}-jenkins-url\"\n"], [256, "    Environment = var.environment\n"], [257, "    Project     = var.project\n"], [258, "  }\n"], [259, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [248, 259], "resource": "module.ecs_jenkins_github_dr.module.cicd.aws_ssm_parameter.jenkins_url", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SSMParameterUsesCMK", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-url", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-337", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_386", "bc_check_id": "BC_AWS_GENERAL_271", "check_name": "Reduce potential for WhoAMI cloud image name confusion attack", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[237, "data \"aws_ami\" \"amazon_linux_2\" {\n"], [238, "  most_recent = true\n"], [239, "  owners      = [\"amazon\"]\n"], [240, "\n"], [241, "  filter {\n"], [242, "    name   = \"name\"\n"], [243, "    values = [\"amzn2-ami-hvm-*-x86_64-gp2\"]\n"], [244, "  }\n"], [245, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [237, 245], "resource": "module.ecs_jenkins_github_dr.module.cicd.aws_ami.amazon_linux_2", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.WhoAMI", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-supply-chain-policies/bc-aws-386", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[10, "resource \"aws_iam_role\" \"rds_monitoring_role\" {\n"], [11, "  name = \"rds-monitoring-role\"\n"], [12, "\n"], [13, "  assume_role_policy = jsonencode({\n"], [14, "    Version = \"2012-10-17\",\n"], [15, "    Statement = [{\n"], [16, "      Action = \"sts:AssumeRole\",\n"], [17, "      Effect = \"Allow\",\n"], [18, "      Principal = {\n"], [19, "        Service = \"monitoring.rds.amazonaws.com\"\n"], [20, "      }\n"], [21, "    }]\n"], [22, "  })\n"], [23, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [10, 23], "resource": "module.ecs_jenkins_github.module.database.aws_iam_role.rds_monitoring_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[10, "resource \"aws_iam_role\" \"rds_monitoring_role\" {\n"], [11, "  name = \"rds-monitoring-role\"\n"], [12, "\n"], [13, "  assume_role_policy = jsonencode({\n"], [14, "    Version = \"2012-10-17\",\n"], [15, "    Statement = [{\n"], [16, "      Action = \"sts:AssumeRole\",\n"], [17, "      Effect = \"Allow\",\n"], [18, "      Principal = {\n"], [19, "        Service = \"monitoring.rds.amazonaws.com\"\n"], [20, "      }\n"], [21, "    }]\n"], [22, "  })\n"], [23, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [10, 23], "resource": "module.ecs_jenkins_github.module.database.aws_iam_role.rds_monitoring_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[10, "resource \"aws_iam_role\" \"rds_monitoring_role\" {\n"], [11, "  name = \"rds-monitoring-role\"\n"], [12, "\n"], [13, "  assume_role_policy = jsonencode({\n"], [14, "    Version = \"2012-10-17\",\n"], [15, "    Statement = [{\n"], [16, "      Action = \"sts:AssumeRole\",\n"], [17, "      Effect = \"Allow\",\n"], [18, "      Principal = {\n"], [19, "        Service = \"monitoring.rds.amazonaws.com\"\n"], [20, "      }\n"], [21, "    }]\n"], [22, "  })\n"], [23, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [10, 23], "resource": "module.ecs_jenkins_github.module.database.aws_iam_role.rds_monitoring_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[25, "resource \"aws_iam_role_policy_attachment\" \"rds_monitoring_attach\" {\n"], [26, "  role       = aws_iam_role.rds_monitoring_role.name\n"], [27, "  policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonRDSEnhancedMonitoringRole\"\n"], [28, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [25, 28], "resource": "module.ecs_jenkins_github.module.database.aws_iam_role_policy_attachment.rds_monitoring_attach", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_133", "bc_check_id": "BC_AWS_GENERAL_46", "check_name": "Ensure that RDS instances has backup policy", "check_result": {"result": "PASSED", "evaluated_keys": ["backup_retention_period"]}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.DBInstanceBackupRetentionPeriod", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-rds-instances-have-backup-policy", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_129", "bc_check_id": "BC_AWS_IAM_60", "check_name": "Ensure that respective logs of Amazon Relational Database Service (Amazon RDS) are enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["enabled_cloudwatch_logs_exports/[0]"]}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.DBInstanceLogging", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-that-respective-logs-of-amazon-relational-database-service-amazon-rds-are-enabled", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_226", "bc_check_id": "BC_AWS_GENERAL_121", "check_name": "Ensure DB instance gets all minor upgrades automatically", "check_result": {"result": "PASSED", "evaluated_keys": ["auto_minor_version_upgrade"]}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.DBInstanceMinorUpgrade", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-db-instance-gets-all-minor-upgrades-automatically", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_211", "bc_check_id": "BC_AWS_GENERAL_118", "check_name": "Ensure RDS uses a modern CaCert", "check_result": {"result": "PASSED", "evaluated_keys": ["ca_cert_identifier"]}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSCACertIsRecent", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-rds-uses-a-modern-cacert", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_16", "bc_check_id": "BC_AWS_GENERAL_4", "check_name": "Ensure all data stored in the RDS is securely encrypted at rest", "check_result": {"result": "PASSED", "evaluated_keys": ["storage_encrypted"]}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSEncryption", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-4", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_118", "bc_check_id": "BC_AWS_LOGGING_28", "check_name": "Ensure that enhanced monitoring is enabled for Amazon RDS instances", "check_result": {"result": "PASSED", "evaluated_keys": ["monitoring_interval"]}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSEnhancedMonitorEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/ensure-that-enhanced-monitoring-is-enabled-for-amazon-rds-instances", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_161", "bc_check_id": "BC_AWS_IAM_65", "check_name": "Ensure RDS database has IAM authentication enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["iam_database_authentication_enabled"]}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSIAMAuthentication", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-rds-database-has-iam-authentication-enabled", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_293", "bc_check_id": "BC_AWS_GENERAL_208", "check_name": "Ensure that AWS database instances have deletion protection enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["deletion_protection"]}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSInstanceDeletionProtection", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-293", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_354", "bc_check_id": "BC_AWS_GENERAL_254", "check_name": "Ensure RDS Performance Insights are encrypted using KMS CMKs", "check_result": {"result": "PASSED", "evaluated_keys": ["performance_insights_kms_key_id"]}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSInstancePerfInsightsEncryptionWithCMK", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-354", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_157", "bc_check_id": "BC_AWS_GENERAL_73", "check_name": "Ensure that RDS instances have Multi-AZ enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["multi_az"]}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSMultiAZEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-73", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_17", "bc_check_id": "BC_AWS_PUBLIC_2", "check_name": "Ensure all data stored in RDS is not publicly accessible", "check_result": {"result": "PASSED", "evaluated_keys": ["publicly_accessible"]}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSPubliclyAccessible", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-2", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_388", "bc_check_id": null, "check_name": "Ensure AWS Aurora PostgreSQL is not exposed to local file read vulnerability", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.UnpatchedAuroraPostgresDB", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[10, "resource \"aws_iam_role\" \"rds_monitoring_role\" {\n"], [11, "  name = \"rds-monitoring-role\"\n"], [12, "\n"], [13, "  assume_role_policy = jsonencode({\n"], [14, "    Version = \"2012-10-17\",\n"], [15, "    Statement = [{\n"], [16, "      Action = \"sts:AssumeRole\",\n"], [17, "      Effect = \"Allow\",\n"], [18, "      Principal = {\n"], [19, "        Service = \"monitoring.rds.amazonaws.com\"\n"], [20, "      }\n"], [21, "    }]\n"], [22, "  })\n"], [23, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [10, 23], "resource": "module.ecs_jenkins_github_dr.module.database.aws_iam_role.rds_monitoring_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[10, "resource \"aws_iam_role\" \"rds_monitoring_role\" {\n"], [11, "  name = \"rds-monitoring-role\"\n"], [12, "\n"], [13, "  assume_role_policy = jsonencode({\n"], [14, "    Version = \"2012-10-17\",\n"], [15, "    Statement = [{\n"], [16, "      Action = \"sts:AssumeRole\",\n"], [17, "      Effect = \"Allow\",\n"], [18, "      Principal = {\n"], [19, "        Service = \"monitoring.rds.amazonaws.com\"\n"], [20, "      }\n"], [21, "    }]\n"], [22, "  })\n"], [23, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [10, 23], "resource": "module.ecs_jenkins_github_dr.module.database.aws_iam_role.rds_monitoring_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[10, "resource \"aws_iam_role\" \"rds_monitoring_role\" {\n"], [11, "  name = \"rds-monitoring-role\"\n"], [12, "\n"], [13, "  assume_role_policy = jsonencode({\n"], [14, "    Version = \"2012-10-17\",\n"], [15, "    Statement = [{\n"], [16, "      Action = \"sts:AssumeRole\",\n"], [17, "      Effect = \"Allow\",\n"], [18, "      Principal = {\n"], [19, "        Service = \"monitoring.rds.amazonaws.com\"\n"], [20, "      }\n"], [21, "    }]\n"], [22, "  })\n"], [23, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [10, 23], "resource": "module.ecs_jenkins_github_dr.module.database.aws_iam_role.rds_monitoring_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[25, "resource \"aws_iam_role_policy_attachment\" \"rds_monitoring_attach\" {\n"], [26, "  role       = aws_iam_role.rds_monitoring_role.name\n"], [27, "  policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonRDSEnhancedMonitoringRole\"\n"], [28, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [25, 28], "resource": "module.ecs_jenkins_github_dr.module.database.aws_iam_role_policy_attachment.rds_monitoring_attach", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_133", "bc_check_id": "BC_AWS_GENERAL_46", "check_name": "Ensure that RDS instances has backup policy", "check_result": {"result": "PASSED", "evaluated_keys": ["backup_retention_period"]}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github_dr.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.DBInstanceBackupRetentionPeriod", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-rds-instances-have-backup-policy", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_129", "bc_check_id": "BC_AWS_IAM_60", "check_name": "Ensure that respective logs of Amazon Relational Database Service (Amazon RDS) are enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["enabled_cloudwatch_logs_exports/[0]"]}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github_dr.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.DBInstanceLogging", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-that-respective-logs-of-amazon-relational-database-service-amazon-rds-are-enabled", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_226", "bc_check_id": "BC_AWS_GENERAL_121", "check_name": "Ensure DB instance gets all minor upgrades automatically", "check_result": {"result": "PASSED", "evaluated_keys": ["auto_minor_version_upgrade"]}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github_dr.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.DBInstanceMinorUpgrade", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-db-instance-gets-all-minor-upgrades-automatically", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_211", "bc_check_id": "BC_AWS_GENERAL_118", "check_name": "Ensure RDS uses a modern CaCert", "check_result": {"result": "PASSED", "evaluated_keys": ["ca_cert_identifier"]}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github_dr.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSCACertIsRecent", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-rds-uses-a-modern-cacert", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_16", "bc_check_id": "BC_AWS_GENERAL_4", "check_name": "Ensure all data stored in the RDS is securely encrypted at rest", "check_result": {"result": "PASSED", "evaluated_keys": ["storage_encrypted"]}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github_dr.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSEncryption", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-4", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_118", "bc_check_id": "BC_AWS_LOGGING_28", "check_name": "Ensure that enhanced monitoring is enabled for Amazon RDS instances", "check_result": {"result": "PASSED", "evaluated_keys": ["monitoring_interval"]}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github_dr.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSEnhancedMonitorEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/ensure-that-enhanced-monitoring-is-enabled-for-amazon-rds-instances", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_161", "bc_check_id": "BC_AWS_IAM_65", "check_name": "Ensure RDS database has IAM authentication enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["iam_database_authentication_enabled"]}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github_dr.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSIAMAuthentication", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-rds-database-has-iam-authentication-enabled", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_293", "bc_check_id": "BC_AWS_GENERAL_208", "check_name": "Ensure that AWS database instances have deletion protection enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["deletion_protection"]}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github_dr.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSInstanceDeletionProtection", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-293", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_354", "bc_check_id": "BC_AWS_GENERAL_254", "check_name": "Ensure RDS Performance Insights are encrypted using KMS CMKs", "check_result": {"result": "PASSED", "evaluated_keys": ["performance_insights_kms_key_id"]}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github_dr.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSInstancePerfInsightsEncryptionWithCMK", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-354", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_157", "bc_check_id": "BC_AWS_GENERAL_73", "check_name": "Ensure that RDS instances have Multi-AZ enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["multi_az"]}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github_dr.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSMultiAZEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-73", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_17", "bc_check_id": "BC_AWS_PUBLIC_2", "check_name": "Ensure all data stored in RDS is not publicly accessible", "check_result": {"result": "PASSED", "evaluated_keys": ["publicly_accessible"]}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github_dr.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSPubliclyAccessible", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-2", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_388", "bc_check_id": null, "check_name": "Ensure AWS Aurora PostgreSQL is not exposed to local file read vulnerability", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github_dr.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.UnpatchedAuroraPostgresDB", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_46", "bc_check_id": "BC_AWS_SECRETS_1", "check_name": "Ensure no hard-coded secrets exist in EC2 user data", "check_result": {"result": "PASSED", "evaluated_keys": ["user_data"]}, "code_block": [[19, "resource \"aws_launch_template\" \"ecs_launch_template\" {\n"], [20, "  name_prefix            = \"${var.project}-${var.environment}-\"\n"], [21, "  image_id               = data.aws_ami.ecs_optimized.id\n"], [22, "  instance_type          = var.instance_type\n"], [23, "  vpc_security_group_ids = [var.security_group_id]\n"], [24, "  key_name               = var.key_name\n"], [25, "\n"], [26, "  dynamic \"instance_market_options\" {\n"], [27, "    for_each = var.use_spot_instances ? [1] : []\n"], [28, "    content {\n"], [29, "      market_type = \"spot\"\n"], [30, "      spot_options {\n"], [31, "        max_price                      = var.spot_price\n"], [32, "        spot_instance_type             = \"persistent\"\n"], [33, "        instance_interruption_behavior = \"terminate\"\n"], [34, "      }\n"], [35, "    }\n"], [36, "  }\n"], [37, "\n"], [38, "  iam_instance_profile {\n"], [39, "    name = var.instance_profile_name\n"], [40, "  }\n"], [41, "\n"], [42, "  # ECS Instance Configuration\n"], [43, "  user_data = base64encode(<<-EOF\n"], [44, "    #!/bin/bash\n"], [45, "    echo ECS_CLUSTER=${var.ecs_cluster_name} >> /etc/ecs/ecs.config\n"], [46, "    echo ECS_ENABLE_CONTAINER_METADATA=true >> /etc/ecs/ecs.config\n"], [47, "    echo ECS_ENABLE_SPOT_INSTANCE_DRAINING=true >> /etc/ecs/ecs.config\n"], [48, "    yum update -y\n"], [49, "    amazon-linux-extras install epel -y\n"], [50, "    yum install -y amazon-cloudwatch-agent\n"], [51, "    yum install -y https://s3.amazonaws.com/ec2-downloads-windows/SSMAgent/latest/linux_amd64/amazon-ssm-agent.rpm\n"], [52, "    systemctl enable amazon-ssm-agent\n"], [53, "    systemctl start amazon-ssm-agent\n"], [54, "\n"], [55, "    # Report instance status to Systems Manager\n"], [56, "    aws ssm put-parameter --name \"/${var.project}/${var.environment}/instance-ready\" --type \"String\" --value \"$(date +%s)\" --overwrite --region $(curl -s http://169.254.169.254/latest/meta-data/placement/region)\n"], [57, "  EOF\n"], [58, "  )\n"], [59, "\n"], [60, "  block_device_mappings {\n"], [61, "    device_name = \"/dev/xvda\"\n"], [62, "    ebs {\n"], [63, "      volume_size           = var.root_volume_size\n"], [64, "      volume_type           = \"gp3\"\n"], [65, "      delete_on_termination = true\n"], [66, "      encrypted             = true\n"], [67, "    }\n"], [68, "  }\n"], [69, "\n"], [70, "  metadata_options {\n"], [71, "    http_endpoint               = \"enabled\"\n"], [72, "    http_tokens                 = \"required\" # IMDSv2 required for better security\n"], [73, "    http_put_response_hop_limit = 1\n"], [74, "  }\n"], [75, "\n"], [76, "  monitoring {\n"], [77, "    enabled = true\n"], [78, "  }\n"], [79, "\n"], [80, "  tag_specifications {\n"], [81, "    resource_type = \"instance\"\n"], [82, "    tags = merge(\n"], [83, "      {\n"], [84, "        Name        = \"${var.project}-${var.environment}-ecs-instance\"\n"], [85, "        Environment = var.environment\n"], [86, "        Project     = var.project\n"], [87, "        ManagedBy   = \"Terraform\"\n"], [88, "        AutoUpdate  = \"true\"\n"], [89, "      },\n"], [90, "      var.additional_tags\n"], [91, "    )\n"], [92, "  }\n"], [93, "\n"], [94, "  tag_specifications {\n"], [95, "    resource_type = \"volume\"\n"], [96, "    tags = merge(\n"], [97, "      {\n"], [98, "        Name        = \"${var.project}-${var.environment}-ecs-volume\"\n"], [99, "        Environment = var.environment\n"], [100, "        Project     = var.project\n"], [101, "        ManagedBy   = \"Terraform\"\n"], [102, "      },\n"], [103, "      var.additional_tags\n"], [104, "    )\n"], [105, "  }\n"], [106, "\n"], [107, "  lifecycle {\n"], [108, "    create_before_destroy = true\n"], [109, "  }\n"], [110, "}\n"]], "file_path": "\\modules\\ec2\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [19, 110], "resource": "module.ecs_jenkins_github.module.ec2.aws_launch_template.ecs_launch_template", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2Credentials", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [79, 102], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-1", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_88", "bc_check_id": "BC_AWS_PUBLIC_12", "check_name": "EC2 instance should not have public IP.", "check_result": {"result": "PASSED", "evaluated_keys": ["network_interfaces/[0]/associate_public_ip_address"]}, "code_block": [[19, "resource \"aws_launch_template\" \"ecs_launch_template\" {\n"], [20, "  name_prefix            = \"${var.project}-${var.environment}-\"\n"], [21, "  image_id               = data.aws_ami.ecs_optimized.id\n"], [22, "  instance_type          = var.instance_type\n"], [23, "  vpc_security_group_ids = [var.security_group_id]\n"], [24, "  key_name               = var.key_name\n"], [25, "\n"], [26, "  dynamic \"instance_market_options\" {\n"], [27, "    for_each = var.use_spot_instances ? [1] : []\n"], [28, "    content {\n"], [29, "      market_type = \"spot\"\n"], [30, "      spot_options {\n"], [31, "        max_price                      = var.spot_price\n"], [32, "        spot_instance_type             = \"persistent\"\n"], [33, "        instance_interruption_behavior = \"terminate\"\n"], [34, "      }\n"], [35, "    }\n"], [36, "  }\n"], [37, "\n"], [38, "  iam_instance_profile {\n"], [39, "    name = var.instance_profile_name\n"], [40, "  }\n"], [41, "\n"], [42, "  # ECS Instance Configuration\n"], [43, "  user_data = base64encode(<<-EOF\n"], [44, "    #!/bin/bash\n"], [45, "    echo ECS_CLUSTER=${var.ecs_cluster_name} >> /etc/ecs/ecs.config\n"], [46, "    echo ECS_ENABLE_CONTAINER_METADATA=true >> /etc/ecs/ecs.config\n"], [47, "    echo ECS_ENABLE_SPOT_INSTANCE_DRAINING=true >> /etc/ecs/ecs.config\n"], [48, "    yum update -y\n"], [49, "    amazon-linux-extras install epel -y\n"], [50, "    yum install -y amazon-cloudwatch-agent\n"], [51, "    yum install -y https://s3.amazonaws.com/ec2-downloads-windows/SSMAgent/latest/linux_amd64/amazon-ssm-agent.rpm\n"], [52, "    systemctl enable amazon-ssm-agent\n"], [53, "    systemctl start amazon-ssm-agent\n"], [54, "\n"], [55, "    # Report instance status to Systems Manager\n"], [56, "    aws ssm put-parameter --name \"/${var.project}/${var.environment}/instance-ready\" --type \"String\" --value \"$(date +%s)\" --overwrite --region $(curl -s http://169.254.169.254/latest/meta-data/placement/region)\n"], [57, "  EOF\n"], [58, "  )\n"], [59, "\n"], [60, "  block_device_mappings {\n"], [61, "    device_name = \"/dev/xvda\"\n"], [62, "    ebs {\n"], [63, "      volume_size           = var.root_volume_size\n"], [64, "      volume_type           = \"gp3\"\n"], [65, "      delete_on_termination = true\n"], [66, "      encrypted             = true\n"], [67, "    }\n"], [68, "  }\n"], [69, "\n"], [70, "  metadata_options {\n"], [71, "    http_endpoint               = \"enabled\"\n"], [72, "    http_tokens                 = \"required\" # IMDSv2 required for better security\n"], [73, "    http_put_response_hop_limit = 1\n"], [74, "  }\n"], [75, "\n"], [76, "  monitoring {\n"], [77, "    enabled = true\n"], [78, "  }\n"], [79, "\n"], [80, "  tag_specifications {\n"], [81, "    resource_type = \"instance\"\n"], [82, "    tags = merge(\n"], [83, "      {\n"], [84, "        Name        = \"${var.project}-${var.environment}-ecs-instance\"\n"], [85, "        Environment = var.environment\n"], [86, "        Project     = var.project\n"], [87, "        ManagedBy   = \"Terraform\"\n"], [88, "        AutoUpdate  = \"true\"\n"], [89, "      },\n"], [90, "      var.additional_tags\n"], [91, "    )\n"], [92, "  }\n"], [93, "\n"], [94, "  tag_specifications {\n"], [95, "    resource_type = \"volume\"\n"], [96, "    tags = merge(\n"], [97, "      {\n"], [98, "        Name        = \"${var.project}-${var.environment}-ecs-volume\"\n"], [99, "        Environment = var.environment\n"], [100, "        Project     = var.project\n"], [101, "        ManagedBy   = \"Terraform\"\n"], [102, "      },\n"], [103, "      var.additional_tags\n"], [104, "    )\n"], [105, "  }\n"], [106, "\n"], [107, "  lifecycle {\n"], [108, "    create_before_destroy = true\n"], [109, "  }\n"], [110, "}\n"]], "file_path": "\\modules\\ec2\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [19, 110], "resource": "module.ecs_jenkins_github.module.ec2.aws_launch_template.ecs_launch_template", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2PublicIP", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [79, 102], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-12", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_79", "bc_check_id": "BC_AWS_GENERAL_31", "check_name": "Ensure Instance Metadata Service Version 1 is not enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["metadata_options/[0]/http_tokens"]}, "code_block": [[19, "resource \"aws_launch_template\" \"ecs_launch_template\" {\n"], [20, "  name_prefix            = \"${var.project}-${var.environment}-\"\n"], [21, "  image_id               = data.aws_ami.ecs_optimized.id\n"], [22, "  instance_type          = var.instance_type\n"], [23, "  vpc_security_group_ids = [var.security_group_id]\n"], [24, "  key_name               = var.key_name\n"], [25, "\n"], [26, "  dynamic \"instance_market_options\" {\n"], [27, "    for_each = var.use_spot_instances ? [1] : []\n"], [28, "    content {\n"], [29, "      market_type = \"spot\"\n"], [30, "      spot_options {\n"], [31, "        max_price                      = var.spot_price\n"], [32, "        spot_instance_type             = \"persistent\"\n"], [33, "        instance_interruption_behavior = \"terminate\"\n"], [34, "      }\n"], [35, "    }\n"], [36, "  }\n"], [37, "\n"], [38, "  iam_instance_profile {\n"], [39, "    name = var.instance_profile_name\n"], [40, "  }\n"], [41, "\n"], [42, "  # ECS Instance Configuration\n"], [43, "  user_data = base64encode(<<-EOF\n"], [44, "    #!/bin/bash\n"], [45, "    echo ECS_CLUSTER=${var.ecs_cluster_name} >> /etc/ecs/ecs.config\n"], [46, "    echo ECS_ENABLE_CONTAINER_METADATA=true >> /etc/ecs/ecs.config\n"], [47, "    echo ECS_ENABLE_SPOT_INSTANCE_DRAINING=true >> /etc/ecs/ecs.config\n"], [48, "    yum update -y\n"], [49, "    amazon-linux-extras install epel -y\n"], [50, "    yum install -y amazon-cloudwatch-agent\n"], [51, "    yum install -y https://s3.amazonaws.com/ec2-downloads-windows/SSMAgent/latest/linux_amd64/amazon-ssm-agent.rpm\n"], [52, "    systemctl enable amazon-ssm-agent\n"], [53, "    systemctl start amazon-ssm-agent\n"], [54, "\n"], [55, "    # Report instance status to Systems Manager\n"], [56, "    aws ssm put-parameter --name \"/${var.project}/${var.environment}/instance-ready\" --type \"String\" --value \"$(date +%s)\" --overwrite --region $(curl -s http://169.254.169.254/latest/meta-data/placement/region)\n"], [57, "  EOF\n"], [58, "  )\n"], [59, "\n"], [60, "  block_device_mappings {\n"], [61, "    device_name = \"/dev/xvda\"\n"], [62, "    ebs {\n"], [63, "      volume_size           = var.root_volume_size\n"], [64, "      volume_type           = \"gp3\"\n"], [65, "      delete_on_termination = true\n"], [66, "      encrypted             = true\n"], [67, "    }\n"], [68, "  }\n"], [69, "\n"], [70, "  metadata_options {\n"], [71, "    http_endpoint               = \"enabled\"\n"], [72, "    http_tokens                 = \"required\" # IMDSv2 required for better security\n"], [73, "    http_put_response_hop_limit = 1\n"], [74, "  }\n"], [75, "\n"], [76, "  monitoring {\n"], [77, "    enabled = true\n"], [78, "  }\n"], [79, "\n"], [80, "  tag_specifications {\n"], [81, "    resource_type = \"instance\"\n"], [82, "    tags = merge(\n"], [83, "      {\n"], [84, "        Name        = \"${var.project}-${var.environment}-ecs-instance\"\n"], [85, "        Environment = var.environment\n"], [86, "        Project     = var.project\n"], [87, "        ManagedBy   = \"Terraform\"\n"], [88, "        AutoUpdate  = \"true\"\n"], [89, "      },\n"], [90, "      var.additional_tags\n"], [91, "    )\n"], [92, "  }\n"], [93, "\n"], [94, "  tag_specifications {\n"], [95, "    resource_type = \"volume\"\n"], [96, "    tags = merge(\n"], [97, "      {\n"], [98, "        Name        = \"${var.project}-${var.environment}-ecs-volume\"\n"], [99, "        Environment = var.environment\n"], [100, "        Project     = var.project\n"], [101, "        ManagedBy   = \"Terraform\"\n"], [102, "      },\n"], [103, "      var.additional_tags\n"], [104, "    )\n"], [105, "  }\n"], [106, "\n"], [107, "  lifecycle {\n"], [108, "    create_before_destroy = true\n"], [109, "  }\n"], [110, "}\n"]], "file_path": "\\modules\\ec2\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [19, 110], "resource": "module.ecs_jenkins_github.module.ec2.aws_launch_template.ecs_launch_template", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IMDSv1Disabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [79, 102], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-31", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_341", "bc_check_id": "BC_AWS_GENERAL_244", "check_name": "Ensure Launch template should not have a metadata response hop limit greater than 1", "check_result": {"result": "PASSED", "evaluated_keys": ["metadata_options/[0]/http_put_response_hop_limit"]}, "code_block": [[19, "resource \"aws_launch_template\" \"ecs_launch_template\" {\n"], [20, "  name_prefix            = \"${var.project}-${var.environment}-\"\n"], [21, "  image_id               = data.aws_ami.ecs_optimized.id\n"], [22, "  instance_type          = var.instance_type\n"], [23, "  vpc_security_group_ids = [var.security_group_id]\n"], [24, "  key_name               = var.key_name\n"], [25, "\n"], [26, "  dynamic \"instance_market_options\" {\n"], [27, "    for_each = var.use_spot_instances ? [1] : []\n"], [28, "    content {\n"], [29, "      market_type = \"spot\"\n"], [30, "      spot_options {\n"], [31, "        max_price                      = var.spot_price\n"], [32, "        spot_instance_type             = \"persistent\"\n"], [33, "        instance_interruption_behavior = \"terminate\"\n"], [34, "      }\n"], [35, "    }\n"], [36, "  }\n"], [37, "\n"], [38, "  iam_instance_profile {\n"], [39, "    name = var.instance_profile_name\n"], [40, "  }\n"], [41, "\n"], [42, "  # ECS Instance Configuration\n"], [43, "  user_data = base64encode(<<-EOF\n"], [44, "    #!/bin/bash\n"], [45, "    echo ECS_CLUSTER=${var.ecs_cluster_name} >> /etc/ecs/ecs.config\n"], [46, "    echo ECS_ENABLE_CONTAINER_METADATA=true >> /etc/ecs/ecs.config\n"], [47, "    echo ECS_ENABLE_SPOT_INSTANCE_DRAINING=true >> /etc/ecs/ecs.config\n"], [48, "    yum update -y\n"], [49, "    amazon-linux-extras install epel -y\n"], [50, "    yum install -y amazon-cloudwatch-agent\n"], [51, "    yum install -y https://s3.amazonaws.com/ec2-downloads-windows/SSMAgent/latest/linux_amd64/amazon-ssm-agent.rpm\n"], [52, "    systemctl enable amazon-ssm-agent\n"], [53, "    systemctl start amazon-ssm-agent\n"], [54, "\n"], [55, "    # Report instance status to Systems Manager\n"], [56, "    aws ssm put-parameter --name \"/${var.project}/${var.environment}/instance-ready\" --type \"String\" --value \"$(date +%s)\" --overwrite --region $(curl -s http://169.254.169.254/latest/meta-data/placement/region)\n"], [57, "  EOF\n"], [58, "  )\n"], [59, "\n"], [60, "  block_device_mappings {\n"], [61, "    device_name = \"/dev/xvda\"\n"], [62, "    ebs {\n"], [63, "      volume_size           = var.root_volume_size\n"], [64, "      volume_type           = \"gp3\"\n"], [65, "      delete_on_termination = true\n"], [66, "      encrypted             = true\n"], [67, "    }\n"], [68, "  }\n"], [69, "\n"], [70, "  metadata_options {\n"], [71, "    http_endpoint               = \"enabled\"\n"], [72, "    http_tokens                 = \"required\" # IMDSv2 required for better security\n"], [73, "    http_put_response_hop_limit = 1\n"], [74, "  }\n"], [75, "\n"], [76, "  monitoring {\n"], [77, "    enabled = true\n"], [78, "  }\n"], [79, "\n"], [80, "  tag_specifications {\n"], [81, "    resource_type = \"instance\"\n"], [82, "    tags = merge(\n"], [83, "      {\n"], [84, "        Name        = \"${var.project}-${var.environment}-ecs-instance\"\n"], [85, "        Environment = var.environment\n"], [86, "        Project     = var.project\n"], [87, "        ManagedBy   = \"Terraform\"\n"], [88, "        AutoUpdate  = \"true\"\n"], [89, "      },\n"], [90, "      var.additional_tags\n"], [91, "    )\n"], [92, "  }\n"], [93, "\n"], [94, "  tag_specifications {\n"], [95, "    resource_type = \"volume\"\n"], [96, "    tags = merge(\n"], [97, "      {\n"], [98, "        Name        = \"${var.project}-${var.environment}-ecs-volume\"\n"], [99, "        Environment = var.environment\n"], [100, "        Project     = var.project\n"], [101, "        ManagedBy   = \"Terraform\"\n"], [102, "      },\n"], [103, "      var.additional_tags\n"], [104, "    )\n"], [105, "  }\n"], [106, "\n"], [107, "  lifecycle {\n"], [108, "    create_before_destroy = true\n"], [109, "  }\n"], [110, "}\n"]], "file_path": "\\modules\\ec2\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [19, 110], "resource": "module.ecs_jenkins_github.module.ec2.aws_launch_template.ecs_launch_template", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LaunchTemplateMetadataHop", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [79, 102], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-341", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_315", "bc_check_id": "BC_AWS_GENERAL_226", "check_name": "Ensure EC2 Auto Scaling groups use EC2 launch templates", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[113, "resource \"aws_autoscaling_group\" \"ecs_asg\" {\n"], [114, "  name                      = \"${var.project}-${var.environment}-ecs-asg\"\n"], [115, "  vpc_zone_identifier       = var.subnet_ids\n"], [116, "  min_size                  = var.is_pilot_light ? (var.min_size > 0 ? 1 : 0) : var.min_size\n"], [117, "  max_size                  = var.is_pilot_light ? var.max_size : var.max_size\n"], [118, "  desired_capacity          = var.is_pilot_light ? (var.desired_capacity > 0 ? 1 : 0) : var.desired_capacity\n"], [119, "  health_check_type         = \"ELB\"\n"], [120, "  health_check_grace_period = 300\n"], [121, "  force_delete              = true\n"], [122, "\n"], [123, "  launch_template {\n"], [124, "    id      = aws_launch_template.ecs_launch_template.id\n"], [125, "    version = \"$Latest\"\n"], [126, "  }\n"], [127, "\n"], [128, "  dynamic \"tag\" {\n"], [129, "    for_each = merge(\n"], [130, "      {\n"], [131, "        Name        = \"${var.project}-${var.environment}-ecs-asg\"\n"], [132, "        Environment = var.environment\n"], [133, "        Project     = var.project\n"], [134, "        ManagedBy   = \"Terraform\"\n"], [135, "        PilotLight  = var.is_pilot_light ? \"true\" : \"false\"\n"], [136, "      },\n"], [137, "      var.additional_tags\n"], [138, "    )\n"], [139, "\n"], [140, "    content {\n"], [141, "      key                 = tag.key\n"], [142, "      value               = tag.value\n"], [143, "      propagate_at_launch = true\n"], [144, "    }\n"], [145, "  }\n"], [146, "\n"], [147, "  # ASG warm pool for faster scaling during failover testing\n"], [148, "  dynamic \"warm_pool\" {\n"], [149, "    for_each = var.is_pilot_light ? [1] : []\n"], [150, "    content {\n"], [151, "      pool_state                  = \"Stopped\"\n"], [152, "      min_size                    = 1\n"], [153, "      max_group_prepared_capacity = 2\n"], [154, "    }\n"], [155, "  }\n"], [156, "\n"], [157, "  instance_refresh {\n"], [158, "    strategy = \"Rolling\"\n"], [159, "    preferences {\n"], [160, "      min_healthy_percentage = 50\n"], [161, "      instance_warmup        = 300\n"], [162, "    }\n"], [163, "  }\n"], [164, "\n"], [165, "  lifecycle {\n"], [166, "    create_before_destroy = true\n"], [167, "    ignore_changes        = [desired_capacity]\n"], [168, "  }\n"], [169, "}\n"]], "file_path": "\\modules\\ec2\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [113, 169], "resource": "module.ecs_jenkins_github.module.ec2.aws_autoscaling_group.ecs_asg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.AutoScalingLaunchTemplate", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [79, 102], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-315", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_153", "bc_check_id": "BC_AWS_GENERAL_82", "check_name": "Autoscaling groups should supply tags to launch configurations", "check_result": {"result": "PASSED", "evaluated_keys": ["tag", "tags"]}, "code_block": [[113, "resource \"aws_autoscaling_group\" \"ecs_asg\" {\n"], [114, "  name                      = \"${var.project}-${var.environment}-ecs-asg\"\n"], [115, "  vpc_zone_identifier       = var.subnet_ids\n"], [116, "  min_size                  = var.is_pilot_light ? (var.min_size > 0 ? 1 : 0) : var.min_size\n"], [117, "  max_size                  = var.is_pilot_light ? var.max_size : var.max_size\n"], [118, "  desired_capacity          = var.is_pilot_light ? (var.desired_capacity > 0 ? 1 : 0) : var.desired_capacity\n"], [119, "  health_check_type         = \"ELB\"\n"], [120, "  health_check_grace_period = 300\n"], [121, "  force_delete              = true\n"], [122, "\n"], [123, "  launch_template {\n"], [124, "    id      = aws_launch_template.ecs_launch_template.id\n"], [125, "    version = \"$Latest\"\n"], [126, "  }\n"], [127, "\n"], [128, "  dynamic \"tag\" {\n"], [129, "    for_each = merge(\n"], [130, "      {\n"], [131, "        Name        = \"${var.project}-${var.environment}-ecs-asg\"\n"], [132, "        Environment = var.environment\n"], [133, "        Project     = var.project\n"], [134, "        ManagedBy   = \"Terraform\"\n"], [135, "        PilotLight  = var.is_pilot_light ? \"true\" : \"false\"\n"], [136, "      },\n"], [137, "      var.additional_tags\n"], [138, "    )\n"], [139, "\n"], [140, "    content {\n"], [141, "      key                 = tag.key\n"], [142, "      value               = tag.value\n"], [143, "      propagate_at_launch = true\n"], [144, "    }\n"], [145, "  }\n"], [146, "\n"], [147, "  # ASG warm pool for faster scaling during failover testing\n"], [148, "  dynamic \"warm_pool\" {\n"], [149, "    for_each = var.is_pilot_light ? [1] : []\n"], [150, "    content {\n"], [151, "      pool_state                  = \"Stopped\"\n"], [152, "      min_size                    = 1\n"], [153, "      max_group_prepared_capacity = 2\n"], [154, "    }\n"], [155, "  }\n"], [156, "\n"], [157, "  instance_refresh {\n"], [158, "    strategy = \"Rolling\"\n"], [159, "    preferences {\n"], [160, "      min_healthy_percentage = 50\n"], [161, "      instance_warmup        = 300\n"], [162, "    }\n"], [163, "  }\n"], [164, "\n"], [165, "  lifecycle {\n"], [166, "    create_before_destroy = true\n"], [167, "    ignore_changes        = [desired_capacity]\n"], [168, "  }\n"], [169, "}\n"]], "file_path": "\\modules\\ec2\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [113, 169], "resource": "module.ecs_jenkins_github.module.ec2.aws_autoscaling_group.ecs_asg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.AutoScalingTagging", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [79, 102], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/autoscaling-groups-should-supply-tags-to-launch-configurations", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_93", "bc_check_id": "BC_AWS_S3_24", "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[199, "resource \"aws_s3_bucket\" \"patch_logs\" {\n"], [200, "  bucket = \"${var.project}-${var.environment}-patch-logs-${random_string.suffix.result}\"\n"], [201, "\n"], [202, "  tags = {\n"], [203, "    Name        = \"${var.project}-${var.environment}-patch-logs\"\n"], [204, "    Environment = var.environment\n"], [205, "    Project     = var.project\n"], [206, "  }\n"], [207, "}\n"]], "file_path": "\\modules\\ec2\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [199, 207], "resource": "module.ecs_jenkins_github.module.ec2.aws_s3_bucket.patch_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-patch-logs", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [79, 102], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-24", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_319", "bc_check_id": "BC_AWS_GENERAL_229", "check_name": "Ensure that CloudWatch alarm actions are enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["actions_enabled"]}, "code_block": [[294, "resource \"aws_cloudwatch_metric_alarm\" \"asg_health\" {\n"], [295, "  alarm_name          = \"${var.project}-${var.environment}-asg-health\"\n"], [296, "  comparison_operator = \"LessThanThreshold\"\n"], [297, "  evaluation_periods  = \"2\"\n"], [298, "  metric_name         = \"GroupInServiceInstances\"\n"], [299, "  namespace           = \"AWS/AutoScaling\"\n"], [300, "  period              = \"60\"\n"], [301, "  statistic           = \"Average\"\n"], [302, "  threshold           = var.min_size\n"], [303, "  alarm_description   = \"This alarm monitors ASG health for ${var.project}-${var.environment}\"\n"], [304, "\n"], [305, "  dimensions = {\n"], [306, "    AutoScalingGroupName = aws_autoscaling_group.ecs_asg.name\n"], [307, "  }\n"], [308, "\n"], [309, "  alarm_actions = [var.sns_topic_arn]\n"], [310, "  ok_actions    = [var.sns_topic_arn]\n"], [311, "}\n"]], "file_path": "\\modules\\ec2\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [294, 311], "resource": "module.ecs_jenkins_github.module.ec2.aws_cloudwatch_metric_alarm.asg_health", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchAlarmsEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [79, 102], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-319", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_386", "bc_check_id": "BC_AWS_GENERAL_271", "check_name": "Reduce potential for WhoAMI cloud image name confusion attack", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[3, "data \"aws_ami\" \"ecs_optimized\" {\n"], [4, "  most_recent = true\n"], [5, "  owners      = [\"amazon\"]\n"], [6, "\n"], [7, "  filter {\n"], [8, "    name   = \"name\"\n"], [9, "    values = [\"amzn2-ami-ecs-hvm-*-x86_64-ebs\"]\n"], [10, "  }\n"], [11, "\n"], [12, "  filter {\n"], [13, "    name   = \"virtualization-type\"\n"], [14, "    values = [\"hvm\"]\n"], [15, "  }\n"], [16, "}\n"]], "file_path": "\\modules\\ec2\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [3, 16], "resource": "module.ecs_jenkins_github.module.ec2.aws_ami.ecs_optimized", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.WhoAMI", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [79, 102], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-supply-chain-policies/bc-aws-386", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_46", "bc_check_id": "BC_AWS_SECRETS_1", "check_name": "Ensure no hard-coded secrets exist in EC2 user data", "check_result": {"result": "PASSED", "evaluated_keys": ["user_data"]}, "code_block": [[19, "resource \"aws_launch_template\" \"ecs_launch_template\" {\n"], [20, "  name_prefix            = \"${var.project}-${var.environment}-\"\n"], [21, "  image_id               = data.aws_ami.ecs_optimized.id\n"], [22, "  instance_type          = var.instance_type\n"], [23, "  vpc_security_group_ids = [var.security_group_id]\n"], [24, "  key_name               = var.key_name\n"], [25, "\n"], [26, "  dynamic \"instance_market_options\" {\n"], [27, "    for_each = var.use_spot_instances ? [1] : []\n"], [28, "    content {\n"], [29, "      market_type = \"spot\"\n"], [30, "      spot_options {\n"], [31, "        max_price                      = var.spot_price\n"], [32, "        spot_instance_type             = \"persistent\"\n"], [33, "        instance_interruption_behavior = \"terminate\"\n"], [34, "      }\n"], [35, "    }\n"], [36, "  }\n"], [37, "\n"], [38, "  iam_instance_profile {\n"], [39, "    name = var.instance_profile_name\n"], [40, "  }\n"], [41, "\n"], [42, "  # ECS Instance Configuration\n"], [43, "  user_data = base64encode(<<-EOF\n"], [44, "    #!/bin/bash\n"], [45, "    echo ECS_CLUSTER=${var.ecs_cluster_name} >> /etc/ecs/ecs.config\n"], [46, "    echo ECS_ENABLE_CONTAINER_METADATA=true >> /etc/ecs/ecs.config\n"], [47, "    echo ECS_ENABLE_SPOT_INSTANCE_DRAINING=true >> /etc/ecs/ecs.config\n"], [48, "    yum update -y\n"], [49, "    amazon-linux-extras install epel -y\n"], [50, "    yum install -y amazon-cloudwatch-agent\n"], [51, "    yum install -y https://s3.amazonaws.com/ec2-downloads-windows/SSMAgent/latest/linux_amd64/amazon-ssm-agent.rpm\n"], [52, "    systemctl enable amazon-ssm-agent\n"], [53, "    systemctl start amazon-ssm-agent\n"], [54, "\n"], [55, "    # Report instance status to Systems Manager\n"], [56, "    aws ssm put-parameter --name \"/${var.project}/${var.environment}/instance-ready\" --type \"String\" --value \"$(date +%s)\" --overwrite --region $(curl -s http://169.254.169.254/latest/meta-data/placement/region)\n"], [57, "  EOF\n"], [58, "  )\n"], [59, "\n"], [60, "  block_device_mappings {\n"], [61, "    device_name = \"/dev/xvda\"\n"], [62, "    ebs {\n"], [63, "      volume_size           = var.root_volume_size\n"], [64, "      volume_type           = \"gp3\"\n"], [65, "      delete_on_termination = true\n"], [66, "      encrypted             = true\n"], [67, "    }\n"], [68, "  }\n"], [69, "\n"], [70, "  metadata_options {\n"], [71, "    http_endpoint               = \"enabled\"\n"], [72, "    http_tokens                 = \"required\" # IMDSv2 required for better security\n"], [73, "    http_put_response_hop_limit = 1\n"], [74, "  }\n"], [75, "\n"], [76, "  monitoring {\n"], [77, "    enabled = true\n"], [78, "  }\n"], [79, "\n"], [80, "  tag_specifications {\n"], [81, "    resource_type = \"instance\"\n"], [82, "    tags = merge(\n"], [83, "      {\n"], [84, "        Name        = \"${var.project}-${var.environment}-ecs-instance\"\n"], [85, "        Environment = var.environment\n"], [86, "        Project     = var.project\n"], [87, "        ManagedBy   = \"Terraform\"\n"], [88, "        AutoUpdate  = \"true\"\n"], [89, "      },\n"], [90, "      var.additional_tags\n"], [91, "    )\n"], [92, "  }\n"], [93, "\n"], [94, "  tag_specifications {\n"], [95, "    resource_type = \"volume\"\n"], [96, "    tags = merge(\n"], [97, "      {\n"], [98, "        Name        = \"${var.project}-${var.environment}-ecs-volume\"\n"], [99, "        Environment = var.environment\n"], [100, "        Project     = var.project\n"], [101, "        ManagedBy   = \"Terraform\"\n"], [102, "      },\n"], [103, "      var.additional_tags\n"], [104, "    )\n"], [105, "  }\n"], [106, "\n"], [107, "  lifecycle {\n"], [108, "    create_before_destroy = true\n"], [109, "  }\n"], [110, "}\n"]], "file_path": "\\modules\\ec2\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [19, 110], "resource": "module.ecs_jenkins_github_dr.module.ec2.aws_launch_template.ecs_launch_template", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2Credentials", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [79, 102], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-1", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_88", "bc_check_id": "BC_AWS_PUBLIC_12", "check_name": "EC2 instance should not have public IP.", "check_result": {"result": "PASSED", "evaluated_keys": ["network_interfaces/[0]/associate_public_ip_address"]}, "code_block": [[19, "resource \"aws_launch_template\" \"ecs_launch_template\" {\n"], [20, "  name_prefix            = \"${var.project}-${var.environment}-\"\n"], [21, "  image_id               = data.aws_ami.ecs_optimized.id\n"], [22, "  instance_type          = var.instance_type\n"], [23, "  vpc_security_group_ids = [var.security_group_id]\n"], [24, "  key_name               = var.key_name\n"], [25, "\n"], [26, "  dynamic \"instance_market_options\" {\n"], [27, "    for_each = var.use_spot_instances ? [1] : []\n"], [28, "    content {\n"], [29, "      market_type = \"spot\"\n"], [30, "      spot_options {\n"], [31, "        max_price                      = var.spot_price\n"], [32, "        spot_instance_type             = \"persistent\"\n"], [33, "        instance_interruption_behavior = \"terminate\"\n"], [34, "      }\n"], [35, "    }\n"], [36, "  }\n"], [37, "\n"], [38, "  iam_instance_profile {\n"], [39, "    name = var.instance_profile_name\n"], [40, "  }\n"], [41, "\n"], [42, "  # ECS Instance Configuration\n"], [43, "  user_data = base64encode(<<-EOF\n"], [44, "    #!/bin/bash\n"], [45, "    echo ECS_CLUSTER=${var.ecs_cluster_name} >> /etc/ecs/ecs.config\n"], [46, "    echo ECS_ENABLE_CONTAINER_METADATA=true >> /etc/ecs/ecs.config\n"], [47, "    echo ECS_ENABLE_SPOT_INSTANCE_DRAINING=true >> /etc/ecs/ecs.config\n"], [48, "    yum update -y\n"], [49, "    amazon-linux-extras install epel -y\n"], [50, "    yum install -y amazon-cloudwatch-agent\n"], [51, "    yum install -y https://s3.amazonaws.com/ec2-downloads-windows/SSMAgent/latest/linux_amd64/amazon-ssm-agent.rpm\n"], [52, "    systemctl enable amazon-ssm-agent\n"], [53, "    systemctl start amazon-ssm-agent\n"], [54, "\n"], [55, "    # Report instance status to Systems Manager\n"], [56, "    aws ssm put-parameter --name \"/${var.project}/${var.environment}/instance-ready\" --type \"String\" --value \"$(date +%s)\" --overwrite --region $(curl -s http://169.254.169.254/latest/meta-data/placement/region)\n"], [57, "  EOF\n"], [58, "  )\n"], [59, "\n"], [60, "  block_device_mappings {\n"], [61, "    device_name = \"/dev/xvda\"\n"], [62, "    ebs {\n"], [63, "      volume_size           = var.root_volume_size\n"], [64, "      volume_type           = \"gp3\"\n"], [65, "      delete_on_termination = true\n"], [66, "      encrypted             = true\n"], [67, "    }\n"], [68, "  }\n"], [69, "\n"], [70, "  metadata_options {\n"], [71, "    http_endpoint               = \"enabled\"\n"], [72, "    http_tokens                 = \"required\" # IMDSv2 required for better security\n"], [73, "    http_put_response_hop_limit = 1\n"], [74, "  }\n"], [75, "\n"], [76, "  monitoring {\n"], [77, "    enabled = true\n"], [78, "  }\n"], [79, "\n"], [80, "  tag_specifications {\n"], [81, "    resource_type = \"instance\"\n"], [82, "    tags = merge(\n"], [83, "      {\n"], [84, "        Name        = \"${var.project}-${var.environment}-ecs-instance\"\n"], [85, "        Environment = var.environment\n"], [86, "        Project     = var.project\n"], [87, "        ManagedBy   = \"Terraform\"\n"], [88, "        AutoUpdate  = \"true\"\n"], [89, "      },\n"], [90, "      var.additional_tags\n"], [91, "    )\n"], [92, "  }\n"], [93, "\n"], [94, "  tag_specifications {\n"], [95, "    resource_type = \"volume\"\n"], [96, "    tags = merge(\n"], [97, "      {\n"], [98, "        Name        = \"${var.project}-${var.environment}-ecs-volume\"\n"], [99, "        Environment = var.environment\n"], [100, "        Project     = var.project\n"], [101, "        ManagedBy   = \"Terraform\"\n"], [102, "      },\n"], [103, "      var.additional_tags\n"], [104, "    )\n"], [105, "  }\n"], [106, "\n"], [107, "  lifecycle {\n"], [108, "    create_before_destroy = true\n"], [109, "  }\n"], [110, "}\n"]], "file_path": "\\modules\\ec2\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [19, 110], "resource": "module.ecs_jenkins_github_dr.module.ec2.aws_launch_template.ecs_launch_template", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2PublicIP", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [79, 102], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-12", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_79", "bc_check_id": "BC_AWS_GENERAL_31", "check_name": "Ensure Instance Metadata Service Version 1 is not enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["metadata_options/[0]/http_tokens"]}, "code_block": [[19, "resource \"aws_launch_template\" \"ecs_launch_template\" {\n"], [20, "  name_prefix            = \"${var.project}-${var.environment}-\"\n"], [21, "  image_id               = data.aws_ami.ecs_optimized.id\n"], [22, "  instance_type          = var.instance_type\n"], [23, "  vpc_security_group_ids = [var.security_group_id]\n"], [24, "  key_name               = var.key_name\n"], [25, "\n"], [26, "  dynamic \"instance_market_options\" {\n"], [27, "    for_each = var.use_spot_instances ? [1] : []\n"], [28, "    content {\n"], [29, "      market_type = \"spot\"\n"], [30, "      spot_options {\n"], [31, "        max_price                      = var.spot_price\n"], [32, "        spot_instance_type             = \"persistent\"\n"], [33, "        instance_interruption_behavior = \"terminate\"\n"], [34, "      }\n"], [35, "    }\n"], [36, "  }\n"], [37, "\n"], [38, "  iam_instance_profile {\n"], [39, "    name = var.instance_profile_name\n"], [40, "  }\n"], [41, "\n"], [42, "  # ECS Instance Configuration\n"], [43, "  user_data = base64encode(<<-EOF\n"], [44, "    #!/bin/bash\n"], [45, "    echo ECS_CLUSTER=${var.ecs_cluster_name} >> /etc/ecs/ecs.config\n"], [46, "    echo ECS_ENABLE_CONTAINER_METADATA=true >> /etc/ecs/ecs.config\n"], [47, "    echo ECS_ENABLE_SPOT_INSTANCE_DRAINING=true >> /etc/ecs/ecs.config\n"], [48, "    yum update -y\n"], [49, "    amazon-linux-extras install epel -y\n"], [50, "    yum install -y amazon-cloudwatch-agent\n"], [51, "    yum install -y https://s3.amazonaws.com/ec2-downloads-windows/SSMAgent/latest/linux_amd64/amazon-ssm-agent.rpm\n"], [52, "    systemctl enable amazon-ssm-agent\n"], [53, "    systemctl start amazon-ssm-agent\n"], [54, "\n"], [55, "    # Report instance status to Systems Manager\n"], [56, "    aws ssm put-parameter --name \"/${var.project}/${var.environment}/instance-ready\" --type \"String\" --value \"$(date +%s)\" --overwrite --region $(curl -s http://169.254.169.254/latest/meta-data/placement/region)\n"], [57, "  EOF\n"], [58, "  )\n"], [59, "\n"], [60, "  block_device_mappings {\n"], [61, "    device_name = \"/dev/xvda\"\n"], [62, "    ebs {\n"], [63, "      volume_size           = var.root_volume_size\n"], [64, "      volume_type           = \"gp3\"\n"], [65, "      delete_on_termination = true\n"], [66, "      encrypted             = true\n"], [67, "    }\n"], [68, "  }\n"], [69, "\n"], [70, "  metadata_options {\n"], [71, "    http_endpoint               = \"enabled\"\n"], [72, "    http_tokens                 = \"required\" # IMDSv2 required for better security\n"], [73, "    http_put_response_hop_limit = 1\n"], [74, "  }\n"], [75, "\n"], [76, "  monitoring {\n"], [77, "    enabled = true\n"], [78, "  }\n"], [79, "\n"], [80, "  tag_specifications {\n"], [81, "    resource_type = \"instance\"\n"], [82, "    tags = merge(\n"], [83, "      {\n"], [84, "        Name        = \"${var.project}-${var.environment}-ecs-instance\"\n"], [85, "        Environment = var.environment\n"], [86, "        Project     = var.project\n"], [87, "        ManagedBy   = \"Terraform\"\n"], [88, "        AutoUpdate  = \"true\"\n"], [89, "      },\n"], [90, "      var.additional_tags\n"], [91, "    )\n"], [92, "  }\n"], [93, "\n"], [94, "  tag_specifications {\n"], [95, "    resource_type = \"volume\"\n"], [96, "    tags = merge(\n"], [97, "      {\n"], [98, "        Name        = \"${var.project}-${var.environment}-ecs-volume\"\n"], [99, "        Environment = var.environment\n"], [100, "        Project     = var.project\n"], [101, "        ManagedBy   = \"Terraform\"\n"], [102, "      },\n"], [103, "      var.additional_tags\n"], [104, "    )\n"], [105, "  }\n"], [106, "\n"], [107, "  lifecycle {\n"], [108, "    create_before_destroy = true\n"], [109, "  }\n"], [110, "}\n"]], "file_path": "\\modules\\ec2\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [19, 110], "resource": "module.ecs_jenkins_github_dr.module.ec2.aws_launch_template.ecs_launch_template", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IMDSv1Disabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [79, 102], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-31", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_341", "bc_check_id": "BC_AWS_GENERAL_244", "check_name": "Ensure Launch template should not have a metadata response hop limit greater than 1", "check_result": {"result": "PASSED", "evaluated_keys": ["metadata_options/[0]/http_put_response_hop_limit"]}, "code_block": [[19, "resource \"aws_launch_template\" \"ecs_launch_template\" {\n"], [20, "  name_prefix            = \"${var.project}-${var.environment}-\"\n"], [21, "  image_id               = data.aws_ami.ecs_optimized.id\n"], [22, "  instance_type          = var.instance_type\n"], [23, "  vpc_security_group_ids = [var.security_group_id]\n"], [24, "  key_name               = var.key_name\n"], [25, "\n"], [26, "  dynamic \"instance_market_options\" {\n"], [27, "    for_each = var.use_spot_instances ? [1] : []\n"], [28, "    content {\n"], [29, "      market_type = \"spot\"\n"], [30, "      spot_options {\n"], [31, "        max_price                      = var.spot_price\n"], [32, "        spot_instance_type             = \"persistent\"\n"], [33, "        instance_interruption_behavior = \"terminate\"\n"], [34, "      }\n"], [35, "    }\n"], [36, "  }\n"], [37, "\n"], [38, "  iam_instance_profile {\n"], [39, "    name = var.instance_profile_name\n"], [40, "  }\n"], [41, "\n"], [42, "  # ECS Instance Configuration\n"], [43, "  user_data = base64encode(<<-EOF\n"], [44, "    #!/bin/bash\n"], [45, "    echo ECS_CLUSTER=${var.ecs_cluster_name} >> /etc/ecs/ecs.config\n"], [46, "    echo ECS_ENABLE_CONTAINER_METADATA=true >> /etc/ecs/ecs.config\n"], [47, "    echo ECS_ENABLE_SPOT_INSTANCE_DRAINING=true >> /etc/ecs/ecs.config\n"], [48, "    yum update -y\n"], [49, "    amazon-linux-extras install epel -y\n"], [50, "    yum install -y amazon-cloudwatch-agent\n"], [51, "    yum install -y https://s3.amazonaws.com/ec2-downloads-windows/SSMAgent/latest/linux_amd64/amazon-ssm-agent.rpm\n"], [52, "    systemctl enable amazon-ssm-agent\n"], [53, "    systemctl start amazon-ssm-agent\n"], [54, "\n"], [55, "    # Report instance status to Systems Manager\n"], [56, "    aws ssm put-parameter --name \"/${var.project}/${var.environment}/instance-ready\" --type \"String\" --value \"$(date +%s)\" --overwrite --region $(curl -s http://169.254.169.254/latest/meta-data/placement/region)\n"], [57, "  EOF\n"], [58, "  )\n"], [59, "\n"], [60, "  block_device_mappings {\n"], [61, "    device_name = \"/dev/xvda\"\n"], [62, "    ebs {\n"], [63, "      volume_size           = var.root_volume_size\n"], [64, "      volume_type           = \"gp3\"\n"], [65, "      delete_on_termination = true\n"], [66, "      encrypted             = true\n"], [67, "    }\n"], [68, "  }\n"], [69, "\n"], [70, "  metadata_options {\n"], [71, "    http_endpoint               = \"enabled\"\n"], [72, "    http_tokens                 = \"required\" # IMDSv2 required for better security\n"], [73, "    http_put_response_hop_limit = 1\n"], [74, "  }\n"], [75, "\n"], [76, "  monitoring {\n"], [77, "    enabled = true\n"], [78, "  }\n"], [79, "\n"], [80, "  tag_specifications {\n"], [81, "    resource_type = \"instance\"\n"], [82, "    tags = merge(\n"], [83, "      {\n"], [84, "        Name        = \"${var.project}-${var.environment}-ecs-instance\"\n"], [85, "        Environment = var.environment\n"], [86, "        Project     = var.project\n"], [87, "        ManagedBy   = \"Terraform\"\n"], [88, "        AutoUpdate  = \"true\"\n"], [89, "      },\n"], [90, "      var.additional_tags\n"], [91, "    )\n"], [92, "  }\n"], [93, "\n"], [94, "  tag_specifications {\n"], [95, "    resource_type = \"volume\"\n"], [96, "    tags = merge(\n"], [97, "      {\n"], [98, "        Name        = \"${var.project}-${var.environment}-ecs-volume\"\n"], [99, "        Environment = var.environment\n"], [100, "        Project     = var.project\n"], [101, "        ManagedBy   = \"Terraform\"\n"], [102, "      },\n"], [103, "      var.additional_tags\n"], [104, "    )\n"], [105, "  }\n"], [106, "\n"], [107, "  lifecycle {\n"], [108, "    create_before_destroy = true\n"], [109, "  }\n"], [110, "}\n"]], "file_path": "\\modules\\ec2\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [19, 110], "resource": "module.ecs_jenkins_github_dr.module.ec2.aws_launch_template.ecs_launch_template", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LaunchTemplateMetadataHop", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [79, 102], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-341", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_315", "bc_check_id": "BC_AWS_GENERAL_226", "check_name": "Ensure EC2 Auto Scaling groups use EC2 launch templates", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[113, "resource \"aws_autoscaling_group\" \"ecs_asg\" {\n"], [114, "  name                      = \"${var.project}-${var.environment}-ecs-asg\"\n"], [115, "  vpc_zone_identifier       = var.subnet_ids\n"], [116, "  min_size                  = var.is_pilot_light ? (var.min_size > 0 ? 1 : 0) : var.min_size\n"], [117, "  max_size                  = var.is_pilot_light ? var.max_size : var.max_size\n"], [118, "  desired_capacity          = var.is_pilot_light ? (var.desired_capacity > 0 ? 1 : 0) : var.desired_capacity\n"], [119, "  health_check_type         = \"ELB\"\n"], [120, "  health_check_grace_period = 300\n"], [121, "  force_delete              = true\n"], [122, "\n"], [123, "  launch_template {\n"], [124, "    id      = aws_launch_template.ecs_launch_template.id\n"], [125, "    version = \"$Latest\"\n"], [126, "  }\n"], [127, "\n"], [128, "  dynamic \"tag\" {\n"], [129, "    for_each = merge(\n"], [130, "      {\n"], [131, "        Name        = \"${var.project}-${var.environment}-ecs-asg\"\n"], [132, "        Environment = var.environment\n"], [133, "        Project     = var.project\n"], [134, "        ManagedBy   = \"Terraform\"\n"], [135, "        PilotLight  = var.is_pilot_light ? \"true\" : \"false\"\n"], [136, "      },\n"], [137, "      var.additional_tags\n"], [138, "    )\n"], [139, "\n"], [140, "    content {\n"], [141, "      key                 = tag.key\n"], [142, "      value               = tag.value\n"], [143, "      propagate_at_launch = true\n"], [144, "    }\n"], [145, "  }\n"], [146, "\n"], [147, "  # ASG warm pool for faster scaling during failover testing\n"], [148, "  dynamic \"warm_pool\" {\n"], [149, "    for_each = var.is_pilot_light ? [1] : []\n"], [150, "    content {\n"], [151, "      pool_state                  = \"Stopped\"\n"], [152, "      min_size                    = 1\n"], [153, "      max_group_prepared_capacity = 2\n"], [154, "    }\n"], [155, "  }\n"], [156, "\n"], [157, "  instance_refresh {\n"], [158, "    strategy = \"Rolling\"\n"], [159, "    preferences {\n"], [160, "      min_healthy_percentage = 50\n"], [161, "      instance_warmup        = 300\n"], [162, "    }\n"], [163, "  }\n"], [164, "\n"], [165, "  lifecycle {\n"], [166, "    create_before_destroy = true\n"], [167, "    ignore_changes        = [desired_capacity]\n"], [168, "  }\n"], [169, "}\n"]], "file_path": "\\modules\\ec2\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [113, 169], "resource": "module.ecs_jenkins_github_dr.module.ec2.aws_autoscaling_group.ecs_asg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.AutoScalingLaunchTemplate", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [79, 102], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-315", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_153", "bc_check_id": "BC_AWS_GENERAL_82", "check_name": "Autoscaling groups should supply tags to launch configurations", "check_result": {"result": "PASSED", "evaluated_keys": ["tag", "tags"]}, "code_block": [[113, "resource \"aws_autoscaling_group\" \"ecs_asg\" {\n"], [114, "  name                      = \"${var.project}-${var.environment}-ecs-asg\"\n"], [115, "  vpc_zone_identifier       = var.subnet_ids\n"], [116, "  min_size                  = var.is_pilot_light ? (var.min_size > 0 ? 1 : 0) : var.min_size\n"], [117, "  max_size                  = var.is_pilot_light ? var.max_size : var.max_size\n"], [118, "  desired_capacity          = var.is_pilot_light ? (var.desired_capacity > 0 ? 1 : 0) : var.desired_capacity\n"], [119, "  health_check_type         = \"ELB\"\n"], [120, "  health_check_grace_period = 300\n"], [121, "  force_delete              = true\n"], [122, "\n"], [123, "  launch_template {\n"], [124, "    id      = aws_launch_template.ecs_launch_template.id\n"], [125, "    version = \"$Latest\"\n"], [126, "  }\n"], [127, "\n"], [128, "  dynamic \"tag\" {\n"], [129, "    for_each = merge(\n"], [130, "      {\n"], [131, "        Name        = \"${var.project}-${var.environment}-ecs-asg\"\n"], [132, "        Environment = var.environment\n"], [133, "        Project     = var.project\n"], [134, "        ManagedBy   = \"Terraform\"\n"], [135, "        PilotLight  = var.is_pilot_light ? \"true\" : \"false\"\n"], [136, "      },\n"], [137, "      var.additional_tags\n"], [138, "    )\n"], [139, "\n"], [140, "    content {\n"], [141, "      key                 = tag.key\n"], [142, "      value               = tag.value\n"], [143, "      propagate_at_launch = true\n"], [144, "    }\n"], [145, "  }\n"], [146, "\n"], [147, "  # ASG warm pool for faster scaling during failover testing\n"], [148, "  dynamic \"warm_pool\" {\n"], [149, "    for_each = var.is_pilot_light ? [1] : []\n"], [150, "    content {\n"], [151, "      pool_state                  = \"Stopped\"\n"], [152, "      min_size                    = 1\n"], [153, "      max_group_prepared_capacity = 2\n"], [154, "    }\n"], [155, "  }\n"], [156, "\n"], [157, "  instance_refresh {\n"], [158, "    strategy = \"Rolling\"\n"], [159, "    preferences {\n"], [160, "      min_healthy_percentage = 50\n"], [161, "      instance_warmup        = 300\n"], [162, "    }\n"], [163, "  }\n"], [164, "\n"], [165, "  lifecycle {\n"], [166, "    create_before_destroy = true\n"], [167, "    ignore_changes        = [desired_capacity]\n"], [168, "  }\n"], [169, "}\n"]], "file_path": "\\modules\\ec2\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [113, 169], "resource": "module.ecs_jenkins_github_dr.module.ec2.aws_autoscaling_group.ecs_asg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.AutoScalingTagging", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [79, 102], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/autoscaling-groups-should-supply-tags-to-launch-configurations", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_93", "bc_check_id": "BC_AWS_S3_24", "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[199, "resource \"aws_s3_bucket\" \"patch_logs\" {\n"], [200, "  bucket = \"${var.project}-${var.environment}-patch-logs-${random_string.suffix.result}\"\n"], [201, "\n"], [202, "  tags = {\n"], [203, "    Name        = \"${var.project}-${var.environment}-patch-logs\"\n"], [204, "    Environment = var.environment\n"], [205, "    Project     = var.project\n"], [206, "  }\n"], [207, "}\n"]], "file_path": "\\modules\\ec2\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [199, 207], "resource": "module.ecs_jenkins_github_dr.module.ec2.aws_s3_bucket.patch_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-patch-logs", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [79, 102], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-24", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_319", "bc_check_id": "BC_AWS_GENERAL_229", "check_name": "Ensure that CloudWatch alarm actions are enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["actions_enabled"]}, "code_block": [[294, "resource \"aws_cloudwatch_metric_alarm\" \"asg_health\" {\n"], [295, "  alarm_name          = \"${var.project}-${var.environment}-asg-health\"\n"], [296, "  comparison_operator = \"LessThanThreshold\"\n"], [297, "  evaluation_periods  = \"2\"\n"], [298, "  metric_name         = \"GroupInServiceInstances\"\n"], [299, "  namespace           = \"AWS/AutoScaling\"\n"], [300, "  period              = \"60\"\n"], [301, "  statistic           = \"Average\"\n"], [302, "  threshold           = var.min_size\n"], [303, "  alarm_description   = \"This alarm monitors ASG health for ${var.project}-${var.environment}\"\n"], [304, "\n"], [305, "  dimensions = {\n"], [306, "    AutoScalingGroupName = aws_autoscaling_group.ecs_asg.name\n"], [307, "  }\n"], [308, "\n"], [309, "  alarm_actions = [var.sns_topic_arn]\n"], [310, "  ok_actions    = [var.sns_topic_arn]\n"], [311, "}\n"]], "file_path": "\\modules\\ec2\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [294, 311], "resource": "module.ecs_jenkins_github_dr.module.ec2.aws_cloudwatch_metric_alarm.asg_health", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchAlarmsEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [79, 102], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-319", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_386", "bc_check_id": "BC_AWS_GENERAL_271", "check_name": "Reduce potential for WhoAMI cloud image name confusion attack", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[3, "data \"aws_ami\" \"ecs_optimized\" {\n"], [4, "  most_recent = true\n"], [5, "  owners      = [\"amazon\"]\n"], [6, "\n"], [7, "  filter {\n"], [8, "    name   = \"name\"\n"], [9, "    values = [\"amzn2-ami-ecs-hvm-*-x86_64-ebs\"]\n"], [10, "  }\n"], [11, "\n"], [12, "  filter {\n"], [13, "    name   = \"virtualization-type\"\n"], [14, "    values = [\"hvm\"]\n"], [15, "  }\n"], [16, "}\n"]], "file_path": "\\modules\\ec2\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [3, 16], "resource": "module.ecs_jenkins_github_dr.module.ec2.aws_ami.ecs_optimized", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.WhoAMI", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [79, 102], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-supply-chain-policies/bc-aws-386", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_65", "bc_check_id": "BC_AWS_LOGGING_11", "check_name": "Ensure container insights are enabled on ECS cluster", "check_result": {"result": "PASSED", "evaluated_keys": ["setting/[0]/name", "setting/[0]/value"]}, "code_block": [[2, "resource \"aws_ecs_cluster\" \"cluster\" {\n"], [3, "  name = \"${var.project}-${var.environment}-cluster\"\n"], [4, "\n"], [5, "  setting {\n"], [6, "    name  = \"containerInsights\"\n"], [7, "    value = \"enabled\"\n"], [8, "  }\n"], [9, "\n"], [10, "  tags = {\n"], [11, "    Name        = \"${var.project}-${var.environment}-cluster\"\n"], [12, "    Environment = var.environment\n"], [13, "    Project     = var.project\n"], [14, "  }\n"], [15, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [2, 15], "resource": "module.ecs_jenkins_github.module.ecs.aws_ecs_cluster.cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSClusterContainerInsights", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-cluster", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-logging-11", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_223", "bc_check_id": "BC_AWS_GENERAL_171", "check_name": "Ensure ECS Cluster enables logging of ECS Exec", "check_result": {"result": "PASSED", "evaluated_keys": ["configuration/[0]/execute_command_configuration/[0]/logging"]}, "code_block": [[2, "resource \"aws_ecs_cluster\" \"cluster\" {\n"], [3, "  name = \"${var.project}-${var.environment}-cluster\"\n"], [4, "\n"], [5, "  setting {\n"], [6, "    name  = \"containerInsights\"\n"], [7, "    value = \"enabled\"\n"], [8, "  }\n"], [9, "\n"], [10, "  tags = {\n"], [11, "    Name        = \"${var.project}-${var.environment}-cluster\"\n"], [12, "    Environment = var.environment\n"], [13, "    Project     = var.project\n"], [14, "  }\n"], [15, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [2, 15], "resource": "module.ecs_jenkins_github.module.ecs.aws_ecs_cluster.cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSClusterLoggingEnabled", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-cluster", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-ecs-cluster-enables-logging-of-ecs-exec", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_66", "bc_check_id": "BC_AWS_LOGGING_13", "check_name": "Ensure that CloudWatch Log Group specifies retention days", "check_result": {"result": "PASSED", "evaluated_keys": ["retention_in_days"]}, "code_block": [[18, "resource \"aws_cloudwatch_log_group\" \"ecs_logs\" {\n"], [19, "  name              = \"/ecs/${var.project}-${var.environment}\"\n"], [20, "  retention_in_days = 30\n"], [21, "\n"], [22, "  tags = {\n"], [23, "    Name        = \"${var.project}-${var.environment}-ecs-logs\"\n"], [24, "    Environment = var.environment\n"], [25, "    Project     = var.project\n"], [26, "  }\n"], [27, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [18, 27], "resource": "module.ecs_jenkins_github.module.ecs.aws_cloudwatch_log_group.ecs_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetention", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-ecs-logs", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-13", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_328", "bc_check_id": "BC_AWS_NETWORKING_89", "check_name": "Ensure that ALB is configured with defensive or strictest desync mitigation mode", "check_result": {"result": "PASSED", "evaluated_keys": ["desync_mitigation_mode"]}, "code_block": [[30, "resource \"aws_lb\" \"alb\" {\n"], [31, "  name               = \"${var.project}-${var.environment}-alb\"\n"], [32, "  internal           = false\n"], [33, "  load_balancer_type = \"application\"\n"], [34, "  security_groups    = [var.alb_security_group]\n"], [35, "  subnets            = var.public_subnets\n"], [36, "\n"], [37, "  enable_deletion_protection = false\n"], [38, "\n"], [39, "  tags = {\n"], [40, "    Name        = \"${var.project}-${var.environment}-alb\"\n"], [41, "    Environment = var.environment\n"], [42, "    Project     = var.project\n"], [43, "  }\n"], [44, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [30, 44], "resource": "module.ecs_jenkins_github.module.ecs.aws_lb.alb", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ALBDesyncMode", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-alb", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-328", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_261", "bc_check_id": "BC_AWS_GENERAL_177", "check_name": "Ensure HTTP HTTPS Target group defines Healthcheck", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[46, "resource \"aws_lb_target_group\" \"target_group\" {\n"], [47, "  name        = \"${var.project}-${var.environment}-tg\"\n"], [48, "  port        = 80\n"], [49, "  protocol    = \"HTTP\"\n"], [50, "  vpc_id      = var.vpc_id\n"], [51, "  target_type = \"ip\"\n"], [52, "\n"], [53, "  health_check {\n"], [54, "    enabled             = true\n"], [55, "    interval            = 30\n"], [56, "    path                = \"/\"\n"], [57, "    port                = \"traffic-port\"\n"], [58, "    healthy_threshold   = 3\n"], [59, "    unhealthy_threshold = 3\n"], [60, "    timeout             = 5\n"], [61, "    protocol            = \"HTTP\"\n"], [62, "    matcher             = \"200\"\n"], [63, "  }\n"], [64, "\n"], [65, "  tags = {\n"], [66, "    Name        = \"${var.project}-${var.environment}-tg\"\n"], [67, "    Environment = var.environment\n"], [68, "    Project     = var.project\n"], [69, "  }\n"], [70, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [46, 70], "resource": "module.ecs_jenkins_github.module.ecs.aws_lb_target_group.target_group", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LBTargetGroupsDefinesHealthcheck", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-tg", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-kendra-index-server-side-encryption-uses-customer-managed-keys-cmks", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_335", "bc_check_id": "BC_AWS_GENERAL_240", "check_name": "Ensure ECS task definitions should not share the host's process namespace", "check_result": {"result": "PASSED", "evaluated_keys": ["container_definitions"]}, "code_block": [[90, "resource \"aws_ecs_task_definition\" \"task_definition\" {\n"], [91, "  family                   = \"${var.project}-${var.environment}-task\"\n"], [92, "  network_mode             = \"awsvpc\"\n"], [93, "  requires_compatibilities = [\"FARGATE\"]\n"], [94, "  cpu                      = \"256\"\n"], [95, "  memory                   = \"512\"\n"], [96, "  execution_role_arn       = var.ecs_task_execution_role\n"], [97, "  task_role_arn            = var.ecs_task_role\n"], [98, "\n"], [99, "  container_definitions = jsonencode([\n"], [100, "    {\n"], [101, "      name      = \"${var.project}-${var.environment}-container\"\n"], [102, "      image     = \"nginx:latest\" # This is a placeholder image\n"], [103, "      essential = true\n"], [104, "      portMappings = [\n"], [105, "        {\n"], [106, "          containerPort = 80\n"], [107, "          hostPort      = 80\n"], [108, "          protocol      = \"tcp\"\n"], [109, "        }\n"], [110, "      ]\n"], [111, "      logConfiguration = {\n"], [112, "        logDriver = \"awslogs\"\n"], [113, "        options = {\n"], [114, "          \"awslogs-group\"         = aws_cloudwatch_log_group.ecs_logs.name\n"], [115, "          \"awslogs-region\"        = data.aws_region.current.id\n"], [116, "          \"awslogs-stream-prefix\" = \"ecs\"\n"], [117, "        }\n"], [118, "      }\n"], [119, "    }\n"], [120, "  ])\n"], [121, "\n"], [122, "  tags = {\n"], [123, "    Name        = \"${var.project}-${var.environment}-task\"\n"], [124, "    Environment = var.environment\n"], [125, "    Project     = var.project\n"], [126, "  }\n"], [127, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [90, 127], "resource": "module.ecs_jenkins_github.module.ecs.aws_ecs_task_definition.task_definition", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSContainerHostProcess", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-task", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-335", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_334", "bc_check_id": "BC_AWS_GENERAL_239", "check_name": "Ensure ECS containers should run as non-privileged", "check_result": {"result": "PASSED", "evaluated_keys": ["container_definitions"]}, "code_block": [[90, "resource \"aws_ecs_task_definition\" \"task_definition\" {\n"], [91, "  family                   = \"${var.project}-${var.environment}-task\"\n"], [92, "  network_mode             = \"awsvpc\"\n"], [93, "  requires_compatibilities = [\"FARGATE\"]\n"], [94, "  cpu                      = \"256\"\n"], [95, "  memory                   = \"512\"\n"], [96, "  execution_role_arn       = var.ecs_task_execution_role\n"], [97, "  task_role_arn            = var.ecs_task_role\n"], [98, "\n"], [99, "  container_definitions = jsonencode([\n"], [100, "    {\n"], [101, "      name      = \"${var.project}-${var.environment}-container\"\n"], [102, "      image     = \"nginx:latest\" # This is a placeholder image\n"], [103, "      essential = true\n"], [104, "      portMappings = [\n"], [105, "        {\n"], [106, "          containerPort = 80\n"], [107, "          hostPort      = 80\n"], [108, "          protocol      = \"tcp\"\n"], [109, "        }\n"], [110, "      ]\n"], [111, "      logConfiguration = {\n"], [112, "        logDriver = \"awslogs\"\n"], [113, "        options = {\n"], [114, "          \"awslogs-group\"         = aws_cloudwatch_log_group.ecs_logs.name\n"], [115, "          \"awslogs-region\"        = data.aws_region.current.id\n"], [116, "          \"awslogs-stream-prefix\" = \"ecs\"\n"], [117, "        }\n"], [118, "      }\n"], [119, "    }\n"], [120, "  ])\n"], [121, "\n"], [122, "  tags = {\n"], [123, "    Name        = \"${var.project}-${var.environment}-task\"\n"], [124, "    Environment = var.environment\n"], [125, "    Project     = var.project\n"], [126, "  }\n"], [127, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [90, 127], "resource": "module.ecs_jenkins_github.module.ecs.aws_ecs_task_definition.task_definition", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSContainerPrivilege", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-task", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-334", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_97", "bc_check_id": "BC_AWS_GENERAL_39", "check_name": "Ensure Encryption in transit is enabled for EFS volumes in ECS Task definitions", "check_result": {"result": "PASSED", "evaluated_keys": ["volume"]}, "code_block": [[90, "resource \"aws_ecs_task_definition\" \"task_definition\" {\n"], [91, "  family                   = \"${var.project}-${var.environment}-task\"\n"], [92, "  network_mode             = \"awsvpc\"\n"], [93, "  requires_compatibilities = [\"FARGATE\"]\n"], [94, "  cpu                      = \"256\"\n"], [95, "  memory                   = \"512\"\n"], [96, "  execution_role_arn       = var.ecs_task_execution_role\n"], [97, "  task_role_arn            = var.ecs_task_role\n"], [98, "\n"], [99, "  container_definitions = jsonencode([\n"], [100, "    {\n"], [101, "      name      = \"${var.project}-${var.environment}-container\"\n"], [102, "      image     = \"nginx:latest\" # This is a placeholder image\n"], [103, "      essential = true\n"], [104, "      portMappings = [\n"], [105, "        {\n"], [106, "          containerPort = 80\n"], [107, "          hostPort      = 80\n"], [108, "          protocol      = \"tcp\"\n"], [109, "        }\n"], [110, "      ]\n"], [111, "      logConfiguration = {\n"], [112, "        logDriver = \"awslogs\"\n"], [113, "        options = {\n"], [114, "          \"awslogs-group\"         = aws_cloudwatch_log_group.ecs_logs.name\n"], [115, "          \"awslogs-region\"        = data.aws_region.current.id\n"], [116, "          \"awslogs-stream-prefix\" = \"ecs\"\n"], [117, "        }\n"], [118, "      }\n"], [119, "    }\n"], [120, "  ])\n"], [121, "\n"], [122, "  tags = {\n"], [123, "    Name        = \"${var.project}-${var.environment}-task\"\n"], [124, "    Environment = var.environment\n"], [125, "    Project     = var.project\n"], [126, "  }\n"], [127, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [90, 127], "resource": "module.ecs_jenkins_github.module.ecs.aws_ecs_task_definition.task_definition", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSTaskDefinitionEFSVolumeEncryption", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-task", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-39", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_249", "bc_check_id": "BC_AWS_IAM_68", "check_name": "Ensure that the Execution Role ARN and the Task Role ARN are different in ECS Task definitions", "check_result": {"result": "PASSED", "evaluated_keys": ["execution_role_arn", "task_role_arn"]}, "code_block": [[90, "resource \"aws_ecs_task_definition\" \"task_definition\" {\n"], [91, "  family                   = \"${var.project}-${var.environment}-task\"\n"], [92, "  network_mode             = \"awsvpc\"\n"], [93, "  requires_compatibilities = [\"FARGATE\"]\n"], [94, "  cpu                      = \"256\"\n"], [95, "  memory                   = \"512\"\n"], [96, "  execution_role_arn       = var.ecs_task_execution_role\n"], [97, "  task_role_arn            = var.ecs_task_role\n"], [98, "\n"], [99, "  container_definitions = jsonencode([\n"], [100, "    {\n"], [101, "      name      = \"${var.project}-${var.environment}-container\"\n"], [102, "      image     = \"nginx:latest\" # This is a placeholder image\n"], [103, "      essential = true\n"], [104, "      portMappings = [\n"], [105, "        {\n"], [106, "          containerPort = 80\n"], [107, "          hostPort      = 80\n"], [108, "          protocol      = \"tcp\"\n"], [109, "        }\n"], [110, "      ]\n"], [111, "      logConfiguration = {\n"], [112, "        logDriver = \"awslogs\"\n"], [113, "        options = {\n"], [114, "          \"awslogs-group\"         = aws_cloudwatch_log_group.ecs_logs.name\n"], [115, "          \"awslogs-region\"        = data.aws_region.current.id\n"], [116, "          \"awslogs-stream-prefix\" = \"ecs\"\n"], [117, "        }\n"], [118, "      }\n"], [119, "    }\n"], [120, "  ])\n"], [121, "\n"], [122, "  tags = {\n"], [123, "    Name        = \"${var.project}-${var.environment}-task\"\n"], [124, "    Environment = var.environment\n"], [125, "    Project     = var.project\n"], [126, "  }\n"], [127, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [90, 127], "resource": "module.ecs_jenkins_github.module.ecs.aws_ecs_task_definition.task_definition", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSTaskDefinitionRoleCheck", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-task", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-the-aws-execution-role-arn-and-task-role-arn-are-different-in-ecs-task-definitions", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_332", "bc_check_id": "BC_AWS_GENERAL_238", "check_name": "Ensure ECS Fargate services run on the latest Fargate platform version", "check_result": {"result": "PASSED", "evaluated_keys": ["launch_type", "platform_version"]}, "code_block": [[130, "resource \"aws_ecs_service\" \"service\" {\n"], [131, "  name            = \"${var.project}-${var.environment}-service\"\n"], [132, "  cluster         = aws_ecs_cluster.cluster.id\n"], [133, "  task_definition = aws_ecs_task_definition.task_definition.arn\n"], [134, "  desired_count   = 2\n"], [135, "  launch_type     = \"FARGATE\"\n"], [136, "\n"], [137, "  network_configuration {\n"], [138, "    subnets          = var.private_subnets\n"], [139, "    security_groups  = [var.ecs_security_group]\n"], [140, "    assign_public_ip = false\n"], [141, "  }\n"], [142, "\n"], [143, "  load_balancer {\n"], [144, "    target_group_arn = aws_lb_target_group.target_group.arn\n"], [145, "    container_name   = \"${var.project}-${var.environment}-container\"\n"], [146, "    container_port   = 80\n"], [147, "  }\n"], [148, "\n"], [149, "  depends_on = [aws_lb_listener.http]\n"], [150, "\n"], [151, "  tags = {\n"], [152, "    Name        = \"${var.project}-${var.environment}-service\"\n"], [153, "    Environment = var.environment\n"], [154, "    Project     = var.project\n"], [155, "  }\n"], [156, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [130, 156], "resource": "module.ecs_jenkins_github.module.ecs.aws_ecs_service.service", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSServiceFargateLatest", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-service", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-332", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_333", "bc_check_id": "BC_AWS_LOGGING_45", "check_name": "Ensure ECS services do not have public IP addresses assigned to them automatically", "check_result": {"result": "PASSED", "evaluated_keys": ["network_configuration/[0]/assign_public_ip"]}, "code_block": [[130, "resource \"aws_ecs_service\" \"service\" {\n"], [131, "  name            = \"${var.project}-${var.environment}-service\"\n"], [132, "  cluster         = aws_ecs_cluster.cluster.id\n"], [133, "  task_definition = aws_ecs_task_definition.task_definition.arn\n"], [134, "  desired_count   = 2\n"], [135, "  launch_type     = \"FARGATE\"\n"], [136, "\n"], [137, "  network_configuration {\n"], [138, "    subnets          = var.private_subnets\n"], [139, "    security_groups  = [var.ecs_security_group]\n"], [140, "    assign_public_ip = false\n"], [141, "  }\n"], [142, "\n"], [143, "  load_balancer {\n"], [144, "    target_group_arn = aws_lb_target_group.target_group.arn\n"], [145, "    container_name   = \"${var.project}-${var.environment}-container\"\n"], [146, "    container_port   = 80\n"], [147, "  }\n"], [148, "\n"], [149, "  depends_on = [aws_lb_listener.http]\n"], [150, "\n"], [151, "  tags = {\n"], [152, "    Name        = \"${var.project}-${var.environment}-service\"\n"], [153, "    Environment = var.environment\n"], [154, "    Project     = var.project\n"], [155, "  }\n"], [156, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [130, 156], "resource": "module.ecs_jenkins_github.module.ecs.aws_ecs_service.service", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSServicePublicIP", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-service", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-333", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_46", "bc_check_id": "BC_AWS_SECRETS_1", "check_name": "Ensure no hard-coded secrets exist in EC2 user data", "check_result": {"result": "PASSED", "evaluated_keys": ["user_data"]}, "code_block": [[159, "resource \"aws_instance\" \"jenkins\" {\n"], [160, "  count = var.create_jenkins ? 1 : 0\n"], [161, "\n"], [162, "  ami                    = data.aws_ami.amazon_linux_2.id\n"], [163, "  instance_type          = \"t3.medium\"\n"], [164, "  subnet_id              = var.public_subnets[0]\n"], [165, "  vpc_security_group_ids = [var.jenkins_security_group]\n"], [166, "  key_name               = var.key_name\n"], [167, "\n"], [168, "  user_data = <<-EOF\n"], [169, "    #!/bin/bash\n"], [170, "    sudo yum update -y\n"], [171, "    sudo amazon-linux-extras install java-openjdk11 -y\n"], [172, "    sudo yum install -y jenkins git docker\n"], [173, "    sudo systemctl start jenkins\n"], [174, "    sudo systemctl enable jenkins\n"], [175, "    sudo systemctl start docker\n"], [176, "    sudo systemctl enable docker\n"], [177, "    sudo usermod -aG docker jenkins\n"], [178, "    sudo systemctl restart jenkins\n"], [179, "  EOF\n"], [180, "\n"], [181, "  tags = {\n"], [182, "    Name        = \"${var.project}-${var.environment}-jenkins\"\n"], [183, "    Environment = var.environment\n"], [184, "    Project     = var.project\n"], [185, "  }\n"], [186, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [159, 186], "resource": "module.ecs_jenkins_github.module.ecs.aws_instance.jenkins[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2Credentials", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-1", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_88", "bc_check_id": "BC_AWS_PUBLIC_12", "check_name": "EC2 instance should not have public IP.", "check_result": {"result": "PASSED", "evaluated_keys": ["associate_public_ip_address"]}, "code_block": [[159, "resource \"aws_instance\" \"jenkins\" {\n"], [160, "  count = var.create_jenkins ? 1 : 0\n"], [161, "\n"], [162, "  ami                    = data.aws_ami.amazon_linux_2.id\n"], [163, "  instance_type          = \"t3.medium\"\n"], [164, "  subnet_id              = var.public_subnets[0]\n"], [165, "  vpc_security_group_ids = [var.jenkins_security_group]\n"], [166, "  key_name               = var.key_name\n"], [167, "\n"], [168, "  user_data = <<-EOF\n"], [169, "    #!/bin/bash\n"], [170, "    sudo yum update -y\n"], [171, "    sudo amazon-linux-extras install java-openjdk11 -y\n"], [172, "    sudo yum install -y jenkins git docker\n"], [173, "    sudo systemctl start jenkins\n"], [174, "    sudo systemctl enable jenkins\n"], [175, "    sudo systemctl start docker\n"], [176, "    sudo systemctl enable docker\n"], [177, "    sudo usermod -aG docker jenkins\n"], [178, "    sudo systemctl restart jenkins\n"], [179, "  EOF\n"], [180, "\n"], [181, "  tags = {\n"], [182, "    Name        = \"${var.project}-${var.environment}-jenkins\"\n"], [183, "    Environment = var.environment\n"], [184, "    Project     = var.project\n"], [185, "  }\n"], [186, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [159, 186], "resource": "module.ecs_jenkins_github.module.ecs.aws_instance.jenkins[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2PublicIP", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-12", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_233", "bc_check_id": "BC_AWS_NETWORKING_69", "check_name": "Ensure Create before destroy for ACM certificates", "check_result": {"result": "PASSED", "evaluated_keys": ["lifecycle/[0]/create_before_destroy"]}, "code_block": [[230, "resource \"aws_acm_certificate\" \"cert\" {\n"], [231, "  count                  = var.create_dummy_cert ? 1 : 0\n"], [232, "  private_key            = tls_private_key.example[0].private_key_pem\n"], [233, "  certificate_body       = tls_self_signed_cert.example[0].cert_pem\n"], [234, "  certificate_chain      = tls_self_signed_cert.example[0].cert_pem\n"], [235, "  early_renewal_duration = \"24h\"      # 24 hours before expiration\n"], [236, "  key_algorithm          = \"RSA_4096\" # Matches our 4096-bit RSA key\n"], [237, "  tags = {\n"], [238, "    Name        = \"${var.project}-${var.environment}-cert\"\n"], [239, "    Environment = var.environment\n"], [240, "    Project     = var.project\n"], [241, "    ManagedBy   = \"Terraform\"\n"], [242, "    AutoRenew   = \"false\" # Self-signed certs shouldn't be auto-renewed\n"], [243, "  }\n"], [244, "\n"], [245, "  lifecycle {\n"], [246, "    create_before_destroy = true\n"], [247, "    ignore_changes = [\n"], [248, "      # Ignore changes to tags, e.g. because a management agent\n"], [249, "      # updates these based on some ruleset managed elsewhere.\n"], [250, "      tags,\n"], [251, "    ]\n"], [252, "  }\n"], [253, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [230, 253], "resource": "module.ecs_jenkins_github.module.ecs.aws_acm_certificate.cert[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ACMCertCreateBeforeDestroy", "fixed_definition": null, "entity_tags": {"AutoRenew": false, "Environment": "prod", "ManagedBy": "Terraform", "Name": "ecs-jenkins-prod-cert", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-acm-certificate-enables-create-before-destroy", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_234", "bc_check_id": "BC_AWS_GENERAL_173", "check_name": "Verify logging preference for ACM certificates", "check_result": {"result": "PASSED", "evaluated_keys": ["options/[0]/certificate_transparency_logging_preference"]}, "code_block": [[230, "resource \"aws_acm_certificate\" \"cert\" {\n"], [231, "  count                  = var.create_dummy_cert ? 1 : 0\n"], [232, "  private_key            = tls_private_key.example[0].private_key_pem\n"], [233, "  certificate_body       = tls_self_signed_cert.example[0].cert_pem\n"], [234, "  certificate_chain      = tls_self_signed_cert.example[0].cert_pem\n"], [235, "  early_renewal_duration = \"24h\"      # 24 hours before expiration\n"], [236, "  key_algorithm          = \"RSA_4096\" # Matches our 4096-bit RSA key\n"], [237, "  tags = {\n"], [238, "    Name        = \"${var.project}-${var.environment}-cert\"\n"], [239, "    Environment = var.environment\n"], [240, "    Project     = var.project\n"], [241, "    ManagedBy   = \"Terraform\"\n"], [242, "    AutoRenew   = \"false\" # Self-signed certs shouldn't be auto-renewed\n"], [243, "  }\n"], [244, "\n"], [245, "  lifecycle {\n"], [246, "    create_before_destroy = true\n"], [247, "    ignore_changes = [\n"], [248, "      # Ignore changes to tags, e.g. because a management agent\n"], [249, "      # updates these based on some ruleset managed elsewhere.\n"], [250, "      tags,\n"], [251, "    ]\n"], [252, "  }\n"], [253, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [230, 253], "resource": "module.ecs_jenkins_github.module.ecs.aws_acm_certificate.cert[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ACMCertSetLoggingPreference", "fixed_definition": null, "entity_tags": {"AutoRenew": false, "Environment": "prod", "ManagedBy": "Terraform", "Name": "ecs-jenkins-prod-cert", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-acm-certificates-has-logging-preference", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_2", "bc_check_id": "BC_AWS_NETWORKING_29", "check_name": "Ensure ALB protocol is HTTPS", "check_result": {"result": "PASSED", "evaluated_keys": ["protocol"]}, "code_block": [[256, "resource \"aws_lb_listener\" \"https\" {\n"], [257, "  count             = var.create_dummy_cert ? 1 : 0\n"], [258, "  load_balancer_arn = aws_lb.alb.arn\n"], [259, "  port              = 443\n"], [260, "  protocol          = \"HTTPS\"\n"], [261, "  # Use a more secure SSL policy that requires TLS 1.2 minimum (OWASP recommendation)\n"], [262, "  ssl_policy      = \"ELBSecurityPolicy-TLS-1-2-2017-01\"\n"], [263, "  certificate_arn = aws_acm_certificate.cert[0].arn\n"], [264, "\n"], [265, "  default_action {\n"], [266, "    type             = \"forward\"\n"], [267, "    target_group_arn = aws_lb_target_group.target_group.arn\n"], [268, "  }\n"], [269, "\n"], [270, "  tags = {\n"], [271, "    Name               = \"${var.project}-${var.environment}-https\"\n"], [272, "    Environment        = var.environment\n"], [273, "    Project            = var.project\n"], [274, "    SecurityCompliance = \"OWASP-TLS-1.2\"\n"], [275, "  }\n"], [276, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [256, 276], "resource": "module.ecs_jenkins_github.module.ecs.aws_lb_listener.https[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ALBListenerHTTPS", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-https", "Project": "ecs-jenkins", "SecurityCompliance": "OWASP-TLS-1.2"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-29", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_2", "bc_check_id": "BC_AWS_NETWORKING_29", "check_name": "Ensure ALB protocol is HTTPS", "check_result": {"result": "PASSED", "evaluated_keys": ["default_action/[0]/redirect/[0]/protocol"]}, "code_block": [[279, "resource \"aws_lb_listener\" \"http_redirect\" {\n"], [280, "  load_balancer_arn = aws_lb.alb.arn\n"], [281, "  port              = 80\n"], [282, "  protocol          = \"HTTP\"\n"], [283, "\n"], [284, "  default_action {\n"], [285, "    type = \"redirect\"\n"], [286, "\n"], [287, "    redirect {\n"], [288, "      port        = \"443\"\n"], [289, "      protocol    = \"HTTPS\"\n"], [290, "      status_code = \"HTTP_301\"\n"], [291, "    }\n"], [292, "  }\n"], [293, "\n"], [294, "  # Add security headers via response headers policy\n"], [295, "  lifecycle {\n"], [296, "    ignore_changes = [default_action]\n"], [297, "  }\n"], [298, "\n"], [299, "  tags = {\n"], [300, "    Name        = \"${var.project}-${var.environment}-http-redirect\"\n"], [301, "    Environment = var.environment\n"], [302, "    Project     = var.project\n"], [303, "    ManagedBy   = \"Terraform\"\n"], [304, "  }\n"], [305, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [279, 305], "resource": "module.ecs_jenkins_github.module.ecs.aws_lb_listener.http_redirect", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ALBListenerHTTPS", "fixed_definition": null, "entity_tags": {"Environment": "prod", "ManagedBy": "Terraform", "Name": "ecs-jenkins-prod-http-redirect", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-29", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_259", "bc_check_id": "BC_AWS_GENERAL_134", "check_name": "Ensure CloudFront response header policy enforces Strict Transport Security", "check_result": {"result": "PASSED", "evaluated_keys": ["security_headers_config/[0]/strict_transport_security/[0]/access_control_max_age_sec", "security_headers_config/[0]/strict_transport_security/[0]/include_subdomains", "security_headers_config/[0]/strict_transport_security/[0]/preload", "security_headers_config/[0]/strict_transport_security/[0]/override"]}, "code_block": [[308, "resource \"aws_cloudfront_response_headers_policy\" \"security_headers\" {\n"], [309, "  name    = \"${var.project}-${var.environment}-security-headers\"\n"], [310, "  comment = \"Security headers policy for ${var.project} - OWASP Compliant\"\n"], [311, "\n"], [312, "  security_headers_config {\n"], [313, "    content_security_policy {\n"], [314, "      # Enhanced CSP aligned with OWASP recommendations\n"], [315, "      content_security_policy = \"default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https:; style-src 'self' 'unsafe-inline' https:; img-src 'self' data: https:; font-src 'self' https: data:; connect-src 'self' https:; media-src 'self' https:; object-src 'none'; frame-src 'self' https:; worker-src 'self' blob:; manifest-src 'self'; base-uri 'self'; form-action 'self';\"\n"], [316, "      override                = true\n"], [317, "    }\n"], [318, "\n"], [319, "    content_type_options {\n"], [320, "      override = true\n"], [321, "    }\n"], [322, "\n"], [323, "    frame_options {\n"], [324, "      frame_option = \"DENY\"\n"], [325, "      override     = true\n"], [326, "    }\n"], [327, "\n"], [328, "    referrer_policy {\n"], [329, "      referrer_policy = \"strict-origin-when-cross-origin\"\n"], [330, "      override        = true\n"], [331, "    }\n"], [332, "\n"], [333, "    xss_protection {\n"], [334, "      mode_block = true\n"], [335, "      protection = true\n"], [336, "      override   = true\n"], [337, "    }\n"], [338, "\n"], [339, "    # HSTS (HTTP Strict Transport Security)\n"], [340, "    strict_transport_security {\n"], [341, "      access_control_max_age_sec = 63072000 # 2 years\n"], [342, "      include_subdomains         = true\n"], [343, "      preload                    = true\n"], [344, "      override                   = true\n"], [345, "    }\n"], [346, "  }\n"], [347, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [308, 347], "resource": "module.ecs_jenkins_github.module.ecs.aws_cloudfront_response_headers_policy.security_headers", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudFrontResponseHeaderStrictTransportSecurity", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-cloudfront-response-header-policy-enforces-strict-transport-security", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_386", "bc_check_id": "BC_AWS_GENERAL_271", "check_name": "Reduce potential for WhoAMI cloud image name confusion attack", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[352, "data \"aws_ami\" \"amazon_linux_2\" {\n"], [353, "  most_recent = true\n"], [354, "  owners      = [\"amazon\"]\n"], [355, "\n"], [356, "  filter {\n"], [357, "    name   = \"name\"\n"], [358, "    values = [\"amzn2-ami-hvm-*-x86_64-gp2\"]\n"], [359, "  }\n"], [360, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [352, 360], "resource": "module.ecs_jenkins_github.module.ecs.aws_ami.amazon_linux_2", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.WhoAMI", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-supply-chain-policies/bc-aws-386", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_65", "bc_check_id": "BC_AWS_LOGGING_11", "check_name": "Ensure container insights are enabled on ECS cluster", "check_result": {"result": "PASSED", "evaluated_keys": ["setting/[0]/name", "setting/[0]/value"]}, "code_block": [[2, "resource \"aws_ecs_cluster\" \"cluster\" {\n"], [3, "  name = \"${var.project}-${var.environment}-cluster\"\n"], [4, "\n"], [5, "  setting {\n"], [6, "    name  = \"containerInsights\"\n"], [7, "    value = \"enabled\"\n"], [8, "  }\n"], [9, "\n"], [10, "  tags = {\n"], [11, "    Name        = \"${var.project}-${var.environment}-cluster\"\n"], [12, "    Environment = var.environment\n"], [13, "    Project     = var.project\n"], [14, "  }\n"], [15, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [2, 15], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_ecs_cluster.cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSClusterContainerInsights", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-cluster", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-logging-11", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_223", "bc_check_id": "BC_AWS_GENERAL_171", "check_name": "Ensure ECS Cluster enables logging of ECS Exec", "check_result": {"result": "PASSED", "evaluated_keys": ["configuration/[0]/execute_command_configuration/[0]/logging"]}, "code_block": [[2, "resource \"aws_ecs_cluster\" \"cluster\" {\n"], [3, "  name = \"${var.project}-${var.environment}-cluster\"\n"], [4, "\n"], [5, "  setting {\n"], [6, "    name  = \"containerInsights\"\n"], [7, "    value = \"enabled\"\n"], [8, "  }\n"], [9, "\n"], [10, "  tags = {\n"], [11, "    Name        = \"${var.project}-${var.environment}-cluster\"\n"], [12, "    Environment = var.environment\n"], [13, "    Project     = var.project\n"], [14, "  }\n"], [15, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [2, 15], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_ecs_cluster.cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSClusterLoggingEnabled", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-cluster", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-ecs-cluster-enables-logging-of-ecs-exec", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_66", "bc_check_id": "BC_AWS_LOGGING_13", "check_name": "Ensure that CloudWatch Log Group specifies retention days", "check_result": {"result": "PASSED", "evaluated_keys": ["retention_in_days"]}, "code_block": [[18, "resource \"aws_cloudwatch_log_group\" \"ecs_logs\" {\n"], [19, "  name              = \"/ecs/${var.project}-${var.environment}\"\n"], [20, "  retention_in_days = 30\n"], [21, "\n"], [22, "  tags = {\n"], [23, "    Name        = \"${var.project}-${var.environment}-ecs-logs\"\n"], [24, "    Environment = var.environment\n"], [25, "    Project     = var.project\n"], [26, "  }\n"], [27, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [18, 27], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_cloudwatch_log_group.ecs_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetention", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-ecs-logs", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-13", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_328", "bc_check_id": "BC_AWS_NETWORKING_89", "check_name": "Ensure that ALB is configured with defensive or strictest desync mitigation mode", "check_result": {"result": "PASSED", "evaluated_keys": ["desync_mitigation_mode"]}, "code_block": [[30, "resource \"aws_lb\" \"alb\" {\n"], [31, "  name               = \"${var.project}-${var.environment}-alb\"\n"], [32, "  internal           = false\n"], [33, "  load_balancer_type = \"application\"\n"], [34, "  security_groups    = [var.alb_security_group]\n"], [35, "  subnets            = var.public_subnets\n"], [36, "\n"], [37, "  enable_deletion_protection = false\n"], [38, "\n"], [39, "  tags = {\n"], [40, "    Name        = \"${var.project}-${var.environment}-alb\"\n"], [41, "    Environment = var.environment\n"], [42, "    Project     = var.project\n"], [43, "  }\n"], [44, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [30, 44], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_lb.alb", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ALBDesyncMode", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-alb", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-328", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_261", "bc_check_id": "BC_AWS_GENERAL_177", "check_name": "Ensure HTTP HTTPS Target group defines Healthcheck", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[46, "resource \"aws_lb_target_group\" \"target_group\" {\n"], [47, "  name        = \"${var.project}-${var.environment}-tg\"\n"], [48, "  port        = 80\n"], [49, "  protocol    = \"HTTP\"\n"], [50, "  vpc_id      = var.vpc_id\n"], [51, "  target_type = \"ip\"\n"], [52, "\n"], [53, "  health_check {\n"], [54, "    enabled             = true\n"], [55, "    interval            = 30\n"], [56, "    path                = \"/\"\n"], [57, "    port                = \"traffic-port\"\n"], [58, "    healthy_threshold   = 3\n"], [59, "    unhealthy_threshold = 3\n"], [60, "    timeout             = 5\n"], [61, "    protocol            = \"HTTP\"\n"], [62, "    matcher             = \"200\"\n"], [63, "  }\n"], [64, "\n"], [65, "  tags = {\n"], [66, "    Name        = \"${var.project}-${var.environment}-tg\"\n"], [67, "    Environment = var.environment\n"], [68, "    Project     = var.project\n"], [69, "  }\n"], [70, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [46, 70], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_lb_target_group.target_group", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LBTargetGroupsDefinesHealthcheck", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-tg", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-kendra-index-server-side-encryption-uses-customer-managed-keys-cmks", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_335", "bc_check_id": "BC_AWS_GENERAL_240", "check_name": "Ensure ECS task definitions should not share the host's process namespace", "check_result": {"result": "PASSED", "evaluated_keys": ["container_definitions"]}, "code_block": [[90, "resource \"aws_ecs_task_definition\" \"task_definition\" {\n"], [91, "  family                   = \"${var.project}-${var.environment}-task\"\n"], [92, "  network_mode             = \"awsvpc\"\n"], [93, "  requires_compatibilities = [\"FARGATE\"]\n"], [94, "  cpu                      = \"256\"\n"], [95, "  memory                   = \"512\"\n"], [96, "  execution_role_arn       = var.ecs_task_execution_role\n"], [97, "  task_role_arn            = var.ecs_task_role\n"], [98, "\n"], [99, "  container_definitions = jsonencode([\n"], [100, "    {\n"], [101, "      name      = \"${var.project}-${var.environment}-container\"\n"], [102, "      image     = \"nginx:latest\" # This is a placeholder image\n"], [103, "      essential = true\n"], [104, "      portMappings = [\n"], [105, "        {\n"], [106, "          containerPort = 80\n"], [107, "          hostPort      = 80\n"], [108, "          protocol      = \"tcp\"\n"], [109, "        }\n"], [110, "      ]\n"], [111, "      logConfiguration = {\n"], [112, "        logDriver = \"awslogs\"\n"], [113, "        options = {\n"], [114, "          \"awslogs-group\"         = aws_cloudwatch_log_group.ecs_logs.name\n"], [115, "          \"awslogs-region\"        = data.aws_region.current.id\n"], [116, "          \"awslogs-stream-prefix\" = \"ecs\"\n"], [117, "        }\n"], [118, "      }\n"], [119, "    }\n"], [120, "  ])\n"], [121, "\n"], [122, "  tags = {\n"], [123, "    Name        = \"${var.project}-${var.environment}-task\"\n"], [124, "    Environment = var.environment\n"], [125, "    Project     = var.project\n"], [126, "  }\n"], [127, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [90, 127], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_ecs_task_definition.task_definition", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSContainerHostProcess", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-task", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-335", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_334", "bc_check_id": "BC_AWS_GENERAL_239", "check_name": "Ensure ECS containers should run as non-privileged", "check_result": {"result": "PASSED", "evaluated_keys": ["container_definitions"]}, "code_block": [[90, "resource \"aws_ecs_task_definition\" \"task_definition\" {\n"], [91, "  family                   = \"${var.project}-${var.environment}-task\"\n"], [92, "  network_mode             = \"awsvpc\"\n"], [93, "  requires_compatibilities = [\"FARGATE\"]\n"], [94, "  cpu                      = \"256\"\n"], [95, "  memory                   = \"512\"\n"], [96, "  execution_role_arn       = var.ecs_task_execution_role\n"], [97, "  task_role_arn            = var.ecs_task_role\n"], [98, "\n"], [99, "  container_definitions = jsonencode([\n"], [100, "    {\n"], [101, "      name      = \"${var.project}-${var.environment}-container\"\n"], [102, "      image     = \"nginx:latest\" # This is a placeholder image\n"], [103, "      essential = true\n"], [104, "      portMappings = [\n"], [105, "        {\n"], [106, "          containerPort = 80\n"], [107, "          hostPort      = 80\n"], [108, "          protocol      = \"tcp\"\n"], [109, "        }\n"], [110, "      ]\n"], [111, "      logConfiguration = {\n"], [112, "        logDriver = \"awslogs\"\n"], [113, "        options = {\n"], [114, "          \"awslogs-group\"         = aws_cloudwatch_log_group.ecs_logs.name\n"], [115, "          \"awslogs-region\"        = data.aws_region.current.id\n"], [116, "          \"awslogs-stream-prefix\" = \"ecs\"\n"], [117, "        }\n"], [118, "      }\n"], [119, "    }\n"], [120, "  ])\n"], [121, "\n"], [122, "  tags = {\n"], [123, "    Name        = \"${var.project}-${var.environment}-task\"\n"], [124, "    Environment = var.environment\n"], [125, "    Project     = var.project\n"], [126, "  }\n"], [127, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [90, 127], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_ecs_task_definition.task_definition", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSContainerPrivilege", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-task", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-334", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_97", "bc_check_id": "BC_AWS_GENERAL_39", "check_name": "Ensure Encryption in transit is enabled for EFS volumes in ECS Task definitions", "check_result": {"result": "PASSED", "evaluated_keys": ["volume"]}, "code_block": [[90, "resource \"aws_ecs_task_definition\" \"task_definition\" {\n"], [91, "  family                   = \"${var.project}-${var.environment}-task\"\n"], [92, "  network_mode             = \"awsvpc\"\n"], [93, "  requires_compatibilities = [\"FARGATE\"]\n"], [94, "  cpu                      = \"256\"\n"], [95, "  memory                   = \"512\"\n"], [96, "  execution_role_arn       = var.ecs_task_execution_role\n"], [97, "  task_role_arn            = var.ecs_task_role\n"], [98, "\n"], [99, "  container_definitions = jsonencode([\n"], [100, "    {\n"], [101, "      name      = \"${var.project}-${var.environment}-container\"\n"], [102, "      image     = \"nginx:latest\" # This is a placeholder image\n"], [103, "      essential = true\n"], [104, "      portMappings = [\n"], [105, "        {\n"], [106, "          containerPort = 80\n"], [107, "          hostPort      = 80\n"], [108, "          protocol      = \"tcp\"\n"], [109, "        }\n"], [110, "      ]\n"], [111, "      logConfiguration = {\n"], [112, "        logDriver = \"awslogs\"\n"], [113, "        options = {\n"], [114, "          \"awslogs-group\"         = aws_cloudwatch_log_group.ecs_logs.name\n"], [115, "          \"awslogs-region\"        = data.aws_region.current.id\n"], [116, "          \"awslogs-stream-prefix\" = \"ecs\"\n"], [117, "        }\n"], [118, "      }\n"], [119, "    }\n"], [120, "  ])\n"], [121, "\n"], [122, "  tags = {\n"], [123, "    Name        = \"${var.project}-${var.environment}-task\"\n"], [124, "    Environment = var.environment\n"], [125, "    Project     = var.project\n"], [126, "  }\n"], [127, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [90, 127], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_ecs_task_definition.task_definition", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSTaskDefinitionEFSVolumeEncryption", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-task", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-39", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_249", "bc_check_id": "BC_AWS_IAM_68", "check_name": "Ensure that the Execution Role ARN and the Task Role ARN are different in ECS Task definitions", "check_result": {"result": "PASSED", "evaluated_keys": ["execution_role_arn", "task_role_arn"]}, "code_block": [[90, "resource \"aws_ecs_task_definition\" \"task_definition\" {\n"], [91, "  family                   = \"${var.project}-${var.environment}-task\"\n"], [92, "  network_mode             = \"awsvpc\"\n"], [93, "  requires_compatibilities = [\"FARGATE\"]\n"], [94, "  cpu                      = \"256\"\n"], [95, "  memory                   = \"512\"\n"], [96, "  execution_role_arn       = var.ecs_task_execution_role\n"], [97, "  task_role_arn            = var.ecs_task_role\n"], [98, "\n"], [99, "  container_definitions = jsonencode([\n"], [100, "    {\n"], [101, "      name      = \"${var.project}-${var.environment}-container\"\n"], [102, "      image     = \"nginx:latest\" # This is a placeholder image\n"], [103, "      essential = true\n"], [104, "      portMappings = [\n"], [105, "        {\n"], [106, "          containerPort = 80\n"], [107, "          hostPort      = 80\n"], [108, "          protocol      = \"tcp\"\n"], [109, "        }\n"], [110, "      ]\n"], [111, "      logConfiguration = {\n"], [112, "        logDriver = \"awslogs\"\n"], [113, "        options = {\n"], [114, "          \"awslogs-group\"         = aws_cloudwatch_log_group.ecs_logs.name\n"], [115, "          \"awslogs-region\"        = data.aws_region.current.id\n"], [116, "          \"awslogs-stream-prefix\" = \"ecs\"\n"], [117, "        }\n"], [118, "      }\n"], [119, "    }\n"], [120, "  ])\n"], [121, "\n"], [122, "  tags = {\n"], [123, "    Name        = \"${var.project}-${var.environment}-task\"\n"], [124, "    Environment = var.environment\n"], [125, "    Project     = var.project\n"], [126, "  }\n"], [127, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [90, 127], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_ecs_task_definition.task_definition", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSTaskDefinitionRoleCheck", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-task", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-the-aws-execution-role-arn-and-task-role-arn-are-different-in-ecs-task-definitions", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_332", "bc_check_id": "BC_AWS_GENERAL_238", "check_name": "Ensure ECS Fargate services run on the latest Fargate platform version", "check_result": {"result": "PASSED", "evaluated_keys": ["launch_type", "platform_version"]}, "code_block": [[130, "resource \"aws_ecs_service\" \"service\" {\n"], [131, "  name            = \"${var.project}-${var.environment}-service\"\n"], [132, "  cluster         = aws_ecs_cluster.cluster.id\n"], [133, "  task_definition = aws_ecs_task_definition.task_definition.arn\n"], [134, "  desired_count   = 2\n"], [135, "  launch_type     = \"FARGATE\"\n"], [136, "\n"], [137, "  network_configuration {\n"], [138, "    subnets          = var.private_subnets\n"], [139, "    security_groups  = [var.ecs_security_group]\n"], [140, "    assign_public_ip = false\n"], [141, "  }\n"], [142, "\n"], [143, "  load_balancer {\n"], [144, "    target_group_arn = aws_lb_target_group.target_group.arn\n"], [145, "    container_name   = \"${var.project}-${var.environment}-container\"\n"], [146, "    container_port   = 80\n"], [147, "  }\n"], [148, "\n"], [149, "  depends_on = [aws_lb_listener.http]\n"], [150, "\n"], [151, "  tags = {\n"], [152, "    Name        = \"${var.project}-${var.environment}-service\"\n"], [153, "    Environment = var.environment\n"], [154, "    Project     = var.project\n"], [155, "  }\n"], [156, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [130, 156], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_ecs_service.service", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSServiceFargateLatest", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-service", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-332", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_333", "bc_check_id": "BC_AWS_LOGGING_45", "check_name": "Ensure ECS services do not have public IP addresses assigned to them automatically", "check_result": {"result": "PASSED", "evaluated_keys": ["network_configuration/[0]/assign_public_ip"]}, "code_block": [[130, "resource \"aws_ecs_service\" \"service\" {\n"], [131, "  name            = \"${var.project}-${var.environment}-service\"\n"], [132, "  cluster         = aws_ecs_cluster.cluster.id\n"], [133, "  task_definition = aws_ecs_task_definition.task_definition.arn\n"], [134, "  desired_count   = 2\n"], [135, "  launch_type     = \"FARGATE\"\n"], [136, "\n"], [137, "  network_configuration {\n"], [138, "    subnets          = var.private_subnets\n"], [139, "    security_groups  = [var.ecs_security_group]\n"], [140, "    assign_public_ip = false\n"], [141, "  }\n"], [142, "\n"], [143, "  load_balancer {\n"], [144, "    target_group_arn = aws_lb_target_group.target_group.arn\n"], [145, "    container_name   = \"${var.project}-${var.environment}-container\"\n"], [146, "    container_port   = 80\n"], [147, "  }\n"], [148, "\n"], [149, "  depends_on = [aws_lb_listener.http]\n"], [150, "\n"], [151, "  tags = {\n"], [152, "    Name        = \"${var.project}-${var.environment}-service\"\n"], [153, "    Environment = var.environment\n"], [154, "    Project     = var.project\n"], [155, "  }\n"], [156, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [130, 156], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_ecs_service.service", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSServicePublicIP", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-service", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-333", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_46", "bc_check_id": "BC_AWS_SECRETS_1", "check_name": "Ensure no hard-coded secrets exist in EC2 user data", "check_result": {"result": "PASSED", "evaluated_keys": ["user_data"]}, "code_block": [[159, "resource \"aws_instance\" \"jenkins\" {\n"], [160, "  count = var.create_jenkins ? 1 : 0\n"], [161, "\n"], [162, "  ami                    = data.aws_ami.amazon_linux_2.id\n"], [163, "  instance_type          = \"t3.medium\"\n"], [164, "  subnet_id              = var.public_subnets[0]\n"], [165, "  vpc_security_group_ids = [var.jenkins_security_group]\n"], [166, "  key_name               = var.key_name\n"], [167, "\n"], [168, "  user_data = <<-EOF\n"], [169, "    #!/bin/bash\n"], [170, "    sudo yum update -y\n"], [171, "    sudo amazon-linux-extras install java-openjdk11 -y\n"], [172, "    sudo yum install -y jenkins git docker\n"], [173, "    sudo systemctl start jenkins\n"], [174, "    sudo systemctl enable jenkins\n"], [175, "    sudo systemctl start docker\n"], [176, "    sudo systemctl enable docker\n"], [177, "    sudo usermod -aG docker jenkins\n"], [178, "    sudo systemctl restart jenkins\n"], [179, "  EOF\n"], [180, "\n"], [181, "  tags = {\n"], [182, "    Name        = \"${var.project}-${var.environment}-jenkins\"\n"], [183, "    Environment = var.environment\n"], [184, "    Project     = var.project\n"], [185, "  }\n"], [186, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [159, 186], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_instance.jenkins[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2Credentials", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-1", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_88", "bc_check_id": "BC_AWS_PUBLIC_12", "check_name": "EC2 instance should not have public IP.", "check_result": {"result": "PASSED", "evaluated_keys": ["associate_public_ip_address"]}, "code_block": [[159, "resource \"aws_instance\" \"jenkins\" {\n"], [160, "  count = var.create_jenkins ? 1 : 0\n"], [161, "\n"], [162, "  ami                    = data.aws_ami.amazon_linux_2.id\n"], [163, "  instance_type          = \"t3.medium\"\n"], [164, "  subnet_id              = var.public_subnets[0]\n"], [165, "  vpc_security_group_ids = [var.jenkins_security_group]\n"], [166, "  key_name               = var.key_name\n"], [167, "\n"], [168, "  user_data = <<-EOF\n"], [169, "    #!/bin/bash\n"], [170, "    sudo yum update -y\n"], [171, "    sudo amazon-linux-extras install java-openjdk11 -y\n"], [172, "    sudo yum install -y jenkins git docker\n"], [173, "    sudo systemctl start jenkins\n"], [174, "    sudo systemctl enable jenkins\n"], [175, "    sudo systemctl start docker\n"], [176, "    sudo systemctl enable docker\n"], [177, "    sudo usermod -aG docker jenkins\n"], [178, "    sudo systemctl restart jenkins\n"], [179, "  EOF\n"], [180, "\n"], [181, "  tags = {\n"], [182, "    Name        = \"${var.project}-${var.environment}-jenkins\"\n"], [183, "    Environment = var.environment\n"], [184, "    Project     = var.project\n"], [185, "  }\n"], [186, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [159, 186], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_instance.jenkins[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2PublicIP", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-12", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_233", "bc_check_id": "BC_AWS_NETWORKING_69", "check_name": "Ensure Create before destroy for ACM certificates", "check_result": {"result": "PASSED", "evaluated_keys": ["lifecycle/[0]/create_before_destroy"]}, "code_block": [[230, "resource \"aws_acm_certificate\" \"cert\" {\n"], [231, "  count                  = var.create_dummy_cert ? 1 : 0\n"], [232, "  private_key            = tls_private_key.example[0].private_key_pem\n"], [233, "  certificate_body       = tls_self_signed_cert.example[0].cert_pem\n"], [234, "  certificate_chain      = tls_self_signed_cert.example[0].cert_pem\n"], [235, "  early_renewal_duration = \"24h\"      # 24 hours before expiration\n"], [236, "  key_algorithm          = \"RSA_4096\" # Matches our 4096-bit RSA key\n"], [237, "  tags = {\n"], [238, "    Name        = \"${var.project}-${var.environment}-cert\"\n"], [239, "    Environment = var.environment\n"], [240, "    Project     = var.project\n"], [241, "    ManagedBy   = \"Terraform\"\n"], [242, "    AutoRenew   = \"false\" # Self-signed certs shouldn't be auto-renewed\n"], [243, "  }\n"], [244, "\n"], [245, "  lifecycle {\n"], [246, "    create_before_destroy = true\n"], [247, "    ignore_changes = [\n"], [248, "      # Ignore changes to tags, e.g. because a management agent\n"], [249, "      # updates these based on some ruleset managed elsewhere.\n"], [250, "      tags,\n"], [251, "    ]\n"], [252, "  }\n"], [253, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [230, 253], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_acm_certificate.cert[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ACMCertCreateBeforeDestroy", "fixed_definition": null, "entity_tags": {"AutoRenew": false, "Environment": "dr", "ManagedBy": "Terraform", "Name": "ecs-jenkins-dr-cert", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-acm-certificate-enables-create-before-destroy", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_234", "bc_check_id": "BC_AWS_GENERAL_173", "check_name": "Verify logging preference for ACM certificates", "check_result": {"result": "PASSED", "evaluated_keys": ["options/[0]/certificate_transparency_logging_preference"]}, "code_block": [[230, "resource \"aws_acm_certificate\" \"cert\" {\n"], [231, "  count                  = var.create_dummy_cert ? 1 : 0\n"], [232, "  private_key            = tls_private_key.example[0].private_key_pem\n"], [233, "  certificate_body       = tls_self_signed_cert.example[0].cert_pem\n"], [234, "  certificate_chain      = tls_self_signed_cert.example[0].cert_pem\n"], [235, "  early_renewal_duration = \"24h\"      # 24 hours before expiration\n"], [236, "  key_algorithm          = \"RSA_4096\" # Matches our 4096-bit RSA key\n"], [237, "  tags = {\n"], [238, "    Name        = \"${var.project}-${var.environment}-cert\"\n"], [239, "    Environment = var.environment\n"], [240, "    Project     = var.project\n"], [241, "    ManagedBy   = \"Terraform\"\n"], [242, "    AutoRenew   = \"false\" # Self-signed certs shouldn't be auto-renewed\n"], [243, "  }\n"], [244, "\n"], [245, "  lifecycle {\n"], [246, "    create_before_destroy = true\n"], [247, "    ignore_changes = [\n"], [248, "      # Ignore changes to tags, e.g. because a management agent\n"], [249, "      # updates these based on some ruleset managed elsewhere.\n"], [250, "      tags,\n"], [251, "    ]\n"], [252, "  }\n"], [253, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [230, 253], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_acm_certificate.cert[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ACMCertSetLoggingPreference", "fixed_definition": null, "entity_tags": {"AutoRenew": false, "Environment": "dr", "ManagedBy": "Terraform", "Name": "ecs-jenkins-dr-cert", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-acm-certificates-has-logging-preference", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_2", "bc_check_id": "BC_AWS_NETWORKING_29", "check_name": "Ensure ALB protocol is HTTPS", "check_result": {"result": "PASSED", "evaluated_keys": ["protocol"]}, "code_block": [[256, "resource \"aws_lb_listener\" \"https\" {\n"], [257, "  count             = var.create_dummy_cert ? 1 : 0\n"], [258, "  load_balancer_arn = aws_lb.alb.arn\n"], [259, "  port              = 443\n"], [260, "  protocol          = \"HTTPS\"\n"], [261, "  # Use a more secure SSL policy that requires TLS 1.2 minimum (OWASP recommendation)\n"], [262, "  ssl_policy      = \"ELBSecurityPolicy-TLS-1-2-2017-01\"\n"], [263, "  certificate_arn = aws_acm_certificate.cert[0].arn\n"], [264, "\n"], [265, "  default_action {\n"], [266, "    type             = \"forward\"\n"], [267, "    target_group_arn = aws_lb_target_group.target_group.arn\n"], [268, "  }\n"], [269, "\n"], [270, "  tags = {\n"], [271, "    Name               = \"${var.project}-${var.environment}-https\"\n"], [272, "    Environment        = var.environment\n"], [273, "    Project            = var.project\n"], [274, "    SecurityCompliance = \"OWASP-TLS-1.2\"\n"], [275, "  }\n"], [276, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [256, 276], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_lb_listener.https[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ALBListenerHTTPS", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-https", "Project": "ecs-jenkins", "SecurityCompliance": "OWASP-TLS-1.2"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-29", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_2", "bc_check_id": "BC_AWS_NETWORKING_29", "check_name": "Ensure ALB protocol is HTTPS", "check_result": {"result": "PASSED", "evaluated_keys": ["default_action/[0]/redirect/[0]/protocol"]}, "code_block": [[279, "resource \"aws_lb_listener\" \"http_redirect\" {\n"], [280, "  load_balancer_arn = aws_lb.alb.arn\n"], [281, "  port              = 80\n"], [282, "  protocol          = \"HTTP\"\n"], [283, "\n"], [284, "  default_action {\n"], [285, "    type = \"redirect\"\n"], [286, "\n"], [287, "    redirect {\n"], [288, "      port        = \"443\"\n"], [289, "      protocol    = \"HTTPS\"\n"], [290, "      status_code = \"HTTP_301\"\n"], [291, "    }\n"], [292, "  }\n"], [293, "\n"], [294, "  # Add security headers via response headers policy\n"], [295, "  lifecycle {\n"], [296, "    ignore_changes = [default_action]\n"], [297, "  }\n"], [298, "\n"], [299, "  tags = {\n"], [300, "    Name        = \"${var.project}-${var.environment}-http-redirect\"\n"], [301, "    Environment = var.environment\n"], [302, "    Project     = var.project\n"], [303, "    ManagedBy   = \"Terraform\"\n"], [304, "  }\n"], [305, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [279, 305], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_lb_listener.http_redirect", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ALBListenerHTTPS", "fixed_definition": null, "entity_tags": {"Environment": "dr", "ManagedBy": "Terraform", "Name": "ecs-jenkins-dr-http-redirect", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-29", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_259", "bc_check_id": "BC_AWS_GENERAL_134", "check_name": "Ensure CloudFront response header policy enforces Strict Transport Security", "check_result": {"result": "PASSED", "evaluated_keys": ["security_headers_config/[0]/strict_transport_security/[0]/access_control_max_age_sec", "security_headers_config/[0]/strict_transport_security/[0]/include_subdomains", "security_headers_config/[0]/strict_transport_security/[0]/preload", "security_headers_config/[0]/strict_transport_security/[0]/override"]}, "code_block": [[308, "resource \"aws_cloudfront_response_headers_policy\" \"security_headers\" {\n"], [309, "  name    = \"${var.project}-${var.environment}-security-headers\"\n"], [310, "  comment = \"Security headers policy for ${var.project} - OWASP Compliant\"\n"], [311, "\n"], [312, "  security_headers_config {\n"], [313, "    content_security_policy {\n"], [314, "      # Enhanced CSP aligned with OWASP recommendations\n"], [315, "      content_security_policy = \"default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https:; style-src 'self' 'unsafe-inline' https:; img-src 'self' data: https:; font-src 'self' https: data:; connect-src 'self' https:; media-src 'self' https:; object-src 'none'; frame-src 'self' https:; worker-src 'self' blob:; manifest-src 'self'; base-uri 'self'; form-action 'self';\"\n"], [316, "      override                = true\n"], [317, "    }\n"], [318, "\n"], [319, "    content_type_options {\n"], [320, "      override = true\n"], [321, "    }\n"], [322, "\n"], [323, "    frame_options {\n"], [324, "      frame_option = \"DENY\"\n"], [325, "      override     = true\n"], [326, "    }\n"], [327, "\n"], [328, "    referrer_policy {\n"], [329, "      referrer_policy = \"strict-origin-when-cross-origin\"\n"], [330, "      override        = true\n"], [331, "    }\n"], [332, "\n"], [333, "    xss_protection {\n"], [334, "      mode_block = true\n"], [335, "      protection = true\n"], [336, "      override   = true\n"], [337, "    }\n"], [338, "\n"], [339, "    # HSTS (HTTP Strict Transport Security)\n"], [340, "    strict_transport_security {\n"], [341, "      access_control_max_age_sec = 63072000 # 2 years\n"], [342, "      include_subdomains         = true\n"], [343, "      preload                    = true\n"], [344, "      override                   = true\n"], [345, "    }\n"], [346, "  }\n"], [347, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [308, 347], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_cloudfront_response_headers_policy.security_headers", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudFrontResponseHeaderStrictTransportSecurity", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-cloudfront-response-header-policy-enforces-strict-transport-security", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_386", "bc_check_id": "BC_AWS_GENERAL_271", "check_name": "Reduce potential for WhoAMI cloud image name confusion attack", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[352, "data \"aws_ami\" \"amazon_linux_2\" {\n"], [353, "  most_recent = true\n"], [354, "  owners      = [\"amazon\"]\n"], [355, "\n"], [356, "  filter {\n"], [357, "    name   = \"name\"\n"], [358, "    values = [\"amzn2-ami-hvm-*-x86_64-gp2\"]\n"], [359, "  }\n"], [360, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [352, 360], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_ami.amazon_linux_2", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.WhoAMI", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-supply-chain-policies/bc-aws-386", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[2, "resource \"aws_iam_role\" \"ecs_task_execution_role\" {\n"], [3, "  name = \"${var.project}-${var.environment}-ecs-task-execution-role\"\n"], [4, "\n"], [5, "  assume_role_policy = jsonencode({\n"], [6, "    Version = \"2012-10-17\",\n"], [7, "    Statement = [\n"], [8, "      {\n"], [9, "        Action = \"sts:AssumeRole\",\n"], [10, "        Principal = {\n"], [11, "          Service = \"ecs-tasks.amazonaws.com\"\n"], [12, "        },\n"], [13, "        Effect = \"Allow\",\n"], [14, "        Sid    = \"\"\n"], [15, "      }\n"], [16, "    ]\n"], [17, "  })\n"], [18, "\n"], [19, "  tags = {\n"], [20, "    Name        = \"${var.project}-${var.environment}-ecs-task-execution-role\"\n"], [21, "    Environment = var.environment\n"], [22, "    Project     = var.project\n"], [23, "  }\n"], [24, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [2, 24], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role.ecs_task_execution_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-ecs-task-execution-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[2, "resource \"aws_iam_role\" \"ecs_task_execution_role\" {\n"], [3, "  name = \"${var.project}-${var.environment}-ecs-task-execution-role\"\n"], [4, "\n"], [5, "  assume_role_policy = jsonencode({\n"], [6, "    Version = \"2012-10-17\",\n"], [7, "    Statement = [\n"], [8, "      {\n"], [9, "        Action = \"sts:AssumeRole\",\n"], [10, "        Principal = {\n"], [11, "          Service = \"ecs-tasks.amazonaws.com\"\n"], [12, "        },\n"], [13, "        Effect = \"Allow\",\n"], [14, "        Sid    = \"\"\n"], [15, "      }\n"], [16, "    ]\n"], [17, "  })\n"], [18, "\n"], [19, "  tags = {\n"], [20, "    Name        = \"${var.project}-${var.environment}-ecs-task-execution-role\"\n"], [21, "    Environment = var.environment\n"], [22, "    Project     = var.project\n"], [23, "  }\n"], [24, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [2, 24], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role.ecs_task_execution_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-ecs-task-execution-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[2, "resource \"aws_iam_role\" \"ecs_task_execution_role\" {\n"], [3, "  name = \"${var.project}-${var.environment}-ecs-task-execution-role\"\n"], [4, "\n"], [5, "  assume_role_policy = jsonencode({\n"], [6, "    Version = \"2012-10-17\",\n"], [7, "    Statement = [\n"], [8, "      {\n"], [9, "        Action = \"sts:AssumeRole\",\n"], [10, "        Principal = {\n"], [11, "          Service = \"ecs-tasks.amazonaws.com\"\n"], [12, "        },\n"], [13, "        Effect = \"Allow\",\n"], [14, "        Sid    = \"\"\n"], [15, "      }\n"], [16, "    ]\n"], [17, "  })\n"], [18, "\n"], [19, "  tags = {\n"], [20, "    Name        = \"${var.project}-${var.environment}-ecs-task-execution-role\"\n"], [21, "    Environment = var.environment\n"], [22, "    Project     = var.project\n"], [23, "  }\n"], [24, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [2, 24], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role.ecs_task_execution_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-ecs-task-execution-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[26, "resource \"aws_iam_role_policy_attachment\" \"ecs_task_execution_role_policy\" {\n"], [27, "  role       = aws_iam_role.ecs_task_execution_role.name\n"], [28, "  policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy\"\n"], [29, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [26, 29], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role_policy_attachment.ecs_task_execution_role_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[32, "resource \"aws_iam_role\" \"ecs_task_role\" {\n"], [33, "  name = \"${var.project}-${var.environment}-ecs-task-role\"\n"], [34, "\n"], [35, "  assume_role_policy = jsonencode({\n"], [36, "    Version = \"2012-10-17\",\n"], [37, "    Statement = [\n"], [38, "      {\n"], [39, "        Action = \"sts:AssumeRole\",\n"], [40, "        Principal = {\n"], [41, "          Service = \"ecs-tasks.amazonaws.com\"\n"], [42, "        },\n"], [43, "        Effect = \"Allow\",\n"], [44, "        Sid    = \"\"\n"], [45, "      }\n"], [46, "    ]\n"], [47, "  })\n"], [48, "\n"], [49, "  tags = {\n"], [50, "    Name        = \"${var.project}-${var.environment}-ecs-task-role\"\n"], [51, "    Environment = var.environment\n"], [52, "    Project     = var.project\n"], [53, "  }\n"], [54, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [32, 54], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role.ecs_task_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-ecs-task-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[32, "resource \"aws_iam_role\" \"ecs_task_role\" {\n"], [33, "  name = \"${var.project}-${var.environment}-ecs-task-role\"\n"], [34, "\n"], [35, "  assume_role_policy = jsonencode({\n"], [36, "    Version = \"2012-10-17\",\n"], [37, "    Statement = [\n"], [38, "      {\n"], [39, "        Action = \"sts:AssumeRole\",\n"], [40, "        Principal = {\n"], [41, "          Service = \"ecs-tasks.amazonaws.com\"\n"], [42, "        },\n"], [43, "        Effect = \"Allow\",\n"], [44, "        Sid    = \"\"\n"], [45, "      }\n"], [46, "    ]\n"], [47, "  })\n"], [48, "\n"], [49, "  tags = {\n"], [50, "    Name        = \"${var.project}-${var.environment}-ecs-task-role\"\n"], [51, "    Environment = var.environment\n"], [52, "    Project     = var.project\n"], [53, "  }\n"], [54, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [32, 54], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role.ecs_task_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-ecs-task-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[32, "resource \"aws_iam_role\" \"ecs_task_role\" {\n"], [33, "  name = \"${var.project}-${var.environment}-ecs-task-role\"\n"], [34, "\n"], [35, "  assume_role_policy = jsonencode({\n"], [36, "    Version = \"2012-10-17\",\n"], [37, "    Statement = [\n"], [38, "      {\n"], [39, "        Action = \"sts:AssumeRole\",\n"], [40, "        Principal = {\n"], [41, "          Service = \"ecs-tasks.amazonaws.com\"\n"], [42, "        },\n"], [43, "        Effect = \"Allow\",\n"], [44, "        Sid    = \"\"\n"], [45, "      }\n"], [46, "    ]\n"], [47, "  })\n"], [48, "\n"], [49, "  tags = {\n"], [50, "    Name        = \"${var.project}-${var.environment}-ecs-task-role\"\n"], [51, "    Environment = var.environment\n"], [52, "    Project     = var.project\n"], [53, "  }\n"], [54, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [32, 54], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role.ecs_task_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-ecs-task-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[57, "resource \"aws_iam_role\" \"jenkins_role\" {\n"], [58, "  name = \"${var.project}-${var.environment}-jenkins-role\"\n"], [59, "\n"], [60, "  assume_role_policy = jsonencode({\n"], [61, "    Version = \"2012-10-17\",\n"], [62, "    Statement = [\n"], [63, "      {\n"], [64, "        Action = \"sts:AssumeRole\",\n"], [65, "        Principal = {\n"], [66, "          Service = \"ec2.amazonaws.com\"\n"], [67, "        },\n"], [68, "        Effect = \"Allow\",\n"], [69, "        Sid    = \"\"\n"], [70, "      }\n"], [71, "    ]\n"], [72, "  })\n"], [73, "\n"], [74, "  tags = {\n"], [75, "    Name        = \"${var.project}-${var.environment}-jenkins-role\"\n"], [76, "    Environment = var.environment\n"], [77, "    Project     = var.project\n"], [78, "  }\n"], [79, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [57, 79], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role.jenkins_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[57, "resource \"aws_iam_role\" \"jenkins_role\" {\n"], [58, "  name = \"${var.project}-${var.environment}-jenkins-role\"\n"], [59, "\n"], [60, "  assume_role_policy = jsonencode({\n"], [61, "    Version = \"2012-10-17\",\n"], [62, "    Statement = [\n"], [63, "      {\n"], [64, "        Action = \"sts:AssumeRole\",\n"], [65, "        Principal = {\n"], [66, "          Service = \"ec2.amazonaws.com\"\n"], [67, "        },\n"], [68, "        Effect = \"Allow\",\n"], [69, "        Sid    = \"\"\n"], [70, "      }\n"], [71, "    ]\n"], [72, "  })\n"], [73, "\n"], [74, "  tags = {\n"], [75, "    Name        = \"${var.project}-${var.environment}-jenkins-role\"\n"], [76, "    Environment = var.environment\n"], [77, "    Project     = var.project\n"], [78, "  }\n"], [79, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [57, 79], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role.jenkins_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[57, "resource \"aws_iam_role\" \"jenkins_role\" {\n"], [58, "  name = \"${var.project}-${var.environment}-jenkins-role\"\n"], [59, "\n"], [60, "  assume_role_policy = jsonencode({\n"], [61, "    Version = \"2012-10-17\",\n"], [62, "    Statement = [\n"], [63, "      {\n"], [64, "        Action = \"sts:AssumeRole\",\n"], [65, "        Principal = {\n"], [66, "          Service = \"ec2.amazonaws.com\"\n"], [67, "        },\n"], [68, "        Effect = \"Allow\",\n"], [69, "        Sid    = \"\"\n"], [70, "      }\n"], [71, "    ]\n"], [72, "  })\n"], [73, "\n"], [74, "  tags = {\n"], [75, "    Name        = \"${var.project}-${var.environment}-jenkins-role\"\n"], [76, "    Environment = var.environment\n"], [77, "    Project     = var.project\n"], [78, "  }\n"], [79, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [57, 79], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role.jenkins_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_62", "bc_check_id": "BC_AWS_IAM_47", "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[82, "resource \"aws_iam_policy\" \"jenkins_ecs_policy\" {\n"], [83, "  name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [84, "  description = \"Policy to allow Jenkins to deploy to ECS\"\n"], [85, "\n"], [86, "  policy = jsonencode({\n"], [87, "    Version = \"2012-10-17\",\n"], [88, "    Statement = [\n"], [89, "      {\n"], [90, "        Action = [\n"], [91, "          \"ecs:DescribeTaskDefinition\",\n"], [92, "          \"ecs:RegisterTaskDefinition\",\n"], [93, "          \"ecs:UpdateService\",\n"], [94, "          \"ecs:DescribeServices\",\n"], [95, "          \"ecr:GetAuthorizationToken\",\n"], [96, "          \"ecr:BatchCheckLayerAvailability\",\n"], [97, "          \"ecr:GetDownloadUrlForLayer\",\n"], [98, "          \"ecr:BatchGetImage\",\n"], [99, "          \"ecr:InitiateLayerUpload\",\n"], [100, "          \"ecr:UploadLayerPart\",\n"], [101, "          \"ecr:CompleteLayerUpload\",\n"], [102, "          \"ecr:PutImage\"\n"], [103, "        ],\n"], [104, "        Effect   = \"Allow\",\n"], [105, "        Resource = \"*\"\n"], [106, "      },\n"], [107, "      {\n"], [108, "        Action = [\n"], [109, "          \"iam:PassRole\"\n"], [110, "        ],\n"], [111, "        Effect   = \"Allow\",\n"], [112, "        Resource = \"*\"\n"], [113, "      }\n"], [114, "    ]\n"], [115, "  })\n"], [116, "\n"], [117, "  tags = {\n"], [118, "    Name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [119, "    Environment = var.environment\n"], [120, "    Project     = var.project\n"], [121, "  }\n"], [122, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [82, 122], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_policy.jenkins_ecs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMAdminPolicyDocument", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-ecs-policy", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_287", "bc_check_id": "BC_AWS_IAM_82", "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[82, "resource \"aws_iam_policy\" \"jenkins_ecs_policy\" {\n"], [83, "  name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [84, "  description = \"Policy to allow Jenkins to deploy to ECS\"\n"], [85, "\n"], [86, "  policy = jsonencode({\n"], [87, "    Version = \"2012-10-17\",\n"], [88, "    Statement = [\n"], [89, "      {\n"], [90, "        Action = [\n"], [91, "          \"ecs:DescribeTaskDefinition\",\n"], [92, "          \"ecs:RegisterTaskDefinition\",\n"], [93, "          \"ecs:UpdateService\",\n"], [94, "          \"ecs:DescribeServices\",\n"], [95, "          \"ecr:GetAuthorizationToken\",\n"], [96, "          \"ecr:BatchCheckLayerAvailability\",\n"], [97, "          \"ecr:GetDownloadUrlForLayer\",\n"], [98, "          \"ecr:BatchGetImage\",\n"], [99, "          \"ecr:InitiateLayerUpload\",\n"], [100, "          \"ecr:UploadLayerPart\",\n"], [101, "          \"ecr:CompleteLayerUpload\",\n"], [102, "          \"ecr:PutImage\"\n"], [103, "        ],\n"], [104, "        Effect   = \"Allow\",\n"], [105, "        Resource = \"*\"\n"], [106, "      },\n"], [107, "      {\n"], [108, "        Action = [\n"], [109, "          \"iam:PassRole\"\n"], [110, "        ],\n"], [111, "        Effect   = \"Allow\",\n"], [112, "        Resource = \"*\"\n"], [113, "      }\n"], [114, "    ]\n"], [115, "  })\n"], [116, "\n"], [117, "  tags = {\n"], [118, "    Name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [119, "    Environment = var.environment\n"], [120, "    Project     = var.project\n"], [121, "  }\n"], [122, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [82, 122], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_policy.jenkins_ecs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-ecs-policy", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-287", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_288", "bc_check_id": "BC_AWS_IAM_83", "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[82, "resource \"aws_iam_policy\" \"jenkins_ecs_policy\" {\n"], [83, "  name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [84, "  description = \"Policy to allow Jenkins to deploy to ECS\"\n"], [85, "\n"], [86, "  policy = jsonencode({\n"], [87, "    Version = \"2012-10-17\",\n"], [88, "    Statement = [\n"], [89, "      {\n"], [90, "        Action = [\n"], [91, "          \"ecs:DescribeTaskDefinition\",\n"], [92, "          \"ecs:RegisterTaskDefinition\",\n"], [93, "          \"ecs:UpdateService\",\n"], [94, "          \"ecs:DescribeServices\",\n"], [95, "          \"ecr:GetAuthorizationToken\",\n"], [96, "          \"ecr:BatchCheckLayerAvailability\",\n"], [97, "          \"ecr:GetDownloadUrlForLayer\",\n"], [98, "          \"ecr:BatchGetImage\",\n"], [99, "          \"ecr:InitiateLayerUpload\",\n"], [100, "          \"ecr:UploadLayerPart\",\n"], [101, "          \"ecr:CompleteLayerUpload\",\n"], [102, "          \"ecr:PutImage\"\n"], [103, "        ],\n"], [104, "        Effect   = \"Allow\",\n"], [105, "        Resource = \"*\"\n"], [106, "      },\n"], [107, "      {\n"], [108, "        Action = [\n"], [109, "          \"iam:PassRole\"\n"], [110, "        ],\n"], [111, "        Effect   = \"Allow\",\n"], [112, "        Resource = \"*\"\n"], [113, "      }\n"], [114, "    ]\n"], [115, "  })\n"], [116, "\n"], [117, "  tags = {\n"], [118, "    Name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [119, "    Environment = var.environment\n"], [120, "    Project     = var.project\n"], [121, "  }\n"], [122, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [82, 122], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_policy.jenkins_ecs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-ecs-policy", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-288", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_286", "bc_check_id": "BC_AWS_IAM_81", "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[82, "resource \"aws_iam_policy\" \"jenkins_ecs_policy\" {\n"], [83, "  name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [84, "  description = \"Policy to allow Jenkins to deploy to ECS\"\n"], [85, "\n"], [86, "  policy = jsonencode({\n"], [87, "    Version = \"2012-10-17\",\n"], [88, "    Statement = [\n"], [89, "      {\n"], [90, "        Action = [\n"], [91, "          \"ecs:DescribeTaskDefinition\",\n"], [92, "          \"ecs:RegisterTaskDefinition\",\n"], [93, "          \"ecs:UpdateService\",\n"], [94, "          \"ecs:DescribeServices\",\n"], [95, "          \"ecr:GetAuthorizationToken\",\n"], [96, "          \"ecr:BatchCheckLayerAvailability\",\n"], [97, "          \"ecr:GetDownloadUrlForLayer\",\n"], [98, "          \"ecr:BatchGetImage\",\n"], [99, "          \"ecr:InitiateLayerUpload\",\n"], [100, "          \"ecr:UploadLayerPart\",\n"], [101, "          \"ecr:CompleteLayerUpload\",\n"], [102, "          \"ecr:PutImage\"\n"], [103, "        ],\n"], [104, "        Effect   = \"Allow\",\n"], [105, "        Resource = \"*\"\n"], [106, "      },\n"], [107, "      {\n"], [108, "        Action = [\n"], [109, "          \"iam:PassRole\"\n"], [110, "        ],\n"], [111, "        Effect   = \"Allow\",\n"], [112, "        Resource = \"*\"\n"], [113, "      }\n"], [114, "    ]\n"], [115, "  })\n"], [116, "\n"], [117, "  tags = {\n"], [118, "    Name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [119, "    Environment = var.environment\n"], [120, "    Project     = var.project\n"], [121, "  }\n"], [122, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [82, 122], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_policy.jenkins_ecs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-ecs-policy", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-286", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_63", "bc_check_id": "BC_AWS_IAM_48", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[82, "resource \"aws_iam_policy\" \"jenkins_ecs_policy\" {\n"], [83, "  name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [84, "  description = \"Policy to allow Jenkins to deploy to ECS\"\n"], [85, "\n"], [86, "  policy = jsonencode({\n"], [87, "    Version = \"2012-10-17\",\n"], [88, "    Statement = [\n"], [89, "      {\n"], [90, "        Action = [\n"], [91, "          \"ecs:DescribeTaskDefinition\",\n"], [92, "          \"ecs:RegisterTaskDefinition\",\n"], [93, "          \"ecs:UpdateService\",\n"], [94, "          \"ecs:DescribeServices\",\n"], [95, "          \"ecr:GetAuthorizationToken\",\n"], [96, "          \"ecr:BatchCheckLayerAvailability\",\n"], [97, "          \"ecr:GetDownloadUrlForLayer\",\n"], [98, "          \"ecr:BatchGetImage\",\n"], [99, "          \"ecr:InitiateLayerUpload\",\n"], [100, "          \"ecr:UploadLayerPart\",\n"], [101, "          \"ecr:CompleteLayerUpload\",\n"], [102, "          \"ecr:PutImage\"\n"], [103, "        ],\n"], [104, "        Effect   = \"Allow\",\n"], [105, "        Resource = \"*\"\n"], [106, "      },\n"], [107, "      {\n"], [108, "        Action = [\n"], [109, "          \"iam:PassRole\"\n"], [110, "        ],\n"], [111, "        Effect   = \"Allow\",\n"], [112, "        Resource = \"*\"\n"], [113, "      }\n"], [114, "    ]\n"], [115, "  })\n"], [116, "\n"], [117, "  tags = {\n"], [118, "    Name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [119, "    Environment = var.environment\n"], [120, "    Project     = var.project\n"], [121, "  }\n"], [122, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [82, 122], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_policy.jenkins_ecs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarActionPolicyDocument", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-ecs-policy", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[124, "resource \"aws_iam_role_policy_attachment\" \"jenkins_ecs_policy_attachment\" {\n"], [125, "  role       = aws_iam_role.jenkins_role.name\n"], [126, "  policy_arn = aws_iam_policy.jenkins_ecs_policy.arn\n"], [127, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [124, 127], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role_policy_attachment.jenkins_ecs_policy_attachment", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_62", "bc_check_id": "BC_AWS_IAM_47", "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[128, "resource \"aws_iam_policy\" \"prometheus_discovery\" {\n"], [129, "  name        = \"prometheus-discovery\"\n"], [130, "  description = \"Allow Prometheus to discover EC2 and ECS targets\"\n"], [131, "\n"], [132, "  policy = jsonencode({\n"], [133, "    Version = \"2012-10-17\"\n"], [134, "    Statement = [\n"], [135, "      {\n"], [136, "        Action = [\n"], [137, "          \"ec2:DescribeInstances\",\n"], [138, "          \"ec2:DescribeTags\",\n"], [139, "          \"ecs:ListTasks\",\n"], [140, "          \"ecs:DescribeTasks\",\n"], [141, "          \"ecs:ListServices\",\n"], [142, "          \"ecs:DescribeServices\",\n"], [143, "          \"ecs:DescribeTaskDefinition\"\n"], [144, "        ]\n"], [145, "        Effect   = \"Allow\"\n"], [146, "        Resource = \"*\"\n"], [147, "      }\n"], [148, "    ]\n"], [149, "  })\n"], [150, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [128, 150], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_policy.prometheus_discovery", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMAdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_287", "bc_check_id": "BC_AWS_IAM_82", "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[128, "resource \"aws_iam_policy\" \"prometheus_discovery\" {\n"], [129, "  name        = \"prometheus-discovery\"\n"], [130, "  description = \"Allow Prometheus to discover EC2 and ECS targets\"\n"], [131, "\n"], [132, "  policy = jsonencode({\n"], [133, "    Version = \"2012-10-17\"\n"], [134, "    Statement = [\n"], [135, "      {\n"], [136, "        Action = [\n"], [137, "          \"ec2:DescribeInstances\",\n"], [138, "          \"ec2:DescribeTags\",\n"], [139, "          \"ecs:ListTasks\",\n"], [140, "          \"ecs:DescribeTasks\",\n"], [141, "          \"ecs:ListServices\",\n"], [142, "          \"ecs:DescribeServices\",\n"], [143, "          \"ecs:DescribeTaskDefinition\"\n"], [144, "        ]\n"], [145, "        Effect   = \"Allow\"\n"], [146, "        Resource = \"*\"\n"], [147, "      }\n"], [148, "    ]\n"], [149, "  })\n"], [150, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [128, 150], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_policy.prometheus_discovery", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-287", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_288", "bc_check_id": "BC_AWS_IAM_83", "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[128, "resource \"aws_iam_policy\" \"prometheus_discovery\" {\n"], [129, "  name        = \"prometheus-discovery\"\n"], [130, "  description = \"Allow Prometheus to discover EC2 and ECS targets\"\n"], [131, "\n"], [132, "  policy = jsonencode({\n"], [133, "    Version = \"2012-10-17\"\n"], [134, "    Statement = [\n"], [135, "      {\n"], [136, "        Action = [\n"], [137, "          \"ec2:DescribeInstances\",\n"], [138, "          \"ec2:DescribeTags\",\n"], [139, "          \"ecs:ListTasks\",\n"], [140, "          \"ecs:DescribeTasks\",\n"], [141, "          \"ecs:ListServices\",\n"], [142, "          \"ecs:DescribeServices\",\n"], [143, "          \"ecs:DescribeTaskDefinition\"\n"], [144, "        ]\n"], [145, "        Effect   = \"Allow\"\n"], [146, "        Resource = \"*\"\n"], [147, "      }\n"], [148, "    ]\n"], [149, "  })\n"], [150, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [128, 150], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_policy.prometheus_discovery", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-288", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_289", "bc_check_id": "BC_AWS_IAM_84", "check_name": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[128, "resource \"aws_iam_policy\" \"prometheus_discovery\" {\n"], [129, "  name        = \"prometheus-discovery\"\n"], [130, "  description = \"Allow Prometheus to discover EC2 and ECS targets\"\n"], [131, "\n"], [132, "  policy = jsonencode({\n"], [133, "    Version = \"2012-10-17\"\n"], [134, "    Statement = [\n"], [135, "      {\n"], [136, "        Action = [\n"], [137, "          \"ec2:DescribeInstances\",\n"], [138, "          \"ec2:DescribeTags\",\n"], [139, "          \"ecs:ListTasks\",\n"], [140, "          \"ecs:DescribeTasks\",\n"], [141, "          \"ecs:ListServices\",\n"], [142, "          \"ecs:DescribeServices\",\n"], [143, "          \"ecs:DescribeTaskDefinition\"\n"], [144, "        ]\n"], [145, "        Effect   = \"Allow\"\n"], [146, "        Resource = \"*\"\n"], [147, "      }\n"], [148, "    ]\n"], [149, "  })\n"], [150, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [128, 150], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_policy.prometheus_discovery", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-289", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_286", "bc_check_id": "BC_AWS_IAM_81", "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[128, "resource \"aws_iam_policy\" \"prometheus_discovery\" {\n"], [129, "  name        = \"prometheus-discovery\"\n"], [130, "  description = \"Allow Prometheus to discover EC2 and ECS targets\"\n"], [131, "\n"], [132, "  policy = jsonencode({\n"], [133, "    Version = \"2012-10-17\"\n"], [134, "    Statement = [\n"], [135, "      {\n"], [136, "        Action = [\n"], [137, "          \"ec2:DescribeInstances\",\n"], [138, "          \"ec2:DescribeTags\",\n"], [139, "          \"ecs:ListTasks\",\n"], [140, "          \"ecs:DescribeTasks\",\n"], [141, "          \"ecs:ListServices\",\n"], [142, "          \"ecs:DescribeServices\",\n"], [143, "          \"ecs:DescribeTaskDefinition\"\n"], [144, "        ]\n"], [145, "        Effect   = \"Allow\"\n"], [146, "        Resource = \"*\"\n"], [147, "      }\n"], [148, "    ]\n"], [149, "  })\n"], [150, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [128, 150], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_policy.prometheus_discovery", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-286", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_63", "bc_check_id": "BC_AWS_IAM_48", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[128, "resource \"aws_iam_policy\" \"prometheus_discovery\" {\n"], [129, "  name        = \"prometheus-discovery\"\n"], [130, "  description = \"Allow Prometheus to discover EC2 and ECS targets\"\n"], [131, "\n"], [132, "  policy = jsonencode({\n"], [133, "    Version = \"2012-10-17\"\n"], [134, "    Statement = [\n"], [135, "      {\n"], [136, "        Action = [\n"], [137, "          \"ec2:DescribeInstances\",\n"], [138, "          \"ec2:DescribeTags\",\n"], [139, "          \"ecs:ListTasks\",\n"], [140, "          \"ecs:DescribeTasks\",\n"], [141, "          \"ecs:ListServices\",\n"], [142, "          \"ecs:DescribeServices\",\n"], [143, "          \"ecs:DescribeTaskDefinition\"\n"], [144, "        ]\n"], [145, "        Effect   = \"Allow\"\n"], [146, "        Resource = \"*\"\n"], [147, "      }\n"], [148, "    ]\n"], [149, "  })\n"], [150, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [128, 150], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_policy.prometheus_discovery", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_290", "bc_check_id": "BC_AWS_IAM_85", "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[128, "resource \"aws_iam_policy\" \"prometheus_discovery\" {\n"], [129, "  name        = \"prometheus-discovery\"\n"], [130, "  description = \"Allow Prometheus to discover EC2 and ECS targets\"\n"], [131, "\n"], [132, "  policy = jsonencode({\n"], [133, "    Version = \"2012-10-17\"\n"], [134, "    Statement = [\n"], [135, "      {\n"], [136, "        Action = [\n"], [137, "          \"ec2:DescribeInstances\",\n"], [138, "          \"ec2:DescribeTags\",\n"], [139, "          \"ecs:ListTasks\",\n"], [140, "          \"ecs:DescribeTasks\",\n"], [141, "          \"ecs:ListServices\",\n"], [142, "          \"ecs:DescribeServices\",\n"], [143, "          \"ecs:DescribeTaskDefinition\"\n"], [144, "        ]\n"], [145, "        Effect   = \"Allow\"\n"], [146, "        Resource = \"*\"\n"], [147, "      }\n"], [148, "    ]\n"], [149, "  })\n"], [150, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [128, 150], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_policy.prometheus_discovery", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-290", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[152, "resource \"aws_iam_role_policy_attachment\" \"prometheus_discovery\" {\n"], [153, "  role       = aws_iam_role.ecs_task_role.name\n"], [154, "  policy_arn = aws_iam_policy.prometheus_discovery.arn\n"], [155, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [152, 155], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role_policy_attachment.prometheus_discovery", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[156, "resource \"aws_iam_role\" \"ecs_execution_role\" {\n"], [157, "  name = \"ecs-execution-role\"\n"], [158, "\n"], [159, "  assume_role_policy = jsonencode({\n"], [160, "    Version = \"2012-10-17\"\n"], [161, "    Statement = [\n"], [162, "      {\n"], [163, "        Action = \"sts:AssumeRole\"\n"], [164, "        Effect = \"Allow\"\n"], [165, "        Principal = {\n"], [166, "          Service = \"ecs-tasks.amazonaws.com\"\n"], [167, "        }\n"], [168, "      }\n"], [169, "    ]\n"], [170, "  })\n"], [171, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [156, 171], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role.ecs_execution_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[156, "resource \"aws_iam_role\" \"ecs_execution_role\" {\n"], [157, "  name = \"ecs-execution-role\"\n"], [158, "\n"], [159, "  assume_role_policy = jsonencode({\n"], [160, "    Version = \"2012-10-17\"\n"], [161, "    Statement = [\n"], [162, "      {\n"], [163, "        Action = \"sts:AssumeRole\"\n"], [164, "        Effect = \"Allow\"\n"], [165, "        Principal = {\n"], [166, "          Service = \"ecs-tasks.amazonaws.com\"\n"], [167, "        }\n"], [168, "      }\n"], [169, "    ]\n"], [170, "  })\n"], [171, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [156, 171], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role.ecs_execution_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[156, "resource \"aws_iam_role\" \"ecs_execution_role\" {\n"], [157, "  name = \"ecs-execution-role\"\n"], [158, "\n"], [159, "  assume_role_policy = jsonencode({\n"], [160, "    Version = \"2012-10-17\"\n"], [161, "    Statement = [\n"], [162, "      {\n"], [163, "        Action = \"sts:AssumeRole\"\n"], [164, "        Effect = \"Allow\"\n"], [165, "        Principal = {\n"], [166, "          Service = \"ecs-tasks.amazonaws.com\"\n"], [167, "        }\n"], [168, "      }\n"], [169, "    ]\n"], [170, "  })\n"], [171, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [156, 171], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role.ecs_execution_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[173, "resource \"aws_iam_role_policy_attachment\" \"ecs_execution_role_policy\" {\n"], [174, "  role       = aws_iam_role.ecs_execution_role.name\n"], [175, "  policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy\"\n"], [176, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [173, 176], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role_policy_attachment.ecs_execution_role_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[179, "resource \"aws_iam_role\" \"ssm_service_role\" {\n"], [180, "  name = \"${var.project}-${var.environment}-ssm-service-role\"\n"], [181, "\n"], [182, "  assume_role_policy = jsonencode({\n"], [183, "    Version = \"2012-10-17\"\n"], [184, "    Statement = [\n"], [185, "      {\n"], [186, "        Action = \"sts:AssumeRole\"\n"], [187, "        Effect = \"Allow\"\n"], [188, "        Principal = {\n"], [189, "          Service = \"ssm.amazonaws.com\"\n"], [190, "        }\n"], [191, "      }\n"], [192, "    ]\n"], [193, "  })\n"], [194, "\n"], [195, "  tags = {\n"], [196, "    Name        = \"${var.project}-${var.environment}-ssm-service-role\"\n"], [197, "    Environment = var.environment\n"], [198, "    Project     = var.project\n"], [199, "  }\n"], [200, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [179, 200], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role.ssm_service_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-ssm-service-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[179, "resource \"aws_iam_role\" \"ssm_service_role\" {\n"], [180, "  name = \"${var.project}-${var.environment}-ssm-service-role\"\n"], [181, "\n"], [182, "  assume_role_policy = jsonencode({\n"], [183, "    Version = \"2012-10-17\"\n"], [184, "    Statement = [\n"], [185, "      {\n"], [186, "        Action = \"sts:AssumeRole\"\n"], [187, "        Effect = \"Allow\"\n"], [188, "        Principal = {\n"], [189, "          Service = \"ssm.amazonaws.com\"\n"], [190, "        }\n"], [191, "      }\n"], [192, "    ]\n"], [193, "  })\n"], [194, "\n"], [195, "  tags = {\n"], [196, "    Name        = \"${var.project}-${var.environment}-ssm-service-role\"\n"], [197, "    Environment = var.environment\n"], [198, "    Project     = var.project\n"], [199, "  }\n"], [200, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [179, 200], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role.ssm_service_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-ssm-service-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[179, "resource \"aws_iam_role\" \"ssm_service_role\" {\n"], [180, "  name = \"${var.project}-${var.environment}-ssm-service-role\"\n"], [181, "\n"], [182, "  assume_role_policy = jsonencode({\n"], [183, "    Version = \"2012-10-17\"\n"], [184, "    Statement = [\n"], [185, "      {\n"], [186, "        Action = \"sts:AssumeRole\"\n"], [187, "        Effect = \"Allow\"\n"], [188, "        Principal = {\n"], [189, "          Service = \"ssm.amazonaws.com\"\n"], [190, "        }\n"], [191, "      }\n"], [192, "    ]\n"], [193, "  })\n"], [194, "\n"], [195, "  tags = {\n"], [196, "    Name        = \"${var.project}-${var.environment}-ssm-service-role\"\n"], [197, "    Environment = var.environment\n"], [198, "    Project     = var.project\n"], [199, "  }\n"], [200, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [179, 200], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role.ssm_service_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-ssm-service-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[202, "resource \"aws_iam_role_policy_attachment\" \"ssm_service_role_policy\" {\n"], [203, "  role       = aws_iam_role.ssm_service_role.name\n"], [204, "  policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonSSMMaintenanceWindowRole\"\n"], [205, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [202, 205], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role_policy_attachment.ssm_service_role_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[208, "resource \"aws_iam_role\" \"ec2_instance_role\" {\n"], [209, "  name = \"${var.project}-${var.environment}-ec2-instance-role\"\n"], [210, "\n"], [211, "  assume_role_policy = jsonencode({\n"], [212, "    Version = \"2012-10-17\"\n"], [213, "    Statement = [\n"], [214, "      {\n"], [215, "        Action = \"sts:AssumeRole\"\n"], [216, "        Effect = \"Allow\"\n"], [217, "        Principal = {\n"], [218, "          Service = \"ec2.amazonaws.com\"\n"], [219, "        }\n"], [220, "      }\n"], [221, "    ]\n"], [222, "  })\n"], [223, "\n"], [224, "  tags = {\n"], [225, "    Name        = \"${var.project}-${var.environment}-ec2-instance-role\"\n"], [226, "    Environment = var.environment\n"], [227, "    Project     = var.project\n"], [228, "  }\n"], [229, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [208, 229], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role.ec2_instance_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-ec2-instance-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[208, "resource \"aws_iam_role\" \"ec2_instance_role\" {\n"], [209, "  name = \"${var.project}-${var.environment}-ec2-instance-role\"\n"], [210, "\n"], [211, "  assume_role_policy = jsonencode({\n"], [212, "    Version = \"2012-10-17\"\n"], [213, "    Statement = [\n"], [214, "      {\n"], [215, "        Action = \"sts:AssumeRole\"\n"], [216, "        Effect = \"Allow\"\n"], [217, "        Principal = {\n"], [218, "          Service = \"ec2.amazonaws.com\"\n"], [219, "        }\n"], [220, "      }\n"], [221, "    ]\n"], [222, "  })\n"], [223, "\n"], [224, "  tags = {\n"], [225, "    Name        = \"${var.project}-${var.environment}-ec2-instance-role\"\n"], [226, "    Environment = var.environment\n"], [227, "    Project     = var.project\n"], [228, "  }\n"], [229, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [208, 229], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role.ec2_instance_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-ec2-instance-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[208, "resource \"aws_iam_role\" \"ec2_instance_role\" {\n"], [209, "  name = \"${var.project}-${var.environment}-ec2-instance-role\"\n"], [210, "\n"], [211, "  assume_role_policy = jsonencode({\n"], [212, "    Version = \"2012-10-17\"\n"], [213, "    Statement = [\n"], [214, "      {\n"], [215, "        Action = \"sts:AssumeRole\"\n"], [216, "        Effect = \"Allow\"\n"], [217, "        Principal = {\n"], [218, "          Service = \"ec2.amazonaws.com\"\n"], [219, "        }\n"], [220, "      }\n"], [221, "    ]\n"], [222, "  })\n"], [223, "\n"], [224, "  tags = {\n"], [225, "    Name        = \"${var.project}-${var.environment}-ec2-instance-role\"\n"], [226, "    Environment = var.environment\n"], [227, "    Project     = var.project\n"], [228, "  }\n"], [229, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [208, 229], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role.ec2_instance_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-ec2-instance-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[232, "resource \"aws_iam_role_policy_attachment\" \"ec2_ssm_policy\" {\n"], [233, "  role       = aws_iam_role.ec2_instance_role.name\n"], [234, "  policy_arn = \"arn:aws:iam::aws:policy/AmazonSSMManagedInstanceCore\"\n"], [235, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [232, 235], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role_policy_attachment.ec2_ssm_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[237, "resource \"aws_iam_role_policy_attachment\" \"ec2_ecs_policy\" {\n"], [238, "  role       = aws_iam_role.ec2_instance_role.name\n"], [239, "  policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonEC2ContainerServiceforEC2Role\"\n"], [240, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [237, 240], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role_policy_attachment.ec2_ecs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[248, "resource \"aws_iam_role\" \"codedeploy_role\" {\n"], [249, "  name = \"${var.project}-${var.environment}-codedeploy-role\"\n"], [250, "\n"], [251, "  assume_role_policy = jsonencode({\n"], [252, "    Version = \"2012-10-17\"\n"], [253, "    Statement = [\n"], [254, "      {\n"], [255, "        Action = \"sts:AssumeRole\"\n"], [256, "        Effect = \"Allow\"\n"], [257, "        Principal = {\n"], [258, "          Service = \"codedeploy.amazonaws.com\"\n"], [259, "        }\n"], [260, "      }\n"], [261, "    ]\n"], [262, "  })\n"], [263, "\n"], [264, "  tags = {\n"], [265, "    Name        = \"${var.project}-${var.environment}-codedeploy-role\"\n"], [266, "    Environment = var.environment\n"], [267, "    Project     = var.project\n"], [268, "  }\n"], [269, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [248, 269], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role.codedeploy_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-codedeploy-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[248, "resource \"aws_iam_role\" \"codedeploy_role\" {\n"], [249, "  name = \"${var.project}-${var.environment}-codedeploy-role\"\n"], [250, "\n"], [251, "  assume_role_policy = jsonencode({\n"], [252, "    Version = \"2012-10-17\"\n"], [253, "    Statement = [\n"], [254, "      {\n"], [255, "        Action = \"sts:AssumeRole\"\n"], [256, "        Effect = \"Allow\"\n"], [257, "        Principal = {\n"], [258, "          Service = \"codedeploy.amazonaws.com\"\n"], [259, "        }\n"], [260, "      }\n"], [261, "    ]\n"], [262, "  })\n"], [263, "\n"], [264, "  tags = {\n"], [265, "    Name        = \"${var.project}-${var.environment}-codedeploy-role\"\n"], [266, "    Environment = var.environment\n"], [267, "    Project     = var.project\n"], [268, "  }\n"], [269, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [248, 269], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role.codedeploy_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-codedeploy-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[248, "resource \"aws_iam_role\" \"codedeploy_role\" {\n"], [249, "  name = \"${var.project}-${var.environment}-codedeploy-role\"\n"], [250, "\n"], [251, "  assume_role_policy = jsonencode({\n"], [252, "    Version = \"2012-10-17\"\n"], [253, "    Statement = [\n"], [254, "      {\n"], [255, "        Action = \"sts:AssumeRole\"\n"], [256, "        Effect = \"Allow\"\n"], [257, "        Principal = {\n"], [258, "          Service = \"codedeploy.amazonaws.com\"\n"], [259, "        }\n"], [260, "      }\n"], [261, "    ]\n"], [262, "  })\n"], [263, "\n"], [264, "  tags = {\n"], [265, "    Name        = \"${var.project}-${var.environment}-codedeploy-role\"\n"], [266, "    Environment = var.environment\n"], [267, "    Project     = var.project\n"], [268, "  }\n"], [269, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [248, 269], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role.codedeploy_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-codedeploy-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[271, "resource \"aws_iam_role_policy_attachment\" \"codedeploy_policy\" {\n"], [272, "  role       = aws_iam_role.codedeploy_role.name\n"], [273, "  policy_arn = \"arn:aws:iam::aws:policy/AWSCodeDeployRoleForECS\"\n"], [274, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [271, 274], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role_policy_attachment.codedeploy_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[2, "resource \"aws_iam_role\" \"ecs_task_execution_role\" {\n"], [3, "  name = \"${var.project}-${var.environment}-ecs-task-execution-role\"\n"], [4, "\n"], [5, "  assume_role_policy = jsonencode({\n"], [6, "    Version = \"2012-10-17\",\n"], [7, "    Statement = [\n"], [8, "      {\n"], [9, "        Action = \"sts:AssumeRole\",\n"], [10, "        Principal = {\n"], [11, "          Service = \"ecs-tasks.amazonaws.com\"\n"], [12, "        },\n"], [13, "        Effect = \"Allow\",\n"], [14, "        Sid    = \"\"\n"], [15, "      }\n"], [16, "    ]\n"], [17, "  })\n"], [18, "\n"], [19, "  tags = {\n"], [20, "    Name        = \"${var.project}-${var.environment}-ecs-task-execution-role\"\n"], [21, "    Environment = var.environment\n"], [22, "    Project     = var.project\n"], [23, "  }\n"], [24, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [2, 24], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.ecs_task_execution_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-ecs-task-execution-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[2, "resource \"aws_iam_role\" \"ecs_task_execution_role\" {\n"], [3, "  name = \"${var.project}-${var.environment}-ecs-task-execution-role\"\n"], [4, "\n"], [5, "  assume_role_policy = jsonencode({\n"], [6, "    Version = \"2012-10-17\",\n"], [7, "    Statement = [\n"], [8, "      {\n"], [9, "        Action = \"sts:AssumeRole\",\n"], [10, "        Principal = {\n"], [11, "          Service = \"ecs-tasks.amazonaws.com\"\n"], [12, "        },\n"], [13, "        Effect = \"Allow\",\n"], [14, "        Sid    = \"\"\n"], [15, "      }\n"], [16, "    ]\n"], [17, "  })\n"], [18, "\n"], [19, "  tags = {\n"], [20, "    Name        = \"${var.project}-${var.environment}-ecs-task-execution-role\"\n"], [21, "    Environment = var.environment\n"], [22, "    Project     = var.project\n"], [23, "  }\n"], [24, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [2, 24], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.ecs_task_execution_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-ecs-task-execution-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[2, "resource \"aws_iam_role\" \"ecs_task_execution_role\" {\n"], [3, "  name = \"${var.project}-${var.environment}-ecs-task-execution-role\"\n"], [4, "\n"], [5, "  assume_role_policy = jsonencode({\n"], [6, "    Version = \"2012-10-17\",\n"], [7, "    Statement = [\n"], [8, "      {\n"], [9, "        Action = \"sts:AssumeRole\",\n"], [10, "        Principal = {\n"], [11, "          Service = \"ecs-tasks.amazonaws.com\"\n"], [12, "        },\n"], [13, "        Effect = \"Allow\",\n"], [14, "        Sid    = \"\"\n"], [15, "      }\n"], [16, "    ]\n"], [17, "  })\n"], [18, "\n"], [19, "  tags = {\n"], [20, "    Name        = \"${var.project}-${var.environment}-ecs-task-execution-role\"\n"], [21, "    Environment = var.environment\n"], [22, "    Project     = var.project\n"], [23, "  }\n"], [24, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [2, 24], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.ecs_task_execution_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-ecs-task-execution-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[26, "resource \"aws_iam_role_policy_attachment\" \"ecs_task_execution_role_policy\" {\n"], [27, "  role       = aws_iam_role.ecs_task_execution_role.name\n"], [28, "  policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy\"\n"], [29, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [26, 29], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role_policy_attachment.ecs_task_execution_role_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[32, "resource \"aws_iam_role\" \"ecs_task_role\" {\n"], [33, "  name = \"${var.project}-${var.environment}-ecs-task-role\"\n"], [34, "\n"], [35, "  assume_role_policy = jsonencode({\n"], [36, "    Version = \"2012-10-17\",\n"], [37, "    Statement = [\n"], [38, "      {\n"], [39, "        Action = \"sts:AssumeRole\",\n"], [40, "        Principal = {\n"], [41, "          Service = \"ecs-tasks.amazonaws.com\"\n"], [42, "        },\n"], [43, "        Effect = \"Allow\",\n"], [44, "        Sid    = \"\"\n"], [45, "      }\n"], [46, "    ]\n"], [47, "  })\n"], [48, "\n"], [49, "  tags = {\n"], [50, "    Name        = \"${var.project}-${var.environment}-ecs-task-role\"\n"], [51, "    Environment = var.environment\n"], [52, "    Project     = var.project\n"], [53, "  }\n"], [54, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [32, 54], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.ecs_task_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-ecs-task-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[32, "resource \"aws_iam_role\" \"ecs_task_role\" {\n"], [33, "  name = \"${var.project}-${var.environment}-ecs-task-role\"\n"], [34, "\n"], [35, "  assume_role_policy = jsonencode({\n"], [36, "    Version = \"2012-10-17\",\n"], [37, "    Statement = [\n"], [38, "      {\n"], [39, "        Action = \"sts:AssumeRole\",\n"], [40, "        Principal = {\n"], [41, "          Service = \"ecs-tasks.amazonaws.com\"\n"], [42, "        },\n"], [43, "        Effect = \"Allow\",\n"], [44, "        Sid    = \"\"\n"], [45, "      }\n"], [46, "    ]\n"], [47, "  })\n"], [48, "\n"], [49, "  tags = {\n"], [50, "    Name        = \"${var.project}-${var.environment}-ecs-task-role\"\n"], [51, "    Environment = var.environment\n"], [52, "    Project     = var.project\n"], [53, "  }\n"], [54, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [32, 54], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.ecs_task_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-ecs-task-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[32, "resource \"aws_iam_role\" \"ecs_task_role\" {\n"], [33, "  name = \"${var.project}-${var.environment}-ecs-task-role\"\n"], [34, "\n"], [35, "  assume_role_policy = jsonencode({\n"], [36, "    Version = \"2012-10-17\",\n"], [37, "    Statement = [\n"], [38, "      {\n"], [39, "        Action = \"sts:AssumeRole\",\n"], [40, "        Principal = {\n"], [41, "          Service = \"ecs-tasks.amazonaws.com\"\n"], [42, "        },\n"], [43, "        Effect = \"Allow\",\n"], [44, "        Sid    = \"\"\n"], [45, "      }\n"], [46, "    ]\n"], [47, "  })\n"], [48, "\n"], [49, "  tags = {\n"], [50, "    Name        = \"${var.project}-${var.environment}-ecs-task-role\"\n"], [51, "    Environment = var.environment\n"], [52, "    Project     = var.project\n"], [53, "  }\n"], [54, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [32, 54], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.ecs_task_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-ecs-task-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[57, "resource \"aws_iam_role\" \"jenkins_role\" {\n"], [58, "  name = \"${var.project}-${var.environment}-jenkins-role\"\n"], [59, "\n"], [60, "  assume_role_policy = jsonencode({\n"], [61, "    Version = \"2012-10-17\",\n"], [62, "    Statement = [\n"], [63, "      {\n"], [64, "        Action = \"sts:AssumeRole\",\n"], [65, "        Principal = {\n"], [66, "          Service = \"ec2.amazonaws.com\"\n"], [67, "        },\n"], [68, "        Effect = \"Allow\",\n"], [69, "        Sid    = \"\"\n"], [70, "      }\n"], [71, "    ]\n"], [72, "  })\n"], [73, "\n"], [74, "  tags = {\n"], [75, "    Name        = \"${var.project}-${var.environment}-jenkins-role\"\n"], [76, "    Environment = var.environment\n"], [77, "    Project     = var.project\n"], [78, "  }\n"], [79, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [57, 79], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.jenkins_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[57, "resource \"aws_iam_role\" \"jenkins_role\" {\n"], [58, "  name = \"${var.project}-${var.environment}-jenkins-role\"\n"], [59, "\n"], [60, "  assume_role_policy = jsonencode({\n"], [61, "    Version = \"2012-10-17\",\n"], [62, "    Statement = [\n"], [63, "      {\n"], [64, "        Action = \"sts:AssumeRole\",\n"], [65, "        Principal = {\n"], [66, "          Service = \"ec2.amazonaws.com\"\n"], [67, "        },\n"], [68, "        Effect = \"Allow\",\n"], [69, "        Sid    = \"\"\n"], [70, "      }\n"], [71, "    ]\n"], [72, "  })\n"], [73, "\n"], [74, "  tags = {\n"], [75, "    Name        = \"${var.project}-${var.environment}-jenkins-role\"\n"], [76, "    Environment = var.environment\n"], [77, "    Project     = var.project\n"], [78, "  }\n"], [79, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [57, 79], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.jenkins_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[57, "resource \"aws_iam_role\" \"jenkins_role\" {\n"], [58, "  name = \"${var.project}-${var.environment}-jenkins-role\"\n"], [59, "\n"], [60, "  assume_role_policy = jsonencode({\n"], [61, "    Version = \"2012-10-17\",\n"], [62, "    Statement = [\n"], [63, "      {\n"], [64, "        Action = \"sts:AssumeRole\",\n"], [65, "        Principal = {\n"], [66, "          Service = \"ec2.amazonaws.com\"\n"], [67, "        },\n"], [68, "        Effect = \"Allow\",\n"], [69, "        Sid    = \"\"\n"], [70, "      }\n"], [71, "    ]\n"], [72, "  })\n"], [73, "\n"], [74, "  tags = {\n"], [75, "    Name        = \"${var.project}-${var.environment}-jenkins-role\"\n"], [76, "    Environment = var.environment\n"], [77, "    Project     = var.project\n"], [78, "  }\n"], [79, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [57, 79], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.jenkins_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_62", "bc_check_id": "BC_AWS_IAM_47", "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[82, "resource \"aws_iam_policy\" \"jenkins_ecs_policy\" {\n"], [83, "  name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [84, "  description = \"Policy to allow Jenkins to deploy to ECS\"\n"], [85, "\n"], [86, "  policy = jsonencode({\n"], [87, "    Version = \"2012-10-17\",\n"], [88, "    Statement = [\n"], [89, "      {\n"], [90, "        Action = [\n"], [91, "          \"ecs:DescribeTaskDefinition\",\n"], [92, "          \"ecs:RegisterTaskDefinition\",\n"], [93, "          \"ecs:UpdateService\",\n"], [94, "          \"ecs:DescribeServices\",\n"], [95, "          \"ecr:GetAuthorizationToken\",\n"], [96, "          \"ecr:BatchCheckLayerAvailability\",\n"], [97, "          \"ecr:GetDownloadUrlForLayer\",\n"], [98, "          \"ecr:BatchGetImage\",\n"], [99, "          \"ecr:InitiateLayerUpload\",\n"], [100, "          \"ecr:UploadLayerPart\",\n"], [101, "          \"ecr:CompleteLayerUpload\",\n"], [102, "          \"ecr:PutImage\"\n"], [103, "        ],\n"], [104, "        Effect   = \"Allow\",\n"], [105, "        Resource = \"*\"\n"], [106, "      },\n"], [107, "      {\n"], [108, "        Action = [\n"], [109, "          \"iam:PassRole\"\n"], [110, "        ],\n"], [111, "        Effect   = \"Allow\",\n"], [112, "        Resource = \"*\"\n"], [113, "      }\n"], [114, "    ]\n"], [115, "  })\n"], [116, "\n"], [117, "  tags = {\n"], [118, "    Name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [119, "    Environment = var.environment\n"], [120, "    Project     = var.project\n"], [121, "  }\n"], [122, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [82, 122], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_policy.jenkins_ecs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMAdminPolicyDocument", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-ecs-policy", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_287", "bc_check_id": "BC_AWS_IAM_82", "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[82, "resource \"aws_iam_policy\" \"jenkins_ecs_policy\" {\n"], [83, "  name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [84, "  description = \"Policy to allow Jenkins to deploy to ECS\"\n"], [85, "\n"], [86, "  policy = jsonencode({\n"], [87, "    Version = \"2012-10-17\",\n"], [88, "    Statement = [\n"], [89, "      {\n"], [90, "        Action = [\n"], [91, "          \"ecs:DescribeTaskDefinition\",\n"], [92, "          \"ecs:RegisterTaskDefinition\",\n"], [93, "          \"ecs:UpdateService\",\n"], [94, "          \"ecs:DescribeServices\",\n"], [95, "          \"ecr:GetAuthorizationToken\",\n"], [96, "          \"ecr:BatchCheckLayerAvailability\",\n"], [97, "          \"ecr:GetDownloadUrlForLayer\",\n"], [98, "          \"ecr:BatchGetImage\",\n"], [99, "          \"ecr:InitiateLayerUpload\",\n"], [100, "          \"ecr:UploadLayerPart\",\n"], [101, "          \"ecr:CompleteLayerUpload\",\n"], [102, "          \"ecr:PutImage\"\n"], [103, "        ],\n"], [104, "        Effect   = \"Allow\",\n"], [105, "        Resource = \"*\"\n"], [106, "      },\n"], [107, "      {\n"], [108, "        Action = [\n"], [109, "          \"iam:PassRole\"\n"], [110, "        ],\n"], [111, "        Effect   = \"Allow\",\n"], [112, "        Resource = \"*\"\n"], [113, "      }\n"], [114, "    ]\n"], [115, "  })\n"], [116, "\n"], [117, "  tags = {\n"], [118, "    Name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [119, "    Environment = var.environment\n"], [120, "    Project     = var.project\n"], [121, "  }\n"], [122, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [82, 122], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_policy.jenkins_ecs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-ecs-policy", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-287", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_288", "bc_check_id": "BC_AWS_IAM_83", "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[82, "resource \"aws_iam_policy\" \"jenkins_ecs_policy\" {\n"], [83, "  name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [84, "  description = \"Policy to allow Jenkins to deploy to ECS\"\n"], [85, "\n"], [86, "  policy = jsonencode({\n"], [87, "    Version = \"2012-10-17\",\n"], [88, "    Statement = [\n"], [89, "      {\n"], [90, "        Action = [\n"], [91, "          \"ecs:DescribeTaskDefinition\",\n"], [92, "          \"ecs:RegisterTaskDefinition\",\n"], [93, "          \"ecs:UpdateService\",\n"], [94, "          \"ecs:DescribeServices\",\n"], [95, "          \"ecr:GetAuthorizationToken\",\n"], [96, "          \"ecr:BatchCheckLayerAvailability\",\n"], [97, "          \"ecr:GetDownloadUrlForLayer\",\n"], [98, "          \"ecr:BatchGetImage\",\n"], [99, "          \"ecr:InitiateLayerUpload\",\n"], [100, "          \"ecr:UploadLayerPart\",\n"], [101, "          \"ecr:CompleteLayerUpload\",\n"], [102, "          \"ecr:PutImage\"\n"], [103, "        ],\n"], [104, "        Effect   = \"Allow\",\n"], [105, "        Resource = \"*\"\n"], [106, "      },\n"], [107, "      {\n"], [108, "        Action = [\n"], [109, "          \"iam:PassRole\"\n"], [110, "        ],\n"], [111, "        Effect   = \"Allow\",\n"], [112, "        Resource = \"*\"\n"], [113, "      }\n"], [114, "    ]\n"], [115, "  })\n"], [116, "\n"], [117, "  tags = {\n"], [118, "    Name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [119, "    Environment = var.environment\n"], [120, "    Project     = var.project\n"], [121, "  }\n"], [122, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [82, 122], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_policy.jenkins_ecs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-ecs-policy", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-288", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_286", "bc_check_id": "BC_AWS_IAM_81", "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[82, "resource \"aws_iam_policy\" \"jenkins_ecs_policy\" {\n"], [83, "  name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [84, "  description = \"Policy to allow Jenkins to deploy to ECS\"\n"], [85, "\n"], [86, "  policy = jsonencode({\n"], [87, "    Version = \"2012-10-17\",\n"], [88, "    Statement = [\n"], [89, "      {\n"], [90, "        Action = [\n"], [91, "          \"ecs:DescribeTaskDefinition\",\n"], [92, "          \"ecs:RegisterTaskDefinition\",\n"], [93, "          \"ecs:UpdateService\",\n"], [94, "          \"ecs:DescribeServices\",\n"], [95, "          \"ecr:GetAuthorizationToken\",\n"], [96, "          \"ecr:BatchCheckLayerAvailability\",\n"], [97, "          \"ecr:GetDownloadUrlForLayer\",\n"], [98, "          \"ecr:BatchGetImage\",\n"], [99, "          \"ecr:InitiateLayerUpload\",\n"], [100, "          \"ecr:UploadLayerPart\",\n"], [101, "          \"ecr:CompleteLayerUpload\",\n"], [102, "          \"ecr:PutImage\"\n"], [103, "        ],\n"], [104, "        Effect   = \"Allow\",\n"], [105, "        Resource = \"*\"\n"], [106, "      },\n"], [107, "      {\n"], [108, "        Action = [\n"], [109, "          \"iam:PassRole\"\n"], [110, "        ],\n"], [111, "        Effect   = \"Allow\",\n"], [112, "        Resource = \"*\"\n"], [113, "      }\n"], [114, "    ]\n"], [115, "  })\n"], [116, "\n"], [117, "  tags = {\n"], [118, "    Name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [119, "    Environment = var.environment\n"], [120, "    Project     = var.project\n"], [121, "  }\n"], [122, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [82, 122], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_policy.jenkins_ecs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-ecs-policy", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-286", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_63", "bc_check_id": "BC_AWS_IAM_48", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[82, "resource \"aws_iam_policy\" \"jenkins_ecs_policy\" {\n"], [83, "  name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [84, "  description = \"Policy to allow Jenkins to deploy to ECS\"\n"], [85, "\n"], [86, "  policy = jsonencode({\n"], [87, "    Version = \"2012-10-17\",\n"], [88, "    Statement = [\n"], [89, "      {\n"], [90, "        Action = [\n"], [91, "          \"ecs:DescribeTaskDefinition\",\n"], [92, "          \"ecs:RegisterTaskDefinition\",\n"], [93, "          \"ecs:UpdateService\",\n"], [94, "          \"ecs:DescribeServices\",\n"], [95, "          \"ecr:GetAuthorizationToken\",\n"], [96, "          \"ecr:BatchCheckLayerAvailability\",\n"], [97, "          \"ecr:GetDownloadUrlForLayer\",\n"], [98, "          \"ecr:BatchGetImage\",\n"], [99, "          \"ecr:InitiateLayerUpload\",\n"], [100, "          \"ecr:UploadLayerPart\",\n"], [101, "          \"ecr:CompleteLayerUpload\",\n"], [102, "          \"ecr:PutImage\"\n"], [103, "        ],\n"], [104, "        Effect   = \"Allow\",\n"], [105, "        Resource = \"*\"\n"], [106, "      },\n"], [107, "      {\n"], [108, "        Action = [\n"], [109, "          \"iam:PassRole\"\n"], [110, "        ],\n"], [111, "        Effect   = \"Allow\",\n"], [112, "        Resource = \"*\"\n"], [113, "      }\n"], [114, "    ]\n"], [115, "  })\n"], [116, "\n"], [117, "  tags = {\n"], [118, "    Name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [119, "    Environment = var.environment\n"], [120, "    Project     = var.project\n"], [121, "  }\n"], [122, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [82, 122], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_policy.jenkins_ecs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarActionPolicyDocument", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-ecs-policy", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[124, "resource \"aws_iam_role_policy_attachment\" \"jenkins_ecs_policy_attachment\" {\n"], [125, "  role       = aws_iam_role.jenkins_role.name\n"], [126, "  policy_arn = aws_iam_policy.jenkins_ecs_policy.arn\n"], [127, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [124, 127], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role_policy_attachment.jenkins_ecs_policy_attachment", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_62", "bc_check_id": "BC_AWS_IAM_47", "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[128, "resource \"aws_iam_policy\" \"prometheus_discovery\" {\n"], [129, "  name        = \"prometheus-discovery\"\n"], [130, "  description = \"Allow Prometheus to discover EC2 and ECS targets\"\n"], [131, "\n"], [132, "  policy = jsonencode({\n"], [133, "    Version = \"2012-10-17\"\n"], [134, "    Statement = [\n"], [135, "      {\n"], [136, "        Action = [\n"], [137, "          \"ec2:DescribeInstances\",\n"], [138, "          \"ec2:DescribeTags\",\n"], [139, "          \"ecs:ListTasks\",\n"], [140, "          \"ecs:DescribeTasks\",\n"], [141, "          \"ecs:ListServices\",\n"], [142, "          \"ecs:DescribeServices\",\n"], [143, "          \"ecs:DescribeTaskDefinition\"\n"], [144, "        ]\n"], [145, "        Effect   = \"Allow\"\n"], [146, "        Resource = \"*\"\n"], [147, "      }\n"], [148, "    ]\n"], [149, "  })\n"], [150, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [128, 150], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_policy.prometheus_discovery", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMAdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_287", "bc_check_id": "BC_AWS_IAM_82", "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[128, "resource \"aws_iam_policy\" \"prometheus_discovery\" {\n"], [129, "  name        = \"prometheus-discovery\"\n"], [130, "  description = \"Allow Prometheus to discover EC2 and ECS targets\"\n"], [131, "\n"], [132, "  policy = jsonencode({\n"], [133, "    Version = \"2012-10-17\"\n"], [134, "    Statement = [\n"], [135, "      {\n"], [136, "        Action = [\n"], [137, "          \"ec2:DescribeInstances\",\n"], [138, "          \"ec2:DescribeTags\",\n"], [139, "          \"ecs:ListTasks\",\n"], [140, "          \"ecs:DescribeTasks\",\n"], [141, "          \"ecs:ListServices\",\n"], [142, "          \"ecs:DescribeServices\",\n"], [143, "          \"ecs:DescribeTaskDefinition\"\n"], [144, "        ]\n"], [145, "        Effect   = \"Allow\"\n"], [146, "        Resource = \"*\"\n"], [147, "      }\n"], [148, "    ]\n"], [149, "  })\n"], [150, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [128, 150], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_policy.prometheus_discovery", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-287", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_288", "bc_check_id": "BC_AWS_IAM_83", "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[128, "resource \"aws_iam_policy\" \"prometheus_discovery\" {\n"], [129, "  name        = \"prometheus-discovery\"\n"], [130, "  description = \"Allow Prometheus to discover EC2 and ECS targets\"\n"], [131, "\n"], [132, "  policy = jsonencode({\n"], [133, "    Version = \"2012-10-17\"\n"], [134, "    Statement = [\n"], [135, "      {\n"], [136, "        Action = [\n"], [137, "          \"ec2:DescribeInstances\",\n"], [138, "          \"ec2:DescribeTags\",\n"], [139, "          \"ecs:ListTasks\",\n"], [140, "          \"ecs:DescribeTasks\",\n"], [141, "          \"ecs:ListServices\",\n"], [142, "          \"ecs:DescribeServices\",\n"], [143, "          \"ecs:DescribeTaskDefinition\"\n"], [144, "        ]\n"], [145, "        Effect   = \"Allow\"\n"], [146, "        Resource = \"*\"\n"], [147, "      }\n"], [148, "    ]\n"], [149, "  })\n"], [150, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [128, 150], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_policy.prometheus_discovery", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-288", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_289", "bc_check_id": "BC_AWS_IAM_84", "check_name": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[128, "resource \"aws_iam_policy\" \"prometheus_discovery\" {\n"], [129, "  name        = \"prometheus-discovery\"\n"], [130, "  description = \"Allow Prometheus to discover EC2 and ECS targets\"\n"], [131, "\n"], [132, "  policy = jsonencode({\n"], [133, "    Version = \"2012-10-17\"\n"], [134, "    Statement = [\n"], [135, "      {\n"], [136, "        Action = [\n"], [137, "          \"ec2:DescribeInstances\",\n"], [138, "          \"ec2:DescribeTags\",\n"], [139, "          \"ecs:ListTasks\",\n"], [140, "          \"ecs:DescribeTasks\",\n"], [141, "          \"ecs:ListServices\",\n"], [142, "          \"ecs:DescribeServices\",\n"], [143, "          \"ecs:DescribeTaskDefinition\"\n"], [144, "        ]\n"], [145, "        Effect   = \"Allow\"\n"], [146, "        Resource = \"*\"\n"], [147, "      }\n"], [148, "    ]\n"], [149, "  })\n"], [150, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [128, 150], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_policy.prometheus_discovery", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-289", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_286", "bc_check_id": "BC_AWS_IAM_81", "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[128, "resource \"aws_iam_policy\" \"prometheus_discovery\" {\n"], [129, "  name        = \"prometheus-discovery\"\n"], [130, "  description = \"Allow Prometheus to discover EC2 and ECS targets\"\n"], [131, "\n"], [132, "  policy = jsonencode({\n"], [133, "    Version = \"2012-10-17\"\n"], [134, "    Statement = [\n"], [135, "      {\n"], [136, "        Action = [\n"], [137, "          \"ec2:DescribeInstances\",\n"], [138, "          \"ec2:DescribeTags\",\n"], [139, "          \"ecs:ListTasks\",\n"], [140, "          \"ecs:DescribeTasks\",\n"], [141, "          \"ecs:ListServices\",\n"], [142, "          \"ecs:DescribeServices\",\n"], [143, "          \"ecs:DescribeTaskDefinition\"\n"], [144, "        ]\n"], [145, "        Effect   = \"Allow\"\n"], [146, "        Resource = \"*\"\n"], [147, "      }\n"], [148, "    ]\n"], [149, "  })\n"], [150, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [128, 150], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_policy.prometheus_discovery", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-286", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_63", "bc_check_id": "BC_AWS_IAM_48", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[128, "resource \"aws_iam_policy\" \"prometheus_discovery\" {\n"], [129, "  name        = \"prometheus-discovery\"\n"], [130, "  description = \"Allow Prometheus to discover EC2 and ECS targets\"\n"], [131, "\n"], [132, "  policy = jsonencode({\n"], [133, "    Version = \"2012-10-17\"\n"], [134, "    Statement = [\n"], [135, "      {\n"], [136, "        Action = [\n"], [137, "          \"ec2:DescribeInstances\",\n"], [138, "          \"ec2:DescribeTags\",\n"], [139, "          \"ecs:ListTasks\",\n"], [140, "          \"ecs:DescribeTasks\",\n"], [141, "          \"ecs:ListServices\",\n"], [142, "          \"ecs:DescribeServices\",\n"], [143, "          \"ecs:DescribeTaskDefinition\"\n"], [144, "        ]\n"], [145, "        Effect   = \"Allow\"\n"], [146, "        Resource = \"*\"\n"], [147, "      }\n"], [148, "    ]\n"], [149, "  })\n"], [150, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [128, 150], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_policy.prometheus_discovery", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_290", "bc_check_id": "BC_AWS_IAM_85", "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[128, "resource \"aws_iam_policy\" \"prometheus_discovery\" {\n"], [129, "  name        = \"prometheus-discovery\"\n"], [130, "  description = \"Allow Prometheus to discover EC2 and ECS targets\"\n"], [131, "\n"], [132, "  policy = jsonencode({\n"], [133, "    Version = \"2012-10-17\"\n"], [134, "    Statement = [\n"], [135, "      {\n"], [136, "        Action = [\n"], [137, "          \"ec2:DescribeInstances\",\n"], [138, "          \"ec2:DescribeTags\",\n"], [139, "          \"ecs:ListTasks\",\n"], [140, "          \"ecs:DescribeTasks\",\n"], [141, "          \"ecs:ListServices\",\n"], [142, "          \"ecs:DescribeServices\",\n"], [143, "          \"ecs:DescribeTaskDefinition\"\n"], [144, "        ]\n"], [145, "        Effect   = \"Allow\"\n"], [146, "        Resource = \"*\"\n"], [147, "      }\n"], [148, "    ]\n"], [149, "  })\n"], [150, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [128, 150], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_policy.prometheus_discovery", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-290", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[152, "resource \"aws_iam_role_policy_attachment\" \"prometheus_discovery\" {\n"], [153, "  role       = aws_iam_role.ecs_task_role.name\n"], [154, "  policy_arn = aws_iam_policy.prometheus_discovery.arn\n"], [155, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [152, 155], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role_policy_attachment.prometheus_discovery", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[156, "resource \"aws_iam_role\" \"ecs_execution_role\" {\n"], [157, "  name = \"ecs-execution-role\"\n"], [158, "\n"], [159, "  assume_role_policy = jsonencode({\n"], [160, "    Version = \"2012-10-17\"\n"], [161, "    Statement = [\n"], [162, "      {\n"], [163, "        Action = \"sts:AssumeRole\"\n"], [164, "        Effect = \"Allow\"\n"], [165, "        Principal = {\n"], [166, "          Service = \"ecs-tasks.amazonaws.com\"\n"], [167, "        }\n"], [168, "      }\n"], [169, "    ]\n"], [170, "  })\n"], [171, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [156, 171], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.ecs_execution_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[156, "resource \"aws_iam_role\" \"ecs_execution_role\" {\n"], [157, "  name = \"ecs-execution-role\"\n"], [158, "\n"], [159, "  assume_role_policy = jsonencode({\n"], [160, "    Version = \"2012-10-17\"\n"], [161, "    Statement = [\n"], [162, "      {\n"], [163, "        Action = \"sts:AssumeRole\"\n"], [164, "        Effect = \"Allow\"\n"], [165, "        Principal = {\n"], [166, "          Service = \"ecs-tasks.amazonaws.com\"\n"], [167, "        }\n"], [168, "      }\n"], [169, "    ]\n"], [170, "  })\n"], [171, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [156, 171], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.ecs_execution_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[156, "resource \"aws_iam_role\" \"ecs_execution_role\" {\n"], [157, "  name = \"ecs-execution-role\"\n"], [158, "\n"], [159, "  assume_role_policy = jsonencode({\n"], [160, "    Version = \"2012-10-17\"\n"], [161, "    Statement = [\n"], [162, "      {\n"], [163, "        Action = \"sts:AssumeRole\"\n"], [164, "        Effect = \"Allow\"\n"], [165, "        Principal = {\n"], [166, "          Service = \"ecs-tasks.amazonaws.com\"\n"], [167, "        }\n"], [168, "      }\n"], [169, "    ]\n"], [170, "  })\n"], [171, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [156, 171], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.ecs_execution_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[173, "resource \"aws_iam_role_policy_attachment\" \"ecs_execution_role_policy\" {\n"], [174, "  role       = aws_iam_role.ecs_execution_role.name\n"], [175, "  policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy\"\n"], [176, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [173, 176], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role_policy_attachment.ecs_execution_role_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[179, "resource \"aws_iam_role\" \"ssm_service_role\" {\n"], [180, "  name = \"${var.project}-${var.environment}-ssm-service-role\"\n"], [181, "\n"], [182, "  assume_role_policy = jsonencode({\n"], [183, "    Version = \"2012-10-17\"\n"], [184, "    Statement = [\n"], [185, "      {\n"], [186, "        Action = \"sts:AssumeRole\"\n"], [187, "        Effect = \"Allow\"\n"], [188, "        Principal = {\n"], [189, "          Service = \"ssm.amazonaws.com\"\n"], [190, "        }\n"], [191, "      }\n"], [192, "    ]\n"], [193, "  })\n"], [194, "\n"], [195, "  tags = {\n"], [196, "    Name        = \"${var.project}-${var.environment}-ssm-service-role\"\n"], [197, "    Environment = var.environment\n"], [198, "    Project     = var.project\n"], [199, "  }\n"], [200, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [179, 200], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.ssm_service_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-ssm-service-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[179, "resource \"aws_iam_role\" \"ssm_service_role\" {\n"], [180, "  name = \"${var.project}-${var.environment}-ssm-service-role\"\n"], [181, "\n"], [182, "  assume_role_policy = jsonencode({\n"], [183, "    Version = \"2012-10-17\"\n"], [184, "    Statement = [\n"], [185, "      {\n"], [186, "        Action = \"sts:AssumeRole\"\n"], [187, "        Effect = \"Allow\"\n"], [188, "        Principal = {\n"], [189, "          Service = \"ssm.amazonaws.com\"\n"], [190, "        }\n"], [191, "      }\n"], [192, "    ]\n"], [193, "  })\n"], [194, "\n"], [195, "  tags = {\n"], [196, "    Name        = \"${var.project}-${var.environment}-ssm-service-role\"\n"], [197, "    Environment = var.environment\n"], [198, "    Project     = var.project\n"], [199, "  }\n"], [200, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [179, 200], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.ssm_service_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-ssm-service-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[179, "resource \"aws_iam_role\" \"ssm_service_role\" {\n"], [180, "  name = \"${var.project}-${var.environment}-ssm-service-role\"\n"], [181, "\n"], [182, "  assume_role_policy = jsonencode({\n"], [183, "    Version = \"2012-10-17\"\n"], [184, "    Statement = [\n"], [185, "      {\n"], [186, "        Action = \"sts:AssumeRole\"\n"], [187, "        Effect = \"Allow\"\n"], [188, "        Principal = {\n"], [189, "          Service = \"ssm.amazonaws.com\"\n"], [190, "        }\n"], [191, "      }\n"], [192, "    ]\n"], [193, "  })\n"], [194, "\n"], [195, "  tags = {\n"], [196, "    Name        = \"${var.project}-${var.environment}-ssm-service-role\"\n"], [197, "    Environment = var.environment\n"], [198, "    Project     = var.project\n"], [199, "  }\n"], [200, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [179, 200], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.ssm_service_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-ssm-service-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[202, "resource \"aws_iam_role_policy_attachment\" \"ssm_service_role_policy\" {\n"], [203, "  role       = aws_iam_role.ssm_service_role.name\n"], [204, "  policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonSSMMaintenanceWindowRole\"\n"], [205, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [202, 205], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role_policy_attachment.ssm_service_role_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[208, "resource \"aws_iam_role\" \"ec2_instance_role\" {\n"], [209, "  name = \"${var.project}-${var.environment}-ec2-instance-role\"\n"], [210, "\n"], [211, "  assume_role_policy = jsonencode({\n"], [212, "    Version = \"2012-10-17\"\n"], [213, "    Statement = [\n"], [214, "      {\n"], [215, "        Action = \"sts:AssumeRole\"\n"], [216, "        Effect = \"Allow\"\n"], [217, "        Principal = {\n"], [218, "          Service = \"ec2.amazonaws.com\"\n"], [219, "        }\n"], [220, "      }\n"], [221, "    ]\n"], [222, "  })\n"], [223, "\n"], [224, "  tags = {\n"], [225, "    Name        = \"${var.project}-${var.environment}-ec2-instance-role\"\n"], [226, "    Environment = var.environment\n"], [227, "    Project     = var.project\n"], [228, "  }\n"], [229, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [208, 229], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.ec2_instance_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-ec2-instance-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[208, "resource \"aws_iam_role\" \"ec2_instance_role\" {\n"], [209, "  name = \"${var.project}-${var.environment}-ec2-instance-role\"\n"], [210, "\n"], [211, "  assume_role_policy = jsonencode({\n"], [212, "    Version = \"2012-10-17\"\n"], [213, "    Statement = [\n"], [214, "      {\n"], [215, "        Action = \"sts:AssumeRole\"\n"], [216, "        Effect = \"Allow\"\n"], [217, "        Principal = {\n"], [218, "          Service = \"ec2.amazonaws.com\"\n"], [219, "        }\n"], [220, "      }\n"], [221, "    ]\n"], [222, "  })\n"], [223, "\n"], [224, "  tags = {\n"], [225, "    Name        = \"${var.project}-${var.environment}-ec2-instance-role\"\n"], [226, "    Environment = var.environment\n"], [227, "    Project     = var.project\n"], [228, "  }\n"], [229, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [208, 229], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.ec2_instance_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-ec2-instance-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[208, "resource \"aws_iam_role\" \"ec2_instance_role\" {\n"], [209, "  name = \"${var.project}-${var.environment}-ec2-instance-role\"\n"], [210, "\n"], [211, "  assume_role_policy = jsonencode({\n"], [212, "    Version = \"2012-10-17\"\n"], [213, "    Statement = [\n"], [214, "      {\n"], [215, "        Action = \"sts:AssumeRole\"\n"], [216, "        Effect = \"Allow\"\n"], [217, "        Principal = {\n"], [218, "          Service = \"ec2.amazonaws.com\"\n"], [219, "        }\n"], [220, "      }\n"], [221, "    ]\n"], [222, "  })\n"], [223, "\n"], [224, "  tags = {\n"], [225, "    Name        = \"${var.project}-${var.environment}-ec2-instance-role\"\n"], [226, "    Environment = var.environment\n"], [227, "    Project     = var.project\n"], [228, "  }\n"], [229, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [208, 229], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.ec2_instance_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-ec2-instance-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[232, "resource \"aws_iam_role_policy_attachment\" \"ec2_ssm_policy\" {\n"], [233, "  role       = aws_iam_role.ec2_instance_role.name\n"], [234, "  policy_arn = \"arn:aws:iam::aws:policy/AmazonSSMManagedInstanceCore\"\n"], [235, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [232, 235], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role_policy_attachment.ec2_ssm_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[237, "resource \"aws_iam_role_policy_attachment\" \"ec2_ecs_policy\" {\n"], [238, "  role       = aws_iam_role.ec2_instance_role.name\n"], [239, "  policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonEC2ContainerServiceforEC2Role\"\n"], [240, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [237, 240], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role_policy_attachment.ec2_ecs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[248, "resource \"aws_iam_role\" \"codedeploy_role\" {\n"], [249, "  name = \"${var.project}-${var.environment}-codedeploy-role\"\n"], [250, "\n"], [251, "  assume_role_policy = jsonencode({\n"], [252, "    Version = \"2012-10-17\"\n"], [253, "    Statement = [\n"], [254, "      {\n"], [255, "        Action = \"sts:AssumeRole\"\n"], [256, "        Effect = \"Allow\"\n"], [257, "        Principal = {\n"], [258, "          Service = \"codedeploy.amazonaws.com\"\n"], [259, "        }\n"], [260, "      }\n"], [261, "    ]\n"], [262, "  })\n"], [263, "\n"], [264, "  tags = {\n"], [265, "    Name        = \"${var.project}-${var.environment}-codedeploy-role\"\n"], [266, "    Environment = var.environment\n"], [267, "    Project     = var.project\n"], [268, "  }\n"], [269, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [248, 269], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.codedeploy_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-codedeploy-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[248, "resource \"aws_iam_role\" \"codedeploy_role\" {\n"], [249, "  name = \"${var.project}-${var.environment}-codedeploy-role\"\n"], [250, "\n"], [251, "  assume_role_policy = jsonencode({\n"], [252, "    Version = \"2012-10-17\"\n"], [253, "    Statement = [\n"], [254, "      {\n"], [255, "        Action = \"sts:AssumeRole\"\n"], [256, "        Effect = \"Allow\"\n"], [257, "        Principal = {\n"], [258, "          Service = \"codedeploy.amazonaws.com\"\n"], [259, "        }\n"], [260, "      }\n"], [261, "    ]\n"], [262, "  })\n"], [263, "\n"], [264, "  tags = {\n"], [265, "    Name        = \"${var.project}-${var.environment}-codedeploy-role\"\n"], [266, "    Environment = var.environment\n"], [267, "    Project     = var.project\n"], [268, "  }\n"], [269, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [248, 269], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.codedeploy_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-codedeploy-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[248, "resource \"aws_iam_role\" \"codedeploy_role\" {\n"], [249, "  name = \"${var.project}-${var.environment}-codedeploy-role\"\n"], [250, "\n"], [251, "  assume_role_policy = jsonencode({\n"], [252, "    Version = \"2012-10-17\"\n"], [253, "    Statement = [\n"], [254, "      {\n"], [255, "        Action = \"sts:AssumeRole\"\n"], [256, "        Effect = \"Allow\"\n"], [257, "        Principal = {\n"], [258, "          Service = \"codedeploy.amazonaws.com\"\n"], [259, "        }\n"], [260, "      }\n"], [261, "    ]\n"], [262, "  })\n"], [263, "\n"], [264, "  tags = {\n"], [265, "    Name        = \"${var.project}-${var.environment}-codedeploy-role\"\n"], [266, "    Environment = var.environment\n"], [267, "    Project     = var.project\n"], [268, "  }\n"], [269, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [248, 269], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.codedeploy_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-codedeploy-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[271, "resource \"aws_iam_role_policy_attachment\" \"codedeploy_policy\" {\n"], [272, "  role       = aws_iam_role.codedeploy_role.name\n"], [273, "  policy_arn = \"arn:aws:iam::aws:policy/AWSCodeDeployRoleForECS\"\n"], [274, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [271, 274], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role_policy_attachment.codedeploy_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_93", "bc_check_id": "BC_AWS_S3_24", "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[10, "resource \"aws_s3_bucket\" \"lambda_code\" {\n"], [11, "  bucket = \"${var.project}-${var.environment}-lambda-${random_string.bucket_suffix.result}\"\n"], [12, "\n"], [13, "  tags = {\n"], [14, "    Name        = \"${var.project}-${var.environment}-lambda\"\n"], [15, "    Environment = var.environment\n"], [16, "    Project     = var.project\n"], [17, "  }\n"], [18, "}\n"]], "file_path": "\\modules\\lambda\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [10, 18], "resource": "module.lambda_failover.aws_s3_bucket.lambda_code", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Name": "${var.project}-${var.environment}-lambda", "Project": "var.project"}, "caller_file_path": "\\modules\\multi-region\\main.tf", "caller_file_line_range": [66, 79], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-24", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[166, "resource \"aws_iam_role\" \"lambda_role\" {\n"], [167, "  name = \"${var.project}-${var.environment}-lambda-role\"\n"], [168, "\n"], [169, "  assume_role_policy = jsonencode({\n"], [170, "    Version = \"2012-10-17\"\n"], [171, "    Statement = [\n"], [172, "      {\n"], [173, "        Action = \"sts:AssumeRole\"\n"], [174, "        Effect = \"Allow\"\n"], [175, "        Principal = {\n"], [176, "          Service = \"lambda.amazonaws.com\"\n"], [177, "        }\n"], [178, "      }\n"], [179, "    ]\n"], [180, "  })\n"], [181, "\n"], [182, "  tags = {\n"], [183, "    Name        = \"${var.project}-${var.environment}-lambda-role\"\n"], [184, "    Environment = var.environment\n"], [185, "    Project     = var.project\n"], [186, "  }\n"], [187, "}\n"]], "file_path": "\\modules\\lambda\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [166, 187], "resource": "module.lambda_failover.aws_iam_role.lambda_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Name": "${var.project}-${var.environment}-lambda-role", "Project": "var.project"}, "caller_file_path": "\\modules\\multi-region\\main.tf", "caller_file_line_range": [66, 79], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[166, "resource \"aws_iam_role\" \"lambda_role\" {\n"], [167, "  name = \"${var.project}-${var.environment}-lambda-role\"\n"], [168, "\n"], [169, "  assume_role_policy = jsonencode({\n"], [170, "    Version = \"2012-10-17\"\n"], [171, "    Statement = [\n"], [172, "      {\n"], [173, "        Action = \"sts:AssumeRole\"\n"], [174, "        Effect = \"Allow\"\n"], [175, "        Principal = {\n"], [176, "          Service = \"lambda.amazonaws.com\"\n"], [177, "        }\n"], [178, "      }\n"], [179, "    ]\n"], [180, "  })\n"], [181, "\n"], [182, "  tags = {\n"], [183, "    Name        = \"${var.project}-${var.environment}-lambda-role\"\n"], [184, "    Environment = var.environment\n"], [185, "    Project     = var.project\n"], [186, "  }\n"], [187, "}\n"]], "file_path": "\\modules\\lambda\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [166, 187], "resource": "module.lambda_failover.aws_iam_role.lambda_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Name": "${var.project}-${var.environment}-lambda-role", "Project": "var.project"}, "caller_file_path": "\\modules\\multi-region\\main.tf", "caller_file_line_range": [66, 79], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[166, "resource \"aws_iam_role\" \"lambda_role\" {\n"], [167, "  name = \"${var.project}-${var.environment}-lambda-role\"\n"], [168, "\n"], [169, "  assume_role_policy = jsonencode({\n"], [170, "    Version = \"2012-10-17\"\n"], [171, "    Statement = [\n"], [172, "      {\n"], [173, "        Action = \"sts:AssumeRole\"\n"], [174, "        Effect = \"Allow\"\n"], [175, "        Principal = {\n"], [176, "          Service = \"lambda.amazonaws.com\"\n"], [177, "        }\n"], [178, "      }\n"], [179, "    ]\n"], [180, "  })\n"], [181, "\n"], [182, "  tags = {\n"], [183, "    Name        = \"${var.project}-${var.environment}-lambda-role\"\n"], [184, "    Environment = var.environment\n"], [185, "    Project     = var.project\n"], [186, "  }\n"], [187, "}\n"]], "file_path": "\\modules\\lambda\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [166, 187], "resource": "module.lambda_failover.aws_iam_role.lambda_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Name": "${var.project}-${var.environment}-lambda-role", "Project": "var.project"}, "caller_file_path": "\\modules\\multi-region\\main.tf", "caller_file_line_range": [66, 79], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_62", "bc_check_id": "BC_AWS_IAM_47", "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[190, "resource \"aws_iam_policy\" \"lambda_policy\" {\n"], [191, "  name        = \"${var.project}-${var.environment}-lambda-policy\"\n"], [192, "  description = \"Policy to allow Lambda functions to perform failover operations\"\n"], [193, "\n"], [194, "  policy = jsonencode({\n"], [195, "    Version = \"2012-10-17\"\n"], [196, "    Statement = [\n"], [197, "      {\n"], [198, "        Action = [\n"], [199, "          \"logs:CreateLogGroup\",\n"], [200, "          \"logs:CreateLogStream\",\n"], [201, "          \"logs:PutLogEvents\"\n"], [202, "        ]\n"], [203, "        Effect   = \"Allow\"\n"], [204, "        Resource = \"arn:aws:logs:*:*:*\"\n"], [205, "      },\n"], [206, "      {\n"], [207, "        Action = [\n"], [208, "          \"route53:GetHealthCheck\",\n"], [209, "          \"route53:UpdateHealthCheck\"\n"], [210, "        ]\n"], [211, "        Effect   = \"Allow\"\n"], [212, "        Resource = \"*\"\n"], [213, "      },\n"], [214, "      {\n"], [215, "        Action = [\n"], [216, "          \"autoscaling:DescribeAutoScalingGroups\",\n"], [217, "          \"autoscaling:UpdateAutoScalingGroup\"\n"], [218, "        ]\n"], [219, "        Effect   = \"Allow\"\n"], [220, "        Resource = \"*\"\n"], [221, "      },\n"], [222, "      {\n"], [223, "        Action = [\n"], [224, "          \"sns:Publish\"\n"], [225, "        ]\n"], [226, "        Effect   = \"Allow\"\n"], [227, "        Resource = var.sns_topic_arn\n"], [228, "      }\n"], [229, "    ]\n"], [230, "  })\n"], [231, "}\n"]], "file_path": "\\modules\\lambda\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [190, 231], "resource": "module.lambda_failover.aws_iam_policy.lambda_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMAdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\modules\\multi-region\\main.tf", "caller_file_line_range": [66, 79], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_287", "bc_check_id": "BC_AWS_IAM_82", "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[190, "resource \"aws_iam_policy\" \"lambda_policy\" {\n"], [191, "  name        = \"${var.project}-${var.environment}-lambda-policy\"\n"], [192, "  description = \"Policy to allow Lambda functions to perform failover operations\"\n"], [193, "\n"], [194, "  policy = jsonencode({\n"], [195, "    Version = \"2012-10-17\"\n"], [196, "    Statement = [\n"], [197, "      {\n"], [198, "        Action = [\n"], [199, "          \"logs:CreateLogGroup\",\n"], [200, "          \"logs:CreateLogStream\",\n"], [201, "          \"logs:PutLogEvents\"\n"], [202, "        ]\n"], [203, "        Effect   = \"Allow\"\n"], [204, "        Resource = \"arn:aws:logs:*:*:*\"\n"], [205, "      },\n"], [206, "      {\n"], [207, "        Action = [\n"], [208, "          \"route53:GetHealthCheck\",\n"], [209, "          \"route53:UpdateHealthCheck\"\n"], [210, "        ]\n"], [211, "        Effect   = \"Allow\"\n"], [212, "        Resource = \"*\"\n"], [213, "      },\n"], [214, "      {\n"], [215, "        Action = [\n"], [216, "          \"autoscaling:DescribeAutoScalingGroups\",\n"], [217, "          \"autoscaling:UpdateAutoScalingGroup\"\n"], [218, "        ]\n"], [219, "        Effect   = \"Allow\"\n"], [220, "        Resource = \"*\"\n"], [221, "      },\n"], [222, "      {\n"], [223, "        Action = [\n"], [224, "          \"sns:Publish\"\n"], [225, "        ]\n"], [226, "        Effect   = \"Allow\"\n"], [227, "        Resource = var.sns_topic_arn\n"], [228, "      }\n"], [229, "    ]\n"], [230, "  })\n"], [231, "}\n"]], "file_path": "\\modules\\lambda\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [190, 231], "resource": "module.lambda_failover.aws_iam_policy.lambda_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\modules\\multi-region\\main.tf", "caller_file_line_range": [66, 79], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-287", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_288", "bc_check_id": "BC_AWS_IAM_83", "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[190, "resource \"aws_iam_policy\" \"lambda_policy\" {\n"], [191, "  name        = \"${var.project}-${var.environment}-lambda-policy\"\n"], [192, "  description = \"Policy to allow Lambda functions to perform failover operations\"\n"], [193, "\n"], [194, "  policy = jsonencode({\n"], [195, "    Version = \"2012-10-17\"\n"], [196, "    Statement = [\n"], [197, "      {\n"], [198, "        Action = [\n"], [199, "          \"logs:CreateLogGroup\",\n"], [200, "          \"logs:CreateLogStream\",\n"], [201, "          \"logs:PutLogEvents\"\n"], [202, "        ]\n"], [203, "        Effect   = \"Allow\"\n"], [204, "        Resource = \"arn:aws:logs:*:*:*\"\n"], [205, "      },\n"], [206, "      {\n"], [207, "        Action = [\n"], [208, "          \"route53:GetHealthCheck\",\n"], [209, "          \"route53:UpdateHealthCheck\"\n"], [210, "        ]\n"], [211, "        Effect   = \"Allow\"\n"], [212, "        Resource = \"*\"\n"], [213, "      },\n"], [214, "      {\n"], [215, "        Action = [\n"], [216, "          \"autoscaling:DescribeAutoScalingGroups\",\n"], [217, "          \"autoscaling:UpdateAutoScalingGroup\"\n"], [218, "        ]\n"], [219, "        Effect   = \"Allow\"\n"], [220, "        Resource = \"*\"\n"], [221, "      },\n"], [222, "      {\n"], [223, "        Action = [\n"], [224, "          \"sns:Publish\"\n"], [225, "        ]\n"], [226, "        Effect   = \"Allow\"\n"], [227, "        Resource = var.sns_topic_arn\n"], [228, "      }\n"], [229, "    ]\n"], [230, "  })\n"], [231, "}\n"]], "file_path": "\\modules\\lambda\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [190, 231], "resource": "module.lambda_failover.aws_iam_policy.lambda_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\modules\\multi-region\\main.tf", "caller_file_line_range": [66, 79], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-288", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_289", "bc_check_id": "BC_AWS_IAM_84", "check_name": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[190, "resource \"aws_iam_policy\" \"lambda_policy\" {\n"], [191, "  name        = \"${var.project}-${var.environment}-lambda-policy\"\n"], [192, "  description = \"Policy to allow Lambda functions to perform failover operations\"\n"], [193, "\n"], [194, "  policy = jsonencode({\n"], [195, "    Version = \"2012-10-17\"\n"], [196, "    Statement = [\n"], [197, "      {\n"], [198, "        Action = [\n"], [199, "          \"logs:CreateLogGroup\",\n"], [200, "          \"logs:CreateLogStream\",\n"], [201, "          \"logs:PutLogEvents\"\n"], [202, "        ]\n"], [203, "        Effect   = \"Allow\"\n"], [204, "        Resource = \"arn:aws:logs:*:*:*\"\n"], [205, "      },\n"], [206, "      {\n"], [207, "        Action = [\n"], [208, "          \"route53:GetHealthCheck\",\n"], [209, "          \"route53:UpdateHealthCheck\"\n"], [210, "        ]\n"], [211, "        Effect   = \"Allow\"\n"], [212, "        Resource = \"*\"\n"], [213, "      },\n"], [214, "      {\n"], [215, "        Action = [\n"], [216, "          \"autoscaling:DescribeAutoScalingGroups\",\n"], [217, "          \"autoscaling:UpdateAutoScalingGroup\"\n"], [218, "        ]\n"], [219, "        Effect   = \"Allow\"\n"], [220, "        Resource = \"*\"\n"], [221, "      },\n"], [222, "      {\n"], [223, "        Action = [\n"], [224, "          \"sns:Publish\"\n"], [225, "        ]\n"], [226, "        Effect   = \"Allow\"\n"], [227, "        Resource = var.sns_topic_arn\n"], [228, "      }\n"], [229, "    ]\n"], [230, "  })\n"], [231, "}\n"]], "file_path": "\\modules\\lambda\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [190, 231], "resource": "module.lambda_failover.aws_iam_policy.lambda_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\modules\\multi-region\\main.tf", "caller_file_line_range": [66, 79], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-289", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_286", "bc_check_id": "BC_AWS_IAM_81", "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[190, "resource \"aws_iam_policy\" \"lambda_policy\" {\n"], [191, "  name        = \"${var.project}-${var.environment}-lambda-policy\"\n"], [192, "  description = \"Policy to allow Lambda functions to perform failover operations\"\n"], [193, "\n"], [194, "  policy = jsonencode({\n"], [195, "    Version = \"2012-10-17\"\n"], [196, "    Statement = [\n"], [197, "      {\n"], [198, "        Action = [\n"], [199, "          \"logs:CreateLogGroup\",\n"], [200, "          \"logs:CreateLogStream\",\n"], [201, "          \"logs:PutLogEvents\"\n"], [202, "        ]\n"], [203, "        Effect   = \"Allow\"\n"], [204, "        Resource = \"arn:aws:logs:*:*:*\"\n"], [205, "      },\n"], [206, "      {\n"], [207, "        Action = [\n"], [208, "          \"route53:GetHealthCheck\",\n"], [209, "          \"route53:UpdateHealthCheck\"\n"], [210, "        ]\n"], [211, "        Effect   = \"Allow\"\n"], [212, "        Resource = \"*\"\n"], [213, "      },\n"], [214, "      {\n"], [215, "        Action = [\n"], [216, "          \"autoscaling:DescribeAutoScalingGroups\",\n"], [217, "          \"autoscaling:UpdateAutoScalingGroup\"\n"], [218, "        ]\n"], [219, "        Effect   = \"Allow\"\n"], [220, "        Resource = \"*\"\n"], [221, "      },\n"], [222, "      {\n"], [223, "        Action = [\n"], [224, "          \"sns:Publish\"\n"], [225, "        ]\n"], [226, "        Effect   = \"Allow\"\n"], [227, "        Resource = var.sns_topic_arn\n"], [228, "      }\n"], [229, "    ]\n"], [230, "  })\n"], [231, "}\n"]], "file_path": "\\modules\\lambda\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [190, 231], "resource": "module.lambda_failover.aws_iam_policy.lambda_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\modules\\multi-region\\main.tf", "caller_file_line_range": [66, 79], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-286", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_63", "bc_check_id": "BC_AWS_IAM_48", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[190, "resource \"aws_iam_policy\" \"lambda_policy\" {\n"], [191, "  name        = \"${var.project}-${var.environment}-lambda-policy\"\n"], [192, "  description = \"Policy to allow Lambda functions to perform failover operations\"\n"], [193, "\n"], [194, "  policy = jsonencode({\n"], [195, "    Version = \"2012-10-17\"\n"], [196, "    Statement = [\n"], [197, "      {\n"], [198, "        Action = [\n"], [199, "          \"logs:CreateLogGroup\",\n"], [200, "          \"logs:CreateLogStream\",\n"], [201, "          \"logs:PutLogEvents\"\n"], [202, "        ]\n"], [203, "        Effect   = \"Allow\"\n"], [204, "        Resource = \"arn:aws:logs:*:*:*\"\n"], [205, "      },\n"], [206, "      {\n"], [207, "        Action = [\n"], [208, "          \"route53:GetHealthCheck\",\n"], [209, "          \"route53:UpdateHealthCheck\"\n"], [210, "        ]\n"], [211, "        Effect   = \"Allow\"\n"], [212, "        Resource = \"*\"\n"], [213, "      },\n"], [214, "      {\n"], [215, "        Action = [\n"], [216, "          \"autoscaling:DescribeAutoScalingGroups\",\n"], [217, "          \"autoscaling:UpdateAutoScalingGroup\"\n"], [218, "        ]\n"], [219, "        Effect   = \"Allow\"\n"], [220, "        Resource = \"*\"\n"], [221, "      },\n"], [222, "      {\n"], [223, "        Action = [\n"], [224, "          \"sns:Publish\"\n"], [225, "        ]\n"], [226, "        Effect   = \"Allow\"\n"], [227, "        Resource = var.sns_topic_arn\n"], [228, "      }\n"], [229, "    ]\n"], [230, "  })\n"], [231, "}\n"]], "file_path": "\\modules\\lambda\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [190, 231], "resource": "module.lambda_failover.aws_iam_policy.lambda_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\modules\\multi-region\\main.tf", "caller_file_line_range": [66, 79], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[234, "resource \"aws_iam_role_policy_attachment\" \"lambda_policy_attachment\" {\n"], [235, "  role       = aws_iam_role.lambda_role.name\n"], [236, "  policy_arn = aws_iam_policy.lambda_policy.arn\n"], [237, "}\n"]], "file_path": "\\modules\\lambda\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [234, 237], "resource": "module.lambda_failover.aws_iam_role_policy_attachment.lambda_policy_attachment", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\modules\\multi-region\\main.tf", "caller_file_line_range": [66, 79], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_45", "bc_check_id": "BC_AWS_SECRETS_3", "check_name": "Ensure no hard-coded secrets exist in lambda environment", "check_result": {"result": "PASSED", "evaluated_keys": ["environment/[0]/variables"]}, "code_block": [[240, "resource \"aws_lambda_function\" \"failover_lambda\" {\n"], [241, "  function_name = \"${var.project}-${var.environment}-failover-test\"\n"], [242, "  description   = \"Lambda function to test and manage failover between primary and DR regions\"\n"], [243, "  role          = aws_iam_role.lambda_role.arn\n"], [244, "  handler       = \"lambda_function.lambda_handler\"\n"], [245, "  runtime       = \"python3.9\"\n"], [246, "  timeout       = 900 # 15 minutes\n"], [247, "  memory_size   = 128\n"], [248, "\n"], [249, "  s3_bucket = aws_s3_bucket.lambda_code.id\n"], [250, "  s3_key    = aws_s3_object.lambda_code.key\n"], [251, "\n"], [252, "  environment {\n"], [253, "    variables = {\n"], [254, "      PRIMARY_HEALTH_CHECK_ID = var.primary_health_check_id\n"], [255, "      DR_HEALTH_CHECK_ID      = var.dr_health_check_id\n"], [256, "      PRIMARY_ASG_NAME        = var.primary_asg_name\n"], [257, "      DR_ASG_NAME             = var.dr_asg_name\n"], [258, "      PRIMARY_REGION          = var.primary_region\n"], [259, "      DR_REGION               = var.dr_region\n"], [260, "      SNS_TOPIC_ARN           = var.sns_topic_arn\n"], [261, "      FAILOVER_MODE           = \"test\" # Default mode\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "  tags = {\n"], [266, "    Name        = \"${var.project}-${var.environment}-failover-lambda\"\n"], [267, "    Environment = var.environment\n"], [268, "    Project     = var.project\n"], [269, "  }\n"], [270, "}\n"]], "file_path": "\\modules\\lambda\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [240, 270], "resource": "module.lambda_failover.aws_lambda_function.failover_lambda", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaEnvironmentCredentials", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Name": "${var.project}-${var.environment}-failover-lambda", "Project": "var.project"}, "caller_file_path": "\\modules\\multi-region\\main.tf", "caller_file_line_range": [66, 79], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-3", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_301", "bc_check_id": "BC_AWS_GENERAL_215", "check_name": "Ensure that AWS Lambda function is not publicly accessible", "check_result": {"result": "PASSED", "evaluated_keys": ["principal"]}, "code_block": [[293, "resource \"aws_lambda_permission\" \"allow_cloudwatch\" {\n"], [294, "  statement_id  = \"AllowExecutionFromCloudWatch\"\n"], [295, "  action        = \"lambda:InvokeFunction\"\n"], [296, "  function_name = aws_lambda_function.failover_lambda.function_name\n"], [297, "  principal     = \"events.amazonaws.com\"\n"], [298, "  source_arn    = aws_cloudwatch_event_rule.scheduled_failover_test.arn\n"], [299, "}\n"]], "file_path": "\\modules\\lambda\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [293, 299], "resource": "module.lambda_failover.aws_lambda_permission.allow_cloudwatch", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaFunctionIsNotPublic", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\modules\\multi-region\\main.tf", "caller_file_line_range": [66, 79], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-301", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_364", "bc_check_id": "BC_AWS_IAM_91", "check_name": "Ensure that AWS Lambda function permissions delegated to AWS services are limited by SourceArn or SourceAccount", "check_result": {"result": "PASSED", "evaluated_keys": ["principal", "source_arn", "source_account"]}, "code_block": [[293, "resource \"aws_lambda_permission\" \"allow_cloudwatch\" {\n"], [294, "  statement_id  = \"AllowExecutionFromCloudWatch\"\n"], [295, "  action        = \"lambda:InvokeFunction\"\n"], [296, "  function_name = aws_lambda_function.failover_lambda.function_name\n"], [297, "  principal     = \"events.amazonaws.com\"\n"], [298, "  source_arn    = aws_cloudwatch_event_rule.scheduled_failover_test.arn\n"], [299, "}\n"]], "file_path": "\\modules\\lambda\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [293, 299], "resource": "module.lambda_failover.aws_lambda_permission.allow_cloudwatch", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaServicePermission", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\modules\\multi-region\\main.tf", "caller_file_line_range": [66, 79], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-364", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_335", "bc_check_id": "BC_AWS_GENERAL_240", "check_name": "Ensure ECS task definitions should not share the host's process namespace", "check_result": {"result": "PASSED", "evaluated_keys": ["container_definitions"]}, "code_block": [[1, "resource \"aws_ecs_task_definition\" \"grafana\" {\n"], [2, "  family                   = \"grafana\"\n"], [3, "  network_mode             = \"awsvpc\"\n"], [4, "  requires_compatibilities = [\"FARGATE\"]\n"], [5, "  cpu                      = var.grafana_cpu\n"], [6, "  memory                   = var.grafana_memory\n"], [7, "  execution_role_arn       = var.execution_role_arn\n"], [8, "  task_role_arn            = var.task_role_arn\n"], [9, "\n"], [10, "  container_definitions = jsonencode([\n"], [11, "    {\n"], [12, "      name      = \"grafana\"\n"], [13, "      image     = \"grafana/grafana:9.5.1\"\n"], [14, "      essential = true\n"], [15, "\n"], [16, "      portMappings = [\n"], [17, "        {\n"], [18, "          containerPort = 3000\n"], [19, "          hostPort      = 3000\n"], [20, "          protocol      = \"tcp\"\n"], [21, "        }\n"], [22, "      ]\n"], [23, "\n"], [24, "      environment = [\n"], [25, "        {\n"], [26, "          name  = \"GF_AUTH_ANONYMOUS_ENABLED\"\n"], [27, "          value = \"false\"\n"], [28, "        },\n"], [29, "        {\n"], [30, "          name  = \"GF_SECURITY_ADMIN_PASSWORD\"\n"], [31, "          value = var.grafana_admin_password\n"], [32, "        },\n"], [33, "        {\n"], [34, "          name  = \"GF_INSTALL_PLUGINS\"\n"], [35, "          value = \"grafana-clock-panel,grafana-simple-json-datasource\"\n"], [36, "        },\n"], [37, "        {\n"], [38, "          name  = \"GF_SERVER_ROOT_URL\"\n"], [39, "          value = \"https://${var.domain_name}/grafana\"\n"], [40, "        },\n"], [41, "        {\n"], [42, "          name  = \"GF_SERVER_SERVE_FROM_SUB_PATH\"\n"], [43, "          value = \"true\"\n"], [44, "        }\n"], [45, "      ]\n"], [46, "\n"], [47, "      mountPoints = [\n"], [48, "        {\n"], [49, "          sourceVolume  = \"grafana-data\"\n"], [50, "          containerPath = \"/var/lib/grafana\"\n"], [51, "          readOnly      = false\n"], [52, "        }\n"], [53, "      ]\n"], [54, "\n"], [55, "      logConfiguration = {\n"], [56, "        logDriver = \"awslogs\",\n"], [57, "        options = {\n"], [58, "          \"awslogs-group\"         = aws_cloudwatch_log_group.grafana_logs.name,\n"], [59, "          \"awslogs-region\"        = var.aws_region,\n"], [60, "          \"awslogs-stream-prefix\" = \"grafana\"\n"], [61, "        }\n"], [62, "      }\n"], [63, "    }\n"], [64, "  ])\n"], [65, "\n"], [66, "  volume {\n"], [67, "    name = \"grafana-data\"\n"], [68, "    efs_volume_configuration {\n"], [69, "      file_system_id     = aws_efs_file_system.monitoring_data.id\n"], [70, "      transit_encryption = \"ENABLED\"\n"], [71, "      authorization_config {\n"], [72, "        access_point_id = aws_efs_access_point.grafana_ap.id\n"], [73, "        iam             = \"ENABLED\"\n"], [74, "      }\n"], [75, "    }\n"], [76, "  }\n"], [77, "\n"], [78, "  tags = {\n"], [79, "    Name        = \"grafana\"\n"], [80, "    Environment = var.environment\n"], [81, "  }\n"], [82, "}\n"]], "file_path": "\\modules\\monitoring\\grafana.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf", "repo_file_path": "/modules/monitoring/grafana.tf", "file_line_range": [1, 82], "resource": "module.ecs_jenkins_github.module.monitoring.aws_ecs_task_definition.grafana", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSContainerHostProcess", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "grafana"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-335", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf"}, {"check_id": "CKV_AWS_334", "bc_check_id": "BC_AWS_GENERAL_239", "check_name": "Ensure ECS containers should run as non-privileged", "check_result": {"result": "PASSED", "evaluated_keys": ["container_definitions"]}, "code_block": [[1, "resource \"aws_ecs_task_definition\" \"grafana\" {\n"], [2, "  family                   = \"grafana\"\n"], [3, "  network_mode             = \"awsvpc\"\n"], [4, "  requires_compatibilities = [\"FARGATE\"]\n"], [5, "  cpu                      = var.grafana_cpu\n"], [6, "  memory                   = var.grafana_memory\n"], [7, "  execution_role_arn       = var.execution_role_arn\n"], [8, "  task_role_arn            = var.task_role_arn\n"], [9, "\n"], [10, "  container_definitions = jsonencode([\n"], [11, "    {\n"], [12, "      name      = \"grafana\"\n"], [13, "      image     = \"grafana/grafana:9.5.1\"\n"], [14, "      essential = true\n"], [15, "\n"], [16, "      portMappings = [\n"], [17, "        {\n"], [18, "          containerPort = 3000\n"], [19, "          hostPort      = 3000\n"], [20, "          protocol      = \"tcp\"\n"], [21, "        }\n"], [22, "      ]\n"], [23, "\n"], [24, "      environment = [\n"], [25, "        {\n"], [26, "          name  = \"GF_AUTH_ANONYMOUS_ENABLED\"\n"], [27, "          value = \"false\"\n"], [28, "        },\n"], [29, "        {\n"], [30, "          name  = \"GF_SECURITY_ADMIN_PASSWORD\"\n"], [31, "          value = var.grafana_admin_password\n"], [32, "        },\n"], [33, "        {\n"], [34, "          name  = \"GF_INSTALL_PLUGINS\"\n"], [35, "          value = \"grafana-clock-panel,grafana-simple-json-datasource\"\n"], [36, "        },\n"], [37, "        {\n"], [38, "          name  = \"GF_SERVER_ROOT_URL\"\n"], [39, "          value = \"https://${var.domain_name}/grafana\"\n"], [40, "        },\n"], [41, "        {\n"], [42, "          name  = \"GF_SERVER_SERVE_FROM_SUB_PATH\"\n"], [43, "          value = \"true\"\n"], [44, "        }\n"], [45, "      ]\n"], [46, "\n"], [47, "      mountPoints = [\n"], [48, "        {\n"], [49, "          sourceVolume  = \"grafana-data\"\n"], [50, "          containerPath = \"/var/lib/grafana\"\n"], [51, "          readOnly      = false\n"], [52, "        }\n"], [53, "      ]\n"], [54, "\n"], [55, "      logConfiguration = {\n"], [56, "        logDriver = \"awslogs\",\n"], [57, "        options = {\n"], [58, "          \"awslogs-group\"         = aws_cloudwatch_log_group.grafana_logs.name,\n"], [59, "          \"awslogs-region\"        = var.aws_region,\n"], [60, "          \"awslogs-stream-prefix\" = \"grafana\"\n"], [61, "        }\n"], [62, "      }\n"], [63, "    }\n"], [64, "  ])\n"], [65, "\n"], [66, "  volume {\n"], [67, "    name = \"grafana-data\"\n"], [68, "    efs_volume_configuration {\n"], [69, "      file_system_id     = aws_efs_file_system.monitoring_data.id\n"], [70, "      transit_encryption = \"ENABLED\"\n"], [71, "      authorization_config {\n"], [72, "        access_point_id = aws_efs_access_point.grafana_ap.id\n"], [73, "        iam             = \"ENABLED\"\n"], [74, "      }\n"], [75, "    }\n"], [76, "  }\n"], [77, "\n"], [78, "  tags = {\n"], [79, "    Name        = \"grafana\"\n"], [80, "    Environment = var.environment\n"], [81, "  }\n"], [82, "}\n"]], "file_path": "\\modules\\monitoring\\grafana.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf", "repo_file_path": "/modules/monitoring/grafana.tf", "file_line_range": [1, 82], "resource": "module.ecs_jenkins_github.module.monitoring.aws_ecs_task_definition.grafana", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSContainerPrivilege", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "grafana"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-334", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf"}, {"check_id": "CKV_AWS_97", "bc_check_id": "BC_AWS_GENERAL_39", "check_name": "Ensure Encryption in transit is enabled for EFS volumes in ECS Task definitions", "check_result": {"result": "PASSED", "evaluated_keys": ["volume/[0]/efs_volume_configuration/[0]"]}, "code_block": [[1, "resource \"aws_ecs_task_definition\" \"grafana\" {\n"], [2, "  family                   = \"grafana\"\n"], [3, "  network_mode             = \"awsvpc\"\n"], [4, "  requires_compatibilities = [\"FARGATE\"]\n"], [5, "  cpu                      = var.grafana_cpu\n"], [6, "  memory                   = var.grafana_memory\n"], [7, "  execution_role_arn       = var.execution_role_arn\n"], [8, "  task_role_arn            = var.task_role_arn\n"], [9, "\n"], [10, "  container_definitions = jsonencode([\n"], [11, "    {\n"], [12, "      name      = \"grafana\"\n"], [13, "      image     = \"grafana/grafana:9.5.1\"\n"], [14, "      essential = true\n"], [15, "\n"], [16, "      portMappings = [\n"], [17, "        {\n"], [18, "          containerPort = 3000\n"], [19, "          hostPort      = 3000\n"], [20, "          protocol      = \"tcp\"\n"], [21, "        }\n"], [22, "      ]\n"], [23, "\n"], [24, "      environment = [\n"], [25, "        {\n"], [26, "          name  = \"GF_AUTH_ANONYMOUS_ENABLED\"\n"], [27, "          value = \"false\"\n"], [28, "        },\n"], [29, "        {\n"], [30, "          name  = \"GF_SECURITY_ADMIN_PASSWORD\"\n"], [31, "          value = var.grafana_admin_password\n"], [32, "        },\n"], [33, "        {\n"], [34, "          name  = \"GF_INSTALL_PLUGINS\"\n"], [35, "          value = \"grafana-clock-panel,grafana-simple-json-datasource\"\n"], [36, "        },\n"], [37, "        {\n"], [38, "          name  = \"GF_SERVER_ROOT_URL\"\n"], [39, "          value = \"https://${var.domain_name}/grafana\"\n"], [40, "        },\n"], [41, "        {\n"], [42, "          name  = \"GF_SERVER_SERVE_FROM_SUB_PATH\"\n"], [43, "          value = \"true\"\n"], [44, "        }\n"], [45, "      ]\n"], [46, "\n"], [47, "      mountPoints = [\n"], [48, "        {\n"], [49, "          sourceVolume  = \"grafana-data\"\n"], [50, "          containerPath = \"/var/lib/grafana\"\n"], [51, "          readOnly      = false\n"], [52, "        }\n"], [53, "      ]\n"], [54, "\n"], [55, "      logConfiguration = {\n"], [56, "        logDriver = \"awslogs\",\n"], [57, "        options = {\n"], [58, "          \"awslogs-group\"         = aws_cloudwatch_log_group.grafana_logs.name,\n"], [59, "          \"awslogs-region\"        = var.aws_region,\n"], [60, "          \"awslogs-stream-prefix\" = \"grafana\"\n"], [61, "        }\n"], [62, "      }\n"], [63, "    }\n"], [64, "  ])\n"], [65, "\n"], [66, "  volume {\n"], [67, "    name = \"grafana-data\"\n"], [68, "    efs_volume_configuration {\n"], [69, "      file_system_id     = aws_efs_file_system.monitoring_data.id\n"], [70, "      transit_encryption = \"ENABLED\"\n"], [71, "      authorization_config {\n"], [72, "        access_point_id = aws_efs_access_point.grafana_ap.id\n"], [73, "        iam             = \"ENABLED\"\n"], [74, "      }\n"], [75, "    }\n"], [76, "  }\n"], [77, "\n"], [78, "  tags = {\n"], [79, "    Name        = \"grafana\"\n"], [80, "    Environment = var.environment\n"], [81, "  }\n"], [82, "}\n"]], "file_path": "\\modules\\monitoring\\grafana.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf", "repo_file_path": "/modules/monitoring/grafana.tf", "file_line_range": [1, 82], "resource": "module.ecs_jenkins_github.module.monitoring.aws_ecs_task_definition.grafana", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSTaskDefinitionEFSVolumeEncryption", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "grafana"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-39", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf"}, {"check_id": "CKV_AWS_249", "bc_check_id": "BC_AWS_IAM_68", "check_name": "Ensure that the Execution Role ARN and the Task Role ARN are different in ECS Task definitions", "check_result": {"result": "PASSED", "evaluated_keys": ["execution_role_arn", "task_role_arn"]}, "code_block": [[1, "resource \"aws_ecs_task_definition\" \"grafana\" {\n"], [2, "  family                   = \"grafana\"\n"], [3, "  network_mode             = \"awsvpc\"\n"], [4, "  requires_compatibilities = [\"FARGATE\"]\n"], [5, "  cpu                      = var.grafana_cpu\n"], [6, "  memory                   = var.grafana_memory\n"], [7, "  execution_role_arn       = var.execution_role_arn\n"], [8, "  task_role_arn            = var.task_role_arn\n"], [9, "\n"], [10, "  container_definitions = jsonencode([\n"], [11, "    {\n"], [12, "      name      = \"grafana\"\n"], [13, "      image     = \"grafana/grafana:9.5.1\"\n"], [14, "      essential = true\n"], [15, "\n"], [16, "      portMappings = [\n"], [17, "        {\n"], [18, "          containerPort = 3000\n"], [19, "          hostPort      = 3000\n"], [20, "          protocol      = \"tcp\"\n"], [21, "        }\n"], [22, "      ]\n"], [23, "\n"], [24, "      environment = [\n"], [25, "        {\n"], [26, "          name  = \"GF_AUTH_ANONYMOUS_ENABLED\"\n"], [27, "          value = \"false\"\n"], [28, "        },\n"], [29, "        {\n"], [30, "          name  = \"GF_SECURITY_ADMIN_PASSWORD\"\n"], [31, "          value = var.grafana_admin_password\n"], [32, "        },\n"], [33, "        {\n"], [34, "          name  = \"GF_INSTALL_PLUGINS\"\n"], [35, "          value = \"grafana-clock-panel,grafana-simple-json-datasource\"\n"], [36, "        },\n"], [37, "        {\n"], [38, "          name  = \"GF_SERVER_ROOT_URL\"\n"], [39, "          value = \"https://${var.domain_name}/grafana\"\n"], [40, "        },\n"], [41, "        {\n"], [42, "          name  = \"GF_SERVER_SERVE_FROM_SUB_PATH\"\n"], [43, "          value = \"true\"\n"], [44, "        }\n"], [45, "      ]\n"], [46, "\n"], [47, "      mountPoints = [\n"], [48, "        {\n"], [49, "          sourceVolume  = \"grafana-data\"\n"], [50, "          containerPath = \"/var/lib/grafana\"\n"], [51, "          readOnly      = false\n"], [52, "        }\n"], [53, "      ]\n"], [54, "\n"], [55, "      logConfiguration = {\n"], [56, "        logDriver = \"awslogs\",\n"], [57, "        options = {\n"], [58, "          \"awslogs-group\"         = aws_cloudwatch_log_group.grafana_logs.name,\n"], [59, "          \"awslogs-region\"        = var.aws_region,\n"], [60, "          \"awslogs-stream-prefix\" = \"grafana\"\n"], [61, "        }\n"], [62, "      }\n"], [63, "    }\n"], [64, "  ])\n"], [65, "\n"], [66, "  volume {\n"], [67, "    name = \"grafana-data\"\n"], [68, "    efs_volume_configuration {\n"], [69, "      file_system_id     = aws_efs_file_system.monitoring_data.id\n"], [70, "      transit_encryption = \"ENABLED\"\n"], [71, "      authorization_config {\n"], [72, "        access_point_id = aws_efs_access_point.grafana_ap.id\n"], [73, "        iam             = \"ENABLED\"\n"], [74, "      }\n"], [75, "    }\n"], [76, "  }\n"], [77, "\n"], [78, "  tags = {\n"], [79, "    Name        = \"grafana\"\n"], [80, "    Environment = var.environment\n"], [81, "  }\n"], [82, "}\n"]], "file_path": "\\modules\\monitoring\\grafana.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf", "repo_file_path": "/modules/monitoring/grafana.tf", "file_line_range": [1, 82], "resource": "module.ecs_jenkins_github.module.monitoring.aws_ecs_task_definition.grafana", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSTaskDefinitionRoleCheck", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "grafana"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-the-aws-execution-role-arn-and-task-role-arn-are-different-in-ecs-task-definitions", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf"}, {"check_id": "CKV_AWS_329", "bc_check_id": "BC_AWS_GENERAL_235", "check_name": "EFS access points should enforce a root directory", "check_result": {"result": "PASSED", "evaluated_keys": ["root_directory/[0]/path"]}, "code_block": [[84, "resource \"aws_efs_access_point\" \"grafana_ap\" {\n"], [85, "  file_system_id = aws_efs_file_system.monitoring_data.id\n"], [86, "\n"], [87, "  posix_user {\n"], [88, "    uid = 472 # grafana user\n"], [89, "    gid = 472 # grafana group\n"], [90, "  }\n"], [91, "\n"], [92, "  root_directory {\n"], [93, "    path = \"/grafana-data\"\n"], [94, "    creation_info {\n"], [95, "      owner_uid   = 472\n"], [96, "      owner_gid   = 472\n"], [97, "      permissions = \"755\"\n"], [98, "    }\n"], [99, "  }\n"], [100, "}\n"]], "file_path": "\\modules\\monitoring\\grafana.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf", "repo_file_path": "/modules/monitoring/grafana.tf", "file_line_range": [84, 100], "resource": "module.ecs_jenkins_github.module.monitoring.aws_efs_access_point.grafana_ap", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EFSAccessPointRoot", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-329", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf"}, {"check_id": "CKV_AWS_330", "bc_check_id": "BC_AWS_GENERAL_236", "check_name": "EFS access points should enforce a user identity", "check_result": {"result": "PASSED", "evaluated_keys": ["posix_user/[0]/gid"]}, "code_block": [[84, "resource \"aws_efs_access_point\" \"grafana_ap\" {\n"], [85, "  file_system_id = aws_efs_file_system.monitoring_data.id\n"], [86, "\n"], [87, "  posix_user {\n"], [88, "    uid = 472 # grafana user\n"], [89, "    gid = 472 # grafana group\n"], [90, "  }\n"], [91, "\n"], [92, "  root_directory {\n"], [93, "    path = \"/grafana-data\"\n"], [94, "    creation_info {\n"], [95, "      owner_uid   = 472\n"], [96, "      owner_gid   = 472\n"], [97, "      permissions = \"755\"\n"], [98, "    }\n"], [99, "  }\n"], [100, "}\n"]], "file_path": "\\modules\\monitoring\\grafana.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf", "repo_file_path": "/modules/monitoring/grafana.tf", "file_line_range": [84, 100], "resource": "module.ecs_jenkins_github.module.monitoring.aws_efs_access_point.grafana_ap", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EFSAccessUserIdentity", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-330", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf"}, {"check_id": "CKV_AWS_332", "bc_check_id": "BC_AWS_GENERAL_238", "check_name": "Ensure ECS Fargate services run on the latest Fargate platform version", "check_result": {"result": "PASSED", "evaluated_keys": ["launch_type", "platform_version"]}, "code_block": [[102, "resource \"aws_ecs_service\" \"grafana\" {\n"], [103, "  name            = \"grafana\"\n"], [104, "  cluster         = var.ecs_cluster_id\n"], [105, "  task_definition = aws_ecs_task_definition.grafana.arn\n"], [106, "  desired_count   = 1\n"], [107, "  launch_type     = \"FARGATE\"\n"], [108, "\n"], [109, "  network_configuration {\n"], [110, "    subnets          = var.private_subnet_ids\n"], [111, "    security_groups  = [aws_security_group.monitoring_sg.id]\n"], [112, "    assign_public_ip = false\n"], [113, "  }\n"], [114, "\n"], [115, "  load_balancer {\n"], [116, "    target_group_arn = aws_lb_target_group.grafana.arn\n"], [117, "    container_name   = \"grafana\"\n"], [118, "    container_port   = 3000\n"], [119, "  }\n"], [120, "\n"], [121, "  depends_on = [aws_efs_mount_target.monitoring_mount]\n"], [122, "}\n"]], "file_path": "\\modules\\monitoring\\grafana.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf", "repo_file_path": "/modules/monitoring/grafana.tf", "file_line_range": [102, 122], "resource": "module.ecs_jenkins_github.module.monitoring.aws_ecs_service.grafana", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSServiceFargateLatest", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-332", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf"}, {"check_id": "CKV_AWS_333", "bc_check_id": "BC_AWS_LOGGING_45", "check_name": "Ensure ECS services do not have public IP addresses assigned to them automatically", "check_result": {"result": "PASSED", "evaluated_keys": ["network_configuration/[0]/assign_public_ip"]}, "code_block": [[102, "resource \"aws_ecs_service\" \"grafana\" {\n"], [103, "  name            = \"grafana\"\n"], [104, "  cluster         = var.ecs_cluster_id\n"], [105, "  task_definition = aws_ecs_task_definition.grafana.arn\n"], [106, "  desired_count   = 1\n"], [107, "  launch_type     = \"FARGATE\"\n"], [108, "\n"], [109, "  network_configuration {\n"], [110, "    subnets          = var.private_subnet_ids\n"], [111, "    security_groups  = [aws_security_group.monitoring_sg.id]\n"], [112, "    assign_public_ip = false\n"], [113, "  }\n"], [114, "\n"], [115, "  load_balancer {\n"], [116, "    target_group_arn = aws_lb_target_group.grafana.arn\n"], [117, "    container_name   = \"grafana\"\n"], [118, "    container_port   = 3000\n"], [119, "  }\n"], [120, "\n"], [121, "  depends_on = [aws_efs_mount_target.monitoring_mount]\n"], [122, "}\n"]], "file_path": "\\modules\\monitoring\\grafana.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf", "repo_file_path": "/modules/monitoring/grafana.tf", "file_line_range": [102, 122], "resource": "module.ecs_jenkins_github.module.monitoring.aws_ecs_service.grafana", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSServicePublicIP", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-333", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf"}, {"check_id": "CKV_AWS_261", "bc_check_id": "BC_AWS_GENERAL_177", "check_name": "Ensure HTTP HTTPS Target group defines Healthcheck", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[124, "resource \"aws_lb_target_group\" \"grafana\" {\n"], [125, "  name        = \"grafana-tg\"\n"], [126, "  port        = 3000\n"], [127, "  protocol    = \"HTTP\"\n"], [128, "  vpc_id      = var.vpc_id\n"], [129, "  target_type = \"ip\"\n"], [130, "\n"], [131, "  health_check {\n"], [132, "    path                = \"/api/health\"\n"], [133, "    interval            = 30\n"], [134, "    timeout             = 5\n"], [135, "    healthy_threshold   = 3\n"], [136, "    unhealthy_threshold = 3\n"], [137, "    matcher             = \"200\"\n"], [138, "  }\n"], [139, "}\n"]], "file_path": "\\modules\\monitoring\\grafana.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf", "repo_file_path": "/modules/monitoring/grafana.tf", "file_line_range": [124, 139], "resource": "module.ecs_jenkins_github.module.monitoring.aws_lb_target_group.grafana", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LBTargetGroupsDefinesHealthcheck", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-kendra-index-server-side-encryption-uses-customer-managed-keys-cmks", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf"}, {"check_id": "CKV_AWS_335", "bc_check_id": "BC_AWS_GENERAL_240", "check_name": "Ensure ECS task definitions should not share the host's process namespace", "check_result": {"result": "PASSED", "evaluated_keys": ["container_definitions"]}, "code_block": [[1, "resource \"aws_ecs_task_definition\" \"grafana\" {\n"], [2, "  family                   = \"grafana\"\n"], [3, "  network_mode             = \"awsvpc\"\n"], [4, "  requires_compatibilities = [\"FARGATE\"]\n"], [5, "  cpu                      = var.grafana_cpu\n"], [6, "  memory                   = var.grafana_memory\n"], [7, "  execution_role_arn       = var.execution_role_arn\n"], [8, "  task_role_arn            = var.task_role_arn\n"], [9, "\n"], [10, "  container_definitions = jsonencode([\n"], [11, "    {\n"], [12, "      name      = \"grafana\"\n"], [13, "      image     = \"grafana/grafana:9.5.1\"\n"], [14, "      essential = true\n"], [15, "\n"], [16, "      portMappings = [\n"], [17, "        {\n"], [18, "          containerPort = 3000\n"], [19, "          hostPort      = 3000\n"], [20, "          protocol      = \"tcp\"\n"], [21, "        }\n"], [22, "      ]\n"], [23, "\n"], [24, "      environment = [\n"], [25, "        {\n"], [26, "          name  = \"GF_AUTH_ANONYMOUS_ENABLED\"\n"], [27, "          value = \"false\"\n"], [28, "        },\n"], [29, "        {\n"], [30, "          name  = \"GF_SECURITY_ADMIN_PASSWORD\"\n"], [31, "          value = var.grafana_admin_password\n"], [32, "        },\n"], [33, "        {\n"], [34, "          name  = \"GF_INSTALL_PLUGINS\"\n"], [35, "          value = \"grafana-clock-panel,grafana-simple-json-datasource\"\n"], [36, "        },\n"], [37, "        {\n"], [38, "          name  = \"GF_SERVER_ROOT_URL\"\n"], [39, "          value = \"https://${var.domain_name}/grafana\"\n"], [40, "        },\n"], [41, "        {\n"], [42, "          name  = \"GF_SERVER_SERVE_FROM_SUB_PATH\"\n"], [43, "          value = \"true\"\n"], [44, "        }\n"], [45, "      ]\n"], [46, "\n"], [47, "      mountPoints = [\n"], [48, "        {\n"], [49, "          sourceVolume  = \"grafana-data\"\n"], [50, "          containerPath = \"/var/lib/grafana\"\n"], [51, "          readOnly      = false\n"], [52, "        }\n"], [53, "      ]\n"], [54, "\n"], [55, "      logConfiguration = {\n"], [56, "        logDriver = \"awslogs\",\n"], [57, "        options = {\n"], [58, "          \"awslogs-group\"         = aws_cloudwatch_log_group.grafana_logs.name,\n"], [59, "          \"awslogs-region\"        = var.aws_region,\n"], [60, "          \"awslogs-stream-prefix\" = \"grafana\"\n"], [61, "        }\n"], [62, "      }\n"], [63, "    }\n"], [64, "  ])\n"], [65, "\n"], [66, "  volume {\n"], [67, "    name = \"grafana-data\"\n"], [68, "    efs_volume_configuration {\n"], [69, "      file_system_id     = aws_efs_file_system.monitoring_data.id\n"], [70, "      transit_encryption = \"ENABLED\"\n"], [71, "      authorization_config {\n"], [72, "        access_point_id = aws_efs_access_point.grafana_ap.id\n"], [73, "        iam             = \"ENABLED\"\n"], [74, "      }\n"], [75, "    }\n"], [76, "  }\n"], [77, "\n"], [78, "  tags = {\n"], [79, "    Name        = \"grafana\"\n"], [80, "    Environment = var.environment\n"], [81, "  }\n"], [82, "}\n"]], "file_path": "\\modules\\monitoring\\grafana.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf", "repo_file_path": "/modules/monitoring/grafana.tf", "file_line_range": [1, 82], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_ecs_task_definition.grafana", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSContainerHostProcess", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "grafana"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-335", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf"}, {"check_id": "CKV_AWS_334", "bc_check_id": "BC_AWS_GENERAL_239", "check_name": "Ensure ECS containers should run as non-privileged", "check_result": {"result": "PASSED", "evaluated_keys": ["container_definitions"]}, "code_block": [[1, "resource \"aws_ecs_task_definition\" \"grafana\" {\n"], [2, "  family                   = \"grafana\"\n"], [3, "  network_mode             = \"awsvpc\"\n"], [4, "  requires_compatibilities = [\"FARGATE\"]\n"], [5, "  cpu                      = var.grafana_cpu\n"], [6, "  memory                   = var.grafana_memory\n"], [7, "  execution_role_arn       = var.execution_role_arn\n"], [8, "  task_role_arn            = var.task_role_arn\n"], [9, "\n"], [10, "  container_definitions = jsonencode([\n"], [11, "    {\n"], [12, "      name      = \"grafana\"\n"], [13, "      image     = \"grafana/grafana:9.5.1\"\n"], [14, "      essential = true\n"], [15, "\n"], [16, "      portMappings = [\n"], [17, "        {\n"], [18, "          containerPort = 3000\n"], [19, "          hostPort      = 3000\n"], [20, "          protocol      = \"tcp\"\n"], [21, "        }\n"], [22, "      ]\n"], [23, "\n"], [24, "      environment = [\n"], [25, "        {\n"], [26, "          name  = \"GF_AUTH_ANONYMOUS_ENABLED\"\n"], [27, "          value = \"false\"\n"], [28, "        },\n"], [29, "        {\n"], [30, "          name  = \"GF_SECURITY_ADMIN_PASSWORD\"\n"], [31, "          value = var.grafana_admin_password\n"], [32, "        },\n"], [33, "        {\n"], [34, "          name  = \"GF_INSTALL_PLUGINS\"\n"], [35, "          value = \"grafana-clock-panel,grafana-simple-json-datasource\"\n"], [36, "        },\n"], [37, "        {\n"], [38, "          name  = \"GF_SERVER_ROOT_URL\"\n"], [39, "          value = \"https://${var.domain_name}/grafana\"\n"], [40, "        },\n"], [41, "        {\n"], [42, "          name  = \"GF_SERVER_SERVE_FROM_SUB_PATH\"\n"], [43, "          value = \"true\"\n"], [44, "        }\n"], [45, "      ]\n"], [46, "\n"], [47, "      mountPoints = [\n"], [48, "        {\n"], [49, "          sourceVolume  = \"grafana-data\"\n"], [50, "          containerPath = \"/var/lib/grafana\"\n"], [51, "          readOnly      = false\n"], [52, "        }\n"], [53, "      ]\n"], [54, "\n"], [55, "      logConfiguration = {\n"], [56, "        logDriver = \"awslogs\",\n"], [57, "        options = {\n"], [58, "          \"awslogs-group\"         = aws_cloudwatch_log_group.grafana_logs.name,\n"], [59, "          \"awslogs-region\"        = var.aws_region,\n"], [60, "          \"awslogs-stream-prefix\" = \"grafana\"\n"], [61, "        }\n"], [62, "      }\n"], [63, "    }\n"], [64, "  ])\n"], [65, "\n"], [66, "  volume {\n"], [67, "    name = \"grafana-data\"\n"], [68, "    efs_volume_configuration {\n"], [69, "      file_system_id     = aws_efs_file_system.monitoring_data.id\n"], [70, "      transit_encryption = \"ENABLED\"\n"], [71, "      authorization_config {\n"], [72, "        access_point_id = aws_efs_access_point.grafana_ap.id\n"], [73, "        iam             = \"ENABLED\"\n"], [74, "      }\n"], [75, "    }\n"], [76, "  }\n"], [77, "\n"], [78, "  tags = {\n"], [79, "    Name        = \"grafana\"\n"], [80, "    Environment = var.environment\n"], [81, "  }\n"], [82, "}\n"]], "file_path": "\\modules\\monitoring\\grafana.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf", "repo_file_path": "/modules/monitoring/grafana.tf", "file_line_range": [1, 82], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_ecs_task_definition.grafana", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSContainerPrivilege", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "grafana"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-334", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf"}, {"check_id": "CKV_AWS_97", "bc_check_id": "BC_AWS_GENERAL_39", "check_name": "Ensure Encryption in transit is enabled for EFS volumes in ECS Task definitions", "check_result": {"result": "PASSED", "evaluated_keys": ["volume/[0]/efs_volume_configuration/[0]"]}, "code_block": [[1, "resource \"aws_ecs_task_definition\" \"grafana\" {\n"], [2, "  family                   = \"grafana\"\n"], [3, "  network_mode             = \"awsvpc\"\n"], [4, "  requires_compatibilities = [\"FARGATE\"]\n"], [5, "  cpu                      = var.grafana_cpu\n"], [6, "  memory                   = var.grafana_memory\n"], [7, "  execution_role_arn       = var.execution_role_arn\n"], [8, "  task_role_arn            = var.task_role_arn\n"], [9, "\n"], [10, "  container_definitions = jsonencode([\n"], [11, "    {\n"], [12, "      name      = \"grafana\"\n"], [13, "      image     = \"grafana/grafana:9.5.1\"\n"], [14, "      essential = true\n"], [15, "\n"], [16, "      portMappings = [\n"], [17, "        {\n"], [18, "          containerPort = 3000\n"], [19, "          hostPort      = 3000\n"], [20, "          protocol      = \"tcp\"\n"], [21, "        }\n"], [22, "      ]\n"], [23, "\n"], [24, "      environment = [\n"], [25, "        {\n"], [26, "          name  = \"GF_AUTH_ANONYMOUS_ENABLED\"\n"], [27, "          value = \"false\"\n"], [28, "        },\n"], [29, "        {\n"], [30, "          name  = \"GF_SECURITY_ADMIN_PASSWORD\"\n"], [31, "          value = var.grafana_admin_password\n"], [32, "        },\n"], [33, "        {\n"], [34, "          name  = \"GF_INSTALL_PLUGINS\"\n"], [35, "          value = \"grafana-clock-panel,grafana-simple-json-datasource\"\n"], [36, "        },\n"], [37, "        {\n"], [38, "          name  = \"GF_SERVER_ROOT_URL\"\n"], [39, "          value = \"https://${var.domain_name}/grafana\"\n"], [40, "        },\n"], [41, "        {\n"], [42, "          name  = \"GF_SERVER_SERVE_FROM_SUB_PATH\"\n"], [43, "          value = \"true\"\n"], [44, "        }\n"], [45, "      ]\n"], [46, "\n"], [47, "      mountPoints = [\n"], [48, "        {\n"], [49, "          sourceVolume  = \"grafana-data\"\n"], [50, "          containerPath = \"/var/lib/grafana\"\n"], [51, "          readOnly      = false\n"], [52, "        }\n"], [53, "      ]\n"], [54, "\n"], [55, "      logConfiguration = {\n"], [56, "        logDriver = \"awslogs\",\n"], [57, "        options = {\n"], [58, "          \"awslogs-group\"         = aws_cloudwatch_log_group.grafana_logs.name,\n"], [59, "          \"awslogs-region\"        = var.aws_region,\n"], [60, "          \"awslogs-stream-prefix\" = \"grafana\"\n"], [61, "        }\n"], [62, "      }\n"], [63, "    }\n"], [64, "  ])\n"], [65, "\n"], [66, "  volume {\n"], [67, "    name = \"grafana-data\"\n"], [68, "    efs_volume_configuration {\n"], [69, "      file_system_id     = aws_efs_file_system.monitoring_data.id\n"], [70, "      transit_encryption = \"ENABLED\"\n"], [71, "      authorization_config {\n"], [72, "        access_point_id = aws_efs_access_point.grafana_ap.id\n"], [73, "        iam             = \"ENABLED\"\n"], [74, "      }\n"], [75, "    }\n"], [76, "  }\n"], [77, "\n"], [78, "  tags = {\n"], [79, "    Name        = \"grafana\"\n"], [80, "    Environment = var.environment\n"], [81, "  }\n"], [82, "}\n"]], "file_path": "\\modules\\monitoring\\grafana.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf", "repo_file_path": "/modules/monitoring/grafana.tf", "file_line_range": [1, 82], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_ecs_task_definition.grafana", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSTaskDefinitionEFSVolumeEncryption", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "grafana"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-39", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf"}, {"check_id": "CKV_AWS_249", "bc_check_id": "BC_AWS_IAM_68", "check_name": "Ensure that the Execution Role ARN and the Task Role ARN are different in ECS Task definitions", "check_result": {"result": "PASSED", "evaluated_keys": ["execution_role_arn", "task_role_arn"]}, "code_block": [[1, "resource \"aws_ecs_task_definition\" \"grafana\" {\n"], [2, "  family                   = \"grafana\"\n"], [3, "  network_mode             = \"awsvpc\"\n"], [4, "  requires_compatibilities = [\"FARGATE\"]\n"], [5, "  cpu                      = var.grafana_cpu\n"], [6, "  memory                   = var.grafana_memory\n"], [7, "  execution_role_arn       = var.execution_role_arn\n"], [8, "  task_role_arn            = var.task_role_arn\n"], [9, "\n"], [10, "  container_definitions = jsonencode([\n"], [11, "    {\n"], [12, "      name      = \"grafana\"\n"], [13, "      image     = \"grafana/grafana:9.5.1\"\n"], [14, "      essential = true\n"], [15, "\n"], [16, "      portMappings = [\n"], [17, "        {\n"], [18, "          containerPort = 3000\n"], [19, "          hostPort      = 3000\n"], [20, "          protocol      = \"tcp\"\n"], [21, "        }\n"], [22, "      ]\n"], [23, "\n"], [24, "      environment = [\n"], [25, "        {\n"], [26, "          name  = \"GF_AUTH_ANONYMOUS_ENABLED\"\n"], [27, "          value = \"false\"\n"], [28, "        },\n"], [29, "        {\n"], [30, "          name  = \"GF_SECURITY_ADMIN_PASSWORD\"\n"], [31, "          value = var.grafana_admin_password\n"], [32, "        },\n"], [33, "        {\n"], [34, "          name  = \"GF_INSTALL_PLUGINS\"\n"], [35, "          value = \"grafana-clock-panel,grafana-simple-json-datasource\"\n"], [36, "        },\n"], [37, "        {\n"], [38, "          name  = \"GF_SERVER_ROOT_URL\"\n"], [39, "          value = \"https://${var.domain_name}/grafana\"\n"], [40, "        },\n"], [41, "        {\n"], [42, "          name  = \"GF_SERVER_SERVE_FROM_SUB_PATH\"\n"], [43, "          value = \"true\"\n"], [44, "        }\n"], [45, "      ]\n"], [46, "\n"], [47, "      mountPoints = [\n"], [48, "        {\n"], [49, "          sourceVolume  = \"grafana-data\"\n"], [50, "          containerPath = \"/var/lib/grafana\"\n"], [51, "          readOnly      = false\n"], [52, "        }\n"], [53, "      ]\n"], [54, "\n"], [55, "      logConfiguration = {\n"], [56, "        logDriver = \"awslogs\",\n"], [57, "        options = {\n"], [58, "          \"awslogs-group\"         = aws_cloudwatch_log_group.grafana_logs.name,\n"], [59, "          \"awslogs-region\"        = var.aws_region,\n"], [60, "          \"awslogs-stream-prefix\" = \"grafana\"\n"], [61, "        }\n"], [62, "      }\n"], [63, "    }\n"], [64, "  ])\n"], [65, "\n"], [66, "  volume {\n"], [67, "    name = \"grafana-data\"\n"], [68, "    efs_volume_configuration {\n"], [69, "      file_system_id     = aws_efs_file_system.monitoring_data.id\n"], [70, "      transit_encryption = \"ENABLED\"\n"], [71, "      authorization_config {\n"], [72, "        access_point_id = aws_efs_access_point.grafana_ap.id\n"], [73, "        iam             = \"ENABLED\"\n"], [74, "      }\n"], [75, "    }\n"], [76, "  }\n"], [77, "\n"], [78, "  tags = {\n"], [79, "    Name        = \"grafana\"\n"], [80, "    Environment = var.environment\n"], [81, "  }\n"], [82, "}\n"]], "file_path": "\\modules\\monitoring\\grafana.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf", "repo_file_path": "/modules/monitoring/grafana.tf", "file_line_range": [1, 82], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_ecs_task_definition.grafana", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSTaskDefinitionRoleCheck", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "grafana"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-the-aws-execution-role-arn-and-task-role-arn-are-different-in-ecs-task-definitions", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf"}, {"check_id": "CKV_AWS_329", "bc_check_id": "BC_AWS_GENERAL_235", "check_name": "EFS access points should enforce a root directory", "check_result": {"result": "PASSED", "evaluated_keys": ["root_directory/[0]/path"]}, "code_block": [[84, "resource \"aws_efs_access_point\" \"grafana_ap\" {\n"], [85, "  file_system_id = aws_efs_file_system.monitoring_data.id\n"], [86, "\n"], [87, "  posix_user {\n"], [88, "    uid = 472 # grafana user\n"], [89, "    gid = 472 # grafana group\n"], [90, "  }\n"], [91, "\n"], [92, "  root_directory {\n"], [93, "    path = \"/grafana-data\"\n"], [94, "    creation_info {\n"], [95, "      owner_uid   = 472\n"], [96, "      owner_gid   = 472\n"], [97, "      permissions = \"755\"\n"], [98, "    }\n"], [99, "  }\n"], [100, "}\n"]], "file_path": "\\modules\\monitoring\\grafana.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf", "repo_file_path": "/modules/monitoring/grafana.tf", "file_line_range": [84, 100], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_efs_access_point.grafana_ap", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EFSAccessPointRoot", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-329", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf"}, {"check_id": "CKV_AWS_330", "bc_check_id": "BC_AWS_GENERAL_236", "check_name": "EFS access points should enforce a user identity", "check_result": {"result": "PASSED", "evaluated_keys": ["posix_user/[0]/gid"]}, "code_block": [[84, "resource \"aws_efs_access_point\" \"grafana_ap\" {\n"], [85, "  file_system_id = aws_efs_file_system.monitoring_data.id\n"], [86, "\n"], [87, "  posix_user {\n"], [88, "    uid = 472 # grafana user\n"], [89, "    gid = 472 # grafana group\n"], [90, "  }\n"], [91, "\n"], [92, "  root_directory {\n"], [93, "    path = \"/grafana-data\"\n"], [94, "    creation_info {\n"], [95, "      owner_uid   = 472\n"], [96, "      owner_gid   = 472\n"], [97, "      permissions = \"755\"\n"], [98, "    }\n"], [99, "  }\n"], [100, "}\n"]], "file_path": "\\modules\\monitoring\\grafana.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf", "repo_file_path": "/modules/monitoring/grafana.tf", "file_line_range": [84, 100], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_efs_access_point.grafana_ap", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EFSAccessUserIdentity", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-330", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf"}, {"check_id": "CKV_AWS_332", "bc_check_id": "BC_AWS_GENERAL_238", "check_name": "Ensure ECS Fargate services run on the latest Fargate platform version", "check_result": {"result": "PASSED", "evaluated_keys": ["launch_type", "platform_version"]}, "code_block": [[102, "resource \"aws_ecs_service\" \"grafana\" {\n"], [103, "  name            = \"grafana\"\n"], [104, "  cluster         = var.ecs_cluster_id\n"], [105, "  task_definition = aws_ecs_task_definition.grafana.arn\n"], [106, "  desired_count   = 1\n"], [107, "  launch_type     = \"FARGATE\"\n"], [108, "\n"], [109, "  network_configuration {\n"], [110, "    subnets          = var.private_subnet_ids\n"], [111, "    security_groups  = [aws_security_group.monitoring_sg.id]\n"], [112, "    assign_public_ip = false\n"], [113, "  }\n"], [114, "\n"], [115, "  load_balancer {\n"], [116, "    target_group_arn = aws_lb_target_group.grafana.arn\n"], [117, "    container_name   = \"grafana\"\n"], [118, "    container_port   = 3000\n"], [119, "  }\n"], [120, "\n"], [121, "  depends_on = [aws_efs_mount_target.monitoring_mount]\n"], [122, "}\n"]], "file_path": "\\modules\\monitoring\\grafana.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf", "repo_file_path": "/modules/monitoring/grafana.tf", "file_line_range": [102, 122], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_ecs_service.grafana", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSServiceFargateLatest", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-332", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf"}, {"check_id": "CKV_AWS_333", "bc_check_id": "BC_AWS_LOGGING_45", "check_name": "Ensure ECS services do not have public IP addresses assigned to them automatically", "check_result": {"result": "PASSED", "evaluated_keys": ["network_configuration/[0]/assign_public_ip"]}, "code_block": [[102, "resource \"aws_ecs_service\" \"grafana\" {\n"], [103, "  name            = \"grafana\"\n"], [104, "  cluster         = var.ecs_cluster_id\n"], [105, "  task_definition = aws_ecs_task_definition.grafana.arn\n"], [106, "  desired_count   = 1\n"], [107, "  launch_type     = \"FARGATE\"\n"], [108, "\n"], [109, "  network_configuration {\n"], [110, "    subnets          = var.private_subnet_ids\n"], [111, "    security_groups  = [aws_security_group.monitoring_sg.id]\n"], [112, "    assign_public_ip = false\n"], [113, "  }\n"], [114, "\n"], [115, "  load_balancer {\n"], [116, "    target_group_arn = aws_lb_target_group.grafana.arn\n"], [117, "    container_name   = \"grafana\"\n"], [118, "    container_port   = 3000\n"], [119, "  }\n"], [120, "\n"], [121, "  depends_on = [aws_efs_mount_target.monitoring_mount]\n"], [122, "}\n"]], "file_path": "\\modules\\monitoring\\grafana.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf", "repo_file_path": "/modules/monitoring/grafana.tf", "file_line_range": [102, 122], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_ecs_service.grafana", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSServicePublicIP", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-333", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf"}, {"check_id": "CKV_AWS_261", "bc_check_id": "BC_AWS_GENERAL_177", "check_name": "Ensure HTTP HTTPS Target group defines Healthcheck", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[124, "resource \"aws_lb_target_group\" \"grafana\" {\n"], [125, "  name        = \"grafana-tg\"\n"], [126, "  port        = 3000\n"], [127, "  protocol    = \"HTTP\"\n"], [128, "  vpc_id      = var.vpc_id\n"], [129, "  target_type = \"ip\"\n"], [130, "\n"], [131, "  health_check {\n"], [132, "    path                = \"/api/health\"\n"], [133, "    interval            = 30\n"], [134, "    timeout             = 5\n"], [135, "    healthy_threshold   = 3\n"], [136, "    unhealthy_threshold = 3\n"], [137, "    matcher             = \"200\"\n"], [138, "  }\n"], [139, "}\n"]], "file_path": "\\modules\\monitoring\\grafana.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf", "repo_file_path": "/modules/monitoring/grafana.tf", "file_line_range": [124, 139], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_lb_target_group.grafana", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LBTargetGroupsDefinesHealthcheck", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-kendra-index-server-side-encryption-uses-customer-managed-keys-cmks", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf"}, {"check_id": "CKV_AWS_382", "bc_check_id": "BC_AWS_IAM_93", "check_name": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[2, "resource \"aws_security_group\" \"monitoring_sg\" {\n"], [3, "  name        = \"monitoring-sg\"\n"], [4, "  description = \"Security group for Prometheus and Grafana\"\n"], [5, "  vpc_id      = var.vpc_id\n"], [6, "\n"], [7, "  ingress {\n"], [8, "    description     = \"Prometheus UI\"\n"], [9, "    from_port       = 9090\n"], [10, "    to_port         = 9090\n"], [11, "    protocol        = \"tcp\"\n"], [12, "    security_groups = [var.alb_security_group_id]\n"], [13, "  }\n"], [14, "\n"], [15, "  ingress {\n"], [16, "    description     = \"Grafana UI\"\n"], [17, "    from_port       = 3000\n"], [18, "    to_port         = 3000\n"], [19, "    protocol        = \"tcp\"\n"], [20, "    security_groups = [var.alb_security_group_id]\n"], [21, "  }\n"], [22, "\n"], [23, "  egress {\n"], [24, "    description = \"HTTPS to internet\"\n"], [25, "    from_port   = 443\n"], [26, "    to_port     = 443\n"], [27, "    protocol    = \"tcp\"\n"], [28, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [29, "  }\n"], [30, "\n"], [31, "  egress {\n"], [32, "    description = \"HTTP to internet\"\n"], [33, "    from_port   = 80\n"], [34, "    to_port     = 80\n"], [35, "    protocol    = \"tcp\"\n"], [36, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [37, "  }\n"], [38, "\n"], [39, "  tags = {\n"], [40, "    Name = \"monitoring-sg\"\n"], [41, "  }\n"], [42, "}\n"]], "file_path": "\\modules\\monitoring\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [2, 42], "resource": "module.ecs_jenkins_github.module.monitoring.aws_security_group.monitoring_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedEgressAny", "fixed_definition": null, "entity_tags": {"Name": "monitoring-sg"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[2, "resource \"aws_security_group\" \"monitoring_sg\" {\n"], [3, "  name        = \"monitoring-sg\"\n"], [4, "  description = \"Security group for Prometheus and Grafana\"\n"], [5, "  vpc_id      = var.vpc_id\n"], [6, "\n"], [7, "  ingress {\n"], [8, "    description     = \"Prometheus UI\"\n"], [9, "    from_port       = 9090\n"], [10, "    to_port         = 9090\n"], [11, "    protocol        = \"tcp\"\n"], [12, "    security_groups = [var.alb_security_group_id]\n"], [13, "  }\n"], [14, "\n"], [15, "  ingress {\n"], [16, "    description     = \"Grafana UI\"\n"], [17, "    from_port       = 3000\n"], [18, "    to_port         = 3000\n"], [19, "    protocol        = \"tcp\"\n"], [20, "    security_groups = [var.alb_security_group_id]\n"], [21, "  }\n"], [22, "\n"], [23, "  egress {\n"], [24, "    description = \"HTTPS to internet\"\n"], [25, "    from_port   = 443\n"], [26, "    to_port     = 443\n"], [27, "    protocol    = \"tcp\"\n"], [28, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [29, "  }\n"], [30, "\n"], [31, "  egress {\n"], [32, "    description = \"HTTP to internet\"\n"], [33, "    from_port   = 80\n"], [34, "    to_port     = 80\n"], [35, "    protocol    = \"tcp\"\n"], [36, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [37, "  }\n"], [38, "\n"], [39, "  tags = {\n"], [40, "    Name = \"monitoring-sg\"\n"], [41, "  }\n"], [42, "}\n"]], "file_path": "\\modules\\monitoring\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [2, 42], "resource": "module.ecs_jenkins_github.module.monitoring.aws_security_group.monitoring_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": {"Name": "monitoring-sg"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-2", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_260", "bc_check_id": "BC_AWS_NETWORKING_67", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[2, "resource \"aws_security_group\" \"monitoring_sg\" {\n"], [3, "  name        = \"monitoring-sg\"\n"], [4, "  description = \"Security group for Prometheus and Grafana\"\n"], [5, "  vpc_id      = var.vpc_id\n"], [6, "\n"], [7, "  ingress {\n"], [8, "    description     = \"Prometheus UI\"\n"], [9, "    from_port       = 9090\n"], [10, "    to_port         = 9090\n"], [11, "    protocol        = \"tcp\"\n"], [12, "    security_groups = [var.alb_security_group_id]\n"], [13, "  }\n"], [14, "\n"], [15, "  ingress {\n"], [16, "    description     = \"Grafana UI\"\n"], [17, "    from_port       = 3000\n"], [18, "    to_port         = 3000\n"], [19, "    protocol        = \"tcp\"\n"], [20, "    security_groups = [var.alb_security_group_id]\n"], [21, "  }\n"], [22, "\n"], [23, "  egress {\n"], [24, "    description = \"HTTPS to internet\"\n"], [25, "    from_port   = 443\n"], [26, "    to_port     = 443\n"], [27, "    protocol    = \"tcp\"\n"], [28, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [29, "  }\n"], [30, "\n"], [31, "  egress {\n"], [32, "    description = \"HTTP to internet\"\n"], [33, "    from_port   = 80\n"], [34, "    to_port     = 80\n"], [35, "    protocol    = \"tcp\"\n"], [36, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [37, "  }\n"], [38, "\n"], [39, "  tags = {\n"], [40, "    Name = \"monitoring-sg\"\n"], [41, "  }\n"], [42, "}\n"]], "file_path": "\\modules\\monitoring\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [2, 42], "resource": "module.ecs_jenkins_github.module.monitoring.aws_security_group.monitoring_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress80", "fixed_definition": null, "entity_tags": {"Name": "monitoring-sg"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_277", "bc_check_id": "BC_AWS_NETWORKING_78", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[2, "resource \"aws_security_group\" \"monitoring_sg\" {\n"], [3, "  name        = \"monitoring-sg\"\n"], [4, "  description = \"Security group for Prometheus and Grafana\"\n"], [5, "  vpc_id      = var.vpc_id\n"], [6, "\n"], [7, "  ingress {\n"], [8, "    description     = \"Prometheus UI\"\n"], [9, "    from_port       = 9090\n"], [10, "    to_port         = 9090\n"], [11, "    protocol        = \"tcp\"\n"], [12, "    security_groups = [var.alb_security_group_id]\n"], [13, "  }\n"], [14, "\n"], [15, "  ingress {\n"], [16, "    description     = \"Grafana UI\"\n"], [17, "    from_port       = 3000\n"], [18, "    to_port         = 3000\n"], [19, "    protocol        = \"tcp\"\n"], [20, "    security_groups = [var.alb_security_group_id]\n"], [21, "  }\n"], [22, "\n"], [23, "  egress {\n"], [24, "    description = \"HTTPS to internet\"\n"], [25, "    from_port   = 443\n"], [26, "    to_port     = 443\n"], [27, "    protocol    = \"tcp\"\n"], [28, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [29, "  }\n"], [30, "\n"], [31, "  egress {\n"], [32, "    description = \"HTTP to internet\"\n"], [33, "    from_port   = 80\n"], [34, "    to_port     = 80\n"], [35, "    protocol    = \"tcp\"\n"], [36, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [37, "  }\n"], [38, "\n"], [39, "  tags = {\n"], [40, "    Name = \"monitoring-sg\"\n"], [41, "  }\n"], [42, "}\n"]], "file_path": "\\modules\\monitoring\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [2, 42], "resource": "module.ecs_jenkins_github.module.monitoring.aws_security_group.monitoring_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngressAny", "fixed_definition": null, "entity_tags": {"Name": "monitoring-sg"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-group-does-not-allow-all-traffic-on-all-ports", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_66", "bc_check_id": "BC_AWS_LOGGING_13", "check_name": "Ensure that CloudWatch Log Group specifies retention days", "check_result": {"result": "PASSED", "evaluated_keys": ["retention_in_days"]}, "code_block": [[45, "resource \"aws_cloudwatch_log_group\" \"prometheus_logs\" {\n"], [46, "  name              = \"/ecs/prometheus\"\n"], [47, "  retention_in_days = 30\n"], [48, "}\n"]], "file_path": "\\modules\\monitoring\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [45, 48], "resource": "module.ecs_jenkins_github.module.monitoring.aws_cloudwatch_log_group.prometheus_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetention", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-13", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_66", "bc_check_id": "BC_AWS_LOGGING_13", "check_name": "Ensure that CloudWatch Log Group specifies retention days", "check_result": {"result": "PASSED", "evaluated_keys": ["retention_in_days"]}, "code_block": [[50, "resource \"aws_cloudwatch_log_group\" \"grafana_logs\" {\n"], [51, "  name              = \"/ecs/grafana\"\n"], [52, "  retention_in_days = 30\n"], [53, "}\n"]], "file_path": "\\modules\\monitoring\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [50, 53], "resource": "module.ecs_jenkins_github.module.monitoring.aws_cloudwatch_log_group.grafana_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetention", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-13", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_42", "bc_check_id": "BC_AWS_GENERAL_17", "check_name": "Ensure EFS is securely encrypted", "check_result": {"result": "PASSED", "evaluated_keys": ["encrypted"]}, "code_block": [[56, "resource \"aws_efs_file_system\" \"monitoring_data\" {\n"], [57, "  encrypted        = true\n"], [58, "  performance_mode = \"generalPurpose\"\n"], [59, "\n"], [60, "  tags = {\n"], [61, "    Name = \"monitoring-data\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "\\modules\\monitoring\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [56, 63], "resource": "module.ecs_jenkins_github.module.monitoring.aws_efs_file_system.monitoring_data", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EFSEncryptionEnabled", "fixed_definition": null, "entity_tags": {"Name": "monitoring-data"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-17", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_332", "bc_check_id": "BC_AWS_GENERAL_238", "check_name": "Ensure ECS Fargate services run on the latest Fargate platform version", "check_result": {"result": "PASSED", "evaluated_keys": ["launch_type", "platform_version"]}, "code_block": [[73, "resource \"aws_ecs_service\" \"prometheus\" {\n"], [74, "  name            = \"prometheus\"\n"], [75, "  cluster         = var.ecs_cluster_id\n"], [76, "  task_definition = aws_ecs_task_definition.prometheus.arn\n"], [77, "  desired_count   = 1\n"], [78, "  launch_type     = \"FARGATE\"\n"], [79, "\n"], [80, "  network_configuration {\n"], [81, "    subnets          = var.private_subnet_ids\n"], [82, "    security_groups  = [aws_security_group.monitoring_sg.id]\n"], [83, "    assign_public_ip = false\n"], [84, "  }\n"], [85, "\n"], [86, "  load_balancer {\n"], [87, "    target_group_arn = aws_lb_target_group.prometheus.arn\n"], [88, "    container_name   = \"prometheus\"\n"], [89, "    container_port   = 9090\n"], [90, "  }\n"], [91, "}\n"]], "file_path": "\\modules\\monitoring\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [73, 91], "resource": "module.ecs_jenkins_github.module.monitoring.aws_ecs_service.prometheus", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSServiceFargateLatest", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-332", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_333", "bc_check_id": "BC_AWS_LOGGING_45", "check_name": "Ensure ECS services do not have public IP addresses assigned to them automatically", "check_result": {"result": "PASSED", "evaluated_keys": ["network_configuration/[0]/assign_public_ip"]}, "code_block": [[73, "resource \"aws_ecs_service\" \"prometheus\" {\n"], [74, "  name            = \"prometheus\"\n"], [75, "  cluster         = var.ecs_cluster_id\n"], [76, "  task_definition = aws_ecs_task_definition.prometheus.arn\n"], [77, "  desired_count   = 1\n"], [78, "  launch_type     = \"FARGATE\"\n"], [79, "\n"], [80, "  network_configuration {\n"], [81, "    subnets          = var.private_subnet_ids\n"], [82, "    security_groups  = [aws_security_group.monitoring_sg.id]\n"], [83, "    assign_public_ip = false\n"], [84, "  }\n"], [85, "\n"], [86, "  load_balancer {\n"], [87, "    target_group_arn = aws_lb_target_group.prometheus.arn\n"], [88, "    container_name   = \"prometheus\"\n"], [89, "    container_port   = 9090\n"], [90, "  }\n"], [91, "}\n"]], "file_path": "\\modules\\monitoring\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [73, 91], "resource": "module.ecs_jenkins_github.module.monitoring.aws_ecs_service.prometheus", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSServicePublicIP", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-333", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_261", "bc_check_id": "BC_AWS_GENERAL_177", "check_name": "Ensure HTTP HTTPS Target group defines Healthcheck", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[93, "resource \"aws_lb_target_group\" \"prometheus\" {\n"], [94, "  name        = \"prometheus-tg\"\n"], [95, "  port        = 9090\n"], [96, "  protocol    = \"HTTP\"\n"], [97, "  vpc_id      = var.vpc_id\n"], [98, "  target_type = \"ip\"\n"], [99, "\n"], [100, "  health_check {\n"], [101, "    path                = \"/-/healthy\"\n"], [102, "    interval            = 30\n"], [103, "    timeout             = 5\n"], [104, "    healthy_threshold   = 3\n"], [105, "    unhealthy_threshold = 3\n"], [106, "    matcher             = \"200\"\n"], [107, "  }\n"], [108, "}\n"]], "file_path": "\\modules\\monitoring\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [93, 108], "resource": "module.ecs_jenkins_github.module.monitoring.aws_lb_target_group.prometheus", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LBTargetGroupsDefinesHealthcheck", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-kendra-index-server-side-encryption-uses-customer-managed-keys-cmks", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_382", "bc_check_id": "BC_AWS_IAM_93", "check_name": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[2, "resource \"aws_security_group\" \"monitoring_sg\" {\n"], [3, "  name        = \"monitoring-sg\"\n"], [4, "  description = \"Security group for Prometheus and Grafana\"\n"], [5, "  vpc_id      = var.vpc_id\n"], [6, "\n"], [7, "  ingress {\n"], [8, "    description     = \"Prometheus UI\"\n"], [9, "    from_port       = 9090\n"], [10, "    to_port         = 9090\n"], [11, "    protocol        = \"tcp\"\n"], [12, "    security_groups = [var.alb_security_group_id]\n"], [13, "  }\n"], [14, "\n"], [15, "  ingress {\n"], [16, "    description     = \"Grafana UI\"\n"], [17, "    from_port       = 3000\n"], [18, "    to_port         = 3000\n"], [19, "    protocol        = \"tcp\"\n"], [20, "    security_groups = [var.alb_security_group_id]\n"], [21, "  }\n"], [22, "\n"], [23, "  egress {\n"], [24, "    description = \"HTTPS to internet\"\n"], [25, "    from_port   = 443\n"], [26, "    to_port     = 443\n"], [27, "    protocol    = \"tcp\"\n"], [28, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [29, "  }\n"], [30, "\n"], [31, "  egress {\n"], [32, "    description = \"HTTP to internet\"\n"], [33, "    from_port   = 80\n"], [34, "    to_port     = 80\n"], [35, "    protocol    = \"tcp\"\n"], [36, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [37, "  }\n"], [38, "\n"], [39, "  tags = {\n"], [40, "    Name = \"monitoring-sg\"\n"], [41, "  }\n"], [42, "}\n"]], "file_path": "\\modules\\monitoring\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [2, 42], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_security_group.monitoring_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedEgressAny", "fixed_definition": null, "entity_tags": {"Name": "monitoring-sg"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[2, "resource \"aws_security_group\" \"monitoring_sg\" {\n"], [3, "  name        = \"monitoring-sg\"\n"], [4, "  description = \"Security group for Prometheus and Grafana\"\n"], [5, "  vpc_id      = var.vpc_id\n"], [6, "\n"], [7, "  ingress {\n"], [8, "    description     = \"Prometheus UI\"\n"], [9, "    from_port       = 9090\n"], [10, "    to_port         = 9090\n"], [11, "    protocol        = \"tcp\"\n"], [12, "    security_groups = [var.alb_security_group_id]\n"], [13, "  }\n"], [14, "\n"], [15, "  ingress {\n"], [16, "    description     = \"Grafana UI\"\n"], [17, "    from_port       = 3000\n"], [18, "    to_port         = 3000\n"], [19, "    protocol        = \"tcp\"\n"], [20, "    security_groups = [var.alb_security_group_id]\n"], [21, "  }\n"], [22, "\n"], [23, "  egress {\n"], [24, "    description = \"HTTPS to internet\"\n"], [25, "    from_port   = 443\n"], [26, "    to_port     = 443\n"], [27, "    protocol    = \"tcp\"\n"], [28, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [29, "  }\n"], [30, "\n"], [31, "  egress {\n"], [32, "    description = \"HTTP to internet\"\n"], [33, "    from_port   = 80\n"], [34, "    to_port     = 80\n"], [35, "    protocol    = \"tcp\"\n"], [36, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [37, "  }\n"], [38, "\n"], [39, "  tags = {\n"], [40, "    Name = \"monitoring-sg\"\n"], [41, "  }\n"], [42, "}\n"]], "file_path": "\\modules\\monitoring\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [2, 42], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_security_group.monitoring_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": {"Name": "monitoring-sg"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-2", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_260", "bc_check_id": "BC_AWS_NETWORKING_67", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[2, "resource \"aws_security_group\" \"monitoring_sg\" {\n"], [3, "  name        = \"monitoring-sg\"\n"], [4, "  description = \"Security group for Prometheus and Grafana\"\n"], [5, "  vpc_id      = var.vpc_id\n"], [6, "\n"], [7, "  ingress {\n"], [8, "    description     = \"Prometheus UI\"\n"], [9, "    from_port       = 9090\n"], [10, "    to_port         = 9090\n"], [11, "    protocol        = \"tcp\"\n"], [12, "    security_groups = [var.alb_security_group_id]\n"], [13, "  }\n"], [14, "\n"], [15, "  ingress {\n"], [16, "    description     = \"Grafana UI\"\n"], [17, "    from_port       = 3000\n"], [18, "    to_port         = 3000\n"], [19, "    protocol        = \"tcp\"\n"], [20, "    security_groups = [var.alb_security_group_id]\n"], [21, "  }\n"], [22, "\n"], [23, "  egress {\n"], [24, "    description = \"HTTPS to internet\"\n"], [25, "    from_port   = 443\n"], [26, "    to_port     = 443\n"], [27, "    protocol    = \"tcp\"\n"], [28, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [29, "  }\n"], [30, "\n"], [31, "  egress {\n"], [32, "    description = \"HTTP to internet\"\n"], [33, "    from_port   = 80\n"], [34, "    to_port     = 80\n"], [35, "    protocol    = \"tcp\"\n"], [36, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [37, "  }\n"], [38, "\n"], [39, "  tags = {\n"], [40, "    Name = \"monitoring-sg\"\n"], [41, "  }\n"], [42, "}\n"]], "file_path": "\\modules\\monitoring\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [2, 42], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_security_group.monitoring_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress80", "fixed_definition": null, "entity_tags": {"Name": "monitoring-sg"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_277", "bc_check_id": "BC_AWS_NETWORKING_78", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[2, "resource \"aws_security_group\" \"monitoring_sg\" {\n"], [3, "  name        = \"monitoring-sg\"\n"], [4, "  description = \"Security group for Prometheus and Grafana\"\n"], [5, "  vpc_id      = var.vpc_id\n"], [6, "\n"], [7, "  ingress {\n"], [8, "    description     = \"Prometheus UI\"\n"], [9, "    from_port       = 9090\n"], [10, "    to_port         = 9090\n"], [11, "    protocol        = \"tcp\"\n"], [12, "    security_groups = [var.alb_security_group_id]\n"], [13, "  }\n"], [14, "\n"], [15, "  ingress {\n"], [16, "    description     = \"Grafana UI\"\n"], [17, "    from_port       = 3000\n"], [18, "    to_port         = 3000\n"], [19, "    protocol        = \"tcp\"\n"], [20, "    security_groups = [var.alb_security_group_id]\n"], [21, "  }\n"], [22, "\n"], [23, "  egress {\n"], [24, "    description = \"HTTPS to internet\"\n"], [25, "    from_port   = 443\n"], [26, "    to_port     = 443\n"], [27, "    protocol    = \"tcp\"\n"], [28, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [29, "  }\n"], [30, "\n"], [31, "  egress {\n"], [32, "    description = \"HTTP to internet\"\n"], [33, "    from_port   = 80\n"], [34, "    to_port     = 80\n"], [35, "    protocol    = \"tcp\"\n"], [36, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [37, "  }\n"], [38, "\n"], [39, "  tags = {\n"], [40, "    Name = \"monitoring-sg\"\n"], [41, "  }\n"], [42, "}\n"]], "file_path": "\\modules\\monitoring\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [2, 42], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_security_group.monitoring_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngressAny", "fixed_definition": null, "entity_tags": {"Name": "monitoring-sg"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-group-does-not-allow-all-traffic-on-all-ports", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_66", "bc_check_id": "BC_AWS_LOGGING_13", "check_name": "Ensure that CloudWatch Log Group specifies retention days", "check_result": {"result": "PASSED", "evaluated_keys": ["retention_in_days"]}, "code_block": [[45, "resource \"aws_cloudwatch_log_group\" \"prometheus_logs\" {\n"], [46, "  name              = \"/ecs/prometheus\"\n"], [47, "  retention_in_days = 30\n"], [48, "}\n"]], "file_path": "\\modules\\monitoring\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [45, 48], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_cloudwatch_log_group.prometheus_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetention", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-13", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_66", "bc_check_id": "BC_AWS_LOGGING_13", "check_name": "Ensure that CloudWatch Log Group specifies retention days", "check_result": {"result": "PASSED", "evaluated_keys": ["retention_in_days"]}, "code_block": [[50, "resource \"aws_cloudwatch_log_group\" \"grafana_logs\" {\n"], [51, "  name              = \"/ecs/grafana\"\n"], [52, "  retention_in_days = 30\n"], [53, "}\n"]], "file_path": "\\modules\\monitoring\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [50, 53], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_cloudwatch_log_group.grafana_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetention", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-13", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_42", "bc_check_id": "BC_AWS_GENERAL_17", "check_name": "Ensure EFS is securely encrypted", "check_result": {"result": "PASSED", "evaluated_keys": ["encrypted"]}, "code_block": [[56, "resource \"aws_efs_file_system\" \"monitoring_data\" {\n"], [57, "  encrypted        = true\n"], [58, "  performance_mode = \"generalPurpose\"\n"], [59, "\n"], [60, "  tags = {\n"], [61, "    Name = \"monitoring-data\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "\\modules\\monitoring\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [56, 63], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_efs_file_system.monitoring_data", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EFSEncryptionEnabled", "fixed_definition": null, "entity_tags": {"Name": "monitoring-data"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-17", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_332", "bc_check_id": "BC_AWS_GENERAL_238", "check_name": "Ensure ECS Fargate services run on the latest Fargate platform version", "check_result": {"result": "PASSED", "evaluated_keys": ["launch_type", "platform_version"]}, "code_block": [[73, "resource \"aws_ecs_service\" \"prometheus\" {\n"], [74, "  name            = \"prometheus\"\n"], [75, "  cluster         = var.ecs_cluster_id\n"], [76, "  task_definition = aws_ecs_task_definition.prometheus.arn\n"], [77, "  desired_count   = 1\n"], [78, "  launch_type     = \"FARGATE\"\n"], [79, "\n"], [80, "  network_configuration {\n"], [81, "    subnets          = var.private_subnet_ids\n"], [82, "    security_groups  = [aws_security_group.monitoring_sg.id]\n"], [83, "    assign_public_ip = false\n"], [84, "  }\n"], [85, "\n"], [86, "  load_balancer {\n"], [87, "    target_group_arn = aws_lb_target_group.prometheus.arn\n"], [88, "    container_name   = \"prometheus\"\n"], [89, "    container_port   = 9090\n"], [90, "  }\n"], [91, "}\n"]], "file_path": "\\modules\\monitoring\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [73, 91], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_ecs_service.prometheus", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSServiceFargateLatest", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-332", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_333", "bc_check_id": "BC_AWS_LOGGING_45", "check_name": "Ensure ECS services do not have public IP addresses assigned to them automatically", "check_result": {"result": "PASSED", "evaluated_keys": ["network_configuration/[0]/assign_public_ip"]}, "code_block": [[73, "resource \"aws_ecs_service\" \"prometheus\" {\n"], [74, "  name            = \"prometheus\"\n"], [75, "  cluster         = var.ecs_cluster_id\n"], [76, "  task_definition = aws_ecs_task_definition.prometheus.arn\n"], [77, "  desired_count   = 1\n"], [78, "  launch_type     = \"FARGATE\"\n"], [79, "\n"], [80, "  network_configuration {\n"], [81, "    subnets          = var.private_subnet_ids\n"], [82, "    security_groups  = [aws_security_group.monitoring_sg.id]\n"], [83, "    assign_public_ip = false\n"], [84, "  }\n"], [85, "\n"], [86, "  load_balancer {\n"], [87, "    target_group_arn = aws_lb_target_group.prometheus.arn\n"], [88, "    container_name   = \"prometheus\"\n"], [89, "    container_port   = 9090\n"], [90, "  }\n"], [91, "}\n"]], "file_path": "\\modules\\monitoring\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [73, 91], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_ecs_service.prometheus", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSServicePublicIP", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-333", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_261", "bc_check_id": "BC_AWS_GENERAL_177", "check_name": "Ensure HTTP HTTPS Target group defines Healthcheck", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[93, "resource \"aws_lb_target_group\" \"prometheus\" {\n"], [94, "  name        = \"prometheus-tg\"\n"], [95, "  port        = 9090\n"], [96, "  protocol    = \"HTTP\"\n"], [97, "  vpc_id      = var.vpc_id\n"], [98, "  target_type = \"ip\"\n"], [99, "\n"], [100, "  health_check {\n"], [101, "    path                = \"/-/healthy\"\n"], [102, "    interval            = 30\n"], [103, "    timeout             = 5\n"], [104, "    healthy_threshold   = 3\n"], [105, "    unhealthy_threshold = 3\n"], [106, "    matcher             = \"200\"\n"], [107, "  }\n"], [108, "}\n"]], "file_path": "\\modules\\monitoring\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [93, 108], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_lb_target_group.prometheus", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LBTargetGroupsDefinesHealthcheck", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-kendra-index-server-side-encryption-uses-customer-managed-keys-cmks", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_335", "bc_check_id": "BC_AWS_GENERAL_240", "check_name": "Ensure ECS task definitions should not share the host's process namespace", "check_result": {"result": "PASSED", "evaluated_keys": ["container_definitions"]}, "code_block": [[1, "resource \"aws_ecs_task_definition\" \"prometheus\" {\n"], [2, "  family                   = \"prometheus\"\n"], [3, "  network_mode             = \"awsvpc\"\n"], [4, "  requires_compatibilities = [\"FARGATE\"]\n"], [5, "  cpu                      = var.prometheus_cpu\n"], [6, "  memory                   = var.prometheus_memory\n"], [7, "  execution_role_arn       = var.execution_role_arn\n"], [8, "  task_role_arn            = var.task_role_arn\n"], [9, "\n"], [10, "  container_definitions = jsonencode([\n"], [11, "    {\n"], [12, "      name      = \"prometheus\"\n"], [13, "      image     = \"prom/prometheus:v2.42.0\"\n"], [14, "      essential = true\n"], [15, "\n"], [16, "      portMappings = [\n"], [17, "        {\n"], [18, "          containerPort = 9090\n"], [19, "          hostPort      = 9090\n"], [20, "          protocol      = \"tcp\"\n"], [21, "        }\n"], [22, "      ]\n"], [23, "\n"], [24, "      mountPoints = [\n"], [25, "        {\n"], [26, "          sourceVolume  = \"prometheus-data\"\n"], [27, "          containerPath = \"/prometheus\"\n"], [28, "          readOnly      = false\n"], [29, "        },\n"], [30, "        {\n"], [31, "          sourceVolume  = \"prometheus-config\"\n"], [32, "          containerPath = \"/etc/prometheus\"\n"], [33, "          readOnly      = true\n"], [34, "        }\n"], [35, "      ]\n"], [36, "\n"], [37, "      logConfiguration = {\n"], [38, "        logDriver = \"awslogs\"\n"], [39, "        options = {\n"], [40, "          \"awslogs-group\"         = aws_cloudwatch_log_group.prometheus_logs.name\n"], [41, "          \"awslogs-region\"        = var.aws_region\n"], [42, "          \"awslogs-stream-prefix\" = \"prometheus\"\n"], [43, "        }\n"], [44, "      }\n"], [45, "\n"], [46, "      command = [\n"], [47, "        \"--config.file=/etc/prometheus/prometheus.yml\",\n"], [48, "        \"--storage.tsdb.path=/prometheus\",\n"], [49, "        \"--web.console.libraries=/usr/share/prometheus/console_libraries\",\n"], [50, "        \"--web.console.templates=/usr/share/prometheus/consoles\",\n"], [51, "        \"--web.enable-lifecycle\"\n"], [52, "      ]\n"], [53, "\n"], [54, "      readonlyRootFilesystem = true\n"], [55, "    }\n"], [56, "  ])\n"], [57, "\n"], [58, "  volume {\n"], [59, "    name = \"prometheus-data\"\n"], [60, "    efs_volume_configuration {\n"], [61, "      file_system_id     = aws_efs_file_system.monitoring_data.id\n"], [62, "      transit_encryption = \"ENABLED\"\n"], [63, "      authorization_config {\n"], [64, "        access_point_id = aws_efs_access_point.prometheus_ap.id\n"], [65, "        iam             = \"ENABLED\"\n"], [66, "      }\n"], [67, "    }\n"], [68, "  }\n"], [69, "\n"], [70, "  volume {\n"], [71, "    name = \"prometheus-config\"\n"], [72, "    efs_volume_configuration {\n"], [73, "      file_system_id     = aws_efs_file_system.monitoring_data.id\n"], [74, "      transit_encryption = \"ENABLED\"\n"], [75, "      authorization_config {\n"], [76, "        access_point_id = aws_efs_access_point.prometheus_config_ap.id\n"], [77, "        iam             = \"ENABLED\"\n"], [78, "      }\n"], [79, "    }\n"], [80, "  }\n"], [81, "\n"], [82, "  tags = {\n"], [83, "    Name        = \"prometheus\"\n"], [84, "    Environment = var.environment\n"], [85, "  }\n"], [86, "}\n"]], "file_path": "\\modules\\monitoring\\prometheus.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf", "repo_file_path": "/modules/monitoring/prometheus.tf", "file_line_range": [1, 86], "resource": "module.ecs_jenkins_github.module.monitoring.aws_ecs_task_definition.prometheus", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSContainerHostProcess", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "prometheus"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-335", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf"}, {"check_id": "CKV_AWS_334", "bc_check_id": "BC_AWS_GENERAL_239", "check_name": "Ensure ECS containers should run as non-privileged", "check_result": {"result": "PASSED", "evaluated_keys": ["container_definitions"]}, "code_block": [[1, "resource \"aws_ecs_task_definition\" \"prometheus\" {\n"], [2, "  family                   = \"prometheus\"\n"], [3, "  network_mode             = \"awsvpc\"\n"], [4, "  requires_compatibilities = [\"FARGATE\"]\n"], [5, "  cpu                      = var.prometheus_cpu\n"], [6, "  memory                   = var.prometheus_memory\n"], [7, "  execution_role_arn       = var.execution_role_arn\n"], [8, "  task_role_arn            = var.task_role_arn\n"], [9, "\n"], [10, "  container_definitions = jsonencode([\n"], [11, "    {\n"], [12, "      name      = \"prometheus\"\n"], [13, "      image     = \"prom/prometheus:v2.42.0\"\n"], [14, "      essential = true\n"], [15, "\n"], [16, "      portMappings = [\n"], [17, "        {\n"], [18, "          containerPort = 9090\n"], [19, "          hostPort      = 9090\n"], [20, "          protocol      = \"tcp\"\n"], [21, "        }\n"], [22, "      ]\n"], [23, "\n"], [24, "      mountPoints = [\n"], [25, "        {\n"], [26, "          sourceVolume  = \"prometheus-data\"\n"], [27, "          containerPath = \"/prometheus\"\n"], [28, "          readOnly      = false\n"], [29, "        },\n"], [30, "        {\n"], [31, "          sourceVolume  = \"prometheus-config\"\n"], [32, "          containerPath = \"/etc/prometheus\"\n"], [33, "          readOnly      = true\n"], [34, "        }\n"], [35, "      ]\n"], [36, "\n"], [37, "      logConfiguration = {\n"], [38, "        logDriver = \"awslogs\"\n"], [39, "        options = {\n"], [40, "          \"awslogs-group\"         = aws_cloudwatch_log_group.prometheus_logs.name\n"], [41, "          \"awslogs-region\"        = var.aws_region\n"], [42, "          \"awslogs-stream-prefix\" = \"prometheus\"\n"], [43, "        }\n"], [44, "      }\n"], [45, "\n"], [46, "      command = [\n"], [47, "        \"--config.file=/etc/prometheus/prometheus.yml\",\n"], [48, "        \"--storage.tsdb.path=/prometheus\",\n"], [49, "        \"--web.console.libraries=/usr/share/prometheus/console_libraries\",\n"], [50, "        \"--web.console.templates=/usr/share/prometheus/consoles\",\n"], [51, "        \"--web.enable-lifecycle\"\n"], [52, "      ]\n"], [53, "\n"], [54, "      readonlyRootFilesystem = true\n"], [55, "    }\n"], [56, "  ])\n"], [57, "\n"], [58, "  volume {\n"], [59, "    name = \"prometheus-data\"\n"], [60, "    efs_volume_configuration {\n"], [61, "      file_system_id     = aws_efs_file_system.monitoring_data.id\n"], [62, "      transit_encryption = \"ENABLED\"\n"], [63, "      authorization_config {\n"], [64, "        access_point_id = aws_efs_access_point.prometheus_ap.id\n"], [65, "        iam             = \"ENABLED\"\n"], [66, "      }\n"], [67, "    }\n"], [68, "  }\n"], [69, "\n"], [70, "  volume {\n"], [71, "    name = \"prometheus-config\"\n"], [72, "    efs_volume_configuration {\n"], [73, "      file_system_id     = aws_efs_file_system.monitoring_data.id\n"], [74, "      transit_encryption = \"ENABLED\"\n"], [75, "      authorization_config {\n"], [76, "        access_point_id = aws_efs_access_point.prometheus_config_ap.id\n"], [77, "        iam             = \"ENABLED\"\n"], [78, "      }\n"], [79, "    }\n"], [80, "  }\n"], [81, "\n"], [82, "  tags = {\n"], [83, "    Name        = \"prometheus\"\n"], [84, "    Environment = var.environment\n"], [85, "  }\n"], [86, "}\n"]], "file_path": "\\modules\\monitoring\\prometheus.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf", "repo_file_path": "/modules/monitoring/prometheus.tf", "file_line_range": [1, 86], "resource": "module.ecs_jenkins_github.module.monitoring.aws_ecs_task_definition.prometheus", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSContainerPrivilege", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "prometheus"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-334", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf"}, {"check_id": "CKV_AWS_336", "bc_check_id": "BC_AWS_GENERAL_241", "check_name": "Ensure ECS containers are limited to read-only access to root filesystems", "check_result": {"result": "PASSED", "evaluated_keys": ["container_definitions"]}, "code_block": [[1, "resource \"aws_ecs_task_definition\" \"prometheus\" {\n"], [2, "  family                   = \"prometheus\"\n"], [3, "  network_mode             = \"awsvpc\"\n"], [4, "  requires_compatibilities = [\"FARGATE\"]\n"], [5, "  cpu                      = var.prometheus_cpu\n"], [6, "  memory                   = var.prometheus_memory\n"], [7, "  execution_role_arn       = var.execution_role_arn\n"], [8, "  task_role_arn            = var.task_role_arn\n"], [9, "\n"], [10, "  container_definitions = jsonencode([\n"], [11, "    {\n"], [12, "      name      = \"prometheus\"\n"], [13, "      image     = \"prom/prometheus:v2.42.0\"\n"], [14, "      essential = true\n"], [15, "\n"], [16, "      portMappings = [\n"], [17, "        {\n"], [18, "          containerPort = 9090\n"], [19, "          hostPort      = 9090\n"], [20, "          protocol      = \"tcp\"\n"], [21, "        }\n"], [22, "      ]\n"], [23, "\n"], [24, "      mountPoints = [\n"], [25, "        {\n"], [26, "          sourceVolume  = \"prometheus-data\"\n"], [27, "          containerPath = \"/prometheus\"\n"], [28, "          readOnly      = false\n"], [29, "        },\n"], [30, "        {\n"], [31, "          sourceVolume  = \"prometheus-config\"\n"], [32, "          containerPath = \"/etc/prometheus\"\n"], [33, "          readOnly      = true\n"], [34, "        }\n"], [35, "      ]\n"], [36, "\n"], [37, "      logConfiguration = {\n"], [38, "        logDriver = \"awslogs\"\n"], [39, "        options = {\n"], [40, "          \"awslogs-group\"         = aws_cloudwatch_log_group.prometheus_logs.name\n"], [41, "          \"awslogs-region\"        = var.aws_region\n"], [42, "          \"awslogs-stream-prefix\" = \"prometheus\"\n"], [43, "        }\n"], [44, "      }\n"], [45, "\n"], [46, "      command = [\n"], [47, "        \"--config.file=/etc/prometheus/prometheus.yml\",\n"], [48, "        \"--storage.tsdb.path=/prometheus\",\n"], [49, "        \"--web.console.libraries=/usr/share/prometheus/console_libraries\",\n"], [50, "        \"--web.console.templates=/usr/share/prometheus/consoles\",\n"], [51, "        \"--web.enable-lifecycle\"\n"], [52, "      ]\n"], [53, "\n"], [54, "      readonlyRootFilesystem = true\n"], [55, "    }\n"], [56, "  ])\n"], [57, "\n"], [58, "  volume {\n"], [59, "    name = \"prometheus-data\"\n"], [60, "    efs_volume_configuration {\n"], [61, "      file_system_id     = aws_efs_file_system.monitoring_data.id\n"], [62, "      transit_encryption = \"ENABLED\"\n"], [63, "      authorization_config {\n"], [64, "        access_point_id = aws_efs_access_point.prometheus_ap.id\n"], [65, "        iam             = \"ENABLED\"\n"], [66, "      }\n"], [67, "    }\n"], [68, "  }\n"], [69, "\n"], [70, "  volume {\n"], [71, "    name = \"prometheus-config\"\n"], [72, "    efs_volume_configuration {\n"], [73, "      file_system_id     = aws_efs_file_system.monitoring_data.id\n"], [74, "      transit_encryption = \"ENABLED\"\n"], [75, "      authorization_config {\n"], [76, "        access_point_id = aws_efs_access_point.prometheus_config_ap.id\n"], [77, "        iam             = \"ENABLED\"\n"], [78, "      }\n"], [79, "    }\n"], [80, "  }\n"], [81, "\n"], [82, "  tags = {\n"], [83, "    Name        = \"prometheus\"\n"], [84, "    Environment = var.environment\n"], [85, "  }\n"], [86, "}\n"]], "file_path": "\\modules\\monitoring\\prometheus.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf", "repo_file_path": "/modules/monitoring/prometheus.tf", "file_line_range": [1, 86], "resource": "module.ecs_jenkins_github.module.monitoring.aws_ecs_task_definition.prometheus", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSContainerReadOnlyRoot", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "prometheus"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-336", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf"}, {"check_id": "CKV_AWS_97", "bc_check_id": "BC_AWS_GENERAL_39", "check_name": "Ensure Encryption in transit is enabled for EFS volumes in ECS Task definitions", "check_result": {"result": "PASSED", "evaluated_keys": ["volume/[0]/efs_volume_configuration/[0]"]}, "code_block": [[1, "resource \"aws_ecs_task_definition\" \"prometheus\" {\n"], [2, "  family                   = \"prometheus\"\n"], [3, "  network_mode             = \"awsvpc\"\n"], [4, "  requires_compatibilities = [\"FARGATE\"]\n"], [5, "  cpu                      = var.prometheus_cpu\n"], [6, "  memory                   = var.prometheus_memory\n"], [7, "  execution_role_arn       = var.execution_role_arn\n"], [8, "  task_role_arn            = var.task_role_arn\n"], [9, "\n"], [10, "  container_definitions = jsonencode([\n"], [11, "    {\n"], [12, "      name      = \"prometheus\"\n"], [13, "      image     = \"prom/prometheus:v2.42.0\"\n"], [14, "      essential = true\n"], [15, "\n"], [16, "      portMappings = [\n"], [17, "        {\n"], [18, "          containerPort = 9090\n"], [19, "          hostPort      = 9090\n"], [20, "          protocol      = \"tcp\"\n"], [21, "        }\n"], [22, "      ]\n"], [23, "\n"], [24, "      mountPoints = [\n"], [25, "        {\n"], [26, "          sourceVolume  = \"prometheus-data\"\n"], [27, "          containerPath = \"/prometheus\"\n"], [28, "          readOnly      = false\n"], [29, "        },\n"], [30, "        {\n"], [31, "          sourceVolume  = \"prometheus-config\"\n"], [32, "          containerPath = \"/etc/prometheus\"\n"], [33, "          readOnly      = true\n"], [34, "        }\n"], [35, "      ]\n"], [36, "\n"], [37, "      logConfiguration = {\n"], [38, "        logDriver = \"awslogs\"\n"], [39, "        options = {\n"], [40, "          \"awslogs-group\"         = aws_cloudwatch_log_group.prometheus_logs.name\n"], [41, "          \"awslogs-region\"        = var.aws_region\n"], [42, "          \"awslogs-stream-prefix\" = \"prometheus\"\n"], [43, "        }\n"], [44, "      }\n"], [45, "\n"], [46, "      command = [\n"], [47, "        \"--config.file=/etc/prometheus/prometheus.yml\",\n"], [48, "        \"--storage.tsdb.path=/prometheus\",\n"], [49, "        \"--web.console.libraries=/usr/share/prometheus/console_libraries\",\n"], [50, "        \"--web.console.templates=/usr/share/prometheus/consoles\",\n"], [51, "        \"--web.enable-lifecycle\"\n"], [52, "      ]\n"], [53, "\n"], [54, "      readonlyRootFilesystem = true\n"], [55, "    }\n"], [56, "  ])\n"], [57, "\n"], [58, "  volume {\n"], [59, "    name = \"prometheus-data\"\n"], [60, "    efs_volume_configuration {\n"], [61, "      file_system_id     = aws_efs_file_system.monitoring_data.id\n"], [62, "      transit_encryption = \"ENABLED\"\n"], [63, "      authorization_config {\n"], [64, "        access_point_id = aws_efs_access_point.prometheus_ap.id\n"], [65, "        iam             = \"ENABLED\"\n"], [66, "      }\n"], [67, "    }\n"], [68, "  }\n"], [69, "\n"], [70, "  volume {\n"], [71, "    name = \"prometheus-config\"\n"], [72, "    efs_volume_configuration {\n"], [73, "      file_system_id     = aws_efs_file_system.monitoring_data.id\n"], [74, "      transit_encryption = \"ENABLED\"\n"], [75, "      authorization_config {\n"], [76, "        access_point_id = aws_efs_access_point.prometheus_config_ap.id\n"], [77, "        iam             = \"ENABLED\"\n"], [78, "      }\n"], [79, "    }\n"], [80, "  }\n"], [81, "\n"], [82, "  tags = {\n"], [83, "    Name        = \"prometheus\"\n"], [84, "    Environment = var.environment\n"], [85, "  }\n"], [86, "}\n"]], "file_path": "\\modules\\monitoring\\prometheus.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf", "repo_file_path": "/modules/monitoring/prometheus.tf", "file_line_range": [1, 86], "resource": "module.ecs_jenkins_github.module.monitoring.aws_ecs_task_definition.prometheus", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSTaskDefinitionEFSVolumeEncryption", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "prometheus"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-39", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf"}, {"check_id": "CKV_AWS_249", "bc_check_id": "BC_AWS_IAM_68", "check_name": "Ensure that the Execution Role ARN and the Task Role ARN are different in ECS Task definitions", "check_result": {"result": "PASSED", "evaluated_keys": ["execution_role_arn", "task_role_arn"]}, "code_block": [[1, "resource \"aws_ecs_task_definition\" \"prometheus\" {\n"], [2, "  family                   = \"prometheus\"\n"], [3, "  network_mode             = \"awsvpc\"\n"], [4, "  requires_compatibilities = [\"FARGATE\"]\n"], [5, "  cpu                      = var.prometheus_cpu\n"], [6, "  memory                   = var.prometheus_memory\n"], [7, "  execution_role_arn       = var.execution_role_arn\n"], [8, "  task_role_arn            = var.task_role_arn\n"], [9, "\n"], [10, "  container_definitions = jsonencode([\n"], [11, "    {\n"], [12, "      name      = \"prometheus\"\n"], [13, "      image     = \"prom/prometheus:v2.42.0\"\n"], [14, "      essential = true\n"], [15, "\n"], [16, "      portMappings = [\n"], [17, "        {\n"], [18, "          containerPort = 9090\n"], [19, "          hostPort      = 9090\n"], [20, "          protocol      = \"tcp\"\n"], [21, "        }\n"], [22, "      ]\n"], [23, "\n"], [24, "      mountPoints = [\n"], [25, "        {\n"], [26, "          sourceVolume  = \"prometheus-data\"\n"], [27, "          containerPath = \"/prometheus\"\n"], [28, "          readOnly      = false\n"], [29, "        },\n"], [30, "        {\n"], [31, "          sourceVolume  = \"prometheus-config\"\n"], [32, "          containerPath = \"/etc/prometheus\"\n"], [33, "          readOnly      = true\n"], [34, "        }\n"], [35, "      ]\n"], [36, "\n"], [37, "      logConfiguration = {\n"], [38, "        logDriver = \"awslogs\"\n"], [39, "        options = {\n"], [40, "          \"awslogs-group\"         = aws_cloudwatch_log_group.prometheus_logs.name\n"], [41, "          \"awslogs-region\"        = var.aws_region\n"], [42, "          \"awslogs-stream-prefix\" = \"prometheus\"\n"], [43, "        }\n"], [44, "      }\n"], [45, "\n"], [46, "      command = [\n"], [47, "        \"--config.file=/etc/prometheus/prometheus.yml\",\n"], [48, "        \"--storage.tsdb.path=/prometheus\",\n"], [49, "        \"--web.console.libraries=/usr/share/prometheus/console_libraries\",\n"], [50, "        \"--web.console.templates=/usr/share/prometheus/consoles\",\n"], [51, "        \"--web.enable-lifecycle\"\n"], [52, "      ]\n"], [53, "\n"], [54, "      readonlyRootFilesystem = true\n"], [55, "    }\n"], [56, "  ])\n"], [57, "\n"], [58, "  volume {\n"], [59, "    name = \"prometheus-data\"\n"], [60, "    efs_volume_configuration {\n"], [61, "      file_system_id     = aws_efs_file_system.monitoring_data.id\n"], [62, "      transit_encryption = \"ENABLED\"\n"], [63, "      authorization_config {\n"], [64, "        access_point_id = aws_efs_access_point.prometheus_ap.id\n"], [65, "        iam             = \"ENABLED\"\n"], [66, "      }\n"], [67, "    }\n"], [68, "  }\n"], [69, "\n"], [70, "  volume {\n"], [71, "    name = \"prometheus-config\"\n"], [72, "    efs_volume_configuration {\n"], [73, "      file_system_id     = aws_efs_file_system.monitoring_data.id\n"], [74, "      transit_encryption = \"ENABLED\"\n"], [75, "      authorization_config {\n"], [76, "        access_point_id = aws_efs_access_point.prometheus_config_ap.id\n"], [77, "        iam             = \"ENABLED\"\n"], [78, "      }\n"], [79, "    }\n"], [80, "  }\n"], [81, "\n"], [82, "  tags = {\n"], [83, "    Name        = \"prometheus\"\n"], [84, "    Environment = var.environment\n"], [85, "  }\n"], [86, "}\n"]], "file_path": "\\modules\\monitoring\\prometheus.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf", "repo_file_path": "/modules/monitoring/prometheus.tf", "file_line_range": [1, 86], "resource": "module.ecs_jenkins_github.module.monitoring.aws_ecs_task_definition.prometheus", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSTaskDefinitionRoleCheck", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "prometheus"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-the-aws-execution-role-arn-and-task-role-arn-are-different-in-ecs-task-definitions", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf"}, {"check_id": "CKV_AWS_329", "bc_check_id": "BC_AWS_GENERAL_235", "check_name": "EFS access points should enforce a root directory", "check_result": {"result": "PASSED", "evaluated_keys": ["root_directory/[0]/path"]}, "code_block": [[88, "resource \"aws_efs_access_point\" \"prometheus_ap\" {\n"], [89, "  file_system_id = aws_efs_file_system.monitoring_data.id\n"], [90, "\n"], [91, "  posix_user {\n"], [92, "    uid = 65534 # nobody\n"], [93, "    gid = 65534 # nobody\n"], [94, "  }\n"], [95, "\n"], [96, "  root_directory {\n"], [97, "    path = \"/prometheus-data\"\n"], [98, "    creation_info {\n"], [99, "      owner_uid   = 65534\n"], [100, "      owner_gid   = 65534\n"], [101, "      permissions = \"755\"\n"], [102, "    }\n"], [103, "  }\n"], [104, "}\n"]], "file_path": "\\modules\\monitoring\\prometheus.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf", "repo_file_path": "/modules/monitoring/prometheus.tf", "file_line_range": [88, 104], "resource": "module.ecs_jenkins_github.module.monitoring.aws_efs_access_point.prometheus_ap", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EFSAccessPointRoot", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-329", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf"}, {"check_id": "CKV_AWS_330", "bc_check_id": "BC_AWS_GENERAL_236", "check_name": "EFS access points should enforce a user identity", "check_result": {"result": "PASSED", "evaluated_keys": ["posix_user/[0]/gid"]}, "code_block": [[88, "resource \"aws_efs_access_point\" \"prometheus_ap\" {\n"], [89, "  file_system_id = aws_efs_file_system.monitoring_data.id\n"], [90, "\n"], [91, "  posix_user {\n"], [92, "    uid = 65534 # nobody\n"], [93, "    gid = 65534 # nobody\n"], [94, "  }\n"], [95, "\n"], [96, "  root_directory {\n"], [97, "    path = \"/prometheus-data\"\n"], [98, "    creation_info {\n"], [99, "      owner_uid   = 65534\n"], [100, "      owner_gid   = 65534\n"], [101, "      permissions = \"755\"\n"], [102, "    }\n"], [103, "  }\n"], [104, "}\n"]], "file_path": "\\modules\\monitoring\\prometheus.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf", "repo_file_path": "/modules/monitoring/prometheus.tf", "file_line_range": [88, 104], "resource": "module.ecs_jenkins_github.module.monitoring.aws_efs_access_point.prometheus_ap", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EFSAccessUserIdentity", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-330", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf"}, {"check_id": "CKV_AWS_329", "bc_check_id": "BC_AWS_GENERAL_235", "check_name": "EFS access points should enforce a root directory", "check_result": {"result": "PASSED", "evaluated_keys": ["root_directory/[0]/path"]}, "code_block": [[106, "resource \"aws_efs_access_point\" \"prometheus_config_ap\" {\n"], [107, "  file_system_id = aws_efs_file_system.monitoring_data.id\n"], [108, "\n"], [109, "  posix_user {\n"], [110, "    uid = 65534 # nobody\n"], [111, "    gid = 65534 # nobody\n"], [112, "  }\n"], [113, "\n"], [114, "  root_directory {\n"], [115, "    path = \"/prometheus-config\"\n"], [116, "    creation_info {\n"], [117, "      owner_uid   = 65534\n"], [118, "      owner_gid   = 65534\n"], [119, "      permissions = \"755\"\n"], [120, "    }\n"], [121, "  }\n"], [122, "}\n"]], "file_path": "\\modules\\monitoring\\prometheus.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf", "repo_file_path": "/modules/monitoring/prometheus.tf", "file_line_range": [106, 122], "resource": "module.ecs_jenkins_github.module.monitoring.aws_efs_access_point.prometheus_config_ap", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EFSAccessPointRoot", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-329", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf"}, {"check_id": "CKV_AWS_330", "bc_check_id": "BC_AWS_GENERAL_236", "check_name": "EFS access points should enforce a user identity", "check_result": {"result": "PASSED", "evaluated_keys": ["posix_user/[0]/gid"]}, "code_block": [[106, "resource \"aws_efs_access_point\" \"prometheus_config_ap\" {\n"], [107, "  file_system_id = aws_efs_file_system.monitoring_data.id\n"], [108, "\n"], [109, "  posix_user {\n"], [110, "    uid = 65534 # nobody\n"], [111, "    gid = 65534 # nobody\n"], [112, "  }\n"], [113, "\n"], [114, "  root_directory {\n"], [115, "    path = \"/prometheus-config\"\n"], [116, "    creation_info {\n"], [117, "      owner_uid   = 65534\n"], [118, "      owner_gid   = 65534\n"], [119, "      permissions = \"755\"\n"], [120, "    }\n"], [121, "  }\n"], [122, "}\n"]], "file_path": "\\modules\\monitoring\\prometheus.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf", "repo_file_path": "/modules/monitoring/prometheus.tf", "file_line_range": [106, 122], "resource": "module.ecs_jenkins_github.module.monitoring.aws_efs_access_point.prometheus_config_ap", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EFSAccessUserIdentity", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-330", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf"}, {"check_id": "CKV_AWS_335", "bc_check_id": "BC_AWS_GENERAL_240", "check_name": "Ensure ECS task definitions should not share the host's process namespace", "check_result": {"result": "PASSED", "evaluated_keys": ["container_definitions"]}, "code_block": [[1, "resource \"aws_ecs_task_definition\" \"prometheus\" {\n"], [2, "  family                   = \"prometheus\"\n"], [3, "  network_mode             = \"awsvpc\"\n"], [4, "  requires_compatibilities = [\"FARGATE\"]\n"], [5, "  cpu                      = var.prometheus_cpu\n"], [6, "  memory                   = var.prometheus_memory\n"], [7, "  execution_role_arn       = var.execution_role_arn\n"], [8, "  task_role_arn            = var.task_role_arn\n"], [9, "\n"], [10, "  container_definitions = jsonencode([\n"], [11, "    {\n"], [12, "      name      = \"prometheus\"\n"], [13, "      image     = \"prom/prometheus:v2.42.0\"\n"], [14, "      essential = true\n"], [15, "\n"], [16, "      portMappings = [\n"], [17, "        {\n"], [18, "          containerPort = 9090\n"], [19, "          hostPort      = 9090\n"], [20, "          protocol      = \"tcp\"\n"], [21, "        }\n"], [22, "      ]\n"], [23, "\n"], [24, "      mountPoints = [\n"], [25, "        {\n"], [26, "          sourceVolume  = \"prometheus-data\"\n"], [27, "          containerPath = \"/prometheus\"\n"], [28, "          readOnly      = false\n"], [29, "        },\n"], [30, "        {\n"], [31, "          sourceVolume  = \"prometheus-config\"\n"], [32, "          containerPath = \"/etc/prometheus\"\n"], [33, "          readOnly      = true\n"], [34, "        }\n"], [35, "      ]\n"], [36, "\n"], [37, "      logConfiguration = {\n"], [38, "        logDriver = \"awslogs\"\n"], [39, "        options = {\n"], [40, "          \"awslogs-group\"         = aws_cloudwatch_log_group.prometheus_logs.name\n"], [41, "          \"awslogs-region\"        = var.aws_region\n"], [42, "          \"awslogs-stream-prefix\" = \"prometheus\"\n"], [43, "        }\n"], [44, "      }\n"], [45, "\n"], [46, "      command = [\n"], [47, "        \"--config.file=/etc/prometheus/prometheus.yml\",\n"], [48, "        \"--storage.tsdb.path=/prometheus\",\n"], [49, "        \"--web.console.libraries=/usr/share/prometheus/console_libraries\",\n"], [50, "        \"--web.console.templates=/usr/share/prometheus/consoles\",\n"], [51, "        \"--web.enable-lifecycle\"\n"], [52, "      ]\n"], [53, "\n"], [54, "      readonlyRootFilesystem = true\n"], [55, "    }\n"], [56, "  ])\n"], [57, "\n"], [58, "  volume {\n"], [59, "    name = \"prometheus-data\"\n"], [60, "    efs_volume_configuration {\n"], [61, "      file_system_id     = aws_efs_file_system.monitoring_data.id\n"], [62, "      transit_encryption = \"ENABLED\"\n"], [63, "      authorization_config {\n"], [64, "        access_point_id = aws_efs_access_point.prometheus_ap.id\n"], [65, "        iam             = \"ENABLED\"\n"], [66, "      }\n"], [67, "    }\n"], [68, "  }\n"], [69, "\n"], [70, "  volume {\n"], [71, "    name = \"prometheus-config\"\n"], [72, "    efs_volume_configuration {\n"], [73, "      file_system_id     = aws_efs_file_system.monitoring_data.id\n"], [74, "      transit_encryption = \"ENABLED\"\n"], [75, "      authorization_config {\n"], [76, "        access_point_id = aws_efs_access_point.prometheus_config_ap.id\n"], [77, "        iam             = \"ENABLED\"\n"], [78, "      }\n"], [79, "    }\n"], [80, "  }\n"], [81, "\n"], [82, "  tags = {\n"], [83, "    Name        = \"prometheus\"\n"], [84, "    Environment = var.environment\n"], [85, "  }\n"], [86, "}\n"]], "file_path": "\\modules\\monitoring\\prometheus.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf", "repo_file_path": "/modules/monitoring/prometheus.tf", "file_line_range": [1, 86], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_ecs_task_definition.prometheus", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSContainerHostProcess", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "prometheus"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-335", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf"}, {"check_id": "CKV_AWS_334", "bc_check_id": "BC_AWS_GENERAL_239", "check_name": "Ensure ECS containers should run as non-privileged", "check_result": {"result": "PASSED", "evaluated_keys": ["container_definitions"]}, "code_block": [[1, "resource \"aws_ecs_task_definition\" \"prometheus\" {\n"], [2, "  family                   = \"prometheus\"\n"], [3, "  network_mode             = \"awsvpc\"\n"], [4, "  requires_compatibilities = [\"FARGATE\"]\n"], [5, "  cpu                      = var.prometheus_cpu\n"], [6, "  memory                   = var.prometheus_memory\n"], [7, "  execution_role_arn       = var.execution_role_arn\n"], [8, "  task_role_arn            = var.task_role_arn\n"], [9, "\n"], [10, "  container_definitions = jsonencode([\n"], [11, "    {\n"], [12, "      name      = \"prometheus\"\n"], [13, "      image     = \"prom/prometheus:v2.42.0\"\n"], [14, "      essential = true\n"], [15, "\n"], [16, "      portMappings = [\n"], [17, "        {\n"], [18, "          containerPort = 9090\n"], [19, "          hostPort      = 9090\n"], [20, "          protocol      = \"tcp\"\n"], [21, "        }\n"], [22, "      ]\n"], [23, "\n"], [24, "      mountPoints = [\n"], [25, "        {\n"], [26, "          sourceVolume  = \"prometheus-data\"\n"], [27, "          containerPath = \"/prometheus\"\n"], [28, "          readOnly      = false\n"], [29, "        },\n"], [30, "        {\n"], [31, "          sourceVolume  = \"prometheus-config\"\n"], [32, "          containerPath = \"/etc/prometheus\"\n"], [33, "          readOnly      = true\n"], [34, "        }\n"], [35, "      ]\n"], [36, "\n"], [37, "      logConfiguration = {\n"], [38, "        logDriver = \"awslogs\"\n"], [39, "        options = {\n"], [40, "          \"awslogs-group\"         = aws_cloudwatch_log_group.prometheus_logs.name\n"], [41, "          \"awslogs-region\"        = var.aws_region\n"], [42, "          \"awslogs-stream-prefix\" = \"prometheus\"\n"], [43, "        }\n"], [44, "      }\n"], [45, "\n"], [46, "      command = [\n"], [47, "        \"--config.file=/etc/prometheus/prometheus.yml\",\n"], [48, "        \"--storage.tsdb.path=/prometheus\",\n"], [49, "        \"--web.console.libraries=/usr/share/prometheus/console_libraries\",\n"], [50, "        \"--web.console.templates=/usr/share/prometheus/consoles\",\n"], [51, "        \"--web.enable-lifecycle\"\n"], [52, "      ]\n"], [53, "\n"], [54, "      readonlyRootFilesystem = true\n"], [55, "    }\n"], [56, "  ])\n"], [57, "\n"], [58, "  volume {\n"], [59, "    name = \"prometheus-data\"\n"], [60, "    efs_volume_configuration {\n"], [61, "      file_system_id     = aws_efs_file_system.monitoring_data.id\n"], [62, "      transit_encryption = \"ENABLED\"\n"], [63, "      authorization_config {\n"], [64, "        access_point_id = aws_efs_access_point.prometheus_ap.id\n"], [65, "        iam             = \"ENABLED\"\n"], [66, "      }\n"], [67, "    }\n"], [68, "  }\n"], [69, "\n"], [70, "  volume {\n"], [71, "    name = \"prometheus-config\"\n"], [72, "    efs_volume_configuration {\n"], [73, "      file_system_id     = aws_efs_file_system.monitoring_data.id\n"], [74, "      transit_encryption = \"ENABLED\"\n"], [75, "      authorization_config {\n"], [76, "        access_point_id = aws_efs_access_point.prometheus_config_ap.id\n"], [77, "        iam             = \"ENABLED\"\n"], [78, "      }\n"], [79, "    }\n"], [80, "  }\n"], [81, "\n"], [82, "  tags = {\n"], [83, "    Name        = \"prometheus\"\n"], [84, "    Environment = var.environment\n"], [85, "  }\n"], [86, "}\n"]], "file_path": "\\modules\\monitoring\\prometheus.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf", "repo_file_path": "/modules/monitoring/prometheus.tf", "file_line_range": [1, 86], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_ecs_task_definition.prometheus", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSContainerPrivilege", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "prometheus"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-334", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf"}, {"check_id": "CKV_AWS_336", "bc_check_id": "BC_AWS_GENERAL_241", "check_name": "Ensure ECS containers are limited to read-only access to root filesystems", "check_result": {"result": "PASSED", "evaluated_keys": ["container_definitions"]}, "code_block": [[1, "resource \"aws_ecs_task_definition\" \"prometheus\" {\n"], [2, "  family                   = \"prometheus\"\n"], [3, "  network_mode             = \"awsvpc\"\n"], [4, "  requires_compatibilities = [\"FARGATE\"]\n"], [5, "  cpu                      = var.prometheus_cpu\n"], [6, "  memory                   = var.prometheus_memory\n"], [7, "  execution_role_arn       = var.execution_role_arn\n"], [8, "  task_role_arn            = var.task_role_arn\n"], [9, "\n"], [10, "  container_definitions = jsonencode([\n"], [11, "    {\n"], [12, "      name      = \"prometheus\"\n"], [13, "      image     = \"prom/prometheus:v2.42.0\"\n"], [14, "      essential = true\n"], [15, "\n"], [16, "      portMappings = [\n"], [17, "        {\n"], [18, "          containerPort = 9090\n"], [19, "          hostPort      = 9090\n"], [20, "          protocol      = \"tcp\"\n"], [21, "        }\n"], [22, "      ]\n"], [23, "\n"], [24, "      mountPoints = [\n"], [25, "        {\n"], [26, "          sourceVolume  = \"prometheus-data\"\n"], [27, "          containerPath = \"/prometheus\"\n"], [28, "          readOnly      = false\n"], [29, "        },\n"], [30, "        {\n"], [31, "          sourceVolume  = \"prometheus-config\"\n"], [32, "          containerPath = \"/etc/prometheus\"\n"], [33, "          readOnly      = true\n"], [34, "        }\n"], [35, "      ]\n"], [36, "\n"], [37, "      logConfiguration = {\n"], [38, "        logDriver = \"awslogs\"\n"], [39, "        options = {\n"], [40, "          \"awslogs-group\"         = aws_cloudwatch_log_group.prometheus_logs.name\n"], [41, "          \"awslogs-region\"        = var.aws_region\n"], [42, "          \"awslogs-stream-prefix\" = \"prometheus\"\n"], [43, "        }\n"], [44, "      }\n"], [45, "\n"], [46, "      command = [\n"], [47, "        \"--config.file=/etc/prometheus/prometheus.yml\",\n"], [48, "        \"--storage.tsdb.path=/prometheus\",\n"], [49, "        \"--web.console.libraries=/usr/share/prometheus/console_libraries\",\n"], [50, "        \"--web.console.templates=/usr/share/prometheus/consoles\",\n"], [51, "        \"--web.enable-lifecycle\"\n"], [52, "      ]\n"], [53, "\n"], [54, "      readonlyRootFilesystem = true\n"], [55, "    }\n"], [56, "  ])\n"], [57, "\n"], [58, "  volume {\n"], [59, "    name = \"prometheus-data\"\n"], [60, "    efs_volume_configuration {\n"], [61, "      file_system_id     = aws_efs_file_system.monitoring_data.id\n"], [62, "      transit_encryption = \"ENABLED\"\n"], [63, "      authorization_config {\n"], [64, "        access_point_id = aws_efs_access_point.prometheus_ap.id\n"], [65, "        iam             = \"ENABLED\"\n"], [66, "      }\n"], [67, "    }\n"], [68, "  }\n"], [69, "\n"], [70, "  volume {\n"], [71, "    name = \"prometheus-config\"\n"], [72, "    efs_volume_configuration {\n"], [73, "      file_system_id     = aws_efs_file_system.monitoring_data.id\n"], [74, "      transit_encryption = \"ENABLED\"\n"], [75, "      authorization_config {\n"], [76, "        access_point_id = aws_efs_access_point.prometheus_config_ap.id\n"], [77, "        iam             = \"ENABLED\"\n"], [78, "      }\n"], [79, "    }\n"], [80, "  }\n"], [81, "\n"], [82, "  tags = {\n"], [83, "    Name        = \"prometheus\"\n"], [84, "    Environment = var.environment\n"], [85, "  }\n"], [86, "}\n"]], "file_path": "\\modules\\monitoring\\prometheus.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf", "repo_file_path": "/modules/monitoring/prometheus.tf", "file_line_range": [1, 86], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_ecs_task_definition.prometheus", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSContainerReadOnlyRoot", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "prometheus"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-336", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf"}, {"check_id": "CKV_AWS_97", "bc_check_id": "BC_AWS_GENERAL_39", "check_name": "Ensure Encryption in transit is enabled for EFS volumes in ECS Task definitions", "check_result": {"result": "PASSED", "evaluated_keys": ["volume/[0]/efs_volume_configuration/[0]"]}, "code_block": [[1, "resource \"aws_ecs_task_definition\" \"prometheus\" {\n"], [2, "  family                   = \"prometheus\"\n"], [3, "  network_mode             = \"awsvpc\"\n"], [4, "  requires_compatibilities = [\"FARGATE\"]\n"], [5, "  cpu                      = var.prometheus_cpu\n"], [6, "  memory                   = var.prometheus_memory\n"], [7, "  execution_role_arn       = var.execution_role_arn\n"], [8, "  task_role_arn            = var.task_role_arn\n"], [9, "\n"], [10, "  container_definitions = jsonencode([\n"], [11, "    {\n"], [12, "      name      = \"prometheus\"\n"], [13, "      image     = \"prom/prometheus:v2.42.0\"\n"], [14, "      essential = true\n"], [15, "\n"], [16, "      portMappings = [\n"], [17, "        {\n"], [18, "          containerPort = 9090\n"], [19, "          hostPort      = 9090\n"], [20, "          protocol      = \"tcp\"\n"], [21, "        }\n"], [22, "      ]\n"], [23, "\n"], [24, "      mountPoints = [\n"], [25, "        {\n"], [26, "          sourceVolume  = \"prometheus-data\"\n"], [27, "          containerPath = \"/prometheus\"\n"], [28, "          readOnly      = false\n"], [29, "        },\n"], [30, "        {\n"], [31, "          sourceVolume  = \"prometheus-config\"\n"], [32, "          containerPath = \"/etc/prometheus\"\n"], [33, "          readOnly      = true\n"], [34, "        }\n"], [35, "      ]\n"], [36, "\n"], [37, "      logConfiguration = {\n"], [38, "        logDriver = \"awslogs\"\n"], [39, "        options = {\n"], [40, "          \"awslogs-group\"         = aws_cloudwatch_log_group.prometheus_logs.name\n"], [41, "          \"awslogs-region\"        = var.aws_region\n"], [42, "          \"awslogs-stream-prefix\" = \"prometheus\"\n"], [43, "        }\n"], [44, "      }\n"], [45, "\n"], [46, "      command = [\n"], [47, "        \"--config.file=/etc/prometheus/prometheus.yml\",\n"], [48, "        \"--storage.tsdb.path=/prometheus\",\n"], [49, "        \"--web.console.libraries=/usr/share/prometheus/console_libraries\",\n"], [50, "        \"--web.console.templates=/usr/share/prometheus/consoles\",\n"], [51, "        \"--web.enable-lifecycle\"\n"], [52, "      ]\n"], [53, "\n"], [54, "      readonlyRootFilesystem = true\n"], [55, "    }\n"], [56, "  ])\n"], [57, "\n"], [58, "  volume {\n"], [59, "    name = \"prometheus-data\"\n"], [60, "    efs_volume_configuration {\n"], [61, "      file_system_id     = aws_efs_file_system.monitoring_data.id\n"], [62, "      transit_encryption = \"ENABLED\"\n"], [63, "      authorization_config {\n"], [64, "        access_point_id = aws_efs_access_point.prometheus_ap.id\n"], [65, "        iam             = \"ENABLED\"\n"], [66, "      }\n"], [67, "    }\n"], [68, "  }\n"], [69, "\n"], [70, "  volume {\n"], [71, "    name = \"prometheus-config\"\n"], [72, "    efs_volume_configuration {\n"], [73, "      file_system_id     = aws_efs_file_system.monitoring_data.id\n"], [74, "      transit_encryption = \"ENABLED\"\n"], [75, "      authorization_config {\n"], [76, "        access_point_id = aws_efs_access_point.prometheus_config_ap.id\n"], [77, "        iam             = \"ENABLED\"\n"], [78, "      }\n"], [79, "    }\n"], [80, "  }\n"], [81, "\n"], [82, "  tags = {\n"], [83, "    Name        = \"prometheus\"\n"], [84, "    Environment = var.environment\n"], [85, "  }\n"], [86, "}\n"]], "file_path": "\\modules\\monitoring\\prometheus.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf", "repo_file_path": "/modules/monitoring/prometheus.tf", "file_line_range": [1, 86], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_ecs_task_definition.prometheus", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSTaskDefinitionEFSVolumeEncryption", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "prometheus"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-39", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf"}, {"check_id": "CKV_AWS_249", "bc_check_id": "BC_AWS_IAM_68", "check_name": "Ensure that the Execution Role ARN and the Task Role ARN are different in ECS Task definitions", "check_result": {"result": "PASSED", "evaluated_keys": ["execution_role_arn", "task_role_arn"]}, "code_block": [[1, "resource \"aws_ecs_task_definition\" \"prometheus\" {\n"], [2, "  family                   = \"prometheus\"\n"], [3, "  network_mode             = \"awsvpc\"\n"], [4, "  requires_compatibilities = [\"FARGATE\"]\n"], [5, "  cpu                      = var.prometheus_cpu\n"], [6, "  memory                   = var.prometheus_memory\n"], [7, "  execution_role_arn       = var.execution_role_arn\n"], [8, "  task_role_arn            = var.task_role_arn\n"], [9, "\n"], [10, "  container_definitions = jsonencode([\n"], [11, "    {\n"], [12, "      name      = \"prometheus\"\n"], [13, "      image     = \"prom/prometheus:v2.42.0\"\n"], [14, "      essential = true\n"], [15, "\n"], [16, "      portMappings = [\n"], [17, "        {\n"], [18, "          containerPort = 9090\n"], [19, "          hostPort      = 9090\n"], [20, "          protocol      = \"tcp\"\n"], [21, "        }\n"], [22, "      ]\n"], [23, "\n"], [24, "      mountPoints = [\n"], [25, "        {\n"], [26, "          sourceVolume  = \"prometheus-data\"\n"], [27, "          containerPath = \"/prometheus\"\n"], [28, "          readOnly      = false\n"], [29, "        },\n"], [30, "        {\n"], [31, "          sourceVolume  = \"prometheus-config\"\n"], [32, "          containerPath = \"/etc/prometheus\"\n"], [33, "          readOnly      = true\n"], [34, "        }\n"], [35, "      ]\n"], [36, "\n"], [37, "      logConfiguration = {\n"], [38, "        logDriver = \"awslogs\"\n"], [39, "        options = {\n"], [40, "          \"awslogs-group\"         = aws_cloudwatch_log_group.prometheus_logs.name\n"], [41, "          \"awslogs-region\"        = var.aws_region\n"], [42, "          \"awslogs-stream-prefix\" = \"prometheus\"\n"], [43, "        }\n"], [44, "      }\n"], [45, "\n"], [46, "      command = [\n"], [47, "        \"--config.file=/etc/prometheus/prometheus.yml\",\n"], [48, "        \"--storage.tsdb.path=/prometheus\",\n"], [49, "        \"--web.console.libraries=/usr/share/prometheus/console_libraries\",\n"], [50, "        \"--web.console.templates=/usr/share/prometheus/consoles\",\n"], [51, "        \"--web.enable-lifecycle\"\n"], [52, "      ]\n"], [53, "\n"], [54, "      readonlyRootFilesystem = true\n"], [55, "    }\n"], [56, "  ])\n"], [57, "\n"], [58, "  volume {\n"], [59, "    name = \"prometheus-data\"\n"], [60, "    efs_volume_configuration {\n"], [61, "      file_system_id     = aws_efs_file_system.monitoring_data.id\n"], [62, "      transit_encryption = \"ENABLED\"\n"], [63, "      authorization_config {\n"], [64, "        access_point_id = aws_efs_access_point.prometheus_ap.id\n"], [65, "        iam             = \"ENABLED\"\n"], [66, "      }\n"], [67, "    }\n"], [68, "  }\n"], [69, "\n"], [70, "  volume {\n"], [71, "    name = \"prometheus-config\"\n"], [72, "    efs_volume_configuration {\n"], [73, "      file_system_id     = aws_efs_file_system.monitoring_data.id\n"], [74, "      transit_encryption = \"ENABLED\"\n"], [75, "      authorization_config {\n"], [76, "        access_point_id = aws_efs_access_point.prometheus_config_ap.id\n"], [77, "        iam             = \"ENABLED\"\n"], [78, "      }\n"], [79, "    }\n"], [80, "  }\n"], [81, "\n"], [82, "  tags = {\n"], [83, "    Name        = \"prometheus\"\n"], [84, "    Environment = var.environment\n"], [85, "  }\n"], [86, "}\n"]], "file_path": "\\modules\\monitoring\\prometheus.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf", "repo_file_path": "/modules/monitoring/prometheus.tf", "file_line_range": [1, 86], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_ecs_task_definition.prometheus", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSTaskDefinitionRoleCheck", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "prometheus"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-the-aws-execution-role-arn-and-task-role-arn-are-different-in-ecs-task-definitions", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf"}, {"check_id": "CKV_AWS_329", "bc_check_id": "BC_AWS_GENERAL_235", "check_name": "EFS access points should enforce a root directory", "check_result": {"result": "PASSED", "evaluated_keys": ["root_directory/[0]/path"]}, "code_block": [[88, "resource \"aws_efs_access_point\" \"prometheus_ap\" {\n"], [89, "  file_system_id = aws_efs_file_system.monitoring_data.id\n"], [90, "\n"], [91, "  posix_user {\n"], [92, "    uid = 65534 # nobody\n"], [93, "    gid = 65534 # nobody\n"], [94, "  }\n"], [95, "\n"], [96, "  root_directory {\n"], [97, "    path = \"/prometheus-data\"\n"], [98, "    creation_info {\n"], [99, "      owner_uid   = 65534\n"], [100, "      owner_gid   = 65534\n"], [101, "      permissions = \"755\"\n"], [102, "    }\n"], [103, "  }\n"], [104, "}\n"]], "file_path": "\\modules\\monitoring\\prometheus.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf", "repo_file_path": "/modules/monitoring/prometheus.tf", "file_line_range": [88, 104], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_efs_access_point.prometheus_ap", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EFSAccessPointRoot", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-329", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf"}, {"check_id": "CKV_AWS_330", "bc_check_id": "BC_AWS_GENERAL_236", "check_name": "EFS access points should enforce a user identity", "check_result": {"result": "PASSED", "evaluated_keys": ["posix_user/[0]/gid"]}, "code_block": [[88, "resource \"aws_efs_access_point\" \"prometheus_ap\" {\n"], [89, "  file_system_id = aws_efs_file_system.monitoring_data.id\n"], [90, "\n"], [91, "  posix_user {\n"], [92, "    uid = 65534 # nobody\n"], [93, "    gid = 65534 # nobody\n"], [94, "  }\n"], [95, "\n"], [96, "  root_directory {\n"], [97, "    path = \"/prometheus-data\"\n"], [98, "    creation_info {\n"], [99, "      owner_uid   = 65534\n"], [100, "      owner_gid   = 65534\n"], [101, "      permissions = \"755\"\n"], [102, "    }\n"], [103, "  }\n"], [104, "}\n"]], "file_path": "\\modules\\monitoring\\prometheus.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf", "repo_file_path": "/modules/monitoring/prometheus.tf", "file_line_range": [88, 104], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_efs_access_point.prometheus_ap", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EFSAccessUserIdentity", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-330", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf"}, {"check_id": "CKV_AWS_329", "bc_check_id": "BC_AWS_GENERAL_235", "check_name": "EFS access points should enforce a root directory", "check_result": {"result": "PASSED", "evaluated_keys": ["root_directory/[0]/path"]}, "code_block": [[106, "resource \"aws_efs_access_point\" \"prometheus_config_ap\" {\n"], [107, "  file_system_id = aws_efs_file_system.monitoring_data.id\n"], [108, "\n"], [109, "  posix_user {\n"], [110, "    uid = 65534 # nobody\n"], [111, "    gid = 65534 # nobody\n"], [112, "  }\n"], [113, "\n"], [114, "  root_directory {\n"], [115, "    path = \"/prometheus-config\"\n"], [116, "    creation_info {\n"], [117, "      owner_uid   = 65534\n"], [118, "      owner_gid   = 65534\n"], [119, "      permissions = \"755\"\n"], [120, "    }\n"], [121, "  }\n"], [122, "}\n"]], "file_path": "\\modules\\monitoring\\prometheus.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf", "repo_file_path": "/modules/monitoring/prometheus.tf", "file_line_range": [106, 122], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_efs_access_point.prometheus_config_ap", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EFSAccessPointRoot", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-329", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf"}, {"check_id": "CKV_AWS_330", "bc_check_id": "BC_AWS_GENERAL_236", "check_name": "EFS access points should enforce a user identity", "check_result": {"result": "PASSED", "evaluated_keys": ["posix_user/[0]/gid"]}, "code_block": [[106, "resource \"aws_efs_access_point\" \"prometheus_config_ap\" {\n"], [107, "  file_system_id = aws_efs_file_system.monitoring_data.id\n"], [108, "\n"], [109, "  posix_user {\n"], [110, "    uid = 65534 # nobody\n"], [111, "    gid = 65534 # nobody\n"], [112, "  }\n"], [113, "\n"], [114, "  root_directory {\n"], [115, "    path = \"/prometheus-config\"\n"], [116, "    creation_info {\n"], [117, "      owner_uid   = 65534\n"], [118, "      owner_gid   = 65534\n"], [119, "      permissions = \"755\"\n"], [120, "    }\n"], [121, "  }\n"], [122, "}\n"]], "file_path": "\\modules\\monitoring\\prometheus.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf", "repo_file_path": "/modules/monitoring/prometheus.tf", "file_line_range": [106, 122], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_efs_access_point.prometheus_config_ap", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EFSAccessUserIdentity", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-330", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\prometheus.tf"}, {"check_id": "CKV_AWS_385", "bc_check_id": null, "check_name": "Ensure AWS SNS topic policies do not allow cross-account access", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[13, "resource \"aws_sns_topic_policy\" \"infrastructure_alerts_policy\" {\n"], [14, "  arn = aws_sns_topic.infrastructure_alerts.arn\n"], [15, "\n"], [16, "  policy = jsonencode({\n"], [17, "    Version = \"2012-10-17\"\n"], [18, "    Id      = \"Default\"\n"], [19, "    Statement = [\n"], [20, "      {\n"], [21, "        Sid    = \"AllowAWSServicesToPublish\"\n"], [22, "        Effect = \"Allow\"\n"], [23, "        Principal = {\n"], [24, "          Service = [\n"], [25, "            \"cloudwatch.amazonaws.com\",\n"], [26, "            \"autoscaling.amazonaws.com\",\n"], [27, "            \"events.amazonaws.com\",\n"], [28, "            \"ssm.amazonaws.com\"\n"], [29, "          ]\n"], [30, "        }\n"], [31, "        Action   = \"SNS:Publish\"\n"], [32, "        Resource = aws_sns_topic.infrastructure_alerts.arn\n"], [33, "      }\n"], [34, "    ]\n"], [35, "  })\n"], [36, "}\n"]], "file_path": "\\modules\\monitoring\\sns.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\sns.tf", "repo_file_path": "/modules/monitoring/sns.tf", "file_line_range": [13, 36], "resource": "module.ecs_jenkins_github.module.monitoring.aws_sns_topic_policy.infrastructure_alerts_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SNSCrossAccountAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\sns.tf"}, {"check_id": "CKV_AWS_169", "bc_check_id": "BC_AWS_GENERAL_92", "check_name": "Ensure SNS topic policy is not public by only allowing specific services or principals to access it", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[13, "resource \"aws_sns_topic_policy\" \"infrastructure_alerts_policy\" {\n"], [14, "  arn = aws_sns_topic.infrastructure_alerts.arn\n"], [15, "\n"], [16, "  policy = jsonencode({\n"], [17, "    Version = \"2012-10-17\"\n"], [18, "    Id      = \"Default\"\n"], [19, "    Statement = [\n"], [20, "      {\n"], [21, "        Sid    = \"AllowAWSServicesToPublish\"\n"], [22, "        Effect = \"Allow\"\n"], [23, "        Principal = {\n"], [24, "          Service = [\n"], [25, "            \"cloudwatch.amazonaws.com\",\n"], [26, "            \"autoscaling.amazonaws.com\",\n"], [27, "            \"events.amazonaws.com\",\n"], [28, "            \"ssm.amazonaws.com\"\n"], [29, "          ]\n"], [30, "        }\n"], [31, "        Action   = \"SNS:Publish\"\n"], [32, "        Resource = aws_sns_topic.infrastructure_alerts.arn\n"], [33, "      }\n"], [34, "    ]\n"], [35, "  })\n"], [36, "}\n"]], "file_path": "\\modules\\monitoring\\sns.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\sns.tf", "repo_file_path": "/modules/monitoring/sns.tf", "file_line_range": [13, 36], "resource": "module.ecs_jenkins_github.module.monitoring.aws_sns_topic_policy.infrastructure_alerts_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SNSTopicPolicyAnyPrincipal", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-sns-topic-policy-is-not-public-by-only-allowing-specific-services-or-principals-to-access-it", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\sns.tf"}, {"check_id": "CKV_AWS_385", "bc_check_id": null, "check_name": "Ensure AWS SNS topic policies do not allow cross-account access", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[13, "resource \"aws_sns_topic_policy\" \"infrastructure_alerts_policy\" {\n"], [14, "  arn = aws_sns_topic.infrastructure_alerts.arn\n"], [15, "\n"], [16, "  policy = jsonencode({\n"], [17, "    Version = \"2012-10-17\"\n"], [18, "    Id      = \"Default\"\n"], [19, "    Statement = [\n"], [20, "      {\n"], [21, "        Sid    = \"AllowAWSServicesToPublish\"\n"], [22, "        Effect = \"Allow\"\n"], [23, "        Principal = {\n"], [24, "          Service = [\n"], [25, "            \"cloudwatch.amazonaws.com\",\n"], [26, "            \"autoscaling.amazonaws.com\",\n"], [27, "            \"events.amazonaws.com\",\n"], [28, "            \"ssm.amazonaws.com\"\n"], [29, "          ]\n"], [30, "        }\n"], [31, "        Action   = \"SNS:Publish\"\n"], [32, "        Resource = aws_sns_topic.infrastructure_alerts.arn\n"], [33, "      }\n"], [34, "    ]\n"], [35, "  })\n"], [36, "}\n"]], "file_path": "\\modules\\monitoring\\sns.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\sns.tf", "repo_file_path": "/modules/monitoring/sns.tf", "file_line_range": [13, 36], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_sns_topic_policy.infrastructure_alerts_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SNSCrossAccountAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\sns.tf"}, {"check_id": "CKV_AWS_169", "bc_check_id": "BC_AWS_GENERAL_92", "check_name": "Ensure SNS topic policy is not public by only allowing specific services or principals to access it", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[13, "resource \"aws_sns_topic_policy\" \"infrastructure_alerts_policy\" {\n"], [14, "  arn = aws_sns_topic.infrastructure_alerts.arn\n"], [15, "\n"], [16, "  policy = jsonencode({\n"], [17, "    Version = \"2012-10-17\"\n"], [18, "    Id      = \"Default\"\n"], [19, "    Statement = [\n"], [20, "      {\n"], [21, "        Sid    = \"AllowAWSServicesToPublish\"\n"], [22, "        Effect = \"Allow\"\n"], [23, "        Principal = {\n"], [24, "          Service = [\n"], [25, "            \"cloudwatch.amazonaws.com\",\n"], [26, "            \"autoscaling.amazonaws.com\",\n"], [27, "            \"events.amazonaws.com\",\n"], [28, "            \"ssm.amazonaws.com\"\n"], [29, "          ]\n"], [30, "        }\n"], [31, "        Action   = \"SNS:Publish\"\n"], [32, "        Resource = aws_sns_topic.infrastructure_alerts.arn\n"], [33, "      }\n"], [34, "    ]\n"], [35, "  })\n"], [36, "}\n"]], "file_path": "\\modules\\monitoring\\sns.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\sns.tf", "repo_file_path": "/modules/monitoring/sns.tf", "file_line_range": [13, 36], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_sns_topic_policy.infrastructure_alerts_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SNSTopicPolicyAnyPrincipal", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-sns-topic-policy-is-not-public-by-only-allowing-specific-services-or-principals-to-access-it", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\sns.tf"}, {"check_id": "CKV_AWS_168", "bc_check_id": "BC_AWS_GENERAL_91", "check_name": "Ensure SQS queue policy is not public by only allowing specific services or principals to access it", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[35, "resource \"aws_sqs_queue\" \"dr_notification_queue\" {\n"], [36, "  provider = aws.dr\n"], [37, "  name     = \"${var.project}-${var.environment}-dr-notifications\"\n"], [38, "\n"], [39, "  tags = {\n"], [40, "    Name        = \"${var.project}-${var.environment}-dr-notifications\"\n"], [41, "    Environment = var.environment\n"], [42, "    Project     = var.project\n"], [43, "  }\n"], [44, "}\n"]], "file_path": "\\modules\\multi-region\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\multi-region\\main.tf", "repo_file_path": "/modules/multi-region/main.tf", "file_line_range": [35, 44], "resource": "aws_sqs_queue.dr_notification_queue", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SQSQueuePolicyAnyPrincipal", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Name": "${var.project}-${var.environment}-dr-notifications", "Project": "var.project"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-sqs-queue-policy-is-not-public-by-only-allowing-specific-services-or-principals-to-access-it", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\multi-region\\main.tf"}, {"check_id": "CKV_AWS_337", "bc_check_id": "BC_AWS_GENERAL_242", "check_name": "Ensure SSM parameters are using KMS CMK", "check_result": {"result": "PASSED", "evaluated_keys": ["key_id"]}, "code_block": [[82, "resource \"aws_ssm_parameter\" \"failover_mode\" {\n"], [83, "  provider = aws.primary\n"], [84, "  name     = \"/${var.project}/${var.environment}/failover-mode\"\n"], [85, "  type     = \"String\"\n"], [86, "  value    = \"normal\" # Can be \"normal\", \"test\", \"activate_dr\", \"restore\"\n"], [87, "\n"], [88, "  tags = {\n"], [89, "    Environment = var.environment\n"], [90, "    Project     = var.project\n"], [91, "  }\n"], [92, "}\n"]], "file_path": "\\modules\\multi-region\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\multi-region\\main.tf", "repo_file_path": "/modules/multi-region/main.tf", "file_line_range": [82, 92], "resource": "aws_ssm_parameter.failover_mode", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SSMParameterUsesCMK", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Project": "var.project"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-337", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\multi-region\\main.tf"}, {"check_id": "CKV_AWS_337", "bc_check_id": "BC_AWS_GENERAL_242", "check_name": "Ensure SSM parameters are using KMS CMK", "check_result": {"result": "PASSED", "evaluated_keys": ["key_id"]}, "code_block": [[95, "resource \"aws_ssm_parameter\" \"replication_status\" {\n"], [96, "  provider = aws.primary\n"], [97, "  name     = \"/${var.project}/${var.environment}/replication-status\"\n"], [98, "  type     = \"String\"\n"], [99, "  value    = \"healthy\" # Status of data replication between regions\n"], [100, "\n"], [101, "  tags = {\n"], [102, "    Environment = var.environment\n"], [103, "    Project     = var.project\n"], [104, "  }\n"], [105, "}\n"]], "file_path": "\\modules\\multi-region\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\multi-region\\main.tf", "repo_file_path": "/modules/multi-region/main.tf", "file_line_range": [95, 105], "resource": "aws_ssm_parameter.replication_status", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SSMParameterUsesCMK", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Project": "var.project"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-337", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\multi-region\\main.tf"}, {"check_id": "CKV_AWS_41", "bc_check_id": "BC_AWS_SECRETS_5", "check_name": "Ensure no hard coded AWS access key and secret key exists in provider", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[4, "provider \"aws\" {\n"], [5, "  alias  = \"primary\"\n"], [6, "  region = var.primary_region\n"], [7, "}\n"]], "file_path": "\\modules\\multi-region\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\multi-region\\main.tf", "repo_file_path": "/modules/multi-region/main.tf", "file_line_range": [4, 7], "resource": "aws.primary", "evaluations": null, "check_class": "checkov.terraform.checks.provider.aws.credentials", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-5", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\multi-region\\main.tf"}, {"check_id": "CKV_AWS_41", "bc_check_id": "BC_AWS_SECRETS_5", "check_name": "Ensure no hard coded AWS access key and secret key exists in provider", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[10, "provider \"aws\" {\n"], [11, "  alias  = \"dr\"\n"], [12, "  region = var.dr_region\n"], [13, "}\n"]], "file_path": "\\modules\\multi-region\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\multi-region\\main.tf", "repo_file_path": "/modules/multi-region/main.tf", "file_line_range": [10, 13], "resource": "aws.dr", "evaluations": null, "check_class": "checkov.terraform.checks.provider.aws.credentials", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-5", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\multi-region\\main.tf"}, {"check_id": "CKV_AWS_130", "bc_check_id": "BC_AWS_NETWORKING_53", "check_name": "Ensure VPC subnets do not assign public IP by default", "check_result": {"result": "PASSED", "evaluated_keys": ["map_public_ip_on_launch"]}, "code_block": [[11, "resource \"aws_subnet\" \"public_subnet\" {\n"], [12, "  count                   = length(var.public_subnet_cidrs)\n"], [13, "  vpc_id                  = aws_vpc.vpc.id\n"], [14, "  cidr_block              = var.public_subnet_cidrs[count.index]\n"], [15, "  availability_zone       = var.availability_zones[count.index]\n"], [16, "  map_public_ip_on_launch = false # Not assigning public IPs by default\n"], [17, "\n"], [18, "  tags = {\n"], [19, "    Name = \"public-subnet-${count.index}\"\n"], [20, "  }\n"], [21, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [11, 21], "resource": "module.ecs_jenkins_github.module.network.aws_subnet.public_subnet[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP", "fixed_definition": null, "entity_tags": {"Name": "public-subnet-0"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_130", "bc_check_id": "BC_AWS_NETWORKING_53", "check_name": "Ensure VPC subnets do not assign public IP by default", "check_result": {"result": "PASSED", "evaluated_keys": ["map_public_ip_on_launch"]}, "code_block": [[23, "resource \"aws_subnet\" \"private_subnet\" {\n"], [24, "  count             = length(var.private_subnet_cidrs)\n"], [25, "  vpc_id            = aws_vpc.vpc.id\n"], [26, "  cidr_block        = var.private_subnet_cidrs[count.index]\n"], [27, "  availability_zone = var.availability_zones[count.index]\n"], [28, "\n"], [29, "  tags = {\n"], [30, "    Name = \"private-subnet-${count.index}\"\n"], [31, "  }\n"], [32, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [23, 32], "resource": "module.ecs_jenkins_github.module.network.aws_subnet.private_subnet[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP", "fixed_definition": null, "entity_tags": {"Name": "private-subnet-0"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_130", "bc_check_id": "BC_AWS_NETWORKING_53", "check_name": "Ensure VPC subnets do not assign public IP by default", "check_result": {"result": "PASSED", "evaluated_keys": ["map_public_ip_on_launch"]}, "code_block": [[34, "resource \"aws_subnet\" \"database_subnet\" {\n"], [35, "  count             = length(var.database_subnet_cidrs)\n"], [36, "  vpc_id            = aws_vpc.vpc.id\n"], [37, "  cidr_block        = var.database_subnet_cidrs[count.index]\n"], [38, "  availability_zone = var.availability_zones[count.index]\n"], [39, "\n"], [40, "  tags = {\n"], [41, "    Name = \"database-subnet-${count.index}\"\n"], [42, "  }\n"], [43, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [34, 43], "resource": "module.ecs_jenkins_github.module.network.aws_subnet.database_subnet[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP", "fixed_definition": null, "entity_tags": {"Name": "database-subnet-0"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_227", "bc_check_id": "BC_AWS_GENERAL_122", "check_name": "Ensure KMS key is enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["is_enabled"]}, "code_block": [[115, "resource \"aws_kms_key\" \"s3_kms_key\" {\n"], [116, "  description             = \"KMS key for S3 bucket encryption\"\n"], [117, "  deletion_window_in_days = 10\n"], [118, "  enable_key_rotation     = true\n"], [119, "  tags = {\n"], [120, "    Name        = \"s3-kms-key-${var.environment}\"\n"], [121, "    Environment = var.environment\n"], [122, "  }\n"], [123, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [115, 123], "resource": "module.ecs_jenkins_github.module.network.aws_kms_key.s3_kms_key", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.KMSKeyIsEnabled", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "s3-kms-key-prod"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-key-management-service-kms-key-is-enabled", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_33", "bc_check_id": "BC_AWS_IAM_63", "check_name": "Ensure KMS key policy does not contain wildcard (*) principal", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[115, "resource \"aws_kms_key\" \"s3_kms_key\" {\n"], [116, "  description             = \"KMS key for S3 bucket encryption\"\n"], [117, "  deletion_window_in_days = 10\n"], [118, "  enable_key_rotation     = true\n"], [119, "  tags = {\n"], [120, "    Name        = \"s3-kms-key-${var.environment}\"\n"], [121, "    Environment = var.environment\n"], [122, "  }\n"], [123, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [115, 123], "resource": "module.ecs_jenkins_github.module.network.aws_kms_key.s3_kms_key", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.KMSKeyWildcardPrincipal", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "s3-kms-key-prod"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-kms-key-policy-does-not-contain-wildcard-principal", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_7", "bc_check_id": "BC_AWS_LOGGING_8", "check_name": "Ensure rotation for customer created CMKs is enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["enable_key_rotation"]}, "code_block": [[115, "resource \"aws_kms_key\" \"s3_kms_key\" {\n"], [116, "  description             = \"KMS key for S3 bucket encryption\"\n"], [117, "  deletion_window_in_days = 10\n"], [118, "  enable_key_rotation     = true\n"], [119, "  tags = {\n"], [120, "    Name        = \"s3-kms-key-${var.environment}\"\n"], [121, "    Environment = var.environment\n"], [122, "  }\n"], [123, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [115, 123], "resource": "module.ecs_jenkins_github.module.network.aws_kms_key.s3_kms_key", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.KMSRotation", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "s3-kms-key-prod"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-8", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_93", "bc_check_id": "BC_AWS_S3_24", "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[126, "resource \"aws_s3_bucket\" \"alb_logs\" {\n"], [127, "  bucket        = \"alb-logs-${var.environment}-${random_string.suffix.result}\"\n"], [128, "  force_destroy = true\n"], [129, "\n"], [130, "  tags = {\n"], [131, "    Name        = \"alb-access-logs\"\n"], [132, "    Environment = var.environment\n"], [133, "  }\n"], [134, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [126, 134], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "alb-access-logs"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-24", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_93", "bc_check_id": "BC_AWS_S3_24", "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[137, "resource \"aws_s3_bucket\" \"alb_logs_access_logs\" {\n"], [138, "  bucket        = \"alb-logs-access-${var.environment}-${random_string.suffix.result}\"\n"], [139, "  force_destroy = true\n"], [140, "\n"], [141, "  tags = {\n"], [142, "    Name        = \"alb-access-logs-access\"\n"], [143, "    Environment = var.environment\n"], [144, "  }\n"], [145, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [137, 145], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs_access_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "alb-access-logs-access"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-24", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_93", "bc_check_id": "BC_AWS_S3_24", "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[148, "resource \"aws_s3_bucket\" \"replication_logs\" {\n"], [149, "  bucket        = \"replication-logs-${var.environment}-${random_string.suffix.result}\"\n"], [150, "  force_destroy = true\n"], [151, "\n"], [152, "  tags = {\n"], [153, "    Name        = \"replication-logs\"\n"], [154, "    Environment = var.environment\n"], [155, "  }\n"], [156, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [148, 156], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.replication_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "replication-logs"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-24", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[159, "resource \"aws_iam_role\" \"replication\" {\n"], [160, "  name = \"s3-replication-role-${var.environment}\"\n"], [161, "\n"], [162, "  assume_role_policy = jsonencode({\n"], [163, "    Version = \"2012-10-17\"\n"], [164, "    Statement = [\n"], [165, "      {\n"], [166, "        Action = \"sts:AssumeRole\"\n"], [167, "        Effect = \"Allow\"\n"], [168, "        Principal = {\n"], [169, "          Service = \"s3.amazonaws.com\"\n"], [170, "        }\n"], [171, "      },\n"], [172, "    ]\n"], [173, "  })\n"], [174, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [159, 174], "resource": "module.ecs_jenkins_github.module.network.aws_iam_role.replication", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[159, "resource \"aws_iam_role\" \"replication\" {\n"], [160, "  name = \"s3-replication-role-${var.environment}\"\n"], [161, "\n"], [162, "  assume_role_policy = jsonencode({\n"], [163, "    Version = \"2012-10-17\"\n"], [164, "    Statement = [\n"], [165, "      {\n"], [166, "        Action = \"sts:AssumeRole\"\n"], [167, "        Effect = \"Allow\"\n"], [168, "        Principal = {\n"], [169, "          Service = \"s3.amazonaws.com\"\n"], [170, "        }\n"], [171, "      },\n"], [172, "    ]\n"], [173, "  })\n"], [174, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [159, 174], "resource": "module.ecs_jenkins_github.module.network.aws_iam_role.replication", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[159, "resource \"aws_iam_role\" \"replication\" {\n"], [160, "  name = \"s3-replication-role-${var.environment}\"\n"], [161, "\n"], [162, "  assume_role_policy = jsonencode({\n"], [163, "    Version = \"2012-10-17\"\n"], [164, "    Statement = [\n"], [165, "      {\n"], [166, "        Action = \"sts:AssumeRole\"\n"], [167, "        Effect = \"Allow\"\n"], [168, "        Principal = {\n"], [169, "          Service = \"s3.amazonaws.com\"\n"], [170, "        }\n"], [171, "      },\n"], [172, "    ]\n"], [173, "  })\n"], [174, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [159, 174], "resource": "module.ecs_jenkins_github.module.network.aws_iam_role.replication", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_62", "bc_check_id": "BC_AWS_IAM_47", "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[176, "resource \"aws_iam_policy\" \"replication\" {\n"], [177, "  name = \"s3-replication-policy-${var.environment}\"\n"], [178, "  policy = jsonencode({\n"], [179, "    Version = \"2012-10-17\"\n"], [180, "    Statement = [\n"], [181, "      {\n"], [182, "        Effect = \"Allow\"\n"], [183, "        Action = [\n"], [184, "          \"s3:GetReplicationConfiguration\",\n"], [185, "          \"s3:ListBucket\"\n"], [186, "        ],\n"], [187, "        Resource = [\n"], [188, "          aws_s3_bucket.alb_logs.arn,\n"], [189, "          aws_s3_bucket.alb_logs_access_logs.arn\n"], [190, "        ]\n"], [191, "      },\n"], [192, "      {\n"], [193, "        Effect = \"Allow\"\n"], [194, "        Action = [\n"], [195, "          \"s3:GetObjectVersionForReplication\",\n"], [196, "          \"s3:GetObjectVersionAcl\",\n"], [197, "          \"s3:GetObjectVersionTagging\"\n"], [198, "        ],\n"], [199, "        Resource = [\n"], [200, "          \"${aws_s3_bucket.alb_logs.arn}/*\",\n"], [201, "          \"${aws_s3_bucket.alb_logs_access_logs.arn}/*\"\n"], [202, "        ]\n"], [203, "      },\n"], [204, "      {\n"], [205, "        Effect = \"Allow\"\n"], [206, "        Action = [\n"], [207, "          \"s3:ReplicateObject\",\n"], [208, "          \"s3:ReplicateDelete\",\n"], [209, "          \"s3:ReplicateTags\"\n"], [210, "        ],\n"], [211, "        Resource = [\n"], [212, "          \"${aws_s3_bucket.alb_logs.arn}/*\",\n"], [213, "          \"${aws_s3_bucket.alb_logs_access_logs.arn}/*\"\n"], [214, "        ]\n"], [215, "      }\n"], [216, "    ]\n"], [217, "  })\n"], [218, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [176, 218], "resource": "module.ecs_jenkins_github.module.network.aws_iam_policy.replication", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMAdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_63", "bc_check_id": "BC_AWS_IAM_48", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[176, "resource \"aws_iam_policy\" \"replication\" {\n"], [177, "  name = \"s3-replication-policy-${var.environment}\"\n"], [178, "  policy = jsonencode({\n"], [179, "    Version = \"2012-10-17\"\n"], [180, "    Statement = [\n"], [181, "      {\n"], [182, "        Effect = \"Allow\"\n"], [183, "        Action = [\n"], [184, "          \"s3:GetReplicationConfiguration\",\n"], [185, "          \"s3:ListBucket\"\n"], [186, "        ],\n"], [187, "        Resource = [\n"], [188, "          aws_s3_bucket.alb_logs.arn,\n"], [189, "          aws_s3_bucket.alb_logs_access_logs.arn\n"], [190, "        ]\n"], [191, "      },\n"], [192, "      {\n"], [193, "        Effect = \"Allow\"\n"], [194, "        Action = [\n"], [195, "          \"s3:GetObjectVersionForReplication\",\n"], [196, "          \"s3:GetObjectVersionAcl\",\n"], [197, "          \"s3:GetObjectVersionTagging\"\n"], [198, "        ],\n"], [199, "        Resource = [\n"], [200, "          \"${aws_s3_bucket.alb_logs.arn}/*\",\n"], [201, "          \"${aws_s3_bucket.alb_logs_access_logs.arn}/*\"\n"], [202, "        ]\n"], [203, "      },\n"], [204, "      {\n"], [205, "        Effect = \"Allow\"\n"], [206, "        Action = [\n"], [207, "          \"s3:ReplicateObject\",\n"], [208, "          \"s3:ReplicateDelete\",\n"], [209, "          \"s3:ReplicateTags\"\n"], [210, "        ],\n"], [211, "        Resource = [\n"], [212, "          \"${aws_s3_bucket.alb_logs.arn}/*\",\n"], [213, "          \"${aws_s3_bucket.alb_logs_access_logs.arn}/*\"\n"], [214, "        ]\n"], [215, "      }\n"], [216, "    ]\n"], [217, "  })\n"], [218, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [176, 218], "resource": "module.ecs_jenkins_github.module.network.aws_iam_policy.replication", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[220, "resource \"aws_iam_role_policy_attachment\" \"replication\" {\n"], [221, "  role       = aws_iam_role.replication.name\n"], [222, "  policy_arn = aws_iam_policy.replication.arn\n"], [223, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [220, 223], "resource": "module.ecs_jenkins_github.module.network.aws_iam_role_policy_attachment.replication", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_53", "bc_check_id": "BC_AWS_S3_19", "check_name": "Ensure S3 bucket has block public ACLS enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["block_public_acls"]}, "code_block": [[307, "resource \"aws_s3_bucket_public_access_block\" \"replication_logs_public_access\" {\n"], [308, "  bucket = aws_s3_bucket.replication_logs.id\n"], [309, "\n"], [310, "  block_public_acls       = true\n"], [311, "  block_public_policy     = true\n"], [312, "  ignore_public_acls      = true\n"], [313, "  restrict_public_buckets = true\n"], [314, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [307, 314], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket_public_access_block.replication_logs_public_access", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-19", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_54", "bc_check_id": "BC_AWS_S3_20", "check_name": "Ensure S3 bucket has block public policy enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["block_public_policy"]}, "code_block": [[307, "resource \"aws_s3_bucket_public_access_block\" \"replication_logs_public_access\" {\n"], [308, "  bucket = aws_s3_bucket.replication_logs.id\n"], [309, "\n"], [310, "  block_public_acls       = true\n"], [311, "  block_public_policy     = true\n"], [312, "  ignore_public_acls      = true\n"], [313, "  restrict_public_buckets = true\n"], [314, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [307, 314], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket_public_access_block.replication_logs_public_access", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-20", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_55", "bc_check_id": "BC_AWS_S3_21", "check_name": "Ensure S3 bucket has ignore public ACLs enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["ignore_public_acls"]}, "code_block": [[307, "resource \"aws_s3_bucket_public_access_block\" \"replication_logs_public_access\" {\n"], [308, "  bucket = aws_s3_bucket.replication_logs.id\n"], [309, "\n"], [310, "  block_public_acls       = true\n"], [311, "  block_public_policy     = true\n"], [312, "  ignore_public_acls      = true\n"], [313, "  restrict_public_buckets = true\n"], [314, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [307, 314], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket_public_access_block.replication_logs_public_access", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3IgnorePublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-21", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_56", "bc_check_id": "BC_AWS_S3_22", "check_name": "Ensure S3 bucket has 'restrict_public_buckets' enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["restrict_public_buckets"]}, "code_block": [[307, "resource \"aws_s3_bucket_public_access_block\" \"replication_logs_public_access\" {\n"], [308, "  bucket = aws_s3_bucket.replication_logs.id\n"], [309, "\n"], [310, "  block_public_acls       = true\n"], [311, "  block_public_policy     = true\n"], [312, "  ignore_public_acls      = true\n"], [313, "  restrict_public_buckets = true\n"], [314, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [307, 314], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket_public_access_block.replication_logs_public_access", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3RestrictPublicBuckets", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-22", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_53", "bc_check_id": "BC_AWS_S3_19", "check_name": "Ensure S3 bucket has block public ACLS enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["block_public_acls"]}, "code_block": [[317, "resource \"aws_s3_bucket_public_access_block\" \"alb_logs_public_access\" {\n"], [318, "  bucket = aws_s3_bucket.alb_logs.id\n"], [319, "\n"], [320, "  block_public_acls       = true\n"], [321, "  block_public_policy     = true\n"], [322, "  ignore_public_acls      = true\n"], [323, "  restrict_public_buckets = true\n"], [324, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [317, 324], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket_public_access_block.alb_logs_public_access", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-19", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_54", "bc_check_id": "BC_AWS_S3_20", "check_name": "Ensure S3 bucket has block public policy enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["block_public_policy"]}, "code_block": [[317, "resource \"aws_s3_bucket_public_access_block\" \"alb_logs_public_access\" {\n"], [318, "  bucket = aws_s3_bucket.alb_logs.id\n"], [319, "\n"], [320, "  block_public_acls       = true\n"], [321, "  block_public_policy     = true\n"], [322, "  ignore_public_acls      = true\n"], [323, "  restrict_public_buckets = true\n"], [324, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [317, 324], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket_public_access_block.alb_logs_public_access", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-20", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_55", "bc_check_id": "BC_AWS_S3_21", "check_name": "Ensure S3 bucket has ignore public ACLs enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["ignore_public_acls"]}, "code_block": [[317, "resource \"aws_s3_bucket_public_access_block\" \"alb_logs_public_access\" {\n"], [318, "  bucket = aws_s3_bucket.alb_logs.id\n"], [319, "\n"], [320, "  block_public_acls       = true\n"], [321, "  block_public_policy     = true\n"], [322, "  ignore_public_acls      = true\n"], [323, "  restrict_public_buckets = true\n"], [324, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [317, 324], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket_public_access_block.alb_logs_public_access", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3IgnorePublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-21", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_56", "bc_check_id": "BC_AWS_S3_22", "check_name": "Ensure S3 bucket has 'restrict_public_buckets' enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["restrict_public_buckets"]}, "code_block": [[317, "resource \"aws_s3_bucket_public_access_block\" \"alb_logs_public_access\" {\n"], [318, "  bucket = aws_s3_bucket.alb_logs.id\n"], [319, "\n"], [320, "  block_public_acls       = true\n"], [321, "  block_public_policy     = true\n"], [322, "  ignore_public_acls      = true\n"], [323, "  restrict_public_buckets = true\n"], [324, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [317, 324], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket_public_access_block.alb_logs_public_access", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3RestrictPublicBuckets", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-22", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_53", "bc_check_id": "BC_AWS_S3_19", "check_name": "Ensure S3 bucket has block public ACLS enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["block_public_acls"]}, "code_block": [[327, "resource \"aws_s3_bucket_public_access_block\" \"alb_logs_access_public_access\" {\n"], [328, "  bucket = aws_s3_bucket.alb_logs_access_logs.id\n"], [329, "\n"], [330, "  block_public_acls       = true\n"], [331, "  block_public_policy     = true\n"], [332, "  ignore_public_acls      = true\n"], [333, "  restrict_public_buckets = true\n"], [334, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [327, 334], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket_public_access_block.alb_logs_access_public_access", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-19", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_54", "bc_check_id": "BC_AWS_S3_20", "check_name": "Ensure S3 bucket has block public policy enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["block_public_policy"]}, "code_block": [[327, "resource \"aws_s3_bucket_public_access_block\" \"alb_logs_access_public_access\" {\n"], [328, "  bucket = aws_s3_bucket.alb_logs_access_logs.id\n"], [329, "\n"], [330, "  block_public_acls       = true\n"], [331, "  block_public_policy     = true\n"], [332, "  ignore_public_acls      = true\n"], [333, "  restrict_public_buckets = true\n"], [334, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [327, 334], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket_public_access_block.alb_logs_access_public_access", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-20", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_55", "bc_check_id": "BC_AWS_S3_21", "check_name": "Ensure S3 bucket has ignore public ACLs enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["ignore_public_acls"]}, "code_block": [[327, "resource \"aws_s3_bucket_public_access_block\" \"alb_logs_access_public_access\" {\n"], [328, "  bucket = aws_s3_bucket.alb_logs_access_logs.id\n"], [329, "\n"], [330, "  block_public_acls       = true\n"], [331, "  block_public_policy     = true\n"], [332, "  ignore_public_acls      = true\n"], [333, "  restrict_public_buckets = true\n"], [334, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [327, 334], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket_public_access_block.alb_logs_access_public_access", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3IgnorePublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-21", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_56", "bc_check_id": "BC_AWS_S3_22", "check_name": "Ensure S3 bucket has 'restrict_public_buckets' enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["restrict_public_buckets"]}, "code_block": [[327, "resource \"aws_s3_bucket_public_access_block\" \"alb_logs_access_public_access\" {\n"], [328, "  bucket = aws_s3_bucket.alb_logs_access_logs.id\n"], [329, "\n"], [330, "  block_public_acls       = true\n"], [331, "  block_public_policy     = true\n"], [332, "  ignore_public_acls      = true\n"], [333, "  restrict_public_buckets = true\n"], [334, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [327, 334], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket_public_access_block.alb_logs_access_public_access", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3RestrictPublicBuckets", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-22", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_70", "bc_check_id": "BC_AWS_S3_23", "check_name": "Ensure S3 bucket does not allow an action with any Principal", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[386, "resource \"aws_s3_bucket_policy\" \"alb_logs_policy\" {\n"], [387, "  bucket = aws_s3_bucket.alb_logs.id\n"], [388, "\n"], [389, "  policy = jsonencode({\n"], [390, "    Version = \"2012-10-17\"\n"], [391, "    Statement = [\n"], [392, "      {\n"], [393, "        Effect = \"Allow\"\n"], [394, "        Principal = {\n"], [395, "          AWS = \"arn:aws:iam::elb-account-id:root\" # Replace with actual ALB account ID\n"], [396, "        }\n"], [397, "        Action   = \"s3:PutObject\"\n"], [398, "        Resource = \"${aws_s3_bucket.alb_logs.arn}/*\"\n"], [399, "      }\n"], [400, "    ]\n"], [401, "  })\n"], [402, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [386, 402], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket_policy.alb_logs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3AllowsAnyPrincipal", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-23", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_93", "bc_check_id": "BC_AWS_S3_24", "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[386, "resource \"aws_s3_bucket_policy\" \"alb_logs_policy\" {\n"], [387, "  bucket = aws_s3_bucket.alb_logs.id\n"], [388, "\n"], [389, "  policy = jsonencode({\n"], [390, "    Version = \"2012-10-17\"\n"], [391, "    Statement = [\n"], [392, "      {\n"], [393, "        Effect = \"Allow\"\n"], [394, "        Principal = {\n"], [395, "          AWS = \"arn:aws:iam::elb-account-id:root\" # Replace with actual ALB account ID\n"], [396, "        }\n"], [397, "        Action   = \"s3:PutObject\"\n"], [398, "        Resource = \"${aws_s3_bucket.alb_logs.arn}/*\"\n"], [399, "      }\n"], [400, "    ]\n"], [401, "  })\n"], [402, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [386, 402], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket_policy.alb_logs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-24", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "PASSED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[413, "resource \"aws_cloudwatch_log_group\" \"vpc_flow_logs\" {\n"], [414, "  name              = \"/aws/vpc/flow-logs\"\n"], [415, "  retention_in_days = 365\n"], [416, "  kms_key_id        = aws_kms_key.logs_key.arn\n"], [417, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [413, 417], "resource": "module.ecs_jenkins_github.module.network.aws_cloudwatch_log_group.vpc_flow_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_66", "bc_check_id": "BC_AWS_LOGGING_13", "check_name": "Ensure that CloudWatch Log Group specifies retention days", "check_result": {"result": "PASSED", "evaluated_keys": ["retention_in_days"]}, "code_block": [[413, "resource \"aws_cloudwatch_log_group\" \"vpc_flow_logs\" {\n"], [414, "  name              = \"/aws/vpc/flow-logs\"\n"], [415, "  retention_in_days = 365\n"], [416, "  kms_key_id        = aws_kms_key.logs_key.arn\n"], [417, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [413, 417], "resource": "module.ecs_jenkins_github.module.network.aws_cloudwatch_log_group.vpc_flow_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetention", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-13", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_338", "bc_check_id": "BC_AWS_LOGGING_46", "check_name": "Ensure CloudWatch log groups retains logs for at least 1 year", "check_result": {"result": "PASSED", "evaluated_keys": ["retention_in_days"]}, "code_block": [[413, "resource \"aws_cloudwatch_log_group\" \"vpc_flow_logs\" {\n"], [414, "  name              = \"/aws/vpc/flow-logs\"\n"], [415, "  retention_in_days = 365\n"], [416, "  kms_key_id        = aws_kms_key.logs_key.arn\n"], [417, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [413, 417], "resource": "module.ecs_jenkins_github.module.network.aws_cloudwatch_log_group.vpc_flow_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetentionYear", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_227", "bc_check_id": "BC_AWS_GENERAL_122", "check_name": "Ensure KMS key is enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["is_enabled"]}, "code_block": [[419, "resource \"aws_kms_key\" \"logs_key\" {\n"], [420, "  description             = \"KMS key for VPC flow logs\"\n"], [421, "  deletion_window_in_days = 30\n"], [422, "  enable_key_rotation     = true\n"], [423, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [419, 423], "resource": "module.ecs_jenkins_github.module.network.aws_kms_key.logs_key", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.KMSKeyIsEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-key-management-service-kms-key-is-enabled", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_33", "bc_check_id": "BC_AWS_IAM_63", "check_name": "Ensure KMS key policy does not contain wildcard (*) principal", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[419, "resource \"aws_kms_key\" \"logs_key\" {\n"], [420, "  description             = \"KMS key for VPC flow logs\"\n"], [421, "  deletion_window_in_days = 30\n"], [422, "  enable_key_rotation     = true\n"], [423, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [419, 423], "resource": "module.ecs_jenkins_github.module.network.aws_kms_key.logs_key", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.KMSKeyWildcardPrincipal", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-kms-key-policy-does-not-contain-wildcard-principal", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_7", "bc_check_id": "BC_AWS_LOGGING_8", "check_name": "Ensure rotation for customer created CMKs is enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["enable_key_rotation"]}, "code_block": [[419, "resource \"aws_kms_key\" \"logs_key\" {\n"], [420, "  description             = \"KMS key for VPC flow logs\"\n"], [421, "  deletion_window_in_days = 30\n"], [422, "  enable_key_rotation     = true\n"], [423, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [419, 423], "resource": "module.ecs_jenkins_github.module.network.aws_kms_key.logs_key", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.KMSRotation", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-8", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[425, "resource \"aws_iam_role\" \"vpc_flow_logs_role\" {\n"], [426, "  name = \"vpc-flow-logs-role\"\n"], [427, "\n"], [428, "  assume_role_policy = jsonencode({\n"], [429, "    Version = \"2012-10-17\"\n"], [430, "    Statement = [\n"], [431, "      {\n"], [432, "        Action = \"sts:AssumeRole\"\n"], [433, "        Effect = \"Allow\"\n"], [434, "        Principal = {\n"], [435, "          Service = \"vpc-flow-logs.amazonaws.com\"\n"], [436, "        }\n"], [437, "      }\n"], [438, "    ]\n"], [439, "  })\n"], [440, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [425, 440], "resource": "module.ecs_jenkins_github.module.network.aws_iam_role.vpc_flow_logs_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[425, "resource \"aws_iam_role\" \"vpc_flow_logs_role\" {\n"], [426, "  name = \"vpc-flow-logs-role\"\n"], [427, "\n"], [428, "  assume_role_policy = jsonencode({\n"], [429, "    Version = \"2012-10-17\"\n"], [430, "    Statement = [\n"], [431, "      {\n"], [432, "        Action = \"sts:AssumeRole\"\n"], [433, "        Effect = \"Allow\"\n"], [434, "        Principal = {\n"], [435, "          Service = \"vpc-flow-logs.amazonaws.com\"\n"], [436, "        }\n"], [437, "      }\n"], [438, "    ]\n"], [439, "  })\n"], [440, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [425, 440], "resource": "module.ecs_jenkins_github.module.network.aws_iam_role.vpc_flow_logs_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[425, "resource \"aws_iam_role\" \"vpc_flow_logs_role\" {\n"], [426, "  name = \"vpc-flow-logs-role\"\n"], [427, "\n"], [428, "  assume_role_policy = jsonencode({\n"], [429, "    Version = \"2012-10-17\"\n"], [430, "    Statement = [\n"], [431, "      {\n"], [432, "        Action = \"sts:AssumeRole\"\n"], [433, "        Effect = \"Allow\"\n"], [434, "        Principal = {\n"], [435, "          Service = \"vpc-flow-logs.amazonaws.com\"\n"], [436, "        }\n"], [437, "      }\n"], [438, "    ]\n"], [439, "  })\n"], [440, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [425, 440], "resource": "module.ecs_jenkins_github.module.network.aws_iam_role.vpc_flow_logs_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_62", "bc_check_id": "BC_AWS_IAM_47", "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[442, "resource \"aws_iam_role_policy\" \"vpc_flow_logs_policy\" {\n"], [443, "  name = \"vpc-flow-logs-policy\"\n"], [444, "  role = aws_iam_role.vpc_flow_logs_role.id\n"], [445, "\n"], [446, "  policy = jsonencode({\n"], [447, "    Version = \"2012-10-17\"\n"], [448, "    Statement = [\n"], [449, "      {\n"], [450, "        Action = [\n"], [451, "          \"logs:CreateLogGroup\",\n"], [452, "          \"logs:CreateLogStream\",\n"], [453, "          \"logs:PutLogEvents\",\n"], [454, "          \"logs:DescribeLogGroups\",\n"], [455, "          \"logs:DescribeLogStreams\"\n"], [456, "        ]\n"], [457, "        Effect   = \"Allow\"\n"], [458, "        Resource = \"*\"\n"], [459, "      }\n"], [460, "    ]\n"], [461, "  })\n"], [462, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [442, 462], "resource": "module.ecs_jenkins_github.module.network.aws_iam_role_policy.vpc_flow_logs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMAdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_287", "bc_check_id": "BC_AWS_IAM_82", "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[442, "resource \"aws_iam_role_policy\" \"vpc_flow_logs_policy\" {\n"], [443, "  name = \"vpc-flow-logs-policy\"\n"], [444, "  role = aws_iam_role.vpc_flow_logs_role.id\n"], [445, "\n"], [446, "  policy = jsonencode({\n"], [447, "    Version = \"2012-10-17\"\n"], [448, "    Statement = [\n"], [449, "      {\n"], [450, "        Action = [\n"], [451, "          \"logs:CreateLogGroup\",\n"], [452, "          \"logs:CreateLogStream\",\n"], [453, "          \"logs:PutLogEvents\",\n"], [454, "          \"logs:DescribeLogGroups\",\n"], [455, "          \"logs:DescribeLogStreams\"\n"], [456, "        ]\n"], [457, "        Effect   = \"Allow\"\n"], [458, "        Resource = \"*\"\n"], [459, "      }\n"], [460, "    ]\n"], [461, "  })\n"], [462, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [442, 462], "resource": "module.ecs_jenkins_github.module.network.aws_iam_role_policy.vpc_flow_logs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-287", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_288", "bc_check_id": "BC_AWS_IAM_83", "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[442, "resource \"aws_iam_role_policy\" \"vpc_flow_logs_policy\" {\n"], [443, "  name = \"vpc-flow-logs-policy\"\n"], [444, "  role = aws_iam_role.vpc_flow_logs_role.id\n"], [445, "\n"], [446, "  policy = jsonencode({\n"], [447, "    Version = \"2012-10-17\"\n"], [448, "    Statement = [\n"], [449, "      {\n"], [450, "        Action = [\n"], [451, "          \"logs:CreateLogGroup\",\n"], [452, "          \"logs:CreateLogStream\",\n"], [453, "          \"logs:PutLogEvents\",\n"], [454, "          \"logs:DescribeLogGroups\",\n"], [455, "          \"logs:DescribeLogStreams\"\n"], [456, "        ]\n"], [457, "        Effect   = \"Allow\"\n"], [458, "        Resource = \"*\"\n"], [459, "      }\n"], [460, "    ]\n"], [461, "  })\n"], [462, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [442, 462], "resource": "module.ecs_jenkins_github.module.network.aws_iam_role_policy.vpc_flow_logs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-288", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_289", "bc_check_id": "BC_AWS_IAM_84", "check_name": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[442, "resource \"aws_iam_role_policy\" \"vpc_flow_logs_policy\" {\n"], [443, "  name = \"vpc-flow-logs-policy\"\n"], [444, "  role = aws_iam_role.vpc_flow_logs_role.id\n"], [445, "\n"], [446, "  policy = jsonencode({\n"], [447, "    Version = \"2012-10-17\"\n"], [448, "    Statement = [\n"], [449, "      {\n"], [450, "        Action = [\n"], [451, "          \"logs:CreateLogGroup\",\n"], [452, "          \"logs:CreateLogStream\",\n"], [453, "          \"logs:PutLogEvents\",\n"], [454, "          \"logs:DescribeLogGroups\",\n"], [455, "          \"logs:DescribeLogStreams\"\n"], [456, "        ]\n"], [457, "        Effect   = \"Allow\"\n"], [458, "        Resource = \"*\"\n"], [459, "      }\n"], [460, "    ]\n"], [461, "  })\n"], [462, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [442, 462], "resource": "module.ecs_jenkins_github.module.network.aws_iam_role_policy.vpc_flow_logs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-289", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_286", "bc_check_id": "BC_AWS_IAM_81", "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[442, "resource \"aws_iam_role_policy\" \"vpc_flow_logs_policy\" {\n"], [443, "  name = \"vpc-flow-logs-policy\"\n"], [444, "  role = aws_iam_role.vpc_flow_logs_role.id\n"], [445, "\n"], [446, "  policy = jsonencode({\n"], [447, "    Version = \"2012-10-17\"\n"], [448, "    Statement = [\n"], [449, "      {\n"], [450, "        Action = [\n"], [451, "          \"logs:CreateLogGroup\",\n"], [452, "          \"logs:CreateLogStream\",\n"], [453, "          \"logs:PutLogEvents\",\n"], [454, "          \"logs:DescribeLogGroups\",\n"], [455, "          \"logs:DescribeLogStreams\"\n"], [456, "        ]\n"], [457, "        Effect   = \"Allow\"\n"], [458, "        Resource = \"*\"\n"], [459, "      }\n"], [460, "    ]\n"], [461, "  })\n"], [462, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [442, 462], "resource": "module.ecs_jenkins_github.module.network.aws_iam_role_policy.vpc_flow_logs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-286", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_63", "bc_check_id": "BC_AWS_IAM_48", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[442, "resource \"aws_iam_role_policy\" \"vpc_flow_logs_policy\" {\n"], [443, "  name = \"vpc-flow-logs-policy\"\n"], [444, "  role = aws_iam_role.vpc_flow_logs_role.id\n"], [445, "\n"], [446, "  policy = jsonencode({\n"], [447, "    Version = \"2012-10-17\"\n"], [448, "    Statement = [\n"], [449, "      {\n"], [450, "        Action = [\n"], [451, "          \"logs:CreateLogGroup\",\n"], [452, "          \"logs:CreateLogStream\",\n"], [453, "          \"logs:PutLogEvents\",\n"], [454, "          \"logs:DescribeLogGroups\",\n"], [455, "          \"logs:DescribeLogStreams\"\n"], [456, "        ]\n"], [457, "        Effect   = \"Allow\"\n"], [458, "        Resource = \"*\"\n"], [459, "      }\n"], [460, "    ]\n"], [461, "  })\n"], [462, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [442, 462], "resource": "module.ecs_jenkins_github.module.network.aws_iam_role_policy.vpc_flow_logs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_382", "bc_check_id": "BC_AWS_IAM_93", "check_name": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[465, "resource \"aws_security_group\" \"alb_security_group\" {\n"], [466, "  name        = \"alb-security-group\"\n"], [467, "  description = \"Security group for application load balancer\"\n"], [468, "  vpc_id      = aws_vpc.vpc.id\n"], [469, "\n"], [470, "  # Allow incoming HTTPS traffic only\n"], [471, "  ingress {\n"], [472, "    description = \"HTTPS from internet\"\n"], [473, "    from_port   = 443\n"], [474, "    to_port     = 443\n"], [475, "    protocol    = \"tcp\"\n"], [476, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [477, "  }\n"], [478, "\n"], [479, "  # HTTP for redirection only (will be redirected to HTTPS)\n"], [480, "  ingress {\n"], [481, "    description = \"HTTP from internet (for redirection to HTTPS)\"\n"], [482, "    from_port   = 80\n"], [483, "    to_port     = 80\n"], [484, "    protocol    = \"tcp\"\n"], [485, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [486, "  }\n"], [487, "\n"], [488, "  # Restricted egress rules\n"], [489, "  egress {\n"], [490, "    description = \"HTTP to ECS services\"\n"], [491, "    from_port   = 80\n"], [492, "    to_port     = 80\n"], [493, "    protocol    = \"tcp\"\n"], [494, "    cidr_blocks = [aws_vpc.vpc.cidr_block] # Allow traffic to any private IP in the VPC\n"], [495, "  }\n"], [496, "\n"], [497, "  egress {\n"], [498, "    description = \"HTTPS to internet for external resources\"\n"], [499, "    from_port   = 443\n"], [500, "    to_port     = 443\n"], [501, "    protocol    = \"tcp\"\n"], [502, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [503, "  }\n"], [504, "\n"], [505, "  tags = {\n"], [506, "    Name = \"alb-security-group\"\n"], [507, "  }\n"], [508, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [465, 508], "resource": "module.ecs_jenkins_github.module.network.aws_security_group.alb_security_group", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedEgressAny", "fixed_definition": null, "entity_tags": {"Name": "alb-security-group"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[465, "resource \"aws_security_group\" \"alb_security_group\" {\n"], [466, "  name        = \"alb-security-group\"\n"], [467, "  description = \"Security group for application load balancer\"\n"], [468, "  vpc_id      = aws_vpc.vpc.id\n"], [469, "\n"], [470, "  # Allow incoming HTTPS traffic only\n"], [471, "  ingress {\n"], [472, "    description = \"HTTPS from internet\"\n"], [473, "    from_port   = 443\n"], [474, "    to_port     = 443\n"], [475, "    protocol    = \"tcp\"\n"], [476, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [477, "  }\n"], [478, "\n"], [479, "  # HTTP for redirection only (will be redirected to HTTPS)\n"], [480, "  ingress {\n"], [481, "    description = \"HTTP from internet (for redirection to HTTPS)\"\n"], [482, "    from_port   = 80\n"], [483, "    to_port     = 80\n"], [484, "    protocol    = \"tcp\"\n"], [485, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [486, "  }\n"], [487, "\n"], [488, "  # Restricted egress rules\n"], [489, "  egress {\n"], [490, "    description = \"HTTP to ECS services\"\n"], [491, "    from_port   = 80\n"], [492, "    to_port     = 80\n"], [493, "    protocol    = \"tcp\"\n"], [494, "    cidr_blocks = [aws_vpc.vpc.cidr_block] # Allow traffic to any private IP in the VPC\n"], [495, "  }\n"], [496, "\n"], [497, "  egress {\n"], [498, "    description = \"HTTPS to internet for external resources\"\n"], [499, "    from_port   = 443\n"], [500, "    to_port     = 443\n"], [501, "    protocol    = \"tcp\"\n"], [502, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [503, "  }\n"], [504, "\n"], [505, "  tags = {\n"], [506, "    Name = \"alb-security-group\"\n"], [507, "  }\n"], [508, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [465, 508], "resource": "module.ecs_jenkins_github.module.network.aws_security_group.alb_security_group", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": {"Name": "alb-security-group"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-2", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_277", "bc_check_id": "BC_AWS_NETWORKING_78", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[465, "resource \"aws_security_group\" \"alb_security_group\" {\n"], [466, "  name        = \"alb-security-group\"\n"], [467, "  description = \"Security group for application load balancer\"\n"], [468, "  vpc_id      = aws_vpc.vpc.id\n"], [469, "\n"], [470, "  # Allow incoming HTTPS traffic only\n"], [471, "  ingress {\n"], [472, "    description = \"HTTPS from internet\"\n"], [473, "    from_port   = 443\n"], [474, "    to_port     = 443\n"], [475, "    protocol    = \"tcp\"\n"], [476, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [477, "  }\n"], [478, "\n"], [479, "  # HTTP for redirection only (will be redirected to HTTPS)\n"], [480, "  ingress {\n"], [481, "    description = \"HTTP from internet (for redirection to HTTPS)\"\n"], [482, "    from_port   = 80\n"], [483, "    to_port     = 80\n"], [484, "    protocol    = \"tcp\"\n"], [485, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [486, "  }\n"], [487, "\n"], [488, "  # Restricted egress rules\n"], [489, "  egress {\n"], [490, "    description = \"HTTP to ECS services\"\n"], [491, "    from_port   = 80\n"], [492, "    to_port     = 80\n"], [493, "    protocol    = \"tcp\"\n"], [494, "    cidr_blocks = [aws_vpc.vpc.cidr_block] # Allow traffic to any private IP in the VPC\n"], [495, "  }\n"], [496, "\n"], [497, "  egress {\n"], [498, "    description = \"HTTPS to internet for external resources\"\n"], [499, "    from_port   = 443\n"], [500, "    to_port     = 443\n"], [501, "    protocol    = \"tcp\"\n"], [502, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [503, "  }\n"], [504, "\n"], [505, "  tags = {\n"], [506, "    Name = \"alb-security-group\"\n"], [507, "  }\n"], [508, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [465, 508], "resource": "module.ecs_jenkins_github.module.network.aws_security_group.alb_security_group", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngressAny", "fixed_definition": null, "entity_tags": {"Name": "alb-security-group"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-group-does-not-allow-all-traffic-on-all-ports", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_382", "bc_check_id": "BC_AWS_IAM_93", "check_name": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[511, "resource \"aws_security_group\" \"ecs_security_group\" {\n"], [512, "  name        = \"ecs-security-group\"\n"], [513, "  description = \"Security group for ECS Fargate tasks\"\n"], [514, "  vpc_id      = aws_vpc.vpc.id\n"], [515, "\n"], [516, "  # Allow incoming HTTP traffic from VPC CIDR\n"], [517, "  ingress {\n"], [518, "    description = \"HTTP from VPC\"\n"], [519, "    from_port   = 80\n"], [520, "    to_port     = 80\n"], [521, "    protocol    = \"tcp\"\n"], [522, "    cidr_blocks = [aws_vpc.vpc.cidr_block]\n"], [523, "  }\n"], [524, "\n"], [525, "  # Allow internal traffic for service discovery\n"], [526, "  ingress {\n"], [527, "    description = \"Inter-container communication\"\n"], [528, "    from_port   = 8080\n"], [529, "    to_port     = 8080\n"], [530, "    protocol    = \"tcp\"\n"], [531, "    self        = true\n"], [532, "  }\n"], [533, "\n"], [534, "  # Restricted egress rules\n"], [535, "  egress {\n"], [536, "    description = \"HTTPS to internet for external resources\"\n"], [537, "    from_port   = 443\n"], [538, "    to_port     = 443\n"], [539, "    protocol    = \"tcp\"\n"], [540, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [541, "  }\n"], [542, "\n"], [543, "  egress {\n"], [544, "    description     = \"Database access\"\n"], [545, "    from_port       = 5432\n"], [546, "    to_port         = 5432\n"], [547, "    protocol        = \"tcp\"\n"], [548, "    security_groups = [aws_security_group.db_security_group.id]\n"], [549, "  }\n"], [550, "\n"], [551, "  tags = {\n"], [552, "    Name = \"ecs-security-group\"\n"], [553, "  }\n"], [554, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [511, 554], "resource": "module.ecs_jenkins_github.module.network.aws_security_group.ecs_security_group", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedEgressAny", "fixed_definition": null, "entity_tags": {"Name": "ecs-security-group"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[511, "resource \"aws_security_group\" \"ecs_security_group\" {\n"], [512, "  name        = \"ecs-security-group\"\n"], [513, "  description = \"Security group for ECS Fargate tasks\"\n"], [514, "  vpc_id      = aws_vpc.vpc.id\n"], [515, "\n"], [516, "  # Allow incoming HTTP traffic from VPC CIDR\n"], [517, "  ingress {\n"], [518, "    description = \"HTTP from VPC\"\n"], [519, "    from_port   = 80\n"], [520, "    to_port     = 80\n"], [521, "    protocol    = \"tcp\"\n"], [522, "    cidr_blocks = [aws_vpc.vpc.cidr_block]\n"], [523, "  }\n"], [524, "\n"], [525, "  # Allow internal traffic for service discovery\n"], [526, "  ingress {\n"], [527, "    description = \"Inter-container communication\"\n"], [528, "    from_port   = 8080\n"], [529, "    to_port     = 8080\n"], [530, "    protocol    = \"tcp\"\n"], [531, "    self        = true\n"], [532, "  }\n"], [533, "\n"], [534, "  # Restricted egress rules\n"], [535, "  egress {\n"], [536, "    description = \"HTTPS to internet for external resources\"\n"], [537, "    from_port   = 443\n"], [538, "    to_port     = 443\n"], [539, "    protocol    = \"tcp\"\n"], [540, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [541, "  }\n"], [542, "\n"], [543, "  egress {\n"], [544, "    description     = \"Database access\"\n"], [545, "    from_port       = 5432\n"], [546, "    to_port         = 5432\n"], [547, "    protocol        = \"tcp\"\n"], [548, "    security_groups = [aws_security_group.db_security_group.id]\n"], [549, "  }\n"], [550, "\n"], [551, "  tags = {\n"], [552, "    Name = \"ecs-security-group\"\n"], [553, "  }\n"], [554, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [511, 554], "resource": "module.ecs_jenkins_github.module.network.aws_security_group.ecs_security_group", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": {"Name": "ecs-security-group"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-2", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_260", "bc_check_id": "BC_AWS_NETWORKING_67", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[511, "resource \"aws_security_group\" \"ecs_security_group\" {\n"], [512, "  name        = \"ecs-security-group\"\n"], [513, "  description = \"Security group for ECS Fargate tasks\"\n"], [514, "  vpc_id      = aws_vpc.vpc.id\n"], [515, "\n"], [516, "  # Allow incoming HTTP traffic from VPC CIDR\n"], [517, "  ingress {\n"], [518, "    description = \"HTTP from VPC\"\n"], [519, "    from_port   = 80\n"], [520, "    to_port     = 80\n"], [521, "    protocol    = \"tcp\"\n"], [522, "    cidr_blocks = [aws_vpc.vpc.cidr_block]\n"], [523, "  }\n"], [524, "\n"], [525, "  # Allow internal traffic for service discovery\n"], [526, "  ingress {\n"], [527, "    description = \"Inter-container communication\"\n"], [528, "    from_port   = 8080\n"], [529, "    to_port     = 8080\n"], [530, "    protocol    = \"tcp\"\n"], [531, "    self        = true\n"], [532, "  }\n"], [533, "\n"], [534, "  # Restricted egress rules\n"], [535, "  egress {\n"], [536, "    description = \"HTTPS to internet for external resources\"\n"], [537, "    from_port   = 443\n"], [538, "    to_port     = 443\n"], [539, "    protocol    = \"tcp\"\n"], [540, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [541, "  }\n"], [542, "\n"], [543, "  egress {\n"], [544, "    description     = \"Database access\"\n"], [545, "    from_port       = 5432\n"], [546, "    to_port         = 5432\n"], [547, "    protocol        = \"tcp\"\n"], [548, "    security_groups = [aws_security_group.db_security_group.id]\n"], [549, "  }\n"], [550, "\n"], [551, "  tags = {\n"], [552, "    Name = \"ecs-security-group\"\n"], [553, "  }\n"], [554, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [511, 554], "resource": "module.ecs_jenkins_github.module.network.aws_security_group.ecs_security_group", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress80", "fixed_definition": null, "entity_tags": {"Name": "ecs-security-group"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_277", "bc_check_id": "BC_AWS_NETWORKING_78", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[511, "resource \"aws_security_group\" \"ecs_security_group\" {\n"], [512, "  name        = \"ecs-security-group\"\n"], [513, "  description = \"Security group for ECS Fargate tasks\"\n"], [514, "  vpc_id      = aws_vpc.vpc.id\n"], [515, "\n"], [516, "  # Allow incoming HTTP traffic from VPC CIDR\n"], [517, "  ingress {\n"], [518, "    description = \"HTTP from VPC\"\n"], [519, "    from_port   = 80\n"], [520, "    to_port     = 80\n"], [521, "    protocol    = \"tcp\"\n"], [522, "    cidr_blocks = [aws_vpc.vpc.cidr_block]\n"], [523, "  }\n"], [524, "\n"], [525, "  # Allow internal traffic for service discovery\n"], [526, "  ingress {\n"], [527, "    description = \"Inter-container communication\"\n"], [528, "    from_port   = 8080\n"], [529, "    to_port     = 8080\n"], [530, "    protocol    = \"tcp\"\n"], [531, "    self        = true\n"], [532, "  }\n"], [533, "\n"], [534, "  # Restricted egress rules\n"], [535, "  egress {\n"], [536, "    description = \"HTTPS to internet for external resources\"\n"], [537, "    from_port   = 443\n"], [538, "    to_port     = 443\n"], [539, "    protocol    = \"tcp\"\n"], [540, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [541, "  }\n"], [542, "\n"], [543, "  egress {\n"], [544, "    description     = \"Database access\"\n"], [545, "    from_port       = 5432\n"], [546, "    to_port         = 5432\n"], [547, "    protocol        = \"tcp\"\n"], [548, "    security_groups = [aws_security_group.db_security_group.id]\n"], [549, "  }\n"], [550, "\n"], [551, "  tags = {\n"], [552, "    Name = \"ecs-security-group\"\n"], [553, "  }\n"], [554, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [511, 554], "resource": "module.ecs_jenkins_github.module.network.aws_security_group.ecs_security_group", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngressAny", "fixed_definition": null, "entity_tags": {"Name": "ecs-security-group"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-group-does-not-allow-all-traffic-on-all-ports", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_382", "bc_check_id": "BC_AWS_IAM_93", "check_name": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[557, "resource \"aws_security_group\" \"db_security_group\" {\n"], [558, "  name        = \"db-security-group\"\n"], [559, "  description = \"Security group for database instances\"\n"], [560, "  vpc_id      = aws_vpc.vpc.id\n"], [561, "\n"], [562, "  # Allow incoming database traffic from VPC\n"], [563, "  ingress {\n"], [564, "    description = \"Database port from VPC\"\n"], [565, "    from_port   = 5432\n"], [566, "    to_port     = 5432\n"], [567, "    protocol    = \"tcp\"\n"], [568, "    cidr_blocks = [aws_vpc.vpc.cidr_block]\n"], [569, "  }\n"], [570, "\n"], [571, "  # Allow response traffic to VPC\n"], [572, "  egress {\n"], [573, "    description = \"Response traffic to VPC\"\n"], [574, "    from_port   = 1024\n"], [575, "    to_port     = 65535\n"], [576, "    protocol    = \"tcp\"\n"], [577, "    cidr_blocks = [aws_vpc.vpc.cidr_block]\n"], [578, "  }\n"], [579, "\n"], [580, "  tags = {\n"], [581, "    Name = \"db-security-group\"\n"], [582, "  }\n"], [583, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [557, 583], "resource": "module.ecs_jenkins_github.module.network.aws_security_group.db_security_group", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedEgressAny", "fixed_definition": null, "entity_tags": {"Name": "db-security-group"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[557, "resource \"aws_security_group\" \"db_security_group\" {\n"], [558, "  name        = \"db-security-group\"\n"], [559, "  description = \"Security group for database instances\"\n"], [560, "  vpc_id      = aws_vpc.vpc.id\n"], [561, "\n"], [562, "  # Allow incoming database traffic from VPC\n"], [563, "  ingress {\n"], [564, "    description = \"Database port from VPC\"\n"], [565, "    from_port   = 5432\n"], [566, "    to_port     = 5432\n"], [567, "    protocol    = \"tcp\"\n"], [568, "    cidr_blocks = [aws_vpc.vpc.cidr_block]\n"], [569, "  }\n"], [570, "\n"], [571, "  # Allow response traffic to VPC\n"], [572, "  egress {\n"], [573, "    description = \"Response traffic to VPC\"\n"], [574, "    from_port   = 1024\n"], [575, "    to_port     = 65535\n"], [576, "    protocol    = \"tcp\"\n"], [577, "    cidr_blocks = [aws_vpc.vpc.cidr_block]\n"], [578, "  }\n"], [579, "\n"], [580, "  tags = {\n"], [581, "    Name = \"db-security-group\"\n"], [582, "  }\n"], [583, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [557, 583], "resource": "module.ecs_jenkins_github.module.network.aws_security_group.db_security_group", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": {"Name": "db-security-group"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-2", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_260", "bc_check_id": "BC_AWS_NETWORKING_67", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[557, "resource \"aws_security_group\" \"db_security_group\" {\n"], [558, "  name        = \"db-security-group\"\n"], [559, "  description = \"Security group for database instances\"\n"], [560, "  vpc_id      = aws_vpc.vpc.id\n"], [561, "\n"], [562, "  # Allow incoming database traffic from VPC\n"], [563, "  ingress {\n"], [564, "    description = \"Database port from VPC\"\n"], [565, "    from_port   = 5432\n"], [566, "    to_port     = 5432\n"], [567, "    protocol    = \"tcp\"\n"], [568, "    cidr_blocks = [aws_vpc.vpc.cidr_block]\n"], [569, "  }\n"], [570, "\n"], [571, "  # Allow response traffic to VPC\n"], [572, "  egress {\n"], [573, "    description = \"Response traffic to VPC\"\n"], [574, "    from_port   = 1024\n"], [575, "    to_port     = 65535\n"], [576, "    protocol    = \"tcp\"\n"], [577, "    cidr_blocks = [aws_vpc.vpc.cidr_block]\n"], [578, "  }\n"], [579, "\n"], [580, "  tags = {\n"], [581, "    Name = \"db-security-group\"\n"], [582, "  }\n"], [583, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [557, 583], "resource": "module.ecs_jenkins_github.module.network.aws_security_group.db_security_group", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress80", "fixed_definition": null, "entity_tags": {"Name": "db-security-group"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_277", "bc_check_id": "BC_AWS_NETWORKING_78", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[557, "resource \"aws_security_group\" \"db_security_group\" {\n"], [558, "  name        = \"db-security-group\"\n"], [559, "  description = \"Security group for database instances\"\n"], [560, "  vpc_id      = aws_vpc.vpc.id\n"], [561, "\n"], [562, "  # Allow incoming database traffic from VPC\n"], [563, "  ingress {\n"], [564, "    description = \"Database port from VPC\"\n"], [565, "    from_port   = 5432\n"], [566, "    to_port     = 5432\n"], [567, "    protocol    = \"tcp\"\n"], [568, "    cidr_blocks = [aws_vpc.vpc.cidr_block]\n"], [569, "  }\n"], [570, "\n"], [571, "  # Allow response traffic to VPC\n"], [572, "  egress {\n"], [573, "    description = \"Response traffic to VPC\"\n"], [574, "    from_port   = 1024\n"], [575, "    to_port     = 65535\n"], [576, "    protocol    = \"tcp\"\n"], [577, "    cidr_blocks = [aws_vpc.vpc.cidr_block]\n"], [578, "  }\n"], [579, "\n"], [580, "  tags = {\n"], [581, "    Name = \"db-security-group\"\n"], [582, "  }\n"], [583, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [557, 583], "resource": "module.ecs_jenkins_github.module.network.aws_security_group.db_security_group", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngressAny", "fixed_definition": null, "entity_tags": {"Name": "db-security-group"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-group-does-not-allow-all-traffic-on-all-ports", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_130", "bc_check_id": "BC_AWS_NETWORKING_53", "check_name": "Ensure VPC subnets do not assign public IP by default", "check_result": {"result": "PASSED", "evaluated_keys": ["map_public_ip_on_launch"]}, "code_block": [[11, "resource \"aws_subnet\" \"public_subnet\" {\n"], [12, "  count                   = length(var.public_subnet_cidrs)\n"], [13, "  vpc_id                  = aws_vpc.vpc.id\n"], [14, "  cidr_block              = var.public_subnet_cidrs[count.index]\n"], [15, "  availability_zone       = var.availability_zones[count.index]\n"], [16, "  map_public_ip_on_launch = false # Not assigning public IPs by default\n"], [17, "\n"], [18, "  tags = {\n"], [19, "    Name = \"public-subnet-${count.index}\"\n"], [20, "  }\n"], [21, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [11, 21], "resource": "module.ecs_jenkins_github.module.network.aws_subnet.public_subnet[1]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP", "fixed_definition": null, "entity_tags": {"Name": "public-subnet-1"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_130", "bc_check_id": "BC_AWS_NETWORKING_53", "check_name": "Ensure VPC subnets do not assign public IP by default", "check_result": {"result": "PASSED", "evaluated_keys": ["map_public_ip_on_launch"]}, "code_block": [[23, "resource \"aws_subnet\" \"private_subnet\" {\n"], [24, "  count             = length(var.private_subnet_cidrs)\n"], [25, "  vpc_id            = aws_vpc.vpc.id\n"], [26, "  cidr_block        = var.private_subnet_cidrs[count.index]\n"], [27, "  availability_zone = var.availability_zones[count.index]\n"], [28, "\n"], [29, "  tags = {\n"], [30, "    Name = \"private-subnet-${count.index}\"\n"], [31, "  }\n"], [32, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [23, 32], "resource": "module.ecs_jenkins_github.module.network.aws_subnet.private_subnet[1]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP", "fixed_definition": null, "entity_tags": {"Name": "private-subnet-1"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_130", "bc_check_id": "BC_AWS_NETWORKING_53", "check_name": "Ensure VPC subnets do not assign public IP by default", "check_result": {"result": "PASSED", "evaluated_keys": ["map_public_ip_on_launch"]}, "code_block": [[34, "resource \"aws_subnet\" \"database_subnet\" {\n"], [35, "  count             = length(var.database_subnet_cidrs)\n"], [36, "  vpc_id            = aws_vpc.vpc.id\n"], [37, "  cidr_block        = var.database_subnet_cidrs[count.index]\n"], [38, "  availability_zone = var.availability_zones[count.index]\n"], [39, "\n"], [40, "  tags = {\n"], [41, "    Name = \"database-subnet-${count.index}\"\n"], [42, "  }\n"], [43, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [34, 43], "resource": "module.ecs_jenkins_github.module.network.aws_subnet.database_subnet[1]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP", "fixed_definition": null, "entity_tags": {"Name": "database-subnet-1"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_130", "bc_check_id": "BC_AWS_NETWORKING_53", "check_name": "Ensure VPC subnets do not assign public IP by default", "check_result": {"result": "PASSED", "evaluated_keys": ["map_public_ip_on_launch"]}, "code_block": [[11, "resource \"aws_subnet\" \"public_subnet\" {\n"], [12, "  count                   = length(var.public_subnet_cidrs)\n"], [13, "  vpc_id                  = aws_vpc.vpc.id\n"], [14, "  cidr_block              = var.public_subnet_cidrs[count.index]\n"], [15, "  availability_zone       = var.availability_zones[count.index]\n"], [16, "  map_public_ip_on_launch = false # Not assigning public IPs by default\n"], [17, "\n"], [18, "  tags = {\n"], [19, "    Name = \"public-subnet-${count.index}\"\n"], [20, "  }\n"], [21, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [11, 21], "resource": "module.ecs_jenkins_github_dr.module.network.aws_subnet.public_subnet[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP", "fixed_definition": null, "entity_tags": {"Name": "public-subnet-0"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_130", "bc_check_id": "BC_AWS_NETWORKING_53", "check_name": "Ensure VPC subnets do not assign public IP by default", "check_result": {"result": "PASSED", "evaluated_keys": ["map_public_ip_on_launch"]}, "code_block": [[23, "resource \"aws_subnet\" \"private_subnet\" {\n"], [24, "  count             = length(var.private_subnet_cidrs)\n"], [25, "  vpc_id            = aws_vpc.vpc.id\n"], [26, "  cidr_block        = var.private_subnet_cidrs[count.index]\n"], [27, "  availability_zone = var.availability_zones[count.index]\n"], [28, "\n"], [29, "  tags = {\n"], [30, "    Name = \"private-subnet-${count.index}\"\n"], [31, "  }\n"], [32, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [23, 32], "resource": "module.ecs_jenkins_github_dr.module.network.aws_subnet.private_subnet[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP", "fixed_definition": null, "entity_tags": {"Name": "private-subnet-0"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_130", "bc_check_id": "BC_AWS_NETWORKING_53", "check_name": "Ensure VPC subnets do not assign public IP by default", "check_result": {"result": "PASSED", "evaluated_keys": ["map_public_ip_on_launch"]}, "code_block": [[34, "resource \"aws_subnet\" \"database_subnet\" {\n"], [35, "  count             = length(var.database_subnet_cidrs)\n"], [36, "  vpc_id            = aws_vpc.vpc.id\n"], [37, "  cidr_block        = var.database_subnet_cidrs[count.index]\n"], [38, "  availability_zone = var.availability_zones[count.index]\n"], [39, "\n"], [40, "  tags = {\n"], [41, "    Name = \"database-subnet-${count.index}\"\n"], [42, "  }\n"], [43, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [34, 43], "resource": "module.ecs_jenkins_github_dr.module.network.aws_subnet.database_subnet[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP", "fixed_definition": null, "entity_tags": {"Name": "database-subnet-0"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_227", "bc_check_id": "BC_AWS_GENERAL_122", "check_name": "Ensure KMS key is enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["is_enabled"]}, "code_block": [[115, "resource \"aws_kms_key\" \"s3_kms_key\" {\n"], [116, "  description             = \"KMS key for S3 bucket encryption\"\n"], [117, "  deletion_window_in_days = 10\n"], [118, "  enable_key_rotation     = true\n"], [119, "  tags = {\n"], [120, "    Name        = \"s3-kms-key-${var.environment}\"\n"], [121, "    Environment = var.environment\n"], [122, "  }\n"], [123, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [115, 123], "resource": "module.ecs_jenkins_github_dr.module.network.aws_kms_key.s3_kms_key", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.KMSKeyIsEnabled", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "s3-kms-key-dr"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-key-management-service-kms-key-is-enabled", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_33", "bc_check_id": "BC_AWS_IAM_63", "check_name": "Ensure KMS key policy does not contain wildcard (*) principal", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[115, "resource \"aws_kms_key\" \"s3_kms_key\" {\n"], [116, "  description             = \"KMS key for S3 bucket encryption\"\n"], [117, "  deletion_window_in_days = 10\n"], [118, "  enable_key_rotation     = true\n"], [119, "  tags = {\n"], [120, "    Name        = \"s3-kms-key-${var.environment}\"\n"], [121, "    Environment = var.environment\n"], [122, "  }\n"], [123, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [115, 123], "resource": "module.ecs_jenkins_github_dr.module.network.aws_kms_key.s3_kms_key", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.KMSKeyWildcardPrincipal", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "s3-kms-key-dr"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-kms-key-policy-does-not-contain-wildcard-principal", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_7", "bc_check_id": "BC_AWS_LOGGING_8", "check_name": "Ensure rotation for customer created CMKs is enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["enable_key_rotation"]}, "code_block": [[115, "resource \"aws_kms_key\" \"s3_kms_key\" {\n"], [116, "  description             = \"KMS key for S3 bucket encryption\"\n"], [117, "  deletion_window_in_days = 10\n"], [118, "  enable_key_rotation     = true\n"], [119, "  tags = {\n"], [120, "    Name        = \"s3-kms-key-${var.environment}\"\n"], [121, "    Environment = var.environment\n"], [122, "  }\n"], [123, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [115, 123], "resource": "module.ecs_jenkins_github_dr.module.network.aws_kms_key.s3_kms_key", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.KMSRotation", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "s3-kms-key-dr"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-8", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_93", "bc_check_id": "BC_AWS_S3_24", "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[126, "resource \"aws_s3_bucket\" \"alb_logs\" {\n"], [127, "  bucket        = \"alb-logs-${var.environment}-${random_string.suffix.result}\"\n"], [128, "  force_destroy = true\n"], [129, "\n"], [130, "  tags = {\n"], [131, "    Name        = \"alb-access-logs\"\n"], [132, "    Environment = var.environment\n"], [133, "  }\n"], [134, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [126, 134], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "alb-access-logs"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-24", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_93", "bc_check_id": "BC_AWS_S3_24", "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[137, "resource \"aws_s3_bucket\" \"alb_logs_access_logs\" {\n"], [138, "  bucket        = \"alb-logs-access-${var.environment}-${random_string.suffix.result}\"\n"], [139, "  force_destroy = true\n"], [140, "\n"], [141, "  tags = {\n"], [142, "    Name        = \"alb-access-logs-access\"\n"], [143, "    Environment = var.environment\n"], [144, "  }\n"], [145, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [137, 145], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs_access_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "alb-access-logs-access"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-24", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_93", "bc_check_id": "BC_AWS_S3_24", "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[148, "resource \"aws_s3_bucket\" \"replication_logs\" {\n"], [149, "  bucket        = \"replication-logs-${var.environment}-${random_string.suffix.result}\"\n"], [150, "  force_destroy = true\n"], [151, "\n"], [152, "  tags = {\n"], [153, "    Name        = \"replication-logs\"\n"], [154, "    Environment = var.environment\n"], [155, "  }\n"], [156, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [148, 156], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.replication_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "replication-logs"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-24", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[159, "resource \"aws_iam_role\" \"replication\" {\n"], [160, "  name = \"s3-replication-role-${var.environment}\"\n"], [161, "\n"], [162, "  assume_role_policy = jsonencode({\n"], [163, "    Version = \"2012-10-17\"\n"], [164, "    Statement = [\n"], [165, "      {\n"], [166, "        Action = \"sts:AssumeRole\"\n"], [167, "        Effect = \"Allow\"\n"], [168, "        Principal = {\n"], [169, "          Service = \"s3.amazonaws.com\"\n"], [170, "        }\n"], [171, "      },\n"], [172, "    ]\n"], [173, "  })\n"], [174, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [159, 174], "resource": "module.ecs_jenkins_github_dr.module.network.aws_iam_role.replication", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[159, "resource \"aws_iam_role\" \"replication\" {\n"], [160, "  name = \"s3-replication-role-${var.environment}\"\n"], [161, "\n"], [162, "  assume_role_policy = jsonencode({\n"], [163, "    Version = \"2012-10-17\"\n"], [164, "    Statement = [\n"], [165, "      {\n"], [166, "        Action = \"sts:AssumeRole\"\n"], [167, "        Effect = \"Allow\"\n"], [168, "        Principal = {\n"], [169, "          Service = \"s3.amazonaws.com\"\n"], [170, "        }\n"], [171, "      },\n"], [172, "    ]\n"], [173, "  })\n"], [174, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [159, 174], "resource": "module.ecs_jenkins_github_dr.module.network.aws_iam_role.replication", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[159, "resource \"aws_iam_role\" \"replication\" {\n"], [160, "  name = \"s3-replication-role-${var.environment}\"\n"], [161, "\n"], [162, "  assume_role_policy = jsonencode({\n"], [163, "    Version = \"2012-10-17\"\n"], [164, "    Statement = [\n"], [165, "      {\n"], [166, "        Action = \"sts:AssumeRole\"\n"], [167, "        Effect = \"Allow\"\n"], [168, "        Principal = {\n"], [169, "          Service = \"s3.amazonaws.com\"\n"], [170, "        }\n"], [171, "      },\n"], [172, "    ]\n"], [173, "  })\n"], [174, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [159, 174], "resource": "module.ecs_jenkins_github_dr.module.network.aws_iam_role.replication", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_62", "bc_check_id": "BC_AWS_IAM_47", "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[176, "resource \"aws_iam_policy\" \"replication\" {\n"], [177, "  name = \"s3-replication-policy-${var.environment}\"\n"], [178, "  policy = jsonencode({\n"], [179, "    Version = \"2012-10-17\"\n"], [180, "    Statement = [\n"], [181, "      {\n"], [182, "        Effect = \"Allow\"\n"], [183, "        Action = [\n"], [184, "          \"s3:GetReplicationConfiguration\",\n"], [185, "          \"s3:ListBucket\"\n"], [186, "        ],\n"], [187, "        Resource = [\n"], [188, "          aws_s3_bucket.alb_logs.arn,\n"], [189, "          aws_s3_bucket.alb_logs_access_logs.arn\n"], [190, "        ]\n"], [191, "      },\n"], [192, "      {\n"], [193, "        Effect = \"Allow\"\n"], [194, "        Action = [\n"], [195, "          \"s3:GetObjectVersionForReplication\",\n"], [196, "          \"s3:GetObjectVersionAcl\",\n"], [197, "          \"s3:GetObjectVersionTagging\"\n"], [198, "        ],\n"], [199, "        Resource = [\n"], [200, "          \"${aws_s3_bucket.alb_logs.arn}/*\",\n"], [201, "          \"${aws_s3_bucket.alb_logs_access_logs.arn}/*\"\n"], [202, "        ]\n"], [203, "      },\n"], [204, "      {\n"], [205, "        Effect = \"Allow\"\n"], [206, "        Action = [\n"], [207, "          \"s3:ReplicateObject\",\n"], [208, "          \"s3:ReplicateDelete\",\n"], [209, "          \"s3:ReplicateTags\"\n"], [210, "        ],\n"], [211, "        Resource = [\n"], [212, "          \"${aws_s3_bucket.alb_logs.arn}/*\",\n"], [213, "          \"${aws_s3_bucket.alb_logs_access_logs.arn}/*\"\n"], [214, "        ]\n"], [215, "      }\n"], [216, "    ]\n"], [217, "  })\n"], [218, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [176, 218], "resource": "module.ecs_jenkins_github_dr.module.network.aws_iam_policy.replication", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMAdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_63", "bc_check_id": "BC_AWS_IAM_48", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[176, "resource \"aws_iam_policy\" \"replication\" {\n"], [177, "  name = \"s3-replication-policy-${var.environment}\"\n"], [178, "  policy = jsonencode({\n"], [179, "    Version = \"2012-10-17\"\n"], [180, "    Statement = [\n"], [181, "      {\n"], [182, "        Effect = \"Allow\"\n"], [183, "        Action = [\n"], [184, "          \"s3:GetReplicationConfiguration\",\n"], [185, "          \"s3:ListBucket\"\n"], [186, "        ],\n"], [187, "        Resource = [\n"], [188, "          aws_s3_bucket.alb_logs.arn,\n"], [189, "          aws_s3_bucket.alb_logs_access_logs.arn\n"], [190, "        ]\n"], [191, "      },\n"], [192, "      {\n"], [193, "        Effect = \"Allow\"\n"], [194, "        Action = [\n"], [195, "          \"s3:GetObjectVersionForReplication\",\n"], [196, "          \"s3:GetObjectVersionAcl\",\n"], [197, "          \"s3:GetObjectVersionTagging\"\n"], [198, "        ],\n"], [199, "        Resource = [\n"], [200, "          \"${aws_s3_bucket.alb_logs.arn}/*\",\n"], [201, "          \"${aws_s3_bucket.alb_logs_access_logs.arn}/*\"\n"], [202, "        ]\n"], [203, "      },\n"], [204, "      {\n"], [205, "        Effect = \"Allow\"\n"], [206, "        Action = [\n"], [207, "          \"s3:ReplicateObject\",\n"], [208, "          \"s3:ReplicateDelete\",\n"], [209, "          \"s3:ReplicateTags\"\n"], [210, "        ],\n"], [211, "        Resource = [\n"], [212, "          \"${aws_s3_bucket.alb_logs.arn}/*\",\n"], [213, "          \"${aws_s3_bucket.alb_logs_access_logs.arn}/*\"\n"], [214, "        ]\n"], [215, "      }\n"], [216, "    ]\n"], [217, "  })\n"], [218, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [176, 218], "resource": "module.ecs_jenkins_github_dr.module.network.aws_iam_policy.replication", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[220, "resource \"aws_iam_role_policy_attachment\" \"replication\" {\n"], [221, "  role       = aws_iam_role.replication.name\n"], [222, "  policy_arn = aws_iam_policy.replication.arn\n"], [223, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [220, 223], "resource": "module.ecs_jenkins_github_dr.module.network.aws_iam_role_policy_attachment.replication", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_53", "bc_check_id": "BC_AWS_S3_19", "check_name": "Ensure S3 bucket has block public ACLS enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["block_public_acls"]}, "code_block": [[307, "resource \"aws_s3_bucket_public_access_block\" \"replication_logs_public_access\" {\n"], [308, "  bucket = aws_s3_bucket.replication_logs.id\n"], [309, "\n"], [310, "  block_public_acls       = true\n"], [311, "  block_public_policy     = true\n"], [312, "  ignore_public_acls      = true\n"], [313, "  restrict_public_buckets = true\n"], [314, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [307, 314], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket_public_access_block.replication_logs_public_access", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-19", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_54", "bc_check_id": "BC_AWS_S3_20", "check_name": "Ensure S3 bucket has block public policy enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["block_public_policy"]}, "code_block": [[307, "resource \"aws_s3_bucket_public_access_block\" \"replication_logs_public_access\" {\n"], [308, "  bucket = aws_s3_bucket.replication_logs.id\n"], [309, "\n"], [310, "  block_public_acls       = true\n"], [311, "  block_public_policy     = true\n"], [312, "  ignore_public_acls      = true\n"], [313, "  restrict_public_buckets = true\n"], [314, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [307, 314], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket_public_access_block.replication_logs_public_access", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-20", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_55", "bc_check_id": "BC_AWS_S3_21", "check_name": "Ensure S3 bucket has ignore public ACLs enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["ignore_public_acls"]}, "code_block": [[307, "resource \"aws_s3_bucket_public_access_block\" \"replication_logs_public_access\" {\n"], [308, "  bucket = aws_s3_bucket.replication_logs.id\n"], [309, "\n"], [310, "  block_public_acls       = true\n"], [311, "  block_public_policy     = true\n"], [312, "  ignore_public_acls      = true\n"], [313, "  restrict_public_buckets = true\n"], [314, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [307, 314], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket_public_access_block.replication_logs_public_access", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3IgnorePublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-21", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_56", "bc_check_id": "BC_AWS_S3_22", "check_name": "Ensure S3 bucket has 'restrict_public_buckets' enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["restrict_public_buckets"]}, "code_block": [[307, "resource \"aws_s3_bucket_public_access_block\" \"replication_logs_public_access\" {\n"], [308, "  bucket = aws_s3_bucket.replication_logs.id\n"], [309, "\n"], [310, "  block_public_acls       = true\n"], [311, "  block_public_policy     = true\n"], [312, "  ignore_public_acls      = true\n"], [313, "  restrict_public_buckets = true\n"], [314, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [307, 314], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket_public_access_block.replication_logs_public_access", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3RestrictPublicBuckets", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-22", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_53", "bc_check_id": "BC_AWS_S3_19", "check_name": "Ensure S3 bucket has block public ACLS enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["block_public_acls"]}, "code_block": [[317, "resource \"aws_s3_bucket_public_access_block\" \"alb_logs_public_access\" {\n"], [318, "  bucket = aws_s3_bucket.alb_logs.id\n"], [319, "\n"], [320, "  block_public_acls       = true\n"], [321, "  block_public_policy     = true\n"], [322, "  ignore_public_acls      = true\n"], [323, "  restrict_public_buckets = true\n"], [324, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [317, 324], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket_public_access_block.alb_logs_public_access", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-19", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_54", "bc_check_id": "BC_AWS_S3_20", "check_name": "Ensure S3 bucket has block public policy enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["block_public_policy"]}, "code_block": [[317, "resource \"aws_s3_bucket_public_access_block\" \"alb_logs_public_access\" {\n"], [318, "  bucket = aws_s3_bucket.alb_logs.id\n"], [319, "\n"], [320, "  block_public_acls       = true\n"], [321, "  block_public_policy     = true\n"], [322, "  ignore_public_acls      = true\n"], [323, "  restrict_public_buckets = true\n"], [324, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [317, 324], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket_public_access_block.alb_logs_public_access", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-20", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_55", "bc_check_id": "BC_AWS_S3_21", "check_name": "Ensure S3 bucket has ignore public ACLs enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["ignore_public_acls"]}, "code_block": [[317, "resource \"aws_s3_bucket_public_access_block\" \"alb_logs_public_access\" {\n"], [318, "  bucket = aws_s3_bucket.alb_logs.id\n"], [319, "\n"], [320, "  block_public_acls       = true\n"], [321, "  block_public_policy     = true\n"], [322, "  ignore_public_acls      = true\n"], [323, "  restrict_public_buckets = true\n"], [324, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [317, 324], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket_public_access_block.alb_logs_public_access", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3IgnorePublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-21", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_56", "bc_check_id": "BC_AWS_S3_22", "check_name": "Ensure S3 bucket has 'restrict_public_buckets' enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["restrict_public_buckets"]}, "code_block": [[317, "resource \"aws_s3_bucket_public_access_block\" \"alb_logs_public_access\" {\n"], [318, "  bucket = aws_s3_bucket.alb_logs.id\n"], [319, "\n"], [320, "  block_public_acls       = true\n"], [321, "  block_public_policy     = true\n"], [322, "  ignore_public_acls      = true\n"], [323, "  restrict_public_buckets = true\n"], [324, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [317, 324], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket_public_access_block.alb_logs_public_access", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3RestrictPublicBuckets", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-22", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_53", "bc_check_id": "BC_AWS_S3_19", "check_name": "Ensure S3 bucket has block public ACLS enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["block_public_acls"]}, "code_block": [[327, "resource \"aws_s3_bucket_public_access_block\" \"alb_logs_access_public_access\" {\n"], [328, "  bucket = aws_s3_bucket.alb_logs_access_logs.id\n"], [329, "\n"], [330, "  block_public_acls       = true\n"], [331, "  block_public_policy     = true\n"], [332, "  ignore_public_acls      = true\n"], [333, "  restrict_public_buckets = true\n"], [334, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [327, 334], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket_public_access_block.alb_logs_access_public_access", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-19", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_54", "bc_check_id": "BC_AWS_S3_20", "check_name": "Ensure S3 bucket has block public policy enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["block_public_policy"]}, "code_block": [[327, "resource \"aws_s3_bucket_public_access_block\" \"alb_logs_access_public_access\" {\n"], [328, "  bucket = aws_s3_bucket.alb_logs_access_logs.id\n"], [329, "\n"], [330, "  block_public_acls       = true\n"], [331, "  block_public_policy     = true\n"], [332, "  ignore_public_acls      = true\n"], [333, "  restrict_public_buckets = true\n"], [334, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [327, 334], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket_public_access_block.alb_logs_access_public_access", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-20", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_55", "bc_check_id": "BC_AWS_S3_21", "check_name": "Ensure S3 bucket has ignore public ACLs enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["ignore_public_acls"]}, "code_block": [[327, "resource \"aws_s3_bucket_public_access_block\" \"alb_logs_access_public_access\" {\n"], [328, "  bucket = aws_s3_bucket.alb_logs_access_logs.id\n"], [329, "\n"], [330, "  block_public_acls       = true\n"], [331, "  block_public_policy     = true\n"], [332, "  ignore_public_acls      = true\n"], [333, "  restrict_public_buckets = true\n"], [334, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [327, 334], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket_public_access_block.alb_logs_access_public_access", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3IgnorePublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-21", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_56", "bc_check_id": "BC_AWS_S3_22", "check_name": "Ensure S3 bucket has 'restrict_public_buckets' enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["restrict_public_buckets"]}, "code_block": [[327, "resource \"aws_s3_bucket_public_access_block\" \"alb_logs_access_public_access\" {\n"], [328, "  bucket = aws_s3_bucket.alb_logs_access_logs.id\n"], [329, "\n"], [330, "  block_public_acls       = true\n"], [331, "  block_public_policy     = true\n"], [332, "  ignore_public_acls      = true\n"], [333, "  restrict_public_buckets = true\n"], [334, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [327, 334], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket_public_access_block.alb_logs_access_public_access", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3RestrictPublicBuckets", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-22", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_70", "bc_check_id": "BC_AWS_S3_23", "check_name": "Ensure S3 bucket does not allow an action with any Principal", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[386, "resource \"aws_s3_bucket_policy\" \"alb_logs_policy\" {\n"], [387, "  bucket = aws_s3_bucket.alb_logs.id\n"], [388, "\n"], [389, "  policy = jsonencode({\n"], [390, "    Version = \"2012-10-17\"\n"], [391, "    Statement = [\n"], [392, "      {\n"], [393, "        Effect = \"Allow\"\n"], [394, "        Principal = {\n"], [395, "          AWS = \"arn:aws:iam::elb-account-id:root\" # Replace with actual ALB account ID\n"], [396, "        }\n"], [397, "        Action   = \"s3:PutObject\"\n"], [398, "        Resource = \"${aws_s3_bucket.alb_logs.arn}/*\"\n"], [399, "      }\n"], [400, "    ]\n"], [401, "  })\n"], [402, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [386, 402], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket_policy.alb_logs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3AllowsAnyPrincipal", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-23", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_93", "bc_check_id": "BC_AWS_S3_24", "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[386, "resource \"aws_s3_bucket_policy\" \"alb_logs_policy\" {\n"], [387, "  bucket = aws_s3_bucket.alb_logs.id\n"], [388, "\n"], [389, "  policy = jsonencode({\n"], [390, "    Version = \"2012-10-17\"\n"], [391, "    Statement = [\n"], [392, "      {\n"], [393, "        Effect = \"Allow\"\n"], [394, "        Principal = {\n"], [395, "          AWS = \"arn:aws:iam::elb-account-id:root\" # Replace with actual ALB account ID\n"], [396, "        }\n"], [397, "        Action   = \"s3:PutObject\"\n"], [398, "        Resource = \"${aws_s3_bucket.alb_logs.arn}/*\"\n"], [399, "      }\n"], [400, "    ]\n"], [401, "  })\n"], [402, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [386, 402], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket_policy.alb_logs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-24", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "PASSED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[413, "resource \"aws_cloudwatch_log_group\" \"vpc_flow_logs\" {\n"], [414, "  name              = \"/aws/vpc/flow-logs\"\n"], [415, "  retention_in_days = 365\n"], [416, "  kms_key_id        = aws_kms_key.logs_key.arn\n"], [417, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [413, 417], "resource": "module.ecs_jenkins_github_dr.module.network.aws_cloudwatch_log_group.vpc_flow_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_66", "bc_check_id": "BC_AWS_LOGGING_13", "check_name": "Ensure that CloudWatch Log Group specifies retention days", "check_result": {"result": "PASSED", "evaluated_keys": ["retention_in_days"]}, "code_block": [[413, "resource \"aws_cloudwatch_log_group\" \"vpc_flow_logs\" {\n"], [414, "  name              = \"/aws/vpc/flow-logs\"\n"], [415, "  retention_in_days = 365\n"], [416, "  kms_key_id        = aws_kms_key.logs_key.arn\n"], [417, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [413, 417], "resource": "module.ecs_jenkins_github_dr.module.network.aws_cloudwatch_log_group.vpc_flow_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetention", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-13", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_338", "bc_check_id": "BC_AWS_LOGGING_46", "check_name": "Ensure CloudWatch log groups retains logs for at least 1 year", "check_result": {"result": "PASSED", "evaluated_keys": ["retention_in_days"]}, "code_block": [[413, "resource \"aws_cloudwatch_log_group\" \"vpc_flow_logs\" {\n"], [414, "  name              = \"/aws/vpc/flow-logs\"\n"], [415, "  retention_in_days = 365\n"], [416, "  kms_key_id        = aws_kms_key.logs_key.arn\n"], [417, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [413, 417], "resource": "module.ecs_jenkins_github_dr.module.network.aws_cloudwatch_log_group.vpc_flow_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetentionYear", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_227", "bc_check_id": "BC_AWS_GENERAL_122", "check_name": "Ensure KMS key is enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["is_enabled"]}, "code_block": [[419, "resource \"aws_kms_key\" \"logs_key\" {\n"], [420, "  description             = \"KMS key for VPC flow logs\"\n"], [421, "  deletion_window_in_days = 30\n"], [422, "  enable_key_rotation     = true\n"], [423, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [419, 423], "resource": "module.ecs_jenkins_github_dr.module.network.aws_kms_key.logs_key", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.KMSKeyIsEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-key-management-service-kms-key-is-enabled", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_33", "bc_check_id": "BC_AWS_IAM_63", "check_name": "Ensure KMS key policy does not contain wildcard (*) principal", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[419, "resource \"aws_kms_key\" \"logs_key\" {\n"], [420, "  description             = \"KMS key for VPC flow logs\"\n"], [421, "  deletion_window_in_days = 30\n"], [422, "  enable_key_rotation     = true\n"], [423, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [419, 423], "resource": "module.ecs_jenkins_github_dr.module.network.aws_kms_key.logs_key", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.KMSKeyWildcardPrincipal", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-kms-key-policy-does-not-contain-wildcard-principal", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_7", "bc_check_id": "BC_AWS_LOGGING_8", "check_name": "Ensure rotation for customer created CMKs is enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["enable_key_rotation"]}, "code_block": [[419, "resource \"aws_kms_key\" \"logs_key\" {\n"], [420, "  description             = \"KMS key for VPC flow logs\"\n"], [421, "  deletion_window_in_days = 30\n"], [422, "  enable_key_rotation     = true\n"], [423, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [419, 423], "resource": "module.ecs_jenkins_github_dr.module.network.aws_kms_key.logs_key", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.KMSRotation", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-8", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[425, "resource \"aws_iam_role\" \"vpc_flow_logs_role\" {\n"], [426, "  name = \"vpc-flow-logs-role\"\n"], [427, "\n"], [428, "  assume_role_policy = jsonencode({\n"], [429, "    Version = \"2012-10-17\"\n"], [430, "    Statement = [\n"], [431, "      {\n"], [432, "        Action = \"sts:AssumeRole\"\n"], [433, "        Effect = \"Allow\"\n"], [434, "        Principal = {\n"], [435, "          Service = \"vpc-flow-logs.amazonaws.com\"\n"], [436, "        }\n"], [437, "      }\n"], [438, "    ]\n"], [439, "  })\n"], [440, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [425, 440], "resource": "module.ecs_jenkins_github_dr.module.network.aws_iam_role.vpc_flow_logs_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[425, "resource \"aws_iam_role\" \"vpc_flow_logs_role\" {\n"], [426, "  name = \"vpc-flow-logs-role\"\n"], [427, "\n"], [428, "  assume_role_policy = jsonencode({\n"], [429, "    Version = \"2012-10-17\"\n"], [430, "    Statement = [\n"], [431, "      {\n"], [432, "        Action = \"sts:AssumeRole\"\n"], [433, "        Effect = \"Allow\"\n"], [434, "        Principal = {\n"], [435, "          Service = \"vpc-flow-logs.amazonaws.com\"\n"], [436, "        }\n"], [437, "      }\n"], [438, "    ]\n"], [439, "  })\n"], [440, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [425, 440], "resource": "module.ecs_jenkins_github_dr.module.network.aws_iam_role.vpc_flow_logs_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[425, "resource \"aws_iam_role\" \"vpc_flow_logs_role\" {\n"], [426, "  name = \"vpc-flow-logs-role\"\n"], [427, "\n"], [428, "  assume_role_policy = jsonencode({\n"], [429, "    Version = \"2012-10-17\"\n"], [430, "    Statement = [\n"], [431, "      {\n"], [432, "        Action = \"sts:AssumeRole\"\n"], [433, "        Effect = \"Allow\"\n"], [434, "        Principal = {\n"], [435, "          Service = \"vpc-flow-logs.amazonaws.com\"\n"], [436, "        }\n"], [437, "      }\n"], [438, "    ]\n"], [439, "  })\n"], [440, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [425, 440], "resource": "module.ecs_jenkins_github_dr.module.network.aws_iam_role.vpc_flow_logs_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_62", "bc_check_id": "BC_AWS_IAM_47", "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[442, "resource \"aws_iam_role_policy\" \"vpc_flow_logs_policy\" {\n"], [443, "  name = \"vpc-flow-logs-policy\"\n"], [444, "  role = aws_iam_role.vpc_flow_logs_role.id\n"], [445, "\n"], [446, "  policy = jsonencode({\n"], [447, "    Version = \"2012-10-17\"\n"], [448, "    Statement = [\n"], [449, "      {\n"], [450, "        Action = [\n"], [451, "          \"logs:CreateLogGroup\",\n"], [452, "          \"logs:CreateLogStream\",\n"], [453, "          \"logs:PutLogEvents\",\n"], [454, "          \"logs:DescribeLogGroups\",\n"], [455, "          \"logs:DescribeLogStreams\"\n"], [456, "        ]\n"], [457, "        Effect   = \"Allow\"\n"], [458, "        Resource = \"*\"\n"], [459, "      }\n"], [460, "    ]\n"], [461, "  })\n"], [462, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [442, 462], "resource": "module.ecs_jenkins_github_dr.module.network.aws_iam_role_policy.vpc_flow_logs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMAdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_287", "bc_check_id": "BC_AWS_IAM_82", "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[442, "resource \"aws_iam_role_policy\" \"vpc_flow_logs_policy\" {\n"], [443, "  name = \"vpc-flow-logs-policy\"\n"], [444, "  role = aws_iam_role.vpc_flow_logs_role.id\n"], [445, "\n"], [446, "  policy = jsonencode({\n"], [447, "    Version = \"2012-10-17\"\n"], [448, "    Statement = [\n"], [449, "      {\n"], [450, "        Action = [\n"], [451, "          \"logs:CreateLogGroup\",\n"], [452, "          \"logs:CreateLogStream\",\n"], [453, "          \"logs:PutLogEvents\",\n"], [454, "          \"logs:DescribeLogGroups\",\n"], [455, "          \"logs:DescribeLogStreams\"\n"], [456, "        ]\n"], [457, "        Effect   = \"Allow\"\n"], [458, "        Resource = \"*\"\n"], [459, "      }\n"], [460, "    ]\n"], [461, "  })\n"], [462, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [442, 462], "resource": "module.ecs_jenkins_github_dr.module.network.aws_iam_role_policy.vpc_flow_logs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-287", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_288", "bc_check_id": "BC_AWS_IAM_83", "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[442, "resource \"aws_iam_role_policy\" \"vpc_flow_logs_policy\" {\n"], [443, "  name = \"vpc-flow-logs-policy\"\n"], [444, "  role = aws_iam_role.vpc_flow_logs_role.id\n"], [445, "\n"], [446, "  policy = jsonencode({\n"], [447, "    Version = \"2012-10-17\"\n"], [448, "    Statement = [\n"], [449, "      {\n"], [450, "        Action = [\n"], [451, "          \"logs:CreateLogGroup\",\n"], [452, "          \"logs:CreateLogStream\",\n"], [453, "          \"logs:PutLogEvents\",\n"], [454, "          \"logs:DescribeLogGroups\",\n"], [455, "          \"logs:DescribeLogStreams\"\n"], [456, "        ]\n"], [457, "        Effect   = \"Allow\"\n"], [458, "        Resource = \"*\"\n"], [459, "      }\n"], [460, "    ]\n"], [461, "  })\n"], [462, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [442, 462], "resource": "module.ecs_jenkins_github_dr.module.network.aws_iam_role_policy.vpc_flow_logs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-288", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_289", "bc_check_id": "BC_AWS_IAM_84", "check_name": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[442, "resource \"aws_iam_role_policy\" \"vpc_flow_logs_policy\" {\n"], [443, "  name = \"vpc-flow-logs-policy\"\n"], [444, "  role = aws_iam_role.vpc_flow_logs_role.id\n"], [445, "\n"], [446, "  policy = jsonencode({\n"], [447, "    Version = \"2012-10-17\"\n"], [448, "    Statement = [\n"], [449, "      {\n"], [450, "        Action = [\n"], [451, "          \"logs:CreateLogGroup\",\n"], [452, "          \"logs:CreateLogStream\",\n"], [453, "          \"logs:PutLogEvents\",\n"], [454, "          \"logs:DescribeLogGroups\",\n"], [455, "          \"logs:DescribeLogStreams\"\n"], [456, "        ]\n"], [457, "        Effect   = \"Allow\"\n"], [458, "        Resource = \"*\"\n"], [459, "      }\n"], [460, "    ]\n"], [461, "  })\n"], [462, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [442, 462], "resource": "module.ecs_jenkins_github_dr.module.network.aws_iam_role_policy.vpc_flow_logs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-289", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_286", "bc_check_id": "BC_AWS_IAM_81", "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[442, "resource \"aws_iam_role_policy\" \"vpc_flow_logs_policy\" {\n"], [443, "  name = \"vpc-flow-logs-policy\"\n"], [444, "  role = aws_iam_role.vpc_flow_logs_role.id\n"], [445, "\n"], [446, "  policy = jsonencode({\n"], [447, "    Version = \"2012-10-17\"\n"], [448, "    Statement = [\n"], [449, "      {\n"], [450, "        Action = [\n"], [451, "          \"logs:CreateLogGroup\",\n"], [452, "          \"logs:CreateLogStream\",\n"], [453, "          \"logs:PutLogEvents\",\n"], [454, "          \"logs:DescribeLogGroups\",\n"], [455, "          \"logs:DescribeLogStreams\"\n"], [456, "        ]\n"], [457, "        Effect   = \"Allow\"\n"], [458, "        Resource = \"*\"\n"], [459, "      }\n"], [460, "    ]\n"], [461, "  })\n"], [462, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [442, 462], "resource": "module.ecs_jenkins_github_dr.module.network.aws_iam_role_policy.vpc_flow_logs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-286", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_63", "bc_check_id": "BC_AWS_IAM_48", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[442, "resource \"aws_iam_role_policy\" \"vpc_flow_logs_policy\" {\n"], [443, "  name = \"vpc-flow-logs-policy\"\n"], [444, "  role = aws_iam_role.vpc_flow_logs_role.id\n"], [445, "\n"], [446, "  policy = jsonencode({\n"], [447, "    Version = \"2012-10-17\"\n"], [448, "    Statement = [\n"], [449, "      {\n"], [450, "        Action = [\n"], [451, "          \"logs:CreateLogGroup\",\n"], [452, "          \"logs:CreateLogStream\",\n"], [453, "          \"logs:PutLogEvents\",\n"], [454, "          \"logs:DescribeLogGroups\",\n"], [455, "          \"logs:DescribeLogStreams\"\n"], [456, "        ]\n"], [457, "        Effect   = \"Allow\"\n"], [458, "        Resource = \"*\"\n"], [459, "      }\n"], [460, "    ]\n"], [461, "  })\n"], [462, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [442, 462], "resource": "module.ecs_jenkins_github_dr.module.network.aws_iam_role_policy.vpc_flow_logs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_382", "bc_check_id": "BC_AWS_IAM_93", "check_name": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[465, "resource \"aws_security_group\" \"alb_security_group\" {\n"], [466, "  name        = \"alb-security-group\"\n"], [467, "  description = \"Security group for application load balancer\"\n"], [468, "  vpc_id      = aws_vpc.vpc.id\n"], [469, "\n"], [470, "  # Allow incoming HTTPS traffic only\n"], [471, "  ingress {\n"], [472, "    description = \"HTTPS from internet\"\n"], [473, "    from_port   = 443\n"], [474, "    to_port     = 443\n"], [475, "    protocol    = \"tcp\"\n"], [476, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [477, "  }\n"], [478, "\n"], [479, "  # HTTP for redirection only (will be redirected to HTTPS)\n"], [480, "  ingress {\n"], [481, "    description = \"HTTP from internet (for redirection to HTTPS)\"\n"], [482, "    from_port   = 80\n"], [483, "    to_port     = 80\n"], [484, "    protocol    = \"tcp\"\n"], [485, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [486, "  }\n"], [487, "\n"], [488, "  # Restricted egress rules\n"], [489, "  egress {\n"], [490, "    description = \"HTTP to ECS services\"\n"], [491, "    from_port   = 80\n"], [492, "    to_port     = 80\n"], [493, "    protocol    = \"tcp\"\n"], [494, "    cidr_blocks = [aws_vpc.vpc.cidr_block] # Allow traffic to any private IP in the VPC\n"], [495, "  }\n"], [496, "\n"], [497, "  egress {\n"], [498, "    description = \"HTTPS to internet for external resources\"\n"], [499, "    from_port   = 443\n"], [500, "    to_port     = 443\n"], [501, "    protocol    = \"tcp\"\n"], [502, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [503, "  }\n"], [504, "\n"], [505, "  tags = {\n"], [506, "    Name = \"alb-security-group\"\n"], [507, "  }\n"], [508, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [465, 508], "resource": "module.ecs_jenkins_github_dr.module.network.aws_security_group.alb_security_group", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedEgressAny", "fixed_definition": null, "entity_tags": {"Name": "alb-security-group"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[465, "resource \"aws_security_group\" \"alb_security_group\" {\n"], [466, "  name        = \"alb-security-group\"\n"], [467, "  description = \"Security group for application load balancer\"\n"], [468, "  vpc_id      = aws_vpc.vpc.id\n"], [469, "\n"], [470, "  # Allow incoming HTTPS traffic only\n"], [471, "  ingress {\n"], [472, "    description = \"HTTPS from internet\"\n"], [473, "    from_port   = 443\n"], [474, "    to_port     = 443\n"], [475, "    protocol    = \"tcp\"\n"], [476, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [477, "  }\n"], [478, "\n"], [479, "  # HTTP for redirection only (will be redirected to HTTPS)\n"], [480, "  ingress {\n"], [481, "    description = \"HTTP from internet (for redirection to HTTPS)\"\n"], [482, "    from_port   = 80\n"], [483, "    to_port     = 80\n"], [484, "    protocol    = \"tcp\"\n"], [485, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [486, "  }\n"], [487, "\n"], [488, "  # Restricted egress rules\n"], [489, "  egress {\n"], [490, "    description = \"HTTP to ECS services\"\n"], [491, "    from_port   = 80\n"], [492, "    to_port     = 80\n"], [493, "    protocol    = \"tcp\"\n"], [494, "    cidr_blocks = [aws_vpc.vpc.cidr_block] # Allow traffic to any private IP in the VPC\n"], [495, "  }\n"], [496, "\n"], [497, "  egress {\n"], [498, "    description = \"HTTPS to internet for external resources\"\n"], [499, "    from_port   = 443\n"], [500, "    to_port     = 443\n"], [501, "    protocol    = \"tcp\"\n"], [502, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [503, "  }\n"], [504, "\n"], [505, "  tags = {\n"], [506, "    Name = \"alb-security-group\"\n"], [507, "  }\n"], [508, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [465, 508], "resource": "module.ecs_jenkins_github_dr.module.network.aws_security_group.alb_security_group", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": {"Name": "alb-security-group"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-2", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_277", "bc_check_id": "BC_AWS_NETWORKING_78", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[465, "resource \"aws_security_group\" \"alb_security_group\" {\n"], [466, "  name        = \"alb-security-group\"\n"], [467, "  description = \"Security group for application load balancer\"\n"], [468, "  vpc_id      = aws_vpc.vpc.id\n"], [469, "\n"], [470, "  # Allow incoming HTTPS traffic only\n"], [471, "  ingress {\n"], [472, "    description = \"HTTPS from internet\"\n"], [473, "    from_port   = 443\n"], [474, "    to_port     = 443\n"], [475, "    protocol    = \"tcp\"\n"], [476, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [477, "  }\n"], [478, "\n"], [479, "  # HTTP for redirection only (will be redirected to HTTPS)\n"], [480, "  ingress {\n"], [481, "    description = \"HTTP from internet (for redirection to HTTPS)\"\n"], [482, "    from_port   = 80\n"], [483, "    to_port     = 80\n"], [484, "    protocol    = \"tcp\"\n"], [485, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [486, "  }\n"], [487, "\n"], [488, "  # Restricted egress rules\n"], [489, "  egress {\n"], [490, "    description = \"HTTP to ECS services\"\n"], [491, "    from_port   = 80\n"], [492, "    to_port     = 80\n"], [493, "    protocol    = \"tcp\"\n"], [494, "    cidr_blocks = [aws_vpc.vpc.cidr_block] # Allow traffic to any private IP in the VPC\n"], [495, "  }\n"], [496, "\n"], [497, "  egress {\n"], [498, "    description = \"HTTPS to internet for external resources\"\n"], [499, "    from_port   = 443\n"], [500, "    to_port     = 443\n"], [501, "    protocol    = \"tcp\"\n"], [502, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [503, "  }\n"], [504, "\n"], [505, "  tags = {\n"], [506, "    Name = \"alb-security-group\"\n"], [507, "  }\n"], [508, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [465, 508], "resource": "module.ecs_jenkins_github_dr.module.network.aws_security_group.alb_security_group", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngressAny", "fixed_definition": null, "entity_tags": {"Name": "alb-security-group"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-group-does-not-allow-all-traffic-on-all-ports", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_382", "bc_check_id": "BC_AWS_IAM_93", "check_name": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[511, "resource \"aws_security_group\" \"ecs_security_group\" {\n"], [512, "  name        = \"ecs-security-group\"\n"], [513, "  description = \"Security group for ECS Fargate tasks\"\n"], [514, "  vpc_id      = aws_vpc.vpc.id\n"], [515, "\n"], [516, "  # Allow incoming HTTP traffic from VPC CIDR\n"], [517, "  ingress {\n"], [518, "    description = \"HTTP from VPC\"\n"], [519, "    from_port   = 80\n"], [520, "    to_port     = 80\n"], [521, "    protocol    = \"tcp\"\n"], [522, "    cidr_blocks = [aws_vpc.vpc.cidr_block]\n"], [523, "  }\n"], [524, "\n"], [525, "  # Allow internal traffic for service discovery\n"], [526, "  ingress {\n"], [527, "    description = \"Inter-container communication\"\n"], [528, "    from_port   = 8080\n"], [529, "    to_port     = 8080\n"], [530, "    protocol    = \"tcp\"\n"], [531, "    self        = true\n"], [532, "  }\n"], [533, "\n"], [534, "  # Restricted egress rules\n"], [535, "  egress {\n"], [536, "    description = \"HTTPS to internet for external resources\"\n"], [537, "    from_port   = 443\n"], [538, "    to_port     = 443\n"], [539, "    protocol    = \"tcp\"\n"], [540, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [541, "  }\n"], [542, "\n"], [543, "  egress {\n"], [544, "    description     = \"Database access\"\n"], [545, "    from_port       = 5432\n"], [546, "    to_port         = 5432\n"], [547, "    protocol        = \"tcp\"\n"], [548, "    security_groups = [aws_security_group.db_security_group.id]\n"], [549, "  }\n"], [550, "\n"], [551, "  tags = {\n"], [552, "    Name = \"ecs-security-group\"\n"], [553, "  }\n"], [554, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [511, 554], "resource": "module.ecs_jenkins_github_dr.module.network.aws_security_group.ecs_security_group", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedEgressAny", "fixed_definition": null, "entity_tags": {"Name": "ecs-security-group"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[511, "resource \"aws_security_group\" \"ecs_security_group\" {\n"], [512, "  name        = \"ecs-security-group\"\n"], [513, "  description = \"Security group for ECS Fargate tasks\"\n"], [514, "  vpc_id      = aws_vpc.vpc.id\n"], [515, "\n"], [516, "  # Allow incoming HTTP traffic from VPC CIDR\n"], [517, "  ingress {\n"], [518, "    description = \"HTTP from VPC\"\n"], [519, "    from_port   = 80\n"], [520, "    to_port     = 80\n"], [521, "    protocol    = \"tcp\"\n"], [522, "    cidr_blocks = [aws_vpc.vpc.cidr_block]\n"], [523, "  }\n"], [524, "\n"], [525, "  # Allow internal traffic for service discovery\n"], [526, "  ingress {\n"], [527, "    description = \"Inter-container communication\"\n"], [528, "    from_port   = 8080\n"], [529, "    to_port     = 8080\n"], [530, "    protocol    = \"tcp\"\n"], [531, "    self        = true\n"], [532, "  }\n"], [533, "\n"], [534, "  # Restricted egress rules\n"], [535, "  egress {\n"], [536, "    description = \"HTTPS to internet for external resources\"\n"], [537, "    from_port   = 443\n"], [538, "    to_port     = 443\n"], [539, "    protocol    = \"tcp\"\n"], [540, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [541, "  }\n"], [542, "\n"], [543, "  egress {\n"], [544, "    description     = \"Database access\"\n"], [545, "    from_port       = 5432\n"], [546, "    to_port         = 5432\n"], [547, "    protocol        = \"tcp\"\n"], [548, "    security_groups = [aws_security_group.db_security_group.id]\n"], [549, "  }\n"], [550, "\n"], [551, "  tags = {\n"], [552, "    Name = \"ecs-security-group\"\n"], [553, "  }\n"], [554, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [511, 554], "resource": "module.ecs_jenkins_github_dr.module.network.aws_security_group.ecs_security_group", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": {"Name": "ecs-security-group"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-2", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_260", "bc_check_id": "BC_AWS_NETWORKING_67", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[511, "resource \"aws_security_group\" \"ecs_security_group\" {\n"], [512, "  name        = \"ecs-security-group\"\n"], [513, "  description = \"Security group for ECS Fargate tasks\"\n"], [514, "  vpc_id      = aws_vpc.vpc.id\n"], [515, "\n"], [516, "  # Allow incoming HTTP traffic from VPC CIDR\n"], [517, "  ingress {\n"], [518, "    description = \"HTTP from VPC\"\n"], [519, "    from_port   = 80\n"], [520, "    to_port     = 80\n"], [521, "    protocol    = \"tcp\"\n"], [522, "    cidr_blocks = [aws_vpc.vpc.cidr_block]\n"], [523, "  }\n"], [524, "\n"], [525, "  # Allow internal traffic for service discovery\n"], [526, "  ingress {\n"], [527, "    description = \"Inter-container communication\"\n"], [528, "    from_port   = 8080\n"], [529, "    to_port     = 8080\n"], [530, "    protocol    = \"tcp\"\n"], [531, "    self        = true\n"], [532, "  }\n"], [533, "\n"], [534, "  # Restricted egress rules\n"], [535, "  egress {\n"], [536, "    description = \"HTTPS to internet for external resources\"\n"], [537, "    from_port   = 443\n"], [538, "    to_port     = 443\n"], [539, "    protocol    = \"tcp\"\n"], [540, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [541, "  }\n"], [542, "\n"], [543, "  egress {\n"], [544, "    description     = \"Database access\"\n"], [545, "    from_port       = 5432\n"], [546, "    to_port         = 5432\n"], [547, "    protocol        = \"tcp\"\n"], [548, "    security_groups = [aws_security_group.db_security_group.id]\n"], [549, "  }\n"], [550, "\n"], [551, "  tags = {\n"], [552, "    Name = \"ecs-security-group\"\n"], [553, "  }\n"], [554, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [511, 554], "resource": "module.ecs_jenkins_github_dr.module.network.aws_security_group.ecs_security_group", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress80", "fixed_definition": null, "entity_tags": {"Name": "ecs-security-group"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_277", "bc_check_id": "BC_AWS_NETWORKING_78", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[511, "resource \"aws_security_group\" \"ecs_security_group\" {\n"], [512, "  name        = \"ecs-security-group\"\n"], [513, "  description = \"Security group for ECS Fargate tasks\"\n"], [514, "  vpc_id      = aws_vpc.vpc.id\n"], [515, "\n"], [516, "  # Allow incoming HTTP traffic from VPC CIDR\n"], [517, "  ingress {\n"], [518, "    description = \"HTTP from VPC\"\n"], [519, "    from_port   = 80\n"], [520, "    to_port     = 80\n"], [521, "    protocol    = \"tcp\"\n"], [522, "    cidr_blocks = [aws_vpc.vpc.cidr_block]\n"], [523, "  }\n"], [524, "\n"], [525, "  # Allow internal traffic for service discovery\n"], [526, "  ingress {\n"], [527, "    description = \"Inter-container communication\"\n"], [528, "    from_port   = 8080\n"], [529, "    to_port     = 8080\n"], [530, "    protocol    = \"tcp\"\n"], [531, "    self        = true\n"], [532, "  }\n"], [533, "\n"], [534, "  # Restricted egress rules\n"], [535, "  egress {\n"], [536, "    description = \"HTTPS to internet for external resources\"\n"], [537, "    from_port   = 443\n"], [538, "    to_port     = 443\n"], [539, "    protocol    = \"tcp\"\n"], [540, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [541, "  }\n"], [542, "\n"], [543, "  egress {\n"], [544, "    description     = \"Database access\"\n"], [545, "    from_port       = 5432\n"], [546, "    to_port         = 5432\n"], [547, "    protocol        = \"tcp\"\n"], [548, "    security_groups = [aws_security_group.db_security_group.id]\n"], [549, "  }\n"], [550, "\n"], [551, "  tags = {\n"], [552, "    Name = \"ecs-security-group\"\n"], [553, "  }\n"], [554, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [511, 554], "resource": "module.ecs_jenkins_github_dr.module.network.aws_security_group.ecs_security_group", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngressAny", "fixed_definition": null, "entity_tags": {"Name": "ecs-security-group"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-group-does-not-allow-all-traffic-on-all-ports", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_382", "bc_check_id": "BC_AWS_IAM_93", "check_name": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[557, "resource \"aws_security_group\" \"db_security_group\" {\n"], [558, "  name        = \"db-security-group\"\n"], [559, "  description = \"Security group for database instances\"\n"], [560, "  vpc_id      = aws_vpc.vpc.id\n"], [561, "\n"], [562, "  # Allow incoming database traffic from VPC\n"], [563, "  ingress {\n"], [564, "    description = \"Database port from VPC\"\n"], [565, "    from_port   = 5432\n"], [566, "    to_port     = 5432\n"], [567, "    protocol    = \"tcp\"\n"], [568, "    cidr_blocks = [aws_vpc.vpc.cidr_block]\n"], [569, "  }\n"], [570, "\n"], [571, "  # Allow response traffic to VPC\n"], [572, "  egress {\n"], [573, "    description = \"Response traffic to VPC\"\n"], [574, "    from_port   = 1024\n"], [575, "    to_port     = 65535\n"], [576, "    protocol    = \"tcp\"\n"], [577, "    cidr_blocks = [aws_vpc.vpc.cidr_block]\n"], [578, "  }\n"], [579, "\n"], [580, "  tags = {\n"], [581, "    Name = \"db-security-group\"\n"], [582, "  }\n"], [583, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [557, 583], "resource": "module.ecs_jenkins_github_dr.module.network.aws_security_group.db_security_group", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedEgressAny", "fixed_definition": null, "entity_tags": {"Name": "db-security-group"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[557, "resource \"aws_security_group\" \"db_security_group\" {\n"], [558, "  name        = \"db-security-group\"\n"], [559, "  description = \"Security group for database instances\"\n"], [560, "  vpc_id      = aws_vpc.vpc.id\n"], [561, "\n"], [562, "  # Allow incoming database traffic from VPC\n"], [563, "  ingress {\n"], [564, "    description = \"Database port from VPC\"\n"], [565, "    from_port   = 5432\n"], [566, "    to_port     = 5432\n"], [567, "    protocol    = \"tcp\"\n"], [568, "    cidr_blocks = [aws_vpc.vpc.cidr_block]\n"], [569, "  }\n"], [570, "\n"], [571, "  # Allow response traffic to VPC\n"], [572, "  egress {\n"], [573, "    description = \"Response traffic to VPC\"\n"], [574, "    from_port   = 1024\n"], [575, "    to_port     = 65535\n"], [576, "    protocol    = \"tcp\"\n"], [577, "    cidr_blocks = [aws_vpc.vpc.cidr_block]\n"], [578, "  }\n"], [579, "\n"], [580, "  tags = {\n"], [581, "    Name = \"db-security-group\"\n"], [582, "  }\n"], [583, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [557, 583], "resource": "module.ecs_jenkins_github_dr.module.network.aws_security_group.db_security_group", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": {"Name": "db-security-group"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-2", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_260", "bc_check_id": "BC_AWS_NETWORKING_67", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[557, "resource \"aws_security_group\" \"db_security_group\" {\n"], [558, "  name        = \"db-security-group\"\n"], [559, "  description = \"Security group for database instances\"\n"], [560, "  vpc_id      = aws_vpc.vpc.id\n"], [561, "\n"], [562, "  # Allow incoming database traffic from VPC\n"], [563, "  ingress {\n"], [564, "    description = \"Database port from VPC\"\n"], [565, "    from_port   = 5432\n"], [566, "    to_port     = 5432\n"], [567, "    protocol    = \"tcp\"\n"], [568, "    cidr_blocks = [aws_vpc.vpc.cidr_block]\n"], [569, "  }\n"], [570, "\n"], [571, "  # Allow response traffic to VPC\n"], [572, "  egress {\n"], [573, "    description = \"Response traffic to VPC\"\n"], [574, "    from_port   = 1024\n"], [575, "    to_port     = 65535\n"], [576, "    protocol    = \"tcp\"\n"], [577, "    cidr_blocks = [aws_vpc.vpc.cidr_block]\n"], [578, "  }\n"], [579, "\n"], [580, "  tags = {\n"], [581, "    Name = \"db-security-group\"\n"], [582, "  }\n"], [583, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [557, 583], "resource": "module.ecs_jenkins_github_dr.module.network.aws_security_group.db_security_group", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress80", "fixed_definition": null, "entity_tags": {"Name": "db-security-group"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_277", "bc_check_id": "BC_AWS_NETWORKING_78", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[557, "resource \"aws_security_group\" \"db_security_group\" {\n"], [558, "  name        = \"db-security-group\"\n"], [559, "  description = \"Security group for database instances\"\n"], [560, "  vpc_id      = aws_vpc.vpc.id\n"], [561, "\n"], [562, "  # Allow incoming database traffic from VPC\n"], [563, "  ingress {\n"], [564, "    description = \"Database port from VPC\"\n"], [565, "    from_port   = 5432\n"], [566, "    to_port     = 5432\n"], [567, "    protocol    = \"tcp\"\n"], [568, "    cidr_blocks = [aws_vpc.vpc.cidr_block]\n"], [569, "  }\n"], [570, "\n"], [571, "  # Allow response traffic to VPC\n"], [572, "  egress {\n"], [573, "    description = \"Response traffic to VPC\"\n"], [574, "    from_port   = 1024\n"], [575, "    to_port     = 65535\n"], [576, "    protocol    = \"tcp\"\n"], [577, "    cidr_blocks = [aws_vpc.vpc.cidr_block]\n"], [578, "  }\n"], [579, "\n"], [580, "  tags = {\n"], [581, "    Name = \"db-security-group\"\n"], [582, "  }\n"], [583, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [557, 583], "resource": "module.ecs_jenkins_github_dr.module.network.aws_security_group.db_security_group", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngressAny", "fixed_definition": null, "entity_tags": {"Name": "db-security-group"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-group-does-not-allow-all-traffic-on-all-ports", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_130", "bc_check_id": "BC_AWS_NETWORKING_53", "check_name": "Ensure VPC subnets do not assign public IP by default", "check_result": {"result": "PASSED", "evaluated_keys": ["map_public_ip_on_launch"]}, "code_block": [[11, "resource \"aws_subnet\" \"public_subnet\" {\n"], [12, "  count                   = length(var.public_subnet_cidrs)\n"], [13, "  vpc_id                  = aws_vpc.vpc.id\n"], [14, "  cidr_block              = var.public_subnet_cidrs[count.index]\n"], [15, "  availability_zone       = var.availability_zones[count.index]\n"], [16, "  map_public_ip_on_launch = false # Not assigning public IPs by default\n"], [17, "\n"], [18, "  tags = {\n"], [19, "    Name = \"public-subnet-${count.index}\"\n"], [20, "  }\n"], [21, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [11, 21], "resource": "module.ecs_jenkins_github_dr.module.network.aws_subnet.public_subnet[1]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP", "fixed_definition": null, "entity_tags": {"Name": "public-subnet-1"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_130", "bc_check_id": "BC_AWS_NETWORKING_53", "check_name": "Ensure VPC subnets do not assign public IP by default", "check_result": {"result": "PASSED", "evaluated_keys": ["map_public_ip_on_launch"]}, "code_block": [[23, "resource \"aws_subnet\" \"private_subnet\" {\n"], [24, "  count             = length(var.private_subnet_cidrs)\n"], [25, "  vpc_id            = aws_vpc.vpc.id\n"], [26, "  cidr_block        = var.private_subnet_cidrs[count.index]\n"], [27, "  availability_zone = var.availability_zones[count.index]\n"], [28, "\n"], [29, "  tags = {\n"], [30, "    Name = \"private-subnet-${count.index}\"\n"], [31, "  }\n"], [32, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [23, 32], "resource": "module.ecs_jenkins_github_dr.module.network.aws_subnet.private_subnet[1]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP", "fixed_definition": null, "entity_tags": {"Name": "private-subnet-1"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_130", "bc_check_id": "BC_AWS_NETWORKING_53", "check_name": "Ensure VPC subnets do not assign public IP by default", "check_result": {"result": "PASSED", "evaluated_keys": ["map_public_ip_on_launch"]}, "code_block": [[34, "resource \"aws_subnet\" \"database_subnet\" {\n"], [35, "  count             = length(var.database_subnet_cidrs)\n"], [36, "  vpc_id            = aws_vpc.vpc.id\n"], [37, "  cidr_block        = var.database_subnet_cidrs[count.index]\n"], [38, "  availability_zone = var.availability_zones[count.index]\n"], [39, "\n"], [40, "  tags = {\n"], [41, "    Name = \"database-subnet-${count.index}\"\n"], [42, "  }\n"], [43, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [34, 43], "resource": "module.ecs_jenkins_github_dr.module.network.aws_subnet.database_subnet[1]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP", "fixed_definition": null, "entity_tags": {"Name": "database-subnet-1"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_192", "bc_check_id": "BC_AWS_NETWORKING_61", "check_name": "Ensure WAF prevents message lookup in Log4j2. See CVE-2021-44228 aka log4jshell", "check_result": {"result": "PASSED", "evaluated_keys": ["rule/[5]/statement/[0]/managed_rule_group_statement/[0]/name", "rule/[5]/statement/[0]/managed_rule_group_statement/[0]/excluded_rule", "rule/[5]/override_action/[0]/none"]}, "code_block": [[20, "resource \"aws_wafv2_web_acl\" \"owasp_top10_protection\" {\n"], [21, "  name        = \"${var.project}-${var.environment}-owasp-protection\"\n"], [22, "  description = \"WAF WebACL with OWASP Top 10 protections\"\n"], [23, "  scope       = \"REGIONAL\"\n"], [24, "\n"], [25, "  default_action {\n"], [26, "    allow {}\n"], [27, "  }\n"], [28, "\n"], [29, "  # Rule #1: Block IPs from blocklist\n"], [30, "  rule {\n"], [31, "    name     = \"block-known-bad-ips\"\n"], [32, "    priority = 0\n"], [33, "\n"], [34, "    action {\n"], [35, "      block {}\n"], [36, "    }\n"], [37, "\n"], [38, "    statement {\n"], [39, "      ip_set_reference_statement {\n"], [40, "        arn = aws_wafv2_ip_set.known_bad_ips.arn\n"], [41, "      }\n"], [42, "    }\n"], [43, "\n"], [44, "    visibility_config {\n"], [45, "      cloudwatch_metrics_enabled = true\n"], [46, "      metric_name                = \"BlockKnownBadIPs\"\n"], [47, "      sampled_requests_enabled   = true\n"], [48, "    }\n"], [49, "  }\n"], [50, "\n"], [51, "  # Rule #2: AWS Managed Rules for SQL Injection\n"], [52, "  rule {\n"], [53, "    name     = \"AWS-AWSManagedRulesSQLiRuleSet\"\n"], [54, "    priority = 10\n"], [55, "\n"], [56, "    override_action {\n"], [57, "      none {}\n"], [58, "    }\n"], [59, "\n"], [60, "    statement {\n"], [61, "      managed_rule_group_statement {\n"], [62, "        name        = \"AWSManagedRulesSQLiRuleSet\"\n"], [63, "        vendor_name = \"AWS\"\n"], [64, "      }\n"], [65, "    }\n"], [66, "\n"], [67, "    visibility_config {\n"], [68, "      cloudwatch_metrics_enabled = true\n"], [69, "      metric_name                = \"AWSManagedRulesSQLiRuleSet\"\n"], [70, "      sampled_requests_enabled   = true\n"], [71, "    }\n"], [72, "  }\n"], [73, "\n"], [74, "  # Rule #3: AWS Managed Rules for XSS Protection\n"], [75, "  rule {\n"], [76, "    name     = \"AWS-AWSManagedRulesXSSRuleSet\"\n"], [77, "    priority = 20\n"], [78, "\n"], [79, "    override_action {\n"], [80, "      none {}\n"], [81, "    }\n"], [82, "\n"], [83, "    statement {\n"], [84, "      managed_rule_group_statement {\n"], [85, "        name        = \"AWSManagedRulesXSSRuleSet\"\n"], [86, "        vendor_name = \"AWS\"\n"], [87, "      }\n"], [88, "    }\n"], [89, "\n"], [90, "    visibility_config {\n"], [91, "      cloudwatch_metrics_enabled = true\n"], [92, "      metric_name                = \"AWSManagedRulesXSSRuleSet\"\n"], [93, "      sampled_requests_enabled   = true\n"], [94, "    }\n"], [95, "  }\n"], [96, "\n"], [97, "  # Rule #4: Size Constraint Rule - Prevents abnormally large requests\n"], [98, "  rule {\n"], [99, "    name     = \"SizeConstraint\"\n"], [100, "    priority = 30\n"], [101, "\n"], [102, "    action {\n"], [103, "      block {}\n"], [104, "    }\n"], [105, "\n"], [106, "    statement {\n"], [107, "      size_constraint_statement {\n"], [108, "        field_to_match {\n"], [109, "          body {}\n"], [110, "        }\n"], [111, "        comparison_operator = \"GT\"\n"], [112, "        size                = var.max_request_size\n"], [113, "        text_transformation {\n"], [114, "          priority = 0\n"], [115, "          type     = \"NONE\"\n"], [116, "        }\n"], [117, "      }\n"], [118, "    }\n"], [119, "\n"], [120, "    visibility_config {\n"], [121, "      cloudwatch_metrics_enabled = true\n"], [122, "      metric_name                = \"SizeConstraint\"\n"], [123, "      sampled_requests_enabled   = true\n"], [124, "    }\n"], [125, "  }\n"], [126, "\n"], [127, "  # Rule #5: Rate-Based Rule for DDoS protection\n"], [128, "  rule {\n"], [129, "    name     = \"RateBasedRule\"\n"], [130, "    priority = 40\n"], [131, "\n"], [132, "    action {\n"], [133, "      block {}\n"], [134, "    }\n"], [135, "\n"], [136, "    statement {\n"], [137, "      rate_based_statement {\n"], [138, "        limit              = var.request_limit\n"], [139, "        aggregate_key_type = \"IP\"\n"], [140, "      }\n"], [141, "    }\n"], [142, "\n"], [143, "    visibility_config {\n"], [144, "      cloudwatch_metrics_enabled = true\n"], [145, "      metric_name                = \"RateBasedRule\"\n"], [146, "      sampled_requests_enabled   = true\n"], [147, "    }\n"], [148, "  }\n"], [149, "\n"], [150, "  # Rule #6: AWS Managed Rules for Known Bad Inputs\n"], [151, "  rule {\n"], [152, "    name     = \"AWS-AWSManagedRulesKnownBadInputsRuleSet\"\n"], [153, "    priority = 50\n"], [154, "\n"], [155, "    override_action {\n"], [156, "      none {}\n"], [157, "    }\n"], [158, "\n"], [159, "    statement {\n"], [160, "      managed_rule_group_statement {\n"], [161, "        name        = \"AWSManagedRulesKnownBadInputsRuleSet\"\n"], [162, "        vendor_name = \"AWS\"\n"], [163, "      }\n"], [164, "    }\n"], [165, "\n"], [166, "    visibility_config {\n"], [167, "      cloudwatch_metrics_enabled = true\n"], [168, "      metric_name                = \"AWSManagedRulesKnownBadInputsRuleSet\"\n"], [169, "      sampled_requests_enabled   = true\n"], [170, "    }\n"], [171, "  }\n"], [172, "\n"], [173, "  # Rule #7: AWS Managed Rules for OWASP Core Ruleset\n"], [174, "  rule {\n"], [175, "    name     = \"AWS-AWSManagedRulesCommonRuleSet\"\n"], [176, "    priority = 60\n"], [177, "\n"], [178, "    override_action {\n"], [179, "      none {}\n"], [180, "    }\n"], [181, "\n"], [182, "    statement {\n"], [183, "      managed_rule_group_statement {\n"], [184, "        name        = \"AWSManagedRulesCommonRuleSet\"\n"], [185, "        vendor_name = \"AWS\"\n"], [186, "      }\n"], [187, "    }\n"], [188, "\n"], [189, "    visibility_config {\n"], [190, "      cloudwatch_metrics_enabled = true\n"], [191, "      metric_name                = \"AWSManagedRulesCommonRuleSet\"\n"], [192, "      sampled_requests_enabled   = true\n"], [193, "    }\n"], [194, "  }\n"], [195, "\n"], [196, "  # Rule #8: AWS Managed Rules for PHP applications\n"], [197, "  rule {\n"], [198, "    name     = \"AWS-AWSManagedRulesPHPRuleSet\"\n"], [199, "    priority = 70\n"], [200, "\n"], [201, "    override_action {\n"], [202, "      none {}\n"], [203, "    }\n"], [204, "\n"], [205, "    statement {\n"], [206, "      managed_rule_group_statement {\n"], [207, "        name        = \"AWSManagedRulesPHPRuleSet\"\n"], [208, "        vendor_name = \"AWS\"\n"], [209, "      }\n"], [210, "    }\n"], [211, "\n"], [212, "    visibility_config {\n"], [213, "      cloudwatch_metrics_enabled = true\n"], [214, "      metric_name                = \"AWSManagedRulesPHPRuleSet\"\n"], [215, "      sampled_requests_enabled   = true\n"], [216, "    }\n"], [217, "  }\n"], [218, "\n"], [219, "  # Rule #9: AWS Managed Rules for Linux OS\n"], [220, "  rule {\n"], [221, "    name     = \"AWS-AWSManagedRulesLinuxRuleSet\"\n"], [222, "    priority = 80\n"], [223, "\n"], [224, "    override_action {\n"], [225, "      none {}\n"], [226, "    }\n"], [227, "\n"], [228, "    statement {\n"], [229, "      managed_rule_group_statement {\n"], [230, "        name        = \"AWSManagedRulesLinuxRuleSet\"\n"], [231, "        vendor_name = \"AWS\"\n"], [232, "      }\n"], [233, "    }\n"], [234, "\n"], [235, "    visibility_config {\n"], [236, "      cloudwatch_metrics_enabled = true\n"], [237, "      metric_name                = \"AWSManagedRulesLinuxRuleSet\"\n"], [238, "      sampled_requests_enabled   = true\n"], [239, "    }\n"], [240, "  }\n"], [241, "\n"], [242, "  # Rule #10: AWS Managed Rules for Bot Control\n"], [243, "  rule {\n"], [244, "    name     = \"AWS-AWSManagedRulesBotControlRuleSet\"\n"], [245, "    priority = 90\n"], [246, "\n"], [247, "    override_action {\n"], [248, "      none {}\n"], [249, "    }\n"], [250, "\n"], [251, "    statement {\n"], [252, "      managed_rule_group_statement {\n"], [253, "        name        = \"AWSManagedRulesBotControlRuleSet\"\n"], [254, "        vendor_name = \"AWS\"\n"], [255, "      }\n"], [256, "    }\n"], [257, "\n"], [258, "    visibility_config {\n"], [259, "      cloudwatch_metrics_enabled = true\n"], [260, "      metric_name                = \"AWSManagedRulesBotControlRuleSet\"\n"], [261, "      sampled_requests_enabled   = true\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "  visibility_config {\n"], [266, "    cloudwatch_metrics_enabled = true\n"], [267, "    metric_name                = \"owasp-top10-protection\"\n"], [268, "    sampled_requests_enabled   = true\n"], [269, "  }\n"], [270, "\n"], [271, "  # Prevent terraform from rebuilding this resource unless actual changes are made\n"], [272, "  lifecycle {\n"], [273, "    create_before_destroy = true\n"], [274, "  }\n"], [275, "\n"], [276, "  tags = {\n"], [277, "    Name        = \"${var.project}-${var.environment}-waf\"\n"], [278, "    Environment = var.environment\n"], [279, "    Project     = var.project\n"], [280, "  }\n"], [281, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [20, 281], "resource": "module.ecs_jenkins_github.module.security.aws_wafv2_web_acl.owasp_top10_protection", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.WAFACLCVE202144228", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-waf", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-waf-prevents-message-lookup-in-log4j2", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_175", "bc_check_id": "BC_AWS_NETWORKING_64", "check_name": "Ensure WAF has associated rules", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[20, "resource \"aws_wafv2_web_acl\" \"owasp_top10_protection\" {\n"], [21, "  name        = \"${var.project}-${var.environment}-owasp-protection\"\n"], [22, "  description = \"WAF WebACL with OWASP Top 10 protections\"\n"], [23, "  scope       = \"REGIONAL\"\n"], [24, "\n"], [25, "  default_action {\n"], [26, "    allow {}\n"], [27, "  }\n"], [28, "\n"], [29, "  # Rule #1: Block IPs from blocklist\n"], [30, "  rule {\n"], [31, "    name     = \"block-known-bad-ips\"\n"], [32, "    priority = 0\n"], [33, "\n"], [34, "    action {\n"], [35, "      block {}\n"], [36, "    }\n"], [37, "\n"], [38, "    statement {\n"], [39, "      ip_set_reference_statement {\n"], [40, "        arn = aws_wafv2_ip_set.known_bad_ips.arn\n"], [41, "      }\n"], [42, "    }\n"], [43, "\n"], [44, "    visibility_config {\n"], [45, "      cloudwatch_metrics_enabled = true\n"], [46, "      metric_name                = \"BlockKnownBadIPs\"\n"], [47, "      sampled_requests_enabled   = true\n"], [48, "    }\n"], [49, "  }\n"], [50, "\n"], [51, "  # Rule #2: AWS Managed Rules for SQL Injection\n"], [52, "  rule {\n"], [53, "    name     = \"AWS-AWSManagedRulesSQLiRuleSet\"\n"], [54, "    priority = 10\n"], [55, "\n"], [56, "    override_action {\n"], [57, "      none {}\n"], [58, "    }\n"], [59, "\n"], [60, "    statement {\n"], [61, "      managed_rule_group_statement {\n"], [62, "        name        = \"AWSManagedRulesSQLiRuleSet\"\n"], [63, "        vendor_name = \"AWS\"\n"], [64, "      }\n"], [65, "    }\n"], [66, "\n"], [67, "    visibility_config {\n"], [68, "      cloudwatch_metrics_enabled = true\n"], [69, "      metric_name                = \"AWSManagedRulesSQLiRuleSet\"\n"], [70, "      sampled_requests_enabled   = true\n"], [71, "    }\n"], [72, "  }\n"], [73, "\n"], [74, "  # Rule #3: AWS Managed Rules for XSS Protection\n"], [75, "  rule {\n"], [76, "    name     = \"AWS-AWSManagedRulesXSSRuleSet\"\n"], [77, "    priority = 20\n"], [78, "\n"], [79, "    override_action {\n"], [80, "      none {}\n"], [81, "    }\n"], [82, "\n"], [83, "    statement {\n"], [84, "      managed_rule_group_statement {\n"], [85, "        name        = \"AWSManagedRulesXSSRuleSet\"\n"], [86, "        vendor_name = \"AWS\"\n"], [87, "      }\n"], [88, "    }\n"], [89, "\n"], [90, "    visibility_config {\n"], [91, "      cloudwatch_metrics_enabled = true\n"], [92, "      metric_name                = \"AWSManagedRulesXSSRuleSet\"\n"], [93, "      sampled_requests_enabled   = true\n"], [94, "    }\n"], [95, "  }\n"], [96, "\n"], [97, "  # Rule #4: Size Constraint Rule - Prevents abnormally large requests\n"], [98, "  rule {\n"], [99, "    name     = \"SizeConstraint\"\n"], [100, "    priority = 30\n"], [101, "\n"], [102, "    action {\n"], [103, "      block {}\n"], [104, "    }\n"], [105, "\n"], [106, "    statement {\n"], [107, "      size_constraint_statement {\n"], [108, "        field_to_match {\n"], [109, "          body {}\n"], [110, "        }\n"], [111, "        comparison_operator = \"GT\"\n"], [112, "        size                = var.max_request_size\n"], [113, "        text_transformation {\n"], [114, "          priority = 0\n"], [115, "          type     = \"NONE\"\n"], [116, "        }\n"], [117, "      }\n"], [118, "    }\n"], [119, "\n"], [120, "    visibility_config {\n"], [121, "      cloudwatch_metrics_enabled = true\n"], [122, "      metric_name                = \"SizeConstraint\"\n"], [123, "      sampled_requests_enabled   = true\n"], [124, "    }\n"], [125, "  }\n"], [126, "\n"], [127, "  # Rule #5: Rate-Based Rule for DDoS protection\n"], [128, "  rule {\n"], [129, "    name     = \"RateBasedRule\"\n"], [130, "    priority = 40\n"], [131, "\n"], [132, "    action {\n"], [133, "      block {}\n"], [134, "    }\n"], [135, "\n"], [136, "    statement {\n"], [137, "      rate_based_statement {\n"], [138, "        limit              = var.request_limit\n"], [139, "        aggregate_key_type = \"IP\"\n"], [140, "      }\n"], [141, "    }\n"], [142, "\n"], [143, "    visibility_config {\n"], [144, "      cloudwatch_metrics_enabled = true\n"], [145, "      metric_name                = \"RateBasedRule\"\n"], [146, "      sampled_requests_enabled   = true\n"], [147, "    }\n"], [148, "  }\n"], [149, "\n"], [150, "  # Rule #6: AWS Managed Rules for Known Bad Inputs\n"], [151, "  rule {\n"], [152, "    name     = \"AWS-AWSManagedRulesKnownBadInputsRuleSet\"\n"], [153, "    priority = 50\n"], [154, "\n"], [155, "    override_action {\n"], [156, "      none {}\n"], [157, "    }\n"], [158, "\n"], [159, "    statement {\n"], [160, "      managed_rule_group_statement {\n"], [161, "        name        = \"AWSManagedRulesKnownBadInputsRuleSet\"\n"], [162, "        vendor_name = \"AWS\"\n"], [163, "      }\n"], [164, "    }\n"], [165, "\n"], [166, "    visibility_config {\n"], [167, "      cloudwatch_metrics_enabled = true\n"], [168, "      metric_name                = \"AWSManagedRulesKnownBadInputsRuleSet\"\n"], [169, "      sampled_requests_enabled   = true\n"], [170, "    }\n"], [171, "  }\n"], [172, "\n"], [173, "  # Rule #7: AWS Managed Rules for OWASP Core Ruleset\n"], [174, "  rule {\n"], [175, "    name     = \"AWS-AWSManagedRulesCommonRuleSet\"\n"], [176, "    priority = 60\n"], [177, "\n"], [178, "    override_action {\n"], [179, "      none {}\n"], [180, "    }\n"], [181, "\n"], [182, "    statement {\n"], [183, "      managed_rule_group_statement {\n"], [184, "        name        = \"AWSManagedRulesCommonRuleSet\"\n"], [185, "        vendor_name = \"AWS\"\n"], [186, "      }\n"], [187, "    }\n"], [188, "\n"], [189, "    visibility_config {\n"], [190, "      cloudwatch_metrics_enabled = true\n"], [191, "      metric_name                = \"AWSManagedRulesCommonRuleSet\"\n"], [192, "      sampled_requests_enabled   = true\n"], [193, "    }\n"], [194, "  }\n"], [195, "\n"], [196, "  # Rule #8: AWS Managed Rules for PHP applications\n"], [197, "  rule {\n"], [198, "    name     = \"AWS-AWSManagedRulesPHPRuleSet\"\n"], [199, "    priority = 70\n"], [200, "\n"], [201, "    override_action {\n"], [202, "      none {}\n"], [203, "    }\n"], [204, "\n"], [205, "    statement {\n"], [206, "      managed_rule_group_statement {\n"], [207, "        name        = \"AWSManagedRulesPHPRuleSet\"\n"], [208, "        vendor_name = \"AWS\"\n"], [209, "      }\n"], [210, "    }\n"], [211, "\n"], [212, "    visibility_config {\n"], [213, "      cloudwatch_metrics_enabled = true\n"], [214, "      metric_name                = \"AWSManagedRulesPHPRuleSet\"\n"], [215, "      sampled_requests_enabled   = true\n"], [216, "    }\n"], [217, "  }\n"], [218, "\n"], [219, "  # Rule #9: AWS Managed Rules for Linux OS\n"], [220, "  rule {\n"], [221, "    name     = \"AWS-AWSManagedRulesLinuxRuleSet\"\n"], [222, "    priority = 80\n"], [223, "\n"], [224, "    override_action {\n"], [225, "      none {}\n"], [226, "    }\n"], [227, "\n"], [228, "    statement {\n"], [229, "      managed_rule_group_statement {\n"], [230, "        name        = \"AWSManagedRulesLinuxRuleSet\"\n"], [231, "        vendor_name = \"AWS\"\n"], [232, "      }\n"], [233, "    }\n"], [234, "\n"], [235, "    visibility_config {\n"], [236, "      cloudwatch_metrics_enabled = true\n"], [237, "      metric_name                = \"AWSManagedRulesLinuxRuleSet\"\n"], [238, "      sampled_requests_enabled   = true\n"], [239, "    }\n"], [240, "  }\n"], [241, "\n"], [242, "  # Rule #10: AWS Managed Rules for Bot Control\n"], [243, "  rule {\n"], [244, "    name     = \"AWS-AWSManagedRulesBotControlRuleSet\"\n"], [245, "    priority = 90\n"], [246, "\n"], [247, "    override_action {\n"], [248, "      none {}\n"], [249, "    }\n"], [250, "\n"], [251, "    statement {\n"], [252, "      managed_rule_group_statement {\n"], [253, "        name        = \"AWSManagedRulesBotControlRuleSet\"\n"], [254, "        vendor_name = \"AWS\"\n"], [255, "      }\n"], [256, "    }\n"], [257, "\n"], [258, "    visibility_config {\n"], [259, "      cloudwatch_metrics_enabled = true\n"], [260, "      metric_name                = \"AWSManagedRulesBotControlRuleSet\"\n"], [261, "      sampled_requests_enabled   = true\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "  visibility_config {\n"], [266, "    cloudwatch_metrics_enabled = true\n"], [267, "    metric_name                = \"owasp-top10-protection\"\n"], [268, "    sampled_requests_enabled   = true\n"], [269, "  }\n"], [270, "\n"], [271, "  # Prevent terraform from rebuilding this resource unless actual changes are made\n"], [272, "  lifecycle {\n"], [273, "    create_before_destroy = true\n"], [274, "  }\n"], [275, "\n"], [276, "  tags = {\n"], [277, "    Name        = \"${var.project}-${var.environment}-waf\"\n"], [278, "    Environment = var.environment\n"], [279, "    Project     = var.project\n"], [280, "  }\n"], [281, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [20, 281], "resource": "module.ecs_jenkins_github.module.security.aws_wafv2_web_acl.owasp_top10_protection", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.WAFHasAnyRules", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-waf", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-networking-64", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_342", "bc_check_id": "BC_AWS_GENERAL_245", "check_name": "Ensure WAF rule has any actions", "check_result": {"result": "PASSED", "evaluated_keys": ["rule", "rules", "activated_rule"]}, "code_block": [[20, "resource \"aws_wafv2_web_acl\" \"owasp_top10_protection\" {\n"], [21, "  name        = \"${var.project}-${var.environment}-owasp-protection\"\n"], [22, "  description = \"WAF WebACL with OWASP Top 10 protections\"\n"], [23, "  scope       = \"REGIONAL\"\n"], [24, "\n"], [25, "  default_action {\n"], [26, "    allow {}\n"], [27, "  }\n"], [28, "\n"], [29, "  # Rule #1: Block IPs from blocklist\n"], [30, "  rule {\n"], [31, "    name     = \"block-known-bad-ips\"\n"], [32, "    priority = 0\n"], [33, "\n"], [34, "    action {\n"], [35, "      block {}\n"], [36, "    }\n"], [37, "\n"], [38, "    statement {\n"], [39, "      ip_set_reference_statement {\n"], [40, "        arn = aws_wafv2_ip_set.known_bad_ips.arn\n"], [41, "      }\n"], [42, "    }\n"], [43, "\n"], [44, "    visibility_config {\n"], [45, "      cloudwatch_metrics_enabled = true\n"], [46, "      metric_name                = \"BlockKnownBadIPs\"\n"], [47, "      sampled_requests_enabled   = true\n"], [48, "    }\n"], [49, "  }\n"], [50, "\n"], [51, "  # Rule #2: AWS Managed Rules for SQL Injection\n"], [52, "  rule {\n"], [53, "    name     = \"AWS-AWSManagedRulesSQLiRuleSet\"\n"], [54, "    priority = 10\n"], [55, "\n"], [56, "    override_action {\n"], [57, "      none {}\n"], [58, "    }\n"], [59, "\n"], [60, "    statement {\n"], [61, "      managed_rule_group_statement {\n"], [62, "        name        = \"AWSManagedRulesSQLiRuleSet\"\n"], [63, "        vendor_name = \"AWS\"\n"], [64, "      }\n"], [65, "    }\n"], [66, "\n"], [67, "    visibility_config {\n"], [68, "      cloudwatch_metrics_enabled = true\n"], [69, "      metric_name                = \"AWSManagedRulesSQLiRuleSet\"\n"], [70, "      sampled_requests_enabled   = true\n"], [71, "    }\n"], [72, "  }\n"], [73, "\n"], [74, "  # Rule #3: AWS Managed Rules for XSS Protection\n"], [75, "  rule {\n"], [76, "    name     = \"AWS-AWSManagedRulesXSSRuleSet\"\n"], [77, "    priority = 20\n"], [78, "\n"], [79, "    override_action {\n"], [80, "      none {}\n"], [81, "    }\n"], [82, "\n"], [83, "    statement {\n"], [84, "      managed_rule_group_statement {\n"], [85, "        name        = \"AWSManagedRulesXSSRuleSet\"\n"], [86, "        vendor_name = \"AWS\"\n"], [87, "      }\n"], [88, "    }\n"], [89, "\n"], [90, "    visibility_config {\n"], [91, "      cloudwatch_metrics_enabled = true\n"], [92, "      metric_name                = \"AWSManagedRulesXSSRuleSet\"\n"], [93, "      sampled_requests_enabled   = true\n"], [94, "    }\n"], [95, "  }\n"], [96, "\n"], [97, "  # Rule #4: Size Constraint Rule - Prevents abnormally large requests\n"], [98, "  rule {\n"], [99, "    name     = \"SizeConstraint\"\n"], [100, "    priority = 30\n"], [101, "\n"], [102, "    action {\n"], [103, "      block {}\n"], [104, "    }\n"], [105, "\n"], [106, "    statement {\n"], [107, "      size_constraint_statement {\n"], [108, "        field_to_match {\n"], [109, "          body {}\n"], [110, "        }\n"], [111, "        comparison_operator = \"GT\"\n"], [112, "        size                = var.max_request_size\n"], [113, "        text_transformation {\n"], [114, "          priority = 0\n"], [115, "          type     = \"NONE\"\n"], [116, "        }\n"], [117, "      }\n"], [118, "    }\n"], [119, "\n"], [120, "    visibility_config {\n"], [121, "      cloudwatch_metrics_enabled = true\n"], [122, "      metric_name                = \"SizeConstraint\"\n"], [123, "      sampled_requests_enabled   = true\n"], [124, "    }\n"], [125, "  }\n"], [126, "\n"], [127, "  # Rule #5: Rate-Based Rule for DDoS protection\n"], [128, "  rule {\n"], [129, "    name     = \"RateBasedRule\"\n"], [130, "    priority = 40\n"], [131, "\n"], [132, "    action {\n"], [133, "      block {}\n"], [134, "    }\n"], [135, "\n"], [136, "    statement {\n"], [137, "      rate_based_statement {\n"], [138, "        limit              = var.request_limit\n"], [139, "        aggregate_key_type = \"IP\"\n"], [140, "      }\n"], [141, "    }\n"], [142, "\n"], [143, "    visibility_config {\n"], [144, "      cloudwatch_metrics_enabled = true\n"], [145, "      metric_name                = \"RateBasedRule\"\n"], [146, "      sampled_requests_enabled   = true\n"], [147, "    }\n"], [148, "  }\n"], [149, "\n"], [150, "  # Rule #6: AWS Managed Rules for Known Bad Inputs\n"], [151, "  rule {\n"], [152, "    name     = \"AWS-AWSManagedRulesKnownBadInputsRuleSet\"\n"], [153, "    priority = 50\n"], [154, "\n"], [155, "    override_action {\n"], [156, "      none {}\n"], [157, "    }\n"], [158, "\n"], [159, "    statement {\n"], [160, "      managed_rule_group_statement {\n"], [161, "        name        = \"AWSManagedRulesKnownBadInputsRuleSet\"\n"], [162, "        vendor_name = \"AWS\"\n"], [163, "      }\n"], [164, "    }\n"], [165, "\n"], [166, "    visibility_config {\n"], [167, "      cloudwatch_metrics_enabled = true\n"], [168, "      metric_name                = \"AWSManagedRulesKnownBadInputsRuleSet\"\n"], [169, "      sampled_requests_enabled   = true\n"], [170, "    }\n"], [171, "  }\n"], [172, "\n"], [173, "  # Rule #7: AWS Managed Rules for OWASP Core Ruleset\n"], [174, "  rule {\n"], [175, "    name     = \"AWS-AWSManagedRulesCommonRuleSet\"\n"], [176, "    priority = 60\n"], [177, "\n"], [178, "    override_action {\n"], [179, "      none {}\n"], [180, "    }\n"], [181, "\n"], [182, "    statement {\n"], [183, "      managed_rule_group_statement {\n"], [184, "        name        = \"AWSManagedRulesCommonRuleSet\"\n"], [185, "        vendor_name = \"AWS\"\n"], [186, "      }\n"], [187, "    }\n"], [188, "\n"], [189, "    visibility_config {\n"], [190, "      cloudwatch_metrics_enabled = true\n"], [191, "      metric_name                = \"AWSManagedRulesCommonRuleSet\"\n"], [192, "      sampled_requests_enabled   = true\n"], [193, "    }\n"], [194, "  }\n"], [195, "\n"], [196, "  # Rule #8: AWS Managed Rules for PHP applications\n"], [197, "  rule {\n"], [198, "    name     = \"AWS-AWSManagedRulesPHPRuleSet\"\n"], [199, "    priority = 70\n"], [200, "\n"], [201, "    override_action {\n"], [202, "      none {}\n"], [203, "    }\n"], [204, "\n"], [205, "    statement {\n"], [206, "      managed_rule_group_statement {\n"], [207, "        name        = \"AWSManagedRulesPHPRuleSet\"\n"], [208, "        vendor_name = \"AWS\"\n"], [209, "      }\n"], [210, "    }\n"], [211, "\n"], [212, "    visibility_config {\n"], [213, "      cloudwatch_metrics_enabled = true\n"], [214, "      metric_name                = \"AWSManagedRulesPHPRuleSet\"\n"], [215, "      sampled_requests_enabled   = true\n"], [216, "    }\n"], [217, "  }\n"], [218, "\n"], [219, "  # Rule #9: AWS Managed Rules for Linux OS\n"], [220, "  rule {\n"], [221, "    name     = \"AWS-AWSManagedRulesLinuxRuleSet\"\n"], [222, "    priority = 80\n"], [223, "\n"], [224, "    override_action {\n"], [225, "      none {}\n"], [226, "    }\n"], [227, "\n"], [228, "    statement {\n"], [229, "      managed_rule_group_statement {\n"], [230, "        name        = \"AWSManagedRulesLinuxRuleSet\"\n"], [231, "        vendor_name = \"AWS\"\n"], [232, "      }\n"], [233, "    }\n"], [234, "\n"], [235, "    visibility_config {\n"], [236, "      cloudwatch_metrics_enabled = true\n"], [237, "      metric_name                = \"AWSManagedRulesLinuxRuleSet\"\n"], [238, "      sampled_requests_enabled   = true\n"], [239, "    }\n"], [240, "  }\n"], [241, "\n"], [242, "  # Rule #10: AWS Managed Rules for Bot Control\n"], [243, "  rule {\n"], [244, "    name     = \"AWS-AWSManagedRulesBotControlRuleSet\"\n"], [245, "    priority = 90\n"], [246, "\n"], [247, "    override_action {\n"], [248, "      none {}\n"], [249, "    }\n"], [250, "\n"], [251, "    statement {\n"], [252, "      managed_rule_group_statement {\n"], [253, "        name        = \"AWSManagedRulesBotControlRuleSet\"\n"], [254, "        vendor_name = \"AWS\"\n"], [255, "      }\n"], [256, "    }\n"], [257, "\n"], [258, "    visibility_config {\n"], [259, "      cloudwatch_metrics_enabled = true\n"], [260, "      metric_name                = \"AWSManagedRulesBotControlRuleSet\"\n"], [261, "      sampled_requests_enabled   = true\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "  visibility_config {\n"], [266, "    cloudwatch_metrics_enabled = true\n"], [267, "    metric_name                = \"owasp-top10-protection\"\n"], [268, "    sampled_requests_enabled   = true\n"], [269, "  }\n"], [270, "\n"], [271, "  # Prevent terraform from rebuilding this resource unless actual changes are made\n"], [272, "  lifecycle {\n"], [273, "    create_before_destroy = true\n"], [274, "  }\n"], [275, "\n"], [276, "  tags = {\n"], [277, "    Name        = \"${var.project}-${var.environment}-waf\"\n"], [278, "    Environment = var.environment\n"], [279, "    Project     = var.project\n"], [280, "  }\n"], [281, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [20, 281], "resource": "module.ecs_jenkins_github.module.security.aws_wafv2_web_acl.owasp_top10_protection", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.WAFRuleHasAnyActions", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-waf", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-342", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_93", "bc_check_id": "BC_AWS_S3_24", "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[330, "resource \"aws_s3_bucket\" \"config_bucket\" {\n"], [331, "  bucket        = \"${var.project}-${var.environment}-config-${random_string.bucket_suffix.result}\"\n"], [332, "  force_destroy = var.environment != \"prod\"\n"], [333, "\n"], [334, "  tags = {\n"], [335, "    Name        = \"${var.project}-${var.environment}-config-bucket\"\n"], [336, "    Environment = var.environment\n"], [337, "    Project     = var.project\n"], [338, "  }\n"], [339, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [330, 339], "resource": "module.ecs_jenkins_github.module.security.aws_s3_bucket.config_bucket", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-config-bucket", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-24", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_53", "bc_check_id": "BC_AWS_S3_19", "check_name": "Ensure S3 bucket has block public ACLS enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["block_public_acls"]}, "code_block": [[342, "resource \"aws_s3_bucket_public_access_block\" \"config_bucket_block\" {\n"], [343, "  bucket                  = aws_s3_bucket.config_bucket.id\n"], [344, "  block_public_acls       = true\n"], [345, "  block_public_policy     = true\n"], [346, "  ignore_public_acls      = true\n"], [347, "  restrict_public_buckets = true\n"], [348, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [342, 348], "resource": "module.ecs_jenkins_github.module.security.aws_s3_bucket_public_access_block.config_bucket_block", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-19", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_54", "bc_check_id": "BC_AWS_S3_20", "check_name": "Ensure S3 bucket has block public policy enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["block_public_policy"]}, "code_block": [[342, "resource \"aws_s3_bucket_public_access_block\" \"config_bucket_block\" {\n"], [343, "  bucket                  = aws_s3_bucket.config_bucket.id\n"], [344, "  block_public_acls       = true\n"], [345, "  block_public_policy     = true\n"], [346, "  ignore_public_acls      = true\n"], [347, "  restrict_public_buckets = true\n"], [348, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [342, 348], "resource": "module.ecs_jenkins_github.module.security.aws_s3_bucket_public_access_block.config_bucket_block", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-20", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_55", "bc_check_id": "BC_AWS_S3_21", "check_name": "Ensure S3 bucket has ignore public ACLs enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["ignore_public_acls"]}, "code_block": [[342, "resource \"aws_s3_bucket_public_access_block\" \"config_bucket_block\" {\n"], [343, "  bucket                  = aws_s3_bucket.config_bucket.id\n"], [344, "  block_public_acls       = true\n"], [345, "  block_public_policy     = true\n"], [346, "  ignore_public_acls      = true\n"], [347, "  restrict_public_buckets = true\n"], [348, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [342, 348], "resource": "module.ecs_jenkins_github.module.security.aws_s3_bucket_public_access_block.config_bucket_block", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3IgnorePublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-21", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_56", "bc_check_id": "BC_AWS_S3_22", "check_name": "Ensure S3 bucket has 'restrict_public_buckets' enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["restrict_public_buckets"]}, "code_block": [[342, "resource \"aws_s3_bucket_public_access_block\" \"config_bucket_block\" {\n"], [343, "  bucket                  = aws_s3_bucket.config_bucket.id\n"], [344, "  block_public_acls       = true\n"], [345, "  block_public_policy     = true\n"], [346, "  ignore_public_acls      = true\n"], [347, "  restrict_public_buckets = true\n"], [348, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [342, 348], "resource": "module.ecs_jenkins_github.module.security.aws_s3_bucket_public_access_block.config_bucket_block", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3RestrictPublicBuckets", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-22", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[373, "resource \"aws_iam_role\" \"config_role\" {\n"], [374, "  name = \"${var.project}-${var.environment}-config-role\"\n"], [375, "\n"], [376, "  assume_role_policy = jsonencode({\n"], [377, "    Version = \"2012-10-17\"\n"], [378, "    Statement = [\n"], [379, "      {\n"], [380, "        Action = \"sts:AssumeRole\"\n"], [381, "        Effect = \"Allow\"\n"], [382, "        Principal = {\n"], [383, "          Service = \"config.amazonaws.com\"\n"], [384, "        }\n"], [385, "      }\n"], [386, "    ]\n"], [387, "  })\n"], [388, "\n"], [389, "  tags = {\n"], [390, "    Name        = \"${var.project}-${var.environment}-config-role\"\n"], [391, "    Environment = var.environment\n"], [392, "    Project     = var.project\n"], [393, "  }\n"], [394, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [373, 394], "resource": "module.ecs_jenkins_github.module.security.aws_iam_role.config_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-config-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[373, "resource \"aws_iam_role\" \"config_role\" {\n"], [374, "  name = \"${var.project}-${var.environment}-config-role\"\n"], [375, "\n"], [376, "  assume_role_policy = jsonencode({\n"], [377, "    Version = \"2012-10-17\"\n"], [378, "    Statement = [\n"], [379, "      {\n"], [380, "        Action = \"sts:AssumeRole\"\n"], [381, "        Effect = \"Allow\"\n"], [382, "        Principal = {\n"], [383, "          Service = \"config.amazonaws.com\"\n"], [384, "        }\n"], [385, "      }\n"], [386, "    ]\n"], [387, "  })\n"], [388, "\n"], [389, "  tags = {\n"], [390, "    Name        = \"${var.project}-${var.environment}-config-role\"\n"], [391, "    Environment = var.environment\n"], [392, "    Project     = var.project\n"], [393, "  }\n"], [394, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [373, 394], "resource": "module.ecs_jenkins_github.module.security.aws_iam_role.config_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-config-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[373, "resource \"aws_iam_role\" \"config_role\" {\n"], [374, "  name = \"${var.project}-${var.environment}-config-role\"\n"], [375, "\n"], [376, "  assume_role_policy = jsonencode({\n"], [377, "    Version = \"2012-10-17\"\n"], [378, "    Statement = [\n"], [379, "      {\n"], [380, "        Action = \"sts:AssumeRole\"\n"], [381, "        Effect = \"Allow\"\n"], [382, "        Principal = {\n"], [383, "          Service = \"config.amazonaws.com\"\n"], [384, "        }\n"], [385, "      }\n"], [386, "    ]\n"], [387, "  })\n"], [388, "\n"], [389, "  tags = {\n"], [390, "    Name        = \"${var.project}-${var.environment}-config-role\"\n"], [391, "    Environment = var.environment\n"], [392, "    Project     = var.project\n"], [393, "  }\n"], [394, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [373, 394], "resource": "module.ecs_jenkins_github.module.security.aws_iam_role.config_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-config-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_62", "bc_check_id": "BC_AWS_IAM_47", "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[397, "resource \"aws_iam_role_policy\" \"config_policy\" {\n"], [398, "  name = \"${var.project}-${var.environment}-config-policy\"\n"], [399, "  role = aws_iam_role.config_role.id\n"], [400, "\n"], [401, "  policy = jsonencode({\n"], [402, "    Version = \"2012-10-17\"\n"], [403, "    Statement = [\n"], [404, "      {\n"], [405, "        Action = [\n"], [406, "          \"s3:PutObject\",\n"], [407, "          \"s3:GetBucketAcl\",\n"], [408, "        ]\n"], [409, "        Effect = \"Allow\"\n"], [410, "        Resource = [\n"], [411, "          \"${aws_s3_bucket.config_bucket.arn}\",\n"], [412, "          \"${aws_s3_bucket.config_bucket.arn}/*\"\n"], [413, "        ]\n"], [414, "      },\n"], [415, "      {\n"], [416, "        Action = [\n"], [417, "          \"sns:Publish\"\n"], [418, "        ]\n"], [419, "        Effect = \"Allow\"\n"], [420, "        Resource = [\n"], [421, "          aws_sns_topic.security_alerts.arn\n"], [422, "        ]\n"], [423, "      },\n"], [424, "      {\n"], [425, "        Action = [\n"], [426, "          \"config:Put*\",\n"], [427, "          \"config:Get*\",\n"], [428, "          \"config:List*\",\n"], [429, "          \"config:Describe*\"\n"], [430, "        ]\n"], [431, "        Effect   = \"Allow\"\n"], [432, "        Resource = \"*\"\n"], [433, "      }\n"], [434, "    ]\n"], [435, "  })\n"], [436, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [397, 436], "resource": "module.ecs_jenkins_github.module.security.aws_iam_role_policy.config_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMAdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_63", "bc_check_id": "BC_AWS_IAM_48", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[397, "resource \"aws_iam_role_policy\" \"config_policy\" {\n"], [398, "  name = \"${var.project}-${var.environment}-config-policy\"\n"], [399, "  role = aws_iam_role.config_role.id\n"], [400, "\n"], [401, "  policy = jsonencode({\n"], [402, "    Version = \"2012-10-17\"\n"], [403, "    Statement = [\n"], [404, "      {\n"], [405, "        Action = [\n"], [406, "          \"s3:PutObject\",\n"], [407, "          \"s3:GetBucketAcl\",\n"], [408, "        ]\n"], [409, "        Effect = \"Allow\"\n"], [410, "        Resource = [\n"], [411, "          \"${aws_s3_bucket.config_bucket.arn}\",\n"], [412, "          \"${aws_s3_bucket.config_bucket.arn}/*\"\n"], [413, "        ]\n"], [414, "      },\n"], [415, "      {\n"], [416, "        Action = [\n"], [417, "          \"sns:Publish\"\n"], [418, "        ]\n"], [419, "        Effect = \"Allow\"\n"], [420, "        Resource = [\n"], [421, "          aws_sns_topic.security_alerts.arn\n"], [422, "        ]\n"], [423, "      },\n"], [424, "      {\n"], [425, "        Action = [\n"], [426, "          \"config:Put*\",\n"], [427, "          \"config:Get*\",\n"], [428, "          \"config:List*\",\n"], [429, "          \"config:Describe*\"\n"], [430, "        ]\n"], [431, "        Effect   = \"Allow\"\n"], [432, "        Resource = \"*\"\n"], [433, "      }\n"], [434, "    ]\n"], [435, "  })\n"], [436, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [397, 436], "resource": "module.ecs_jenkins_github.module.security.aws_iam_role_policy.config_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_238", "bc_check_id": "BC_AWS_GENERAL_146", "check_name": "Ensure that GuardDuty detector is enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["enable"]}, "code_block": [[517, "resource \"aws_guardduty_detector\" \"security_detector\" {\n"], [518, "  enable = true\n"], [519, "\n"], [520, "  finding_publishing_frequency = \"SIX_HOURS\"\n"], [521, "\n"], [522, "  tags = {\n"], [523, "    Name        = \"${var.project}-${var.environment}-guardduty\"\n"], [524, "    Environment = var.environment\n"], [525, "    Project     = var.project\n"], [526, "  }\n"], [527, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [517, 527], "resource": "module.ecs_jenkins_github.module.security.aws_guardduty_detector.security_detector", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.GuarddutyDetectorEnabled", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-guardduty", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-guardduty-detector-is-enabled", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_93", "bc_check_id": "BC_AWS_S3_24", "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[559, "resource \"aws_s3_bucket\" \"waf_logs\" {\n"], [560, "  bucket        = \"${var.project}-${var.environment}-waf-logs-${random_string.bucket_suffix.result}\"\n"], [561, "  force_destroy = var.environment != \"prod\"\n"], [562, "\n"], [563, "  tags = {\n"], [564, "    Name        = \"${var.project}-${var.environment}-waf-logs\"\n"], [565, "    Environment = var.environment\n"], [566, "    Project     = var.project\n"], [567, "  }\n"], [568, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [559, 568], "resource": "module.ecs_jenkins_github.module.security.aws_s3_bucket.waf_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-waf-logs", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-24", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_53", "bc_check_id": "BC_AWS_S3_19", "check_name": "Ensure S3 bucket has block public ACLS enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["block_public_acls"]}, "code_block": [[570, "resource \"aws_s3_bucket_public_access_block\" \"waf_logs_block\" {\n"], [571, "  bucket                  = aws_s3_bucket.waf_logs.id\n"], [572, "  block_public_acls       = true\n"], [573, "  block_public_policy     = true\n"], [574, "  ignore_public_acls      = true\n"], [575, "  restrict_public_buckets = true\n"], [576, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [570, 576], "resource": "module.ecs_jenkins_github.module.security.aws_s3_bucket_public_access_block.waf_logs_block", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-19", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_54", "bc_check_id": "BC_AWS_S3_20", "check_name": "Ensure S3 bucket has block public policy enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["block_public_policy"]}, "code_block": [[570, "resource \"aws_s3_bucket_public_access_block\" \"waf_logs_block\" {\n"], [571, "  bucket                  = aws_s3_bucket.waf_logs.id\n"], [572, "  block_public_acls       = true\n"], [573, "  block_public_policy     = true\n"], [574, "  ignore_public_acls      = true\n"], [575, "  restrict_public_buckets = true\n"], [576, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [570, 576], "resource": "module.ecs_jenkins_github.module.security.aws_s3_bucket_public_access_block.waf_logs_block", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-20", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_55", "bc_check_id": "BC_AWS_S3_21", "check_name": "Ensure S3 bucket has ignore public ACLs enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["ignore_public_acls"]}, "code_block": [[570, "resource \"aws_s3_bucket_public_access_block\" \"waf_logs_block\" {\n"], [571, "  bucket                  = aws_s3_bucket.waf_logs.id\n"], [572, "  block_public_acls       = true\n"], [573, "  block_public_policy     = true\n"], [574, "  ignore_public_acls      = true\n"], [575, "  restrict_public_buckets = true\n"], [576, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [570, 576], "resource": "module.ecs_jenkins_github.module.security.aws_s3_bucket_public_access_block.waf_logs_block", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3IgnorePublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-21", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_56", "bc_check_id": "BC_AWS_S3_22", "check_name": "Ensure S3 bucket has 'restrict_public_buckets' enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["restrict_public_buckets"]}, "code_block": [[570, "resource \"aws_s3_bucket_public_access_block\" \"waf_logs_block\" {\n"], [571, "  bucket                  = aws_s3_bucket.waf_logs.id\n"], [572, "  block_public_acls       = true\n"], [573, "  block_public_policy     = true\n"], [574, "  ignore_public_acls      = true\n"], [575, "  restrict_public_buckets = true\n"], [576, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [570, 576], "resource": "module.ecs_jenkins_github.module.security.aws_s3_bucket_public_access_block.waf_logs_block", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3RestrictPublicBuckets", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-22", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_192", "bc_check_id": "BC_AWS_NETWORKING_61", "check_name": "Ensure WAF prevents message lookup in Log4j2. See CVE-2021-44228 aka log4jshell", "check_result": {"result": "PASSED", "evaluated_keys": ["rule/[5]/statement/[0]/managed_rule_group_statement/[0]/name", "rule/[5]/statement/[0]/managed_rule_group_statement/[0]/excluded_rule", "rule/[5]/override_action/[0]/none"]}, "code_block": [[20, "resource \"aws_wafv2_web_acl\" \"owasp_top10_protection\" {\n"], [21, "  name        = \"${var.project}-${var.environment}-owasp-protection\"\n"], [22, "  description = \"WAF WebACL with OWASP Top 10 protections\"\n"], [23, "  scope       = \"REGIONAL\"\n"], [24, "\n"], [25, "  default_action {\n"], [26, "    allow {}\n"], [27, "  }\n"], [28, "\n"], [29, "  # Rule #1: Block IPs from blocklist\n"], [30, "  rule {\n"], [31, "    name     = \"block-known-bad-ips\"\n"], [32, "    priority = 0\n"], [33, "\n"], [34, "    action {\n"], [35, "      block {}\n"], [36, "    }\n"], [37, "\n"], [38, "    statement {\n"], [39, "      ip_set_reference_statement {\n"], [40, "        arn = aws_wafv2_ip_set.known_bad_ips.arn\n"], [41, "      }\n"], [42, "    }\n"], [43, "\n"], [44, "    visibility_config {\n"], [45, "      cloudwatch_metrics_enabled = true\n"], [46, "      metric_name                = \"BlockKnownBadIPs\"\n"], [47, "      sampled_requests_enabled   = true\n"], [48, "    }\n"], [49, "  }\n"], [50, "\n"], [51, "  # Rule #2: AWS Managed Rules for SQL Injection\n"], [52, "  rule {\n"], [53, "    name     = \"AWS-AWSManagedRulesSQLiRuleSet\"\n"], [54, "    priority = 10\n"], [55, "\n"], [56, "    override_action {\n"], [57, "      none {}\n"], [58, "    }\n"], [59, "\n"], [60, "    statement {\n"], [61, "      managed_rule_group_statement {\n"], [62, "        name        = \"AWSManagedRulesSQLiRuleSet\"\n"], [63, "        vendor_name = \"AWS\"\n"], [64, "      }\n"], [65, "    }\n"], [66, "\n"], [67, "    visibility_config {\n"], [68, "      cloudwatch_metrics_enabled = true\n"], [69, "      metric_name                = \"AWSManagedRulesSQLiRuleSet\"\n"], [70, "      sampled_requests_enabled   = true\n"], [71, "    }\n"], [72, "  }\n"], [73, "\n"], [74, "  # Rule #3: AWS Managed Rules for XSS Protection\n"], [75, "  rule {\n"], [76, "    name     = \"AWS-AWSManagedRulesXSSRuleSet\"\n"], [77, "    priority = 20\n"], [78, "\n"], [79, "    override_action {\n"], [80, "      none {}\n"], [81, "    }\n"], [82, "\n"], [83, "    statement {\n"], [84, "      managed_rule_group_statement {\n"], [85, "        name        = \"AWSManagedRulesXSSRuleSet\"\n"], [86, "        vendor_name = \"AWS\"\n"], [87, "      }\n"], [88, "    }\n"], [89, "\n"], [90, "    visibility_config {\n"], [91, "      cloudwatch_metrics_enabled = true\n"], [92, "      metric_name                = \"AWSManagedRulesXSSRuleSet\"\n"], [93, "      sampled_requests_enabled   = true\n"], [94, "    }\n"], [95, "  }\n"], [96, "\n"], [97, "  # Rule #4: Size Constraint Rule - Prevents abnormally large requests\n"], [98, "  rule {\n"], [99, "    name     = \"SizeConstraint\"\n"], [100, "    priority = 30\n"], [101, "\n"], [102, "    action {\n"], [103, "      block {}\n"], [104, "    }\n"], [105, "\n"], [106, "    statement {\n"], [107, "      size_constraint_statement {\n"], [108, "        field_to_match {\n"], [109, "          body {}\n"], [110, "        }\n"], [111, "        comparison_operator = \"GT\"\n"], [112, "        size                = var.max_request_size\n"], [113, "        text_transformation {\n"], [114, "          priority = 0\n"], [115, "          type     = \"NONE\"\n"], [116, "        }\n"], [117, "      }\n"], [118, "    }\n"], [119, "\n"], [120, "    visibility_config {\n"], [121, "      cloudwatch_metrics_enabled = true\n"], [122, "      metric_name                = \"SizeConstraint\"\n"], [123, "      sampled_requests_enabled   = true\n"], [124, "    }\n"], [125, "  }\n"], [126, "\n"], [127, "  # Rule #5: Rate-Based Rule for DDoS protection\n"], [128, "  rule {\n"], [129, "    name     = \"RateBasedRule\"\n"], [130, "    priority = 40\n"], [131, "\n"], [132, "    action {\n"], [133, "      block {}\n"], [134, "    }\n"], [135, "\n"], [136, "    statement {\n"], [137, "      rate_based_statement {\n"], [138, "        limit              = var.request_limit\n"], [139, "        aggregate_key_type = \"IP\"\n"], [140, "      }\n"], [141, "    }\n"], [142, "\n"], [143, "    visibility_config {\n"], [144, "      cloudwatch_metrics_enabled = true\n"], [145, "      metric_name                = \"RateBasedRule\"\n"], [146, "      sampled_requests_enabled   = true\n"], [147, "    }\n"], [148, "  }\n"], [149, "\n"], [150, "  # Rule #6: AWS Managed Rules for Known Bad Inputs\n"], [151, "  rule {\n"], [152, "    name     = \"AWS-AWSManagedRulesKnownBadInputsRuleSet\"\n"], [153, "    priority = 50\n"], [154, "\n"], [155, "    override_action {\n"], [156, "      none {}\n"], [157, "    }\n"], [158, "\n"], [159, "    statement {\n"], [160, "      managed_rule_group_statement {\n"], [161, "        name        = \"AWSManagedRulesKnownBadInputsRuleSet\"\n"], [162, "        vendor_name = \"AWS\"\n"], [163, "      }\n"], [164, "    }\n"], [165, "\n"], [166, "    visibility_config {\n"], [167, "      cloudwatch_metrics_enabled = true\n"], [168, "      metric_name                = \"AWSManagedRulesKnownBadInputsRuleSet\"\n"], [169, "      sampled_requests_enabled   = true\n"], [170, "    }\n"], [171, "  }\n"], [172, "\n"], [173, "  # Rule #7: AWS Managed Rules for OWASP Core Ruleset\n"], [174, "  rule {\n"], [175, "    name     = \"AWS-AWSManagedRulesCommonRuleSet\"\n"], [176, "    priority = 60\n"], [177, "\n"], [178, "    override_action {\n"], [179, "      none {}\n"], [180, "    }\n"], [181, "\n"], [182, "    statement {\n"], [183, "      managed_rule_group_statement {\n"], [184, "        name        = \"AWSManagedRulesCommonRuleSet\"\n"], [185, "        vendor_name = \"AWS\"\n"], [186, "      }\n"], [187, "    }\n"], [188, "\n"], [189, "    visibility_config {\n"], [190, "      cloudwatch_metrics_enabled = true\n"], [191, "      metric_name                = \"AWSManagedRulesCommonRuleSet\"\n"], [192, "      sampled_requests_enabled   = true\n"], [193, "    }\n"], [194, "  }\n"], [195, "\n"], [196, "  # Rule #8: AWS Managed Rules for PHP applications\n"], [197, "  rule {\n"], [198, "    name     = \"AWS-AWSManagedRulesPHPRuleSet\"\n"], [199, "    priority = 70\n"], [200, "\n"], [201, "    override_action {\n"], [202, "      none {}\n"], [203, "    }\n"], [204, "\n"], [205, "    statement {\n"], [206, "      managed_rule_group_statement {\n"], [207, "        name        = \"AWSManagedRulesPHPRuleSet\"\n"], [208, "        vendor_name = \"AWS\"\n"], [209, "      }\n"], [210, "    }\n"], [211, "\n"], [212, "    visibility_config {\n"], [213, "      cloudwatch_metrics_enabled = true\n"], [214, "      metric_name                = \"AWSManagedRulesPHPRuleSet\"\n"], [215, "      sampled_requests_enabled   = true\n"], [216, "    }\n"], [217, "  }\n"], [218, "\n"], [219, "  # Rule #9: AWS Managed Rules for Linux OS\n"], [220, "  rule {\n"], [221, "    name     = \"AWS-AWSManagedRulesLinuxRuleSet\"\n"], [222, "    priority = 80\n"], [223, "\n"], [224, "    override_action {\n"], [225, "      none {}\n"], [226, "    }\n"], [227, "\n"], [228, "    statement {\n"], [229, "      managed_rule_group_statement {\n"], [230, "        name        = \"AWSManagedRulesLinuxRuleSet\"\n"], [231, "        vendor_name = \"AWS\"\n"], [232, "      }\n"], [233, "    }\n"], [234, "\n"], [235, "    visibility_config {\n"], [236, "      cloudwatch_metrics_enabled = true\n"], [237, "      metric_name                = \"AWSManagedRulesLinuxRuleSet\"\n"], [238, "      sampled_requests_enabled   = true\n"], [239, "    }\n"], [240, "  }\n"], [241, "\n"], [242, "  # Rule #10: AWS Managed Rules for Bot Control\n"], [243, "  rule {\n"], [244, "    name     = \"AWS-AWSManagedRulesBotControlRuleSet\"\n"], [245, "    priority = 90\n"], [246, "\n"], [247, "    override_action {\n"], [248, "      none {}\n"], [249, "    }\n"], [250, "\n"], [251, "    statement {\n"], [252, "      managed_rule_group_statement {\n"], [253, "        name        = \"AWSManagedRulesBotControlRuleSet\"\n"], [254, "        vendor_name = \"AWS\"\n"], [255, "      }\n"], [256, "    }\n"], [257, "\n"], [258, "    visibility_config {\n"], [259, "      cloudwatch_metrics_enabled = true\n"], [260, "      metric_name                = \"AWSManagedRulesBotControlRuleSet\"\n"], [261, "      sampled_requests_enabled   = true\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "  visibility_config {\n"], [266, "    cloudwatch_metrics_enabled = true\n"], [267, "    metric_name                = \"owasp-top10-protection\"\n"], [268, "    sampled_requests_enabled   = true\n"], [269, "  }\n"], [270, "\n"], [271, "  # Prevent terraform from rebuilding this resource unless actual changes are made\n"], [272, "  lifecycle {\n"], [273, "    create_before_destroy = true\n"], [274, "  }\n"], [275, "\n"], [276, "  tags = {\n"], [277, "    Name        = \"${var.project}-${var.environment}-waf\"\n"], [278, "    Environment = var.environment\n"], [279, "    Project     = var.project\n"], [280, "  }\n"], [281, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [20, 281], "resource": "module.ecs_jenkins_github_dr.module.security.aws_wafv2_web_acl.owasp_top10_protection", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.WAFACLCVE202144228", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-waf", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-waf-prevents-message-lookup-in-log4j2", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_175", "bc_check_id": "BC_AWS_NETWORKING_64", "check_name": "Ensure WAF has associated rules", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[20, "resource \"aws_wafv2_web_acl\" \"owasp_top10_protection\" {\n"], [21, "  name        = \"${var.project}-${var.environment}-owasp-protection\"\n"], [22, "  description = \"WAF WebACL with OWASP Top 10 protections\"\n"], [23, "  scope       = \"REGIONAL\"\n"], [24, "\n"], [25, "  default_action {\n"], [26, "    allow {}\n"], [27, "  }\n"], [28, "\n"], [29, "  # Rule #1: Block IPs from blocklist\n"], [30, "  rule {\n"], [31, "    name     = \"block-known-bad-ips\"\n"], [32, "    priority = 0\n"], [33, "\n"], [34, "    action {\n"], [35, "      block {}\n"], [36, "    }\n"], [37, "\n"], [38, "    statement {\n"], [39, "      ip_set_reference_statement {\n"], [40, "        arn = aws_wafv2_ip_set.known_bad_ips.arn\n"], [41, "      }\n"], [42, "    }\n"], [43, "\n"], [44, "    visibility_config {\n"], [45, "      cloudwatch_metrics_enabled = true\n"], [46, "      metric_name                = \"BlockKnownBadIPs\"\n"], [47, "      sampled_requests_enabled   = true\n"], [48, "    }\n"], [49, "  }\n"], [50, "\n"], [51, "  # Rule #2: AWS Managed Rules for SQL Injection\n"], [52, "  rule {\n"], [53, "    name     = \"AWS-AWSManagedRulesSQLiRuleSet\"\n"], [54, "    priority = 10\n"], [55, "\n"], [56, "    override_action {\n"], [57, "      none {}\n"], [58, "    }\n"], [59, "\n"], [60, "    statement {\n"], [61, "      managed_rule_group_statement {\n"], [62, "        name        = \"AWSManagedRulesSQLiRuleSet\"\n"], [63, "        vendor_name = \"AWS\"\n"], [64, "      }\n"], [65, "    }\n"], [66, "\n"], [67, "    visibility_config {\n"], [68, "      cloudwatch_metrics_enabled = true\n"], [69, "      metric_name                = \"AWSManagedRulesSQLiRuleSet\"\n"], [70, "      sampled_requests_enabled   = true\n"], [71, "    }\n"], [72, "  }\n"], [73, "\n"], [74, "  # Rule #3: AWS Managed Rules for XSS Protection\n"], [75, "  rule {\n"], [76, "    name     = \"AWS-AWSManagedRulesXSSRuleSet\"\n"], [77, "    priority = 20\n"], [78, "\n"], [79, "    override_action {\n"], [80, "      none {}\n"], [81, "    }\n"], [82, "\n"], [83, "    statement {\n"], [84, "      managed_rule_group_statement {\n"], [85, "        name        = \"AWSManagedRulesXSSRuleSet\"\n"], [86, "        vendor_name = \"AWS\"\n"], [87, "      }\n"], [88, "    }\n"], [89, "\n"], [90, "    visibility_config {\n"], [91, "      cloudwatch_metrics_enabled = true\n"], [92, "      metric_name                = \"AWSManagedRulesXSSRuleSet\"\n"], [93, "      sampled_requests_enabled   = true\n"], [94, "    }\n"], [95, "  }\n"], [96, "\n"], [97, "  # Rule #4: Size Constraint Rule - Prevents abnormally large requests\n"], [98, "  rule {\n"], [99, "    name     = \"SizeConstraint\"\n"], [100, "    priority = 30\n"], [101, "\n"], [102, "    action {\n"], [103, "      block {}\n"], [104, "    }\n"], [105, "\n"], [106, "    statement {\n"], [107, "      size_constraint_statement {\n"], [108, "        field_to_match {\n"], [109, "          body {}\n"], [110, "        }\n"], [111, "        comparison_operator = \"GT\"\n"], [112, "        size                = var.max_request_size\n"], [113, "        text_transformation {\n"], [114, "          priority = 0\n"], [115, "          type     = \"NONE\"\n"], [116, "        }\n"], [117, "      }\n"], [118, "    }\n"], [119, "\n"], [120, "    visibility_config {\n"], [121, "      cloudwatch_metrics_enabled = true\n"], [122, "      metric_name                = \"SizeConstraint\"\n"], [123, "      sampled_requests_enabled   = true\n"], [124, "    }\n"], [125, "  }\n"], [126, "\n"], [127, "  # Rule #5: Rate-Based Rule for DDoS protection\n"], [128, "  rule {\n"], [129, "    name     = \"RateBasedRule\"\n"], [130, "    priority = 40\n"], [131, "\n"], [132, "    action {\n"], [133, "      block {}\n"], [134, "    }\n"], [135, "\n"], [136, "    statement {\n"], [137, "      rate_based_statement {\n"], [138, "        limit              = var.request_limit\n"], [139, "        aggregate_key_type = \"IP\"\n"], [140, "      }\n"], [141, "    }\n"], [142, "\n"], [143, "    visibility_config {\n"], [144, "      cloudwatch_metrics_enabled = true\n"], [145, "      metric_name                = \"RateBasedRule\"\n"], [146, "      sampled_requests_enabled   = true\n"], [147, "    }\n"], [148, "  }\n"], [149, "\n"], [150, "  # Rule #6: AWS Managed Rules for Known Bad Inputs\n"], [151, "  rule {\n"], [152, "    name     = \"AWS-AWSManagedRulesKnownBadInputsRuleSet\"\n"], [153, "    priority = 50\n"], [154, "\n"], [155, "    override_action {\n"], [156, "      none {}\n"], [157, "    }\n"], [158, "\n"], [159, "    statement {\n"], [160, "      managed_rule_group_statement {\n"], [161, "        name        = \"AWSManagedRulesKnownBadInputsRuleSet\"\n"], [162, "        vendor_name = \"AWS\"\n"], [163, "      }\n"], [164, "    }\n"], [165, "\n"], [166, "    visibility_config {\n"], [167, "      cloudwatch_metrics_enabled = true\n"], [168, "      metric_name                = \"AWSManagedRulesKnownBadInputsRuleSet\"\n"], [169, "      sampled_requests_enabled   = true\n"], [170, "    }\n"], [171, "  }\n"], [172, "\n"], [173, "  # Rule #7: AWS Managed Rules for OWASP Core Ruleset\n"], [174, "  rule {\n"], [175, "    name     = \"AWS-AWSManagedRulesCommonRuleSet\"\n"], [176, "    priority = 60\n"], [177, "\n"], [178, "    override_action {\n"], [179, "      none {}\n"], [180, "    }\n"], [181, "\n"], [182, "    statement {\n"], [183, "      managed_rule_group_statement {\n"], [184, "        name        = \"AWSManagedRulesCommonRuleSet\"\n"], [185, "        vendor_name = \"AWS\"\n"], [186, "      }\n"], [187, "    }\n"], [188, "\n"], [189, "    visibility_config {\n"], [190, "      cloudwatch_metrics_enabled = true\n"], [191, "      metric_name                = \"AWSManagedRulesCommonRuleSet\"\n"], [192, "      sampled_requests_enabled   = true\n"], [193, "    }\n"], [194, "  }\n"], [195, "\n"], [196, "  # Rule #8: AWS Managed Rules for PHP applications\n"], [197, "  rule {\n"], [198, "    name     = \"AWS-AWSManagedRulesPHPRuleSet\"\n"], [199, "    priority = 70\n"], [200, "\n"], [201, "    override_action {\n"], [202, "      none {}\n"], [203, "    }\n"], [204, "\n"], [205, "    statement {\n"], [206, "      managed_rule_group_statement {\n"], [207, "        name        = \"AWSManagedRulesPHPRuleSet\"\n"], [208, "        vendor_name = \"AWS\"\n"], [209, "      }\n"], [210, "    }\n"], [211, "\n"], [212, "    visibility_config {\n"], [213, "      cloudwatch_metrics_enabled = true\n"], [214, "      metric_name                = \"AWSManagedRulesPHPRuleSet\"\n"], [215, "      sampled_requests_enabled   = true\n"], [216, "    }\n"], [217, "  }\n"], [218, "\n"], [219, "  # Rule #9: AWS Managed Rules for Linux OS\n"], [220, "  rule {\n"], [221, "    name     = \"AWS-AWSManagedRulesLinuxRuleSet\"\n"], [222, "    priority = 80\n"], [223, "\n"], [224, "    override_action {\n"], [225, "      none {}\n"], [226, "    }\n"], [227, "\n"], [228, "    statement {\n"], [229, "      managed_rule_group_statement {\n"], [230, "        name        = \"AWSManagedRulesLinuxRuleSet\"\n"], [231, "        vendor_name = \"AWS\"\n"], [232, "      }\n"], [233, "    }\n"], [234, "\n"], [235, "    visibility_config {\n"], [236, "      cloudwatch_metrics_enabled = true\n"], [237, "      metric_name                = \"AWSManagedRulesLinuxRuleSet\"\n"], [238, "      sampled_requests_enabled   = true\n"], [239, "    }\n"], [240, "  }\n"], [241, "\n"], [242, "  # Rule #10: AWS Managed Rules for Bot Control\n"], [243, "  rule {\n"], [244, "    name     = \"AWS-AWSManagedRulesBotControlRuleSet\"\n"], [245, "    priority = 90\n"], [246, "\n"], [247, "    override_action {\n"], [248, "      none {}\n"], [249, "    }\n"], [250, "\n"], [251, "    statement {\n"], [252, "      managed_rule_group_statement {\n"], [253, "        name        = \"AWSManagedRulesBotControlRuleSet\"\n"], [254, "        vendor_name = \"AWS\"\n"], [255, "      }\n"], [256, "    }\n"], [257, "\n"], [258, "    visibility_config {\n"], [259, "      cloudwatch_metrics_enabled = true\n"], [260, "      metric_name                = \"AWSManagedRulesBotControlRuleSet\"\n"], [261, "      sampled_requests_enabled   = true\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "  visibility_config {\n"], [266, "    cloudwatch_metrics_enabled = true\n"], [267, "    metric_name                = \"owasp-top10-protection\"\n"], [268, "    sampled_requests_enabled   = true\n"], [269, "  }\n"], [270, "\n"], [271, "  # Prevent terraform from rebuilding this resource unless actual changes are made\n"], [272, "  lifecycle {\n"], [273, "    create_before_destroy = true\n"], [274, "  }\n"], [275, "\n"], [276, "  tags = {\n"], [277, "    Name        = \"${var.project}-${var.environment}-waf\"\n"], [278, "    Environment = var.environment\n"], [279, "    Project     = var.project\n"], [280, "  }\n"], [281, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [20, 281], "resource": "module.ecs_jenkins_github_dr.module.security.aws_wafv2_web_acl.owasp_top10_protection", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.WAFHasAnyRules", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-waf", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-networking-64", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_342", "bc_check_id": "BC_AWS_GENERAL_245", "check_name": "Ensure WAF rule has any actions", "check_result": {"result": "PASSED", "evaluated_keys": ["rule", "rules", "activated_rule"]}, "code_block": [[20, "resource \"aws_wafv2_web_acl\" \"owasp_top10_protection\" {\n"], [21, "  name        = \"${var.project}-${var.environment}-owasp-protection\"\n"], [22, "  description = \"WAF WebACL with OWASP Top 10 protections\"\n"], [23, "  scope       = \"REGIONAL\"\n"], [24, "\n"], [25, "  default_action {\n"], [26, "    allow {}\n"], [27, "  }\n"], [28, "\n"], [29, "  # Rule #1: Block IPs from blocklist\n"], [30, "  rule {\n"], [31, "    name     = \"block-known-bad-ips\"\n"], [32, "    priority = 0\n"], [33, "\n"], [34, "    action {\n"], [35, "      block {}\n"], [36, "    }\n"], [37, "\n"], [38, "    statement {\n"], [39, "      ip_set_reference_statement {\n"], [40, "        arn = aws_wafv2_ip_set.known_bad_ips.arn\n"], [41, "      }\n"], [42, "    }\n"], [43, "\n"], [44, "    visibility_config {\n"], [45, "      cloudwatch_metrics_enabled = true\n"], [46, "      metric_name                = \"BlockKnownBadIPs\"\n"], [47, "      sampled_requests_enabled   = true\n"], [48, "    }\n"], [49, "  }\n"], [50, "\n"], [51, "  # Rule #2: AWS Managed Rules for SQL Injection\n"], [52, "  rule {\n"], [53, "    name     = \"AWS-AWSManagedRulesSQLiRuleSet\"\n"], [54, "    priority = 10\n"], [55, "\n"], [56, "    override_action {\n"], [57, "      none {}\n"], [58, "    }\n"], [59, "\n"], [60, "    statement {\n"], [61, "      managed_rule_group_statement {\n"], [62, "        name        = \"AWSManagedRulesSQLiRuleSet\"\n"], [63, "        vendor_name = \"AWS\"\n"], [64, "      }\n"], [65, "    }\n"], [66, "\n"], [67, "    visibility_config {\n"], [68, "      cloudwatch_metrics_enabled = true\n"], [69, "      metric_name                = \"AWSManagedRulesSQLiRuleSet\"\n"], [70, "      sampled_requests_enabled   = true\n"], [71, "    }\n"], [72, "  }\n"], [73, "\n"], [74, "  # Rule #3: AWS Managed Rules for XSS Protection\n"], [75, "  rule {\n"], [76, "    name     = \"AWS-AWSManagedRulesXSSRuleSet\"\n"], [77, "    priority = 20\n"], [78, "\n"], [79, "    override_action {\n"], [80, "      none {}\n"], [81, "    }\n"], [82, "\n"], [83, "    statement {\n"], [84, "      managed_rule_group_statement {\n"], [85, "        name        = \"AWSManagedRulesXSSRuleSet\"\n"], [86, "        vendor_name = \"AWS\"\n"], [87, "      }\n"], [88, "    }\n"], [89, "\n"], [90, "    visibility_config {\n"], [91, "      cloudwatch_metrics_enabled = true\n"], [92, "      metric_name                = \"AWSManagedRulesXSSRuleSet\"\n"], [93, "      sampled_requests_enabled   = true\n"], [94, "    }\n"], [95, "  }\n"], [96, "\n"], [97, "  # Rule #4: Size Constraint Rule - Prevents abnormally large requests\n"], [98, "  rule {\n"], [99, "    name     = \"SizeConstraint\"\n"], [100, "    priority = 30\n"], [101, "\n"], [102, "    action {\n"], [103, "      block {}\n"], [104, "    }\n"], [105, "\n"], [106, "    statement {\n"], [107, "      size_constraint_statement {\n"], [108, "        field_to_match {\n"], [109, "          body {}\n"], [110, "        }\n"], [111, "        comparison_operator = \"GT\"\n"], [112, "        size                = var.max_request_size\n"], [113, "        text_transformation {\n"], [114, "          priority = 0\n"], [115, "          type     = \"NONE\"\n"], [116, "        }\n"], [117, "      }\n"], [118, "    }\n"], [119, "\n"], [120, "    visibility_config {\n"], [121, "      cloudwatch_metrics_enabled = true\n"], [122, "      metric_name                = \"SizeConstraint\"\n"], [123, "      sampled_requests_enabled   = true\n"], [124, "    }\n"], [125, "  }\n"], [126, "\n"], [127, "  # Rule #5: Rate-Based Rule for DDoS protection\n"], [128, "  rule {\n"], [129, "    name     = \"RateBasedRule\"\n"], [130, "    priority = 40\n"], [131, "\n"], [132, "    action {\n"], [133, "      block {}\n"], [134, "    }\n"], [135, "\n"], [136, "    statement {\n"], [137, "      rate_based_statement {\n"], [138, "        limit              = var.request_limit\n"], [139, "        aggregate_key_type = \"IP\"\n"], [140, "      }\n"], [141, "    }\n"], [142, "\n"], [143, "    visibility_config {\n"], [144, "      cloudwatch_metrics_enabled = true\n"], [145, "      metric_name                = \"RateBasedRule\"\n"], [146, "      sampled_requests_enabled   = true\n"], [147, "    }\n"], [148, "  }\n"], [149, "\n"], [150, "  # Rule #6: AWS Managed Rules for Known Bad Inputs\n"], [151, "  rule {\n"], [152, "    name     = \"AWS-AWSManagedRulesKnownBadInputsRuleSet\"\n"], [153, "    priority = 50\n"], [154, "\n"], [155, "    override_action {\n"], [156, "      none {}\n"], [157, "    }\n"], [158, "\n"], [159, "    statement {\n"], [160, "      managed_rule_group_statement {\n"], [161, "        name        = \"AWSManagedRulesKnownBadInputsRuleSet\"\n"], [162, "        vendor_name = \"AWS\"\n"], [163, "      }\n"], [164, "    }\n"], [165, "\n"], [166, "    visibility_config {\n"], [167, "      cloudwatch_metrics_enabled = true\n"], [168, "      metric_name                = \"AWSManagedRulesKnownBadInputsRuleSet\"\n"], [169, "      sampled_requests_enabled   = true\n"], [170, "    }\n"], [171, "  }\n"], [172, "\n"], [173, "  # Rule #7: AWS Managed Rules for OWASP Core Ruleset\n"], [174, "  rule {\n"], [175, "    name     = \"AWS-AWSManagedRulesCommonRuleSet\"\n"], [176, "    priority = 60\n"], [177, "\n"], [178, "    override_action {\n"], [179, "      none {}\n"], [180, "    }\n"], [181, "\n"], [182, "    statement {\n"], [183, "      managed_rule_group_statement {\n"], [184, "        name        = \"AWSManagedRulesCommonRuleSet\"\n"], [185, "        vendor_name = \"AWS\"\n"], [186, "      }\n"], [187, "    }\n"], [188, "\n"], [189, "    visibility_config {\n"], [190, "      cloudwatch_metrics_enabled = true\n"], [191, "      metric_name                = \"AWSManagedRulesCommonRuleSet\"\n"], [192, "      sampled_requests_enabled   = true\n"], [193, "    }\n"], [194, "  }\n"], [195, "\n"], [196, "  # Rule #8: AWS Managed Rules for PHP applications\n"], [197, "  rule {\n"], [198, "    name     = \"AWS-AWSManagedRulesPHPRuleSet\"\n"], [199, "    priority = 70\n"], [200, "\n"], [201, "    override_action {\n"], [202, "      none {}\n"], [203, "    }\n"], [204, "\n"], [205, "    statement {\n"], [206, "      managed_rule_group_statement {\n"], [207, "        name        = \"AWSManagedRulesPHPRuleSet\"\n"], [208, "        vendor_name = \"AWS\"\n"], [209, "      }\n"], [210, "    }\n"], [211, "\n"], [212, "    visibility_config {\n"], [213, "      cloudwatch_metrics_enabled = true\n"], [214, "      metric_name                = \"AWSManagedRulesPHPRuleSet\"\n"], [215, "      sampled_requests_enabled   = true\n"], [216, "    }\n"], [217, "  }\n"], [218, "\n"], [219, "  # Rule #9: AWS Managed Rules for Linux OS\n"], [220, "  rule {\n"], [221, "    name     = \"AWS-AWSManagedRulesLinuxRuleSet\"\n"], [222, "    priority = 80\n"], [223, "\n"], [224, "    override_action {\n"], [225, "      none {}\n"], [226, "    }\n"], [227, "\n"], [228, "    statement {\n"], [229, "      managed_rule_group_statement {\n"], [230, "        name        = \"AWSManagedRulesLinuxRuleSet\"\n"], [231, "        vendor_name = \"AWS\"\n"], [232, "      }\n"], [233, "    }\n"], [234, "\n"], [235, "    visibility_config {\n"], [236, "      cloudwatch_metrics_enabled = true\n"], [237, "      metric_name                = \"AWSManagedRulesLinuxRuleSet\"\n"], [238, "      sampled_requests_enabled   = true\n"], [239, "    }\n"], [240, "  }\n"], [241, "\n"], [242, "  # Rule #10: AWS Managed Rules for Bot Control\n"], [243, "  rule {\n"], [244, "    name     = \"AWS-AWSManagedRulesBotControlRuleSet\"\n"], [245, "    priority = 90\n"], [246, "\n"], [247, "    override_action {\n"], [248, "      none {}\n"], [249, "    }\n"], [250, "\n"], [251, "    statement {\n"], [252, "      managed_rule_group_statement {\n"], [253, "        name        = \"AWSManagedRulesBotControlRuleSet\"\n"], [254, "        vendor_name = \"AWS\"\n"], [255, "      }\n"], [256, "    }\n"], [257, "\n"], [258, "    visibility_config {\n"], [259, "      cloudwatch_metrics_enabled = true\n"], [260, "      metric_name                = \"AWSManagedRulesBotControlRuleSet\"\n"], [261, "      sampled_requests_enabled   = true\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "  visibility_config {\n"], [266, "    cloudwatch_metrics_enabled = true\n"], [267, "    metric_name                = \"owasp-top10-protection\"\n"], [268, "    sampled_requests_enabled   = true\n"], [269, "  }\n"], [270, "\n"], [271, "  # Prevent terraform from rebuilding this resource unless actual changes are made\n"], [272, "  lifecycle {\n"], [273, "    create_before_destroy = true\n"], [274, "  }\n"], [275, "\n"], [276, "  tags = {\n"], [277, "    Name        = \"${var.project}-${var.environment}-waf\"\n"], [278, "    Environment = var.environment\n"], [279, "    Project     = var.project\n"], [280, "  }\n"], [281, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [20, 281], "resource": "module.ecs_jenkins_github_dr.module.security.aws_wafv2_web_acl.owasp_top10_protection", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.WAFRuleHasAnyActions", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-waf", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-342", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_93", "bc_check_id": "BC_AWS_S3_24", "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[330, "resource \"aws_s3_bucket\" \"config_bucket\" {\n"], [331, "  bucket        = \"${var.project}-${var.environment}-config-${random_string.bucket_suffix.result}\"\n"], [332, "  force_destroy = var.environment != \"prod\"\n"], [333, "\n"], [334, "  tags = {\n"], [335, "    Name        = \"${var.project}-${var.environment}-config-bucket\"\n"], [336, "    Environment = var.environment\n"], [337, "    Project     = var.project\n"], [338, "  }\n"], [339, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [330, 339], "resource": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.config_bucket", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-config-bucket", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-24", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_53", "bc_check_id": "BC_AWS_S3_19", "check_name": "Ensure S3 bucket has block public ACLS enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["block_public_acls"]}, "code_block": [[342, "resource \"aws_s3_bucket_public_access_block\" \"config_bucket_block\" {\n"], [343, "  bucket                  = aws_s3_bucket.config_bucket.id\n"], [344, "  block_public_acls       = true\n"], [345, "  block_public_policy     = true\n"], [346, "  ignore_public_acls      = true\n"], [347, "  restrict_public_buckets = true\n"], [348, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [342, 348], "resource": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket_public_access_block.config_bucket_block", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-19", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_54", "bc_check_id": "BC_AWS_S3_20", "check_name": "Ensure S3 bucket has block public policy enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["block_public_policy"]}, "code_block": [[342, "resource \"aws_s3_bucket_public_access_block\" \"config_bucket_block\" {\n"], [343, "  bucket                  = aws_s3_bucket.config_bucket.id\n"], [344, "  block_public_acls       = true\n"], [345, "  block_public_policy     = true\n"], [346, "  ignore_public_acls      = true\n"], [347, "  restrict_public_buckets = true\n"], [348, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [342, 348], "resource": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket_public_access_block.config_bucket_block", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-20", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_55", "bc_check_id": "BC_AWS_S3_21", "check_name": "Ensure S3 bucket has ignore public ACLs enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["ignore_public_acls"]}, "code_block": [[342, "resource \"aws_s3_bucket_public_access_block\" \"config_bucket_block\" {\n"], [343, "  bucket                  = aws_s3_bucket.config_bucket.id\n"], [344, "  block_public_acls       = true\n"], [345, "  block_public_policy     = true\n"], [346, "  ignore_public_acls      = true\n"], [347, "  restrict_public_buckets = true\n"], [348, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [342, 348], "resource": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket_public_access_block.config_bucket_block", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3IgnorePublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-21", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_56", "bc_check_id": "BC_AWS_S3_22", "check_name": "Ensure S3 bucket has 'restrict_public_buckets' enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["restrict_public_buckets"]}, "code_block": [[342, "resource \"aws_s3_bucket_public_access_block\" \"config_bucket_block\" {\n"], [343, "  bucket                  = aws_s3_bucket.config_bucket.id\n"], [344, "  block_public_acls       = true\n"], [345, "  block_public_policy     = true\n"], [346, "  ignore_public_acls      = true\n"], [347, "  restrict_public_buckets = true\n"], [348, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [342, 348], "resource": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket_public_access_block.config_bucket_block", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3RestrictPublicBuckets", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-22", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[373, "resource \"aws_iam_role\" \"config_role\" {\n"], [374, "  name = \"${var.project}-${var.environment}-config-role\"\n"], [375, "\n"], [376, "  assume_role_policy = jsonencode({\n"], [377, "    Version = \"2012-10-17\"\n"], [378, "    Statement = [\n"], [379, "      {\n"], [380, "        Action = \"sts:AssumeRole\"\n"], [381, "        Effect = \"Allow\"\n"], [382, "        Principal = {\n"], [383, "          Service = \"config.amazonaws.com\"\n"], [384, "        }\n"], [385, "      }\n"], [386, "    ]\n"], [387, "  })\n"], [388, "\n"], [389, "  tags = {\n"], [390, "    Name        = \"${var.project}-${var.environment}-config-role\"\n"], [391, "    Environment = var.environment\n"], [392, "    Project     = var.project\n"], [393, "  }\n"], [394, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [373, 394], "resource": "module.ecs_jenkins_github_dr.module.security.aws_iam_role.config_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-config-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[373, "resource \"aws_iam_role\" \"config_role\" {\n"], [374, "  name = \"${var.project}-${var.environment}-config-role\"\n"], [375, "\n"], [376, "  assume_role_policy = jsonencode({\n"], [377, "    Version = \"2012-10-17\"\n"], [378, "    Statement = [\n"], [379, "      {\n"], [380, "        Action = \"sts:AssumeRole\"\n"], [381, "        Effect = \"Allow\"\n"], [382, "        Principal = {\n"], [383, "          Service = \"config.amazonaws.com\"\n"], [384, "        }\n"], [385, "      }\n"], [386, "    ]\n"], [387, "  })\n"], [388, "\n"], [389, "  tags = {\n"], [390, "    Name        = \"${var.project}-${var.environment}-config-role\"\n"], [391, "    Environment = var.environment\n"], [392, "    Project     = var.project\n"], [393, "  }\n"], [394, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [373, 394], "resource": "module.ecs_jenkins_github_dr.module.security.aws_iam_role.config_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-config-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[373, "resource \"aws_iam_role\" \"config_role\" {\n"], [374, "  name = \"${var.project}-${var.environment}-config-role\"\n"], [375, "\n"], [376, "  assume_role_policy = jsonencode({\n"], [377, "    Version = \"2012-10-17\"\n"], [378, "    Statement = [\n"], [379, "      {\n"], [380, "        Action = \"sts:AssumeRole\"\n"], [381, "        Effect = \"Allow\"\n"], [382, "        Principal = {\n"], [383, "          Service = \"config.amazonaws.com\"\n"], [384, "        }\n"], [385, "      }\n"], [386, "    ]\n"], [387, "  })\n"], [388, "\n"], [389, "  tags = {\n"], [390, "    Name        = \"${var.project}-${var.environment}-config-role\"\n"], [391, "    Environment = var.environment\n"], [392, "    Project     = var.project\n"], [393, "  }\n"], [394, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [373, 394], "resource": "module.ecs_jenkins_github_dr.module.security.aws_iam_role.config_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-config-role", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_62", "bc_check_id": "BC_AWS_IAM_47", "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[397, "resource \"aws_iam_role_policy\" \"config_policy\" {\n"], [398, "  name = \"${var.project}-${var.environment}-config-policy\"\n"], [399, "  role = aws_iam_role.config_role.id\n"], [400, "\n"], [401, "  policy = jsonencode({\n"], [402, "    Version = \"2012-10-17\"\n"], [403, "    Statement = [\n"], [404, "      {\n"], [405, "        Action = [\n"], [406, "          \"s3:PutObject\",\n"], [407, "          \"s3:GetBucketAcl\",\n"], [408, "        ]\n"], [409, "        Effect = \"Allow\"\n"], [410, "        Resource = [\n"], [411, "          \"${aws_s3_bucket.config_bucket.arn}\",\n"], [412, "          \"${aws_s3_bucket.config_bucket.arn}/*\"\n"], [413, "        ]\n"], [414, "      },\n"], [415, "      {\n"], [416, "        Action = [\n"], [417, "          \"sns:Publish\"\n"], [418, "        ]\n"], [419, "        Effect = \"Allow\"\n"], [420, "        Resource = [\n"], [421, "          aws_sns_topic.security_alerts.arn\n"], [422, "        ]\n"], [423, "      },\n"], [424, "      {\n"], [425, "        Action = [\n"], [426, "          \"config:Put*\",\n"], [427, "          \"config:Get*\",\n"], [428, "          \"config:List*\",\n"], [429, "          \"config:Describe*\"\n"], [430, "        ]\n"], [431, "        Effect   = \"Allow\"\n"], [432, "        Resource = \"*\"\n"], [433, "      }\n"], [434, "    ]\n"], [435, "  })\n"], [436, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [397, 436], "resource": "module.ecs_jenkins_github_dr.module.security.aws_iam_role_policy.config_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMAdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_63", "bc_check_id": "BC_AWS_IAM_48", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[397, "resource \"aws_iam_role_policy\" \"config_policy\" {\n"], [398, "  name = \"${var.project}-${var.environment}-config-policy\"\n"], [399, "  role = aws_iam_role.config_role.id\n"], [400, "\n"], [401, "  policy = jsonencode({\n"], [402, "    Version = \"2012-10-17\"\n"], [403, "    Statement = [\n"], [404, "      {\n"], [405, "        Action = [\n"], [406, "          \"s3:PutObject\",\n"], [407, "          \"s3:GetBucketAcl\",\n"], [408, "        ]\n"], [409, "        Effect = \"Allow\"\n"], [410, "        Resource = [\n"], [411, "          \"${aws_s3_bucket.config_bucket.arn}\",\n"], [412, "          \"${aws_s3_bucket.config_bucket.arn}/*\"\n"], [413, "        ]\n"], [414, "      },\n"], [415, "      {\n"], [416, "        Action = [\n"], [417, "          \"sns:Publish\"\n"], [418, "        ]\n"], [419, "        Effect = \"Allow\"\n"], [420, "        Resource = [\n"], [421, "          aws_sns_topic.security_alerts.arn\n"], [422, "        ]\n"], [423, "      },\n"], [424, "      {\n"], [425, "        Action = [\n"], [426, "          \"config:Put*\",\n"], [427, "          \"config:Get*\",\n"], [428, "          \"config:List*\",\n"], [429, "          \"config:Describe*\"\n"], [430, "        ]\n"], [431, "        Effect   = \"Allow\"\n"], [432, "        Resource = \"*\"\n"], [433, "      }\n"], [434, "    ]\n"], [435, "  })\n"], [436, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [397, 436], "resource": "module.ecs_jenkins_github_dr.module.security.aws_iam_role_policy.config_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_238", "bc_check_id": "BC_AWS_GENERAL_146", "check_name": "Ensure that GuardDuty detector is enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["enable"]}, "code_block": [[517, "resource \"aws_guardduty_detector\" \"security_detector\" {\n"], [518, "  enable = true\n"], [519, "\n"], [520, "  finding_publishing_frequency = \"SIX_HOURS\"\n"], [521, "\n"], [522, "  tags = {\n"], [523, "    Name        = \"${var.project}-${var.environment}-guardduty\"\n"], [524, "    Environment = var.environment\n"], [525, "    Project     = var.project\n"], [526, "  }\n"], [527, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [517, 527], "resource": "module.ecs_jenkins_github_dr.module.security.aws_guardduty_detector.security_detector", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.GuarddutyDetectorEnabled", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-guardduty", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-guardduty-detector-is-enabled", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_93", "bc_check_id": "BC_AWS_S3_24", "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[559, "resource \"aws_s3_bucket\" \"waf_logs\" {\n"], [560, "  bucket        = \"${var.project}-${var.environment}-waf-logs-${random_string.bucket_suffix.result}\"\n"], [561, "  force_destroy = var.environment != \"prod\"\n"], [562, "\n"], [563, "  tags = {\n"], [564, "    Name        = \"${var.project}-${var.environment}-waf-logs\"\n"], [565, "    Environment = var.environment\n"], [566, "    Project     = var.project\n"], [567, "  }\n"], [568, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [559, 568], "resource": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.waf_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-waf-logs", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-24", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_53", "bc_check_id": "BC_AWS_S3_19", "check_name": "Ensure S3 bucket has block public ACLS enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["block_public_acls"]}, "code_block": [[570, "resource \"aws_s3_bucket_public_access_block\" \"waf_logs_block\" {\n"], [571, "  bucket                  = aws_s3_bucket.waf_logs.id\n"], [572, "  block_public_acls       = true\n"], [573, "  block_public_policy     = true\n"], [574, "  ignore_public_acls      = true\n"], [575, "  restrict_public_buckets = true\n"], [576, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [570, 576], "resource": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket_public_access_block.waf_logs_block", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-19", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_54", "bc_check_id": "BC_AWS_S3_20", "check_name": "Ensure S3 bucket has block public policy enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["block_public_policy"]}, "code_block": [[570, "resource \"aws_s3_bucket_public_access_block\" \"waf_logs_block\" {\n"], [571, "  bucket                  = aws_s3_bucket.waf_logs.id\n"], [572, "  block_public_acls       = true\n"], [573, "  block_public_policy     = true\n"], [574, "  ignore_public_acls      = true\n"], [575, "  restrict_public_buckets = true\n"], [576, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [570, 576], "resource": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket_public_access_block.waf_logs_block", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-20", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_55", "bc_check_id": "BC_AWS_S3_21", "check_name": "Ensure S3 bucket has ignore public ACLs enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["ignore_public_acls"]}, "code_block": [[570, "resource \"aws_s3_bucket_public_access_block\" \"waf_logs_block\" {\n"], [571, "  bucket                  = aws_s3_bucket.waf_logs.id\n"], [572, "  block_public_acls       = true\n"], [573, "  block_public_policy     = true\n"], [574, "  ignore_public_acls      = true\n"], [575, "  restrict_public_buckets = true\n"], [576, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [570, 576], "resource": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket_public_access_block.waf_logs_block", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3IgnorePublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-21", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_56", "bc_check_id": "BC_AWS_S3_22", "check_name": "Ensure S3 bucket has 'restrict_public_buckets' enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["restrict_public_buckets"]}, "code_block": [[570, "resource \"aws_s3_bucket_public_access_block\" \"waf_logs_block\" {\n"], [571, "  bucket                  = aws_s3_bucket.waf_logs.id\n"], [572, "  block_public_acls       = true\n"], [573, "  block_public_policy     = true\n"], [574, "  ignore_public_acls      = true\n"], [575, "  restrict_public_buckets = true\n"], [576, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [570, 576], "resource": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket_public_access_block.waf_logs_block", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3RestrictPublicBuckets", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-22", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV2_AWS_71", "bc_check_id": "BC_AWS_NETWORKING_95", "check_name": "Ensure AWS ACM Certificate domain name does not include wildcards", "check_result": {"result": "PASSED", "entity": {"aws_acm_certificate": {"cert[0]": {"__end_line__": 253, "__start_line__": 230, "certificate_body": ["tls_self_signed_cert.example[0].cert_pem"], "certificate_chain": ["tls_self_signed_cert.example[0].cert_pem"], "early_renewal_duration": ["24h"], "key_algorithm": ["RSA_4096"], "lifecycle": [{"create_before_destroy": [true], "ignore_changes": [["tags"]]}], "private_key": ["tls_private_key.example[0].private_key_pem"], "tags": [{"AutoRenew": false, "Environment": "prod", "ManagedBy": "Terraform", "Name": "ecs-jenkins-prod-cert", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.ecs.aws_acm_certificate.cert[0]"}}}, "evaluated_keys": ["subject_alternative_names/*", "subject_alternative_names", "domain_name"]}, "code_block": [[230, "resource \"aws_acm_certificate\" \"cert\" {\n"], [231, "  count                  = var.create_dummy_cert ? 1 : 0\n"], [232, "  private_key            = tls_private_key.example[0].private_key_pem\n"], [233, "  certificate_body       = tls_self_signed_cert.example[0].cert_pem\n"], [234, "  certificate_chain      = tls_self_signed_cert.example[0].cert_pem\n"], [235, "  early_renewal_duration = \"24h\"      # 24 hours before expiration\n"], [236, "  key_algorithm          = \"RSA_4096\" # Matches our 4096-bit RSA key\n"], [237, "  tags = {\n"], [238, "    Name        = \"${var.project}-${var.environment}-cert\"\n"], [239, "    Environment = var.environment\n"], [240, "    Project     = var.project\n"], [241, "    ManagedBy   = \"Terraform\"\n"], [242, "    AutoRenew   = \"false\" # Self-signed certs shouldn't be auto-renewed\n"], [243, "  }\n"], [244, "\n"], [245, "  lifecycle {\n"], [246, "    create_before_destroy = true\n"], [247, "    ignore_changes = [\n"], [248, "      # Ignore changes to tags, e.g. because a management agent\n"], [249, "      # updates these based on some ruleset managed elsewhere.\n"], [250, "      tags,\n"], [251, "    ]\n"], [252, "  }\n"], [253, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [230, 253], "resource": "module.ecs_jenkins_github.module.ecs.aws_acm_certificate.cert[0]", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"AutoRenew": false, "Environment": "prod", "ManagedBy": "Terraform", "Name": "ecs-jenkins-prod-cert", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-71", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV2_AWS_71", "bc_check_id": "BC_AWS_NETWORKING_95", "check_name": "Ensure AWS ACM Certificate domain name does not include wildcards", "check_result": {"result": "PASSED", "entity": {"aws_acm_certificate": {"cert[0]": {"__end_line__": 253, "__start_line__": 230, "certificate_body": ["tls_self_signed_cert.example[0].cert_pem"], "certificate_chain": ["tls_self_signed_cert.example[0].cert_pem"], "early_renewal_duration": ["24h"], "key_algorithm": ["RSA_4096"], "lifecycle": [{"create_before_destroy": [true], "ignore_changes": [["tags"]]}], "private_key": ["tls_private_key.example[0].private_key_pem"], "tags": [{"AutoRenew": false, "Environment": "dr", "ManagedBy": "Terraform", "Name": "ecs-jenkins-dr-cert", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.ecs.aws_acm_certificate.cert[0]"}}}, "evaluated_keys": ["subject_alternative_names/*", "subject_alternative_names", "domain_name"]}, "code_block": [[230, "resource \"aws_acm_certificate\" \"cert\" {\n"], [231, "  count                  = var.create_dummy_cert ? 1 : 0\n"], [232, "  private_key            = tls_private_key.example[0].private_key_pem\n"], [233, "  certificate_body       = tls_self_signed_cert.example[0].cert_pem\n"], [234, "  certificate_chain      = tls_self_signed_cert.example[0].cert_pem\n"], [235, "  early_renewal_duration = \"24h\"      # 24 hours before expiration\n"], [236, "  key_algorithm          = \"RSA_4096\" # Matches our 4096-bit RSA key\n"], [237, "  tags = {\n"], [238, "    Name        = \"${var.project}-${var.environment}-cert\"\n"], [239, "    Environment = var.environment\n"], [240, "    Project     = var.project\n"], [241, "    ManagedBy   = \"Terraform\"\n"], [242, "    AutoRenew   = \"false\" # Self-signed certs shouldn't be auto-renewed\n"], [243, "  }\n"], [244, "\n"], [245, "  lifecycle {\n"], [246, "    create_before_destroy = true\n"], [247, "    ignore_changes = [\n"], [248, "      # Ignore changes to tags, e.g. because a management agent\n"], [249, "      # updates these based on some ruleset managed elsewhere.\n"], [250, "      tags,\n"], [251, "    ]\n"], [252, "  }\n"], [253, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [230, 253], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_acm_certificate.cert[0]", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"AutoRenew": false, "Environment": "dr", "ManagedBy": "Terraform", "Name": "ecs-jenkins-dr-cert", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-71", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV2_AWS_28", "bc_check_id": "BC_AWS_NETWORKING_58", "check_name": "Ensure public facing ALB are protected by WAF", "check_result": {"result": "PASSED", "entity": {"aws_lb": {"jenkins_nlb": {"__end_line__": 186, "__start_line__": 175, "internal": [false], "load_balancer_type": ["network"], "name": ["ecs-jenkins-prod-jenkins-nlb"], "subnets": [["${${aws_subnet.public_subnet.*.id}[\"0\"]}"]], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-nlb", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.cicd.aws_lb.jenkins_nlb"}}}, "evaluated_keys": ["resource_type", "load_balancer_type", "internal"]}, "code_block": [[175, "resource \"aws_lb\" \"jenkins_nlb\" {\n"], [176, "  name               = \"${var.project}-${var.environment}-jenkins-nlb\"\n"], [177, "  internal           = false\n"], [178, "  load_balancer_type = \"network\"\n"], [179, "  subnets            = [var.subnet_id]\n"], [180, "\n"], [181, "  tags = {\n"], [182, "    Name        = \"${var.project}-${var.environment}-jenkins-nlb\"\n"], [183, "    Environment = var.environment\n"], [184, "    Project     = var.project\n"], [185, "  }\n"], [186, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [175, 186], "resource": "module.ecs_jenkins_github.module.cicd.aws_lb.jenkins_nlb", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-nlb", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-public-facing-alb-are-protected-by-waf", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV2_AWS_28", "bc_check_id": "BC_AWS_NETWORKING_58", "check_name": "Ensure public facing ALB are protected by WAF", "check_result": {"result": "PASSED", "entity": {"aws_lb": {"jenkins_nlb": {"__end_line__": 186, "__start_line__": 175, "internal": [false], "load_balancer_type": ["network"], "name": ["ecs-jenkins-dr-jenkins-nlb"], "subnets": [["${${aws_subnet.public_subnet.*.id}[\"0\"]}"]], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-nlb", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.cicd.aws_lb.jenkins_nlb"}}}, "evaluated_keys": ["resource_type", "load_balancer_type", "internal"]}, "code_block": [[175, "resource \"aws_lb\" \"jenkins_nlb\" {\n"], [176, "  name               = \"${var.project}-${var.environment}-jenkins-nlb\"\n"], [177, "  internal           = false\n"], [178, "  load_balancer_type = \"network\"\n"], [179, "  subnets            = [var.subnet_id]\n"], [180, "\n"], [181, "  tags = {\n"], [182, "    Name        = \"${var.project}-${var.environment}-jenkins-nlb\"\n"], [183, "    Environment = var.environment\n"], [184, "    Project     = var.project\n"], [185, "  }\n"], [186, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [175, 186], "resource": "module.ecs_jenkins_github_dr.module.cicd.aws_lb.jenkins_nlb", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-nlb", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-public-facing-alb-are-protected-by-waf", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV2_AWS_76", "bc_check_id": null, "check_name": "Ensure AWS ALB attached WAFv2 WebACL is configured with AMR for Log4j Vulnerability", "check_result": {"result": "PASSED", "entity": {"aws_lb": {"jenkins_nlb": {"__end_line__": 186, "__start_line__": 175, "internal": [false], "load_balancer_type": ["network"], "name": ["ecs-jenkins-prod-jenkins-nlb"], "subnets": [["${${aws_subnet.public_subnet.*.id}[\"0\"]}"]], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-nlb", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.cicd.aws_lb.jenkins_nlb"}}}, "evaluated_keys": ["rule/*/statement/managed_rule_group_statement/name", "resource_type", "internal"]}, "code_block": [[175, "resource \"aws_lb\" \"jenkins_nlb\" {\n"], [176, "  name               = \"${var.project}-${var.environment}-jenkins-nlb\"\n"], [177, "  internal           = false\n"], [178, "  load_balancer_type = \"network\"\n"], [179, "  subnets            = [var.subnet_id]\n"], [180, "\n"], [181, "  tags = {\n"], [182, "    Name        = \"${var.project}-${var.environment}-jenkins-nlb\"\n"], [183, "    Environment = var.environment\n"], [184, "    Project     = var.project\n"], [185, "  }\n"], [186, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [175, 186], "resource": "module.ecs_jenkins_github.module.cicd.aws_lb.jenkins_nlb", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-nlb", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV2_AWS_76", "bc_check_id": null, "check_name": "Ensure AWS ALB attached WAFv2 WebACL is configured with AMR for Log4j Vulnerability", "check_result": {"result": "PASSED", "entity": {"aws_lb": {"jenkins_nlb": {"__end_line__": 186, "__start_line__": 175, "internal": [false], "load_balancer_type": ["network"], "name": ["ecs-jenkins-dr-jenkins-nlb"], "subnets": [["${${aws_subnet.public_subnet.*.id}[\"0\"]}"]], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-nlb", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.cicd.aws_lb.jenkins_nlb"}}}, "evaluated_keys": ["rule/*/statement/managed_rule_group_statement/name", "resource_type", "internal"]}, "code_block": [[175, "resource \"aws_lb\" \"jenkins_nlb\" {\n"], [176, "  name               = \"${var.project}-${var.environment}-jenkins-nlb\"\n"], [177, "  internal           = false\n"], [178, "  load_balancer_type = \"network\"\n"], [179, "  subnets            = [var.subnet_id]\n"], [180, "\n"], [181, "  tags = {\n"], [182, "    Name        = \"${var.project}-${var.environment}-jenkins-nlb\"\n"], [183, "    Environment = var.environment\n"], [184, "    Project     = var.project\n"], [185, "  }\n"], [186, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [175, 186], "resource": "module.ecs_jenkins_github_dr.module.cicd.aws_lb.jenkins_nlb", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-nlb", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV2_AWS_76", "bc_check_id": null, "check_name": "Ensure AWS ALB attached WAFv2 WebACL is configured with AMR for Log4j Vulnerability", "check_result": {"result": "PASSED", "entity": {"aws_lb": {"alb": {"__end_line__": 44, "__start_line__": 30, "enable_deletion_protection": [false], "internal": [false], "load_balancer_type": ["application"], "name": ["ecs-jenkins-prod-alb"], "security_groups": [[["aws_security_group.alb_security_group.id"]]], "subnets": ["aws_subnet.public_subnet.*.id"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-alb", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.ecs.aws_lb.alb"}}}, "evaluated_keys": ["rule/*/statement/managed_rule_group_statement/name", "resource_type", "internal"]}, "code_block": [[30, "resource \"aws_lb\" \"alb\" {\n"], [31, "  name               = \"${var.project}-${var.environment}-alb\"\n"], [32, "  internal           = false\n"], [33, "  load_balancer_type = \"application\"\n"], [34, "  security_groups    = [var.alb_security_group]\n"], [35, "  subnets            = var.public_subnets\n"], [36, "\n"], [37, "  enable_deletion_protection = false\n"], [38, "\n"], [39, "  tags = {\n"], [40, "    Name        = \"${var.project}-${var.environment}-alb\"\n"], [41, "    Environment = var.environment\n"], [42, "    Project     = var.project\n"], [43, "  }\n"], [44, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [30, 44], "resource": "module.ecs_jenkins_github.module.ecs.aws_lb.alb", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-alb", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV2_AWS_76", "bc_check_id": null, "check_name": "Ensure AWS ALB attached WAFv2 WebACL is configured with AMR for Log4j Vulnerability", "check_result": {"result": "PASSED", "entity": {"aws_lb": {"alb": {"__end_line__": 44, "__start_line__": 30, "enable_deletion_protection": [false], "internal": [false], "load_balancer_type": ["application"], "name": ["ecs-jenkins-dr-alb"], "security_groups": [[["aws_security_group.alb_security_group.id"]]], "subnets": ["aws_subnet.public_subnet.*.id"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-alb", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.ecs.aws_lb.alb"}}}, "evaluated_keys": ["rule/*/statement/managed_rule_group_statement/name", "resource_type", "internal"]}, "code_block": [[30, "resource \"aws_lb\" \"alb\" {\n"], [31, "  name               = \"${var.project}-${var.environment}-alb\"\n"], [32, "  internal           = false\n"], [33, "  load_balancer_type = \"application\"\n"], [34, "  security_groups    = [var.alb_security_group]\n"], [35, "  subnets            = var.public_subnets\n"], [36, "\n"], [37, "  enable_deletion_protection = false\n"], [38, "\n"], [39, "  tags = {\n"], [40, "    Name        = \"${var.project}-${var.environment}-alb\"\n"], [41, "    Environment = var.environment\n"], [42, "    Project     = var.project\n"], [43, "  }\n"], [44, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [30, 44], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_lb.alb", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-alb", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV2_AWS_35", "bc_check_id": "BC_AWS_NETWORKING_77", "check_name": "AWS NAT Gateways should be utilized for the default route", "check_result": {"result": "PASSED", "entity": {"aws_route_table": {"public_route_table": {"__end_line__": 81, "__start_line__": 70, "route": [{"cidr_block": ["0.0.0.0/0"], "gateway_id": ["aws_internet_gateway.igw.id"]}], "tags": [{"Name": "public-route-table"}], "vpc_id": ["aws_vpc.vpc.id"], "__address__": "module.ecs_jenkins_github.module.network.aws_route_table.public_route_table"}}}, "evaluated_keys": ["destination_cidr_block", "instance_id", "route/*/cidr_block", "route/*/instance_id"]}, "code_block": [[70, "resource \"aws_route_table\" \"public_route_table\" {\n"], [71, "  vpc_id = aws_vpc.vpc.id\n"], [72, "\n"], [73, "  route {\n"], [74, "    cidr_block = \"0.0.0.0/0\"\n"], [75, "    gateway_id = aws_internet_gateway.igw.id\n"], [76, "  }\n"], [77, "\n"], [78, "  tags = {\n"], [79, "    Name = \"public-route-table\"\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [70, 81], "resource": "module.ecs_jenkins_github.module.network.aws_route_table.public_route_table", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "public-route-table"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-nat-gateways-are-utilized-for-the-default-route", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_35", "bc_check_id": "BC_AWS_NETWORKING_77", "check_name": "AWS NAT Gateways should be utilized for the default route", "check_result": {"result": "PASSED", "entity": {"aws_route_table": {"private_route_table": {"__end_line__": 94, "__start_line__": 83, "route": [{"cidr_block": ["0.0.0.0/0"], "nat_gateway_id": ["aws_nat_gateway.nat_gateway.id"]}], "tags": [{"Name": "private-route-table"}], "vpc_id": ["aws_vpc.vpc.id"], "__address__": "module.ecs_jenkins_github.module.network.aws_route_table.private_route_table"}}}, "evaluated_keys": ["destination_cidr_block", "instance_id", "route/*/cidr_block", "route/*/instance_id"]}, "code_block": [[83, "resource \"aws_route_table\" \"private_route_table\" {\n"], [84, "  vpc_id = aws_vpc.vpc.id\n"], [85, "\n"], [86, "  route {\n"], [87, "    cidr_block     = \"0.0.0.0/0\"\n"], [88, "    nat_gateway_id = aws_nat_gateway.nat_gateway.id\n"], [89, "  }\n"], [90, "\n"], [91, "  tags = {\n"], [92, "    Name = \"private-route-table\"\n"], [93, "  }\n"], [94, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [83, 94], "resource": "module.ecs_jenkins_github.module.network.aws_route_table.private_route_table", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "private-route-table"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-nat-gateways-are-utilized-for-the-default-route", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_35", "bc_check_id": "BC_AWS_NETWORKING_77", "check_name": "AWS NAT Gateways should be utilized for the default route", "check_result": {"result": "PASSED", "entity": {"aws_route_table": {"public_route_table": {"__end_line__": 81, "__start_line__": 70, "route": [{"cidr_block": ["0.0.0.0/0"], "gateway_id": ["aws_internet_gateway.igw.id"]}], "tags": [{"Name": "public-route-table"}], "vpc_id": ["aws_vpc.vpc.id"], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_route_table.public_route_table"}}}, "evaluated_keys": ["destination_cidr_block", "instance_id", "route/*/cidr_block", "route/*/instance_id"]}, "code_block": [[70, "resource \"aws_route_table\" \"public_route_table\" {\n"], [71, "  vpc_id = aws_vpc.vpc.id\n"], [72, "\n"], [73, "  route {\n"], [74, "    cidr_block = \"0.0.0.0/0\"\n"], [75, "    gateway_id = aws_internet_gateway.igw.id\n"], [76, "  }\n"], [77, "\n"], [78, "  tags = {\n"], [79, "    Name = \"public-route-table\"\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [70, 81], "resource": "module.ecs_jenkins_github_dr.module.network.aws_route_table.public_route_table", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "public-route-table"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-nat-gateways-are-utilized-for-the-default-route", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_35", "bc_check_id": "BC_AWS_NETWORKING_77", "check_name": "AWS NAT Gateways should be utilized for the default route", "check_result": {"result": "PASSED", "entity": {"aws_route_table": {"private_route_table": {"__end_line__": 94, "__start_line__": 83, "route": [{"cidr_block": ["0.0.0.0/0"], "nat_gateway_id": ["aws_nat_gateway.nat_gateway.id"]}], "tags": [{"Name": "private-route-table"}], "vpc_id": ["aws_vpc.vpc.id"], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_route_table.private_route_table"}}}, "evaluated_keys": ["destination_cidr_block", "instance_id", "route/*/cidr_block", "route/*/instance_id"]}, "code_block": [[83, "resource \"aws_route_table\" \"private_route_table\" {\n"], [84, "  vpc_id = aws_vpc.vpc.id\n"], [85, "\n"], [86, "  route {\n"], [87, "    cidr_block     = \"0.0.0.0/0\"\n"], [88, "    nat_gateway_id = aws_nat_gateway.nat_gateway.id\n"], [89, "  }\n"], [90, "\n"], [91, "  tags = {\n"], [92, "    Name = \"private-route-table\"\n"], [93, "  }\n"], [94, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [83, 94], "resource": "module.ecs_jenkins_github_dr.module.network.aws_route_table.private_route_table", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "private-route-table"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-nat-gateways-are-utilized-for-the-default-route", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_45", "bc_check_id": "BC_AWS_GENERAL_182", "check_name": "Ensure AWS Config recorder is enabled to record all supported resources", "check_result": {"result": "PASSED", "entity": {"aws_config_configuration_recorder_status": {"recorder_status": {"__end_line__": 327, "__start_line__": 323, "depends_on": [["aws_config_delivery_channel.channel"]], "is_enabled": [true], "name": ["ecs-jenkins-prod-config-recorder"], "__address__": "module.ecs_jenkins_github.module.security.aws_config_configuration_recorder_status.recorder_status"}}}, "evaluated_keys": ["recording_group/all_supported", "resource_type", "is_enabled"]}, "code_block": [[323, "resource \"aws_config_configuration_recorder_status\" \"recorder_status\" {\n"], [324, "  name       = aws_config_configuration_recorder.recorder.name\n"], [325, "  is_enabled = true\n"], [326, "  depends_on = [aws_config_delivery_channel.channel]\n"], [327, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [323, 327], "resource": "module.ecs_jenkins_github.module.security.aws_config_configuration_recorder_status.recorder_status", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-config-recorder-is-enabled-to-record-all-supported-resources", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV2_AWS_45", "bc_check_id": "BC_AWS_GENERAL_182", "check_name": "Ensure AWS Config recorder is enabled to record all supported resources", "check_result": {"result": "PASSED", "entity": {"aws_config_configuration_recorder_status": {"recorder_status": {"__end_line__": 327, "__start_line__": 323, "depends_on": [["aws_config_delivery_channel.channel"]], "is_enabled": [true], "name": ["ecs-jenkins-dr-config-recorder"], "__address__": "module.ecs_jenkins_github_dr.module.security.aws_config_configuration_recorder_status.recorder_status"}}}, "evaluated_keys": ["recording_group/all_supported", "resource_type", "is_enabled"]}, "code_block": [[323, "resource \"aws_config_configuration_recorder_status\" \"recorder_status\" {\n"], [324, "  name       = aws_config_configuration_recorder.recorder.name\n"], [325, "  is_enabled = true\n"], [326, "  depends_on = [aws_config_delivery_channel.channel]\n"], [327, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [323, 327], "resource": "module.ecs_jenkins_github_dr.module.security.aws_config_configuration_recorder_status.recorder_status", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-config-recorder-is-enabled-to-record-all-supported-resources", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_103", "bc_check_id": "BC_AWS_GENERAL_43", "check_name": "Ensure that load balancer is using at least TLS 1.2", "check_result": {"result": "PASSED", "entity": {"aws_lb_listener": {"jenkins": {"__end_line__": 228, "__start_line__": 219, "default_action": [{"target_group_arn": ["aws_lb_target_group.jenkins.arn"], "type": ["forward"]}], "load_balancer_arn": ["aws_lb.jenkins_nlb.arn"], "port": [80], "protocol": ["TCP"], "__address__": "module.ecs_jenkins_github.module.cicd.aws_lb_listener.jenkins"}}}, "evaluated_keys": ["ssl_policy", "default_action/redirect/protocol", "load_balancer_type", "protocol", "resource_type", "default_action/type"]}, "code_block": [[219, "resource \"aws_lb_listener\" \"jenkins\" {\n"], [220, "  load_balancer_arn = aws_lb.jenkins_nlb.arn\n"], [221, "  port              = 80\n"], [222, "  protocol          = \"TCP\"\n"], [223, "\n"], [224, "  default_action {\n"], [225, "    type             = \"forward\"\n"], [226, "    target_group_arn = aws_lb_target_group.jenkins.arn\n"], [227, "  }\n"], [228, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [219, 228], "resource": "module.ecs_jenkins_github.module.cicd.aws_lb_listener.jenkins", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-43", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_103", "bc_check_id": "BC_AWS_GENERAL_43", "check_name": "Ensure that load balancer is using at least TLS 1.2", "check_result": {"result": "PASSED", "entity": {"aws_lb_listener": {"jenkins": {"__end_line__": 228, "__start_line__": 219, "default_action": [{"target_group_arn": ["aws_lb_target_group.jenkins.arn"], "type": ["forward"]}], "load_balancer_arn": ["aws_lb.jenkins_nlb.arn"], "port": [80], "protocol": ["TCP"], "__address__": "module.ecs_jenkins_github_dr.module.cicd.aws_lb_listener.jenkins"}}}, "evaluated_keys": ["ssl_policy", "default_action/redirect/protocol", "load_balancer_type", "protocol", "resource_type", "default_action/type"]}, "code_block": [[219, "resource \"aws_lb_listener\" \"jenkins\" {\n"], [220, "  load_balancer_arn = aws_lb.jenkins_nlb.arn\n"], [221, "  port              = 80\n"], [222, "  protocol          = \"TCP\"\n"], [223, "\n"], [224, "  default_action {\n"], [225, "    type             = \"forward\"\n"], [226, "    target_group_arn = aws_lb_target_group.jenkins.arn\n"], [227, "  }\n"], [228, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [219, 228], "resource": "module.ecs_jenkins_github_dr.module.cicd.aws_lb_listener.jenkins", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-43", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_103", "bc_check_id": "BC_AWS_GENERAL_43", "check_name": "Ensure that load balancer is using at least TLS 1.2", "check_result": {"result": "PASSED", "entity": {"aws_lb_listener": {"https[0]": {"__end_line__": 276, "__start_line__": 256, "certificate_arn": ["aws_acm_certificate.cert[0].arn"], "default_action": [{"target_group_arn": ["aws_lb_target_group.target_group.arn"], "type": ["forward"]}], "load_balancer_arn": ["aws_lb.alb.arn"], "port": [443], "protocol": ["HTTPS"], "ssl_policy": ["ELBSecurityPolicy-TLS-1-2-2017-01"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-https", "Project": "ecs-jenkins", "SecurityCompliance": "OWASP-TLS-1.2"}], "__address__": "module.ecs_jenkins_github.module.ecs.aws_lb_listener.https[0]"}}}, "evaluated_keys": ["ssl_policy", "default_action/redirect/protocol", "load_balancer_type", "protocol", "resource_type", "default_action/type"]}, "code_block": [[256, "resource \"aws_lb_listener\" \"https\" {\n"], [257, "  count             = var.create_dummy_cert ? 1 : 0\n"], [258, "  load_balancer_arn = aws_lb.alb.arn\n"], [259, "  port              = 443\n"], [260, "  protocol          = \"HTTPS\"\n"], [261, "  # Use a more secure SSL policy that requires TLS 1.2 minimum (OWASP recommendation)\n"], [262, "  ssl_policy      = \"ELBSecurityPolicy-TLS-1-2-2017-01\"\n"], [263, "  certificate_arn = aws_acm_certificate.cert[0].arn\n"], [264, "\n"], [265, "  default_action {\n"], [266, "    type             = \"forward\"\n"], [267, "    target_group_arn = aws_lb_target_group.target_group.arn\n"], [268, "  }\n"], [269, "\n"], [270, "  tags = {\n"], [271, "    Name               = \"${var.project}-${var.environment}-https\"\n"], [272, "    Environment        = var.environment\n"], [273, "    Project            = var.project\n"], [274, "    SecurityCompliance = \"OWASP-TLS-1.2\"\n"], [275, "  }\n"], [276, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [256, 276], "resource": "module.ecs_jenkins_github.module.ecs.aws_lb_listener.https[0]", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-https", "Project": "ecs-jenkins", "SecurityCompliance": "OWASP-TLS-1.2"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-43", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_103", "bc_check_id": "BC_AWS_GENERAL_43", "check_name": "Ensure that load balancer is using at least TLS 1.2", "check_result": {"result": "PASSED", "entity": {"aws_lb_listener": {"https[0]": {"__end_line__": 276, "__start_line__": 256, "certificate_arn": ["aws_acm_certificate.cert[0].arn"], "default_action": [{"target_group_arn": ["aws_lb_target_group.target_group.arn"], "type": ["forward"]}], "load_balancer_arn": ["aws_lb.alb.arn"], "port": [443], "protocol": ["HTTPS"], "ssl_policy": ["ELBSecurityPolicy-TLS-1-2-2017-01"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-https", "Project": "ecs-jenkins", "SecurityCompliance": "OWASP-TLS-1.2"}], "__address__": "module.ecs_jenkins_github_dr.module.ecs.aws_lb_listener.https[0]"}}}, "evaluated_keys": ["ssl_policy", "default_action/redirect/protocol", "load_balancer_type", "protocol", "resource_type", "default_action/type"]}, "code_block": [[256, "resource \"aws_lb_listener\" \"https\" {\n"], [257, "  count             = var.create_dummy_cert ? 1 : 0\n"], [258, "  load_balancer_arn = aws_lb.alb.arn\n"], [259, "  port              = 443\n"], [260, "  protocol          = \"HTTPS\"\n"], [261, "  # Use a more secure SSL policy that requires TLS 1.2 minimum (OWASP recommendation)\n"], [262, "  ssl_policy      = \"ELBSecurityPolicy-TLS-1-2-2017-01\"\n"], [263, "  certificate_arn = aws_acm_certificate.cert[0].arn\n"], [264, "\n"], [265, "  default_action {\n"], [266, "    type             = \"forward\"\n"], [267, "    target_group_arn = aws_lb_target_group.target_group.arn\n"], [268, "  }\n"], [269, "\n"], [270, "  tags = {\n"], [271, "    Name               = \"${var.project}-${var.environment}-https\"\n"], [272, "    Environment        = var.environment\n"], [273, "    Project            = var.project\n"], [274, "    SecurityCompliance = \"OWASP-TLS-1.2\"\n"], [275, "  }\n"], [276, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [256, 276], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_lb_listener.https[0]", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-https", "Project": "ecs-jenkins", "SecurityCompliance": "OWASP-TLS-1.2"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-43", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_103", "bc_check_id": "BC_AWS_GENERAL_43", "check_name": "Ensure that load balancer is using at least TLS 1.2", "check_result": {"result": "PASSED", "entity": {"aws_lb_listener": {"http_redirect": {"__end_line__": 305, "__start_line__": 279, "default_action": [{"redirect": [{"port": ["443"], "protocol": ["HTTPS"], "status_code": ["HTTP_301"]}], "type": ["redirect"]}], "lifecycle": [{"ignore_changes": [["default_action"]]}], "load_balancer_arn": ["aws_lb.alb.arn"], "port": [80], "protocol": ["HTTP"], "tags": [{"Environment": "prod", "ManagedBy": "Terraform", "Name": "ecs-jenkins-prod-http-redirect", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.ecs.aws_lb_listener.http_redirect"}}}, "evaluated_keys": ["ssl_policy", "default_action/redirect/protocol", "load_balancer_type", "protocol", "resource_type", "default_action/type"]}, "code_block": [[279, "resource \"aws_lb_listener\" \"http_redirect\" {\n"], [280, "  load_balancer_arn = aws_lb.alb.arn\n"], [281, "  port              = 80\n"], [282, "  protocol          = \"HTTP\"\n"], [283, "\n"], [284, "  default_action {\n"], [285, "    type = \"redirect\"\n"], [286, "\n"], [287, "    redirect {\n"], [288, "      port        = \"443\"\n"], [289, "      protocol    = \"HTTPS\"\n"], [290, "      status_code = \"HTTP_301\"\n"], [291, "    }\n"], [292, "  }\n"], [293, "\n"], [294, "  # Add security headers via response headers policy\n"], [295, "  lifecycle {\n"], [296, "    ignore_changes = [default_action]\n"], [297, "  }\n"], [298, "\n"], [299, "  tags = {\n"], [300, "    Name        = \"${var.project}-${var.environment}-http-redirect\"\n"], [301, "    Environment = var.environment\n"], [302, "    Project     = var.project\n"], [303, "    ManagedBy   = \"Terraform\"\n"], [304, "  }\n"], [305, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [279, 305], "resource": "module.ecs_jenkins_github.module.ecs.aws_lb_listener.http_redirect", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "ManagedBy": "Terraform", "Name": "ecs-jenkins-prod-http-redirect", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-43", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_103", "bc_check_id": "BC_AWS_GENERAL_43", "check_name": "Ensure that load balancer is using at least TLS 1.2", "check_result": {"result": "PASSED", "entity": {"aws_lb_listener": {"http_redirect": {"__end_line__": 305, "__start_line__": 279, "default_action": [{"redirect": [{"port": ["443"], "protocol": ["HTTPS"], "status_code": ["HTTP_301"]}], "type": ["redirect"]}], "lifecycle": [{"ignore_changes": [["default_action"]]}], "load_balancer_arn": ["aws_lb.alb.arn"], "port": [80], "protocol": ["HTTP"], "tags": [{"Environment": "dr", "ManagedBy": "Terraform", "Name": "ecs-jenkins-dr-http-redirect", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.ecs.aws_lb_listener.http_redirect"}}}, "evaluated_keys": ["ssl_policy", "default_action/redirect/protocol", "load_balancer_type", "protocol", "resource_type", "default_action/type"]}, "code_block": [[279, "resource \"aws_lb_listener\" \"http_redirect\" {\n"], [280, "  load_balancer_arn = aws_lb.alb.arn\n"], [281, "  port              = 80\n"], [282, "  protocol          = \"HTTP\"\n"], [283, "\n"], [284, "  default_action {\n"], [285, "    type = \"redirect\"\n"], [286, "\n"], [287, "    redirect {\n"], [288, "      port        = \"443\"\n"], [289, "      protocol    = \"HTTPS\"\n"], [290, "      status_code = \"HTTP_301\"\n"], [291, "    }\n"], [292, "  }\n"], [293, "\n"], [294, "  # Add security headers via response headers policy\n"], [295, "  lifecycle {\n"], [296, "    ignore_changes = [default_action]\n"], [297, "  }\n"], [298, "\n"], [299, "  tags = {\n"], [300, "    Name        = \"${var.project}-${var.environment}-http-redirect\"\n"], [301, "    Environment = var.environment\n"], [302, "    Project     = var.project\n"], [303, "    ManagedBy   = \"Terraform\"\n"], [304, "  }\n"], [305, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [279, 305], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_lb_listener.http_redirect", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "ManagedBy": "Terraform", "Name": "ecs-jenkins-dr-http-redirect", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-43", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"rds_monitoring_role": {"__end_line__": 23, "__start_line__": 10, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Effect": "Allow", "Principal": {"Service": "monitoring.rds.amazonaws.com"}}]}], "name": ["rds-monitoring-role"], "__address__": "module.ecs_jenkins_github.module.database.aws_iam_role.rds_monitoring_role"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[10, "resource \"aws_iam_role\" \"rds_monitoring_role\" {\n"], [11, "  name = \"rds-monitoring-role\"\n"], [12, "\n"], [13, "  assume_role_policy = jsonencode({\n"], [14, "    Version = \"2012-10-17\",\n"], [15, "    Statement = [{\n"], [16, "      Action = \"sts:AssumeRole\",\n"], [17, "      Effect = \"Allow\",\n"], [18, "      Principal = {\n"], [19, "        Service = \"monitoring.rds.amazonaws.com\"\n"], [20, "      }\n"], [21, "    }]\n"], [22, "  })\n"], [23, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [10, 23], "resource": "module.ecs_jenkins_github.module.database.aws_iam_role.rds_monitoring_role", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy_attachment": {"rds_monitoring_attach": {"__end_line__": 28, "__start_line__": 25, "policy_arn": ["arn:aws:iam::aws:policy/service-role/AmazonRDSEnhancedMonitoringRole"], "role": ["rds-monitoring-role"], "__address__": "module.ecs_jenkins_github.module.database.aws_iam_role_policy_attachment.rds_monitoring_attach"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[25, "resource \"aws_iam_role_policy_attachment\" \"rds_monitoring_attach\" {\n"], [26, "  role       = aws_iam_role.rds_monitoring_role.name\n"], [27, "  policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonRDSEnhancedMonitoringRole\"\n"], [28, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [25, 28], "resource": "module.ecs_jenkins_github.module.database.aws_iam_role_policy_attachment.rds_monitoring_attach", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"rds_monitoring_role": {"__end_line__": 23, "__start_line__": 10, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Effect": "Allow", "Principal": {"Service": "monitoring.rds.amazonaws.com"}}]}], "name": ["rds-monitoring-role"], "__address__": "module.ecs_jenkins_github_dr.module.database.aws_iam_role.rds_monitoring_role"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[10, "resource \"aws_iam_role\" \"rds_monitoring_role\" {\n"], [11, "  name = \"rds-monitoring-role\"\n"], [12, "\n"], [13, "  assume_role_policy = jsonencode({\n"], [14, "    Version = \"2012-10-17\",\n"], [15, "    Statement = [{\n"], [16, "      Action = \"sts:AssumeRole\",\n"], [17, "      Effect = \"Allow\",\n"], [18, "      Principal = {\n"], [19, "        Service = \"monitoring.rds.amazonaws.com\"\n"], [20, "      }\n"], [21, "    }]\n"], [22, "  })\n"], [23, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [10, 23], "resource": "module.ecs_jenkins_github_dr.module.database.aws_iam_role.rds_monitoring_role", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy_attachment": {"rds_monitoring_attach": {"__end_line__": 28, "__start_line__": 25, "policy_arn": ["arn:aws:iam::aws:policy/service-role/AmazonRDSEnhancedMonitoringRole"], "role": ["rds-monitoring-role"], "__address__": "module.ecs_jenkins_github_dr.module.database.aws_iam_role_policy_attachment.rds_monitoring_attach"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[25, "resource \"aws_iam_role_policy_attachment\" \"rds_monitoring_attach\" {\n"], [26, "  role       = aws_iam_role.rds_monitoring_role.name\n"], [27, "  policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonRDSEnhancedMonitoringRole\"\n"], [28, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [25, 28], "resource": "module.ecs_jenkins_github_dr.module.database.aws_iam_role_policy_attachment.rds_monitoring_attach", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"ecs_task_execution_role": {"__end_line__": 24, "__start_line__": 2, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Principal": {"Service": "ecs-tasks.amazonaws.com"}, "Effect": "Allow", "Sid": ""}]}], "name": ["ecs-jenkins-prod-ecs-task-execution-role"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-ecs-task-execution-role", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.iam.aws_iam_role.ecs_task_execution_role"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[2, "resource \"aws_iam_role\" \"ecs_task_execution_role\" {\n"], [3, "  name = \"${var.project}-${var.environment}-ecs-task-execution-role\"\n"], [4, "\n"], [5, "  assume_role_policy = jsonencode({\n"], [6, "    Version = \"2012-10-17\",\n"], [7, "    Statement = [\n"], [8, "      {\n"], [9, "        Action = \"sts:AssumeRole\",\n"], [10, "        Principal = {\n"], [11, "          Service = \"ecs-tasks.amazonaws.com\"\n"], [12, "        },\n"], [13, "        Effect = \"Allow\",\n"], [14, "        Sid    = \"\"\n"], [15, "      }\n"], [16, "    ]\n"], [17, "  })\n"], [18, "\n"], [19, "  tags = {\n"], [20, "    Name        = \"${var.project}-${var.environment}-ecs-task-execution-role\"\n"], [21, "    Environment = var.environment\n"], [22, "    Project     = var.project\n"], [23, "  }\n"], [24, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [2, 24], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role.ecs_task_execution_role", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-ecs-task-execution-role", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy_attachment": {"ecs_task_execution_role_policy": {"__end_line__": 29, "__start_line__": 26, "policy_arn": ["arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy"], "role": ["ecs-jenkins-prod-ecs-task-execution-role"], "__address__": "module.ecs_jenkins_github.module.iam.aws_iam_role_policy_attachment.ecs_task_execution_role_policy"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[26, "resource \"aws_iam_role_policy_attachment\" \"ecs_task_execution_role_policy\" {\n"], [27, "  role       = aws_iam_role.ecs_task_execution_role.name\n"], [28, "  policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy\"\n"], [29, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [26, 29], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role_policy_attachment.ecs_task_execution_role_policy", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"ecs_task_role": {"__end_line__": 54, "__start_line__": 32, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Principal": {"Service": "ecs-tasks.amazonaws.com"}, "Effect": "Allow", "Sid": ""}]}], "name": ["ecs-jenkins-prod-ecs-task-role"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-ecs-task-role", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.iam.aws_iam_role.ecs_task_role"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[32, "resource \"aws_iam_role\" \"ecs_task_role\" {\n"], [33, "  name = \"${var.project}-${var.environment}-ecs-task-role\"\n"], [34, "\n"], [35, "  assume_role_policy = jsonencode({\n"], [36, "    Version = \"2012-10-17\",\n"], [37, "    Statement = [\n"], [38, "      {\n"], [39, "        Action = \"sts:AssumeRole\",\n"], [40, "        Principal = {\n"], [41, "          Service = \"ecs-tasks.amazonaws.com\"\n"], [42, "        },\n"], [43, "        Effect = \"Allow\",\n"], [44, "        Sid    = \"\"\n"], [45, "      }\n"], [46, "    ]\n"], [47, "  })\n"], [48, "\n"], [49, "  tags = {\n"], [50, "    Name        = \"${var.project}-${var.environment}-ecs-task-role\"\n"], [51, "    Environment = var.environment\n"], [52, "    Project     = var.project\n"], [53, "  }\n"], [54, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [32, 54], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role.ecs_task_role", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-ecs-task-role", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"jenkins_role": {"__end_line__": 79, "__start_line__": 57, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Principal": {"Service": "ec2.amazonaws.com"}, "Effect": "Allow", "Sid": ""}]}], "name": ["ecs-jenkins-prod-jenkins-role"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-role", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.iam.aws_iam_role.jenkins_role"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[57, "resource \"aws_iam_role\" \"jenkins_role\" {\n"], [58, "  name = \"${var.project}-${var.environment}-jenkins-role\"\n"], [59, "\n"], [60, "  assume_role_policy = jsonencode({\n"], [61, "    Version = \"2012-10-17\",\n"], [62, "    Statement = [\n"], [63, "      {\n"], [64, "        Action = \"sts:AssumeRole\",\n"], [65, "        Principal = {\n"], [66, "          Service = \"ec2.amazonaws.com\"\n"], [67, "        },\n"], [68, "        Effect = \"Allow\",\n"], [69, "        Sid    = \"\"\n"], [70, "      }\n"], [71, "    ]\n"], [72, "  })\n"], [73, "\n"], [74, "  tags = {\n"], [75, "    Name        = \"${var.project}-${var.environment}-jenkins-role\"\n"], [76, "    Environment = var.environment\n"], [77, "    Project     = var.project\n"], [78, "  }\n"], [79, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [57, 79], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role.jenkins_role", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-role", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"ecs_execution_role": {"__end_line__": 171, "__start_line__": 156, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Effect": "Allow", "Principal": {"Service": "ecs-tasks.amazonaws.com"}}]}], "name": ["ecs-execution-role"], "__address__": "module.ecs_jenkins_github.module.iam.aws_iam_role.ecs_execution_role"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[156, "resource \"aws_iam_role\" \"ecs_execution_role\" {\n"], [157, "  name = \"ecs-execution-role\"\n"], [158, "\n"], [159, "  assume_role_policy = jsonencode({\n"], [160, "    Version = \"2012-10-17\"\n"], [161, "    Statement = [\n"], [162, "      {\n"], [163, "        Action = \"sts:AssumeRole\"\n"], [164, "        Effect = \"Allow\"\n"], [165, "        Principal = {\n"], [166, "          Service = \"ecs-tasks.amazonaws.com\"\n"], [167, "        }\n"], [168, "      }\n"], [169, "    ]\n"], [170, "  })\n"], [171, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [156, 171], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role.ecs_execution_role", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy_attachment": {"ecs_execution_role_policy": {"__end_line__": 176, "__start_line__": 173, "policy_arn": ["arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy"], "role": ["ecs-execution-role"], "__address__": "module.ecs_jenkins_github.module.iam.aws_iam_role_policy_attachment.ecs_execution_role_policy"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[173, "resource \"aws_iam_role_policy_attachment\" \"ecs_execution_role_policy\" {\n"], [174, "  role       = aws_iam_role.ecs_execution_role.name\n"], [175, "  policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy\"\n"], [176, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [173, 176], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role_policy_attachment.ecs_execution_role_policy", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"ssm_service_role": {"__end_line__": 200, "__start_line__": 179, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Effect": "Allow", "Principal": {"Service": "ssm.amazonaws.com"}}]}], "name": ["ecs-jenkins-prod-ssm-service-role"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-ssm-service-role", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.iam.aws_iam_role.ssm_service_role"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[179, "resource \"aws_iam_role\" \"ssm_service_role\" {\n"], [180, "  name = \"${var.project}-${var.environment}-ssm-service-role\"\n"], [181, "\n"], [182, "  assume_role_policy = jsonencode({\n"], [183, "    Version = \"2012-10-17\"\n"], [184, "    Statement = [\n"], [185, "      {\n"], [186, "        Action = \"sts:AssumeRole\"\n"], [187, "        Effect = \"Allow\"\n"], [188, "        Principal = {\n"], [189, "          Service = \"ssm.amazonaws.com\"\n"], [190, "        }\n"], [191, "      }\n"], [192, "    ]\n"], [193, "  })\n"], [194, "\n"], [195, "  tags = {\n"], [196, "    Name        = \"${var.project}-${var.environment}-ssm-service-role\"\n"], [197, "    Environment = var.environment\n"], [198, "    Project     = var.project\n"], [199, "  }\n"], [200, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [179, 200], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role.ssm_service_role", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-ssm-service-role", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy_attachment": {"ssm_service_role_policy": {"__end_line__": 205, "__start_line__": 202, "policy_arn": ["arn:aws:iam::aws:policy/service-role/AmazonSSMMaintenanceWindowRole"], "role": ["ecs-jenkins-prod-ssm-service-role"], "__address__": "module.ecs_jenkins_github.module.iam.aws_iam_role_policy_attachment.ssm_service_role_policy"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[202, "resource \"aws_iam_role_policy_attachment\" \"ssm_service_role_policy\" {\n"], [203, "  role       = aws_iam_role.ssm_service_role.name\n"], [204, "  policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonSSMMaintenanceWindowRole\"\n"], [205, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [202, 205], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role_policy_attachment.ssm_service_role_policy", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"ec2_instance_role": {"__end_line__": 229, "__start_line__": 208, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Effect": "Allow", "Principal": {"Service": "ec2.amazonaws.com"}}]}], "name": ["ecs-jenkins-prod-ec2-instance-role"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-ec2-instance-role", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.iam.aws_iam_role.ec2_instance_role"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[208, "resource \"aws_iam_role\" \"ec2_instance_role\" {\n"], [209, "  name = \"${var.project}-${var.environment}-ec2-instance-role\"\n"], [210, "\n"], [211, "  assume_role_policy = jsonencode({\n"], [212, "    Version = \"2012-10-17\"\n"], [213, "    Statement = [\n"], [214, "      {\n"], [215, "        Action = \"sts:AssumeRole\"\n"], [216, "        Effect = \"Allow\"\n"], [217, "        Principal = {\n"], [218, "          Service = \"ec2.amazonaws.com\"\n"], [219, "        }\n"], [220, "      }\n"], [221, "    ]\n"], [222, "  })\n"], [223, "\n"], [224, "  tags = {\n"], [225, "    Name        = \"${var.project}-${var.environment}-ec2-instance-role\"\n"], [226, "    Environment = var.environment\n"], [227, "    Project     = var.project\n"], [228, "  }\n"], [229, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [208, 229], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role.ec2_instance_role", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-ec2-instance-role", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy_attachment": {"ec2_ssm_policy": {"__end_line__": 235, "__start_line__": 232, "policy_arn": ["arn:aws:iam::aws:policy/AmazonSSMManagedInstanceCore"], "role": ["ecs-jenkins-prod-ec2-instance-role"], "__address__": "module.ecs_jenkins_github.module.iam.aws_iam_role_policy_attachment.ec2_ssm_policy"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[232, "resource \"aws_iam_role_policy_attachment\" \"ec2_ssm_policy\" {\n"], [233, "  role       = aws_iam_role.ec2_instance_role.name\n"], [234, "  policy_arn = \"arn:aws:iam::aws:policy/AmazonSSMManagedInstanceCore\"\n"], [235, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [232, 235], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role_policy_attachment.ec2_ssm_policy", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy_attachment": {"ec2_ecs_policy": {"__end_line__": 240, "__start_line__": 237, "policy_arn": ["arn:aws:iam::aws:policy/service-role/AmazonEC2ContainerServiceforEC2Role"], "role": ["ecs-jenkins-prod-ec2-instance-role"], "__address__": "module.ecs_jenkins_github.module.iam.aws_iam_role_policy_attachment.ec2_ecs_policy"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[237, "resource \"aws_iam_role_policy_attachment\" \"ec2_ecs_policy\" {\n"], [238, "  role       = aws_iam_role.ec2_instance_role.name\n"], [239, "  policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonEC2ContainerServiceforEC2Role\"\n"], [240, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [237, 240], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role_policy_attachment.ec2_ecs_policy", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"codedeploy_role": {"__end_line__": 269, "__start_line__": 248, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Effect": "Allow", "Principal": {"Service": "codedeploy.amazonaws.com"}}]}], "name": ["ecs-jenkins-prod-codedeploy-role"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-codedeploy-role", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.iam.aws_iam_role.codedeploy_role"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[248, "resource \"aws_iam_role\" \"codedeploy_role\" {\n"], [249, "  name = \"${var.project}-${var.environment}-codedeploy-role\"\n"], [250, "\n"], [251, "  assume_role_policy = jsonencode({\n"], [252, "    Version = \"2012-10-17\"\n"], [253, "    Statement = [\n"], [254, "      {\n"], [255, "        Action = \"sts:AssumeRole\"\n"], [256, "        Effect = \"Allow\"\n"], [257, "        Principal = {\n"], [258, "          Service = \"codedeploy.amazonaws.com\"\n"], [259, "        }\n"], [260, "      }\n"], [261, "    ]\n"], [262, "  })\n"], [263, "\n"], [264, "  tags = {\n"], [265, "    Name        = \"${var.project}-${var.environment}-codedeploy-role\"\n"], [266, "    Environment = var.environment\n"], [267, "    Project     = var.project\n"], [268, "  }\n"], [269, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [248, 269], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role.codedeploy_role", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-codedeploy-role", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy_attachment": {"codedeploy_policy": {"__end_line__": 274, "__start_line__": 271, "policy_arn": ["arn:aws:iam::aws:policy/AWSCodeDeployRoleForECS"], "role": ["ecs-jenkins-prod-codedeploy-role"], "__address__": "module.ecs_jenkins_github.module.iam.aws_iam_role_policy_attachment.codedeploy_policy"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[271, "resource \"aws_iam_role_policy_attachment\" \"codedeploy_policy\" {\n"], [272, "  role       = aws_iam_role.codedeploy_role.name\n"], [273, "  policy_arn = \"arn:aws:iam::aws:policy/AWSCodeDeployRoleForECS\"\n"], [274, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [271, 274], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_role_policy_attachment.codedeploy_policy", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"ecs_task_execution_role": {"__end_line__": 24, "__start_line__": 2, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Principal": {"Service": "ecs-tasks.amazonaws.com"}, "Effect": "Allow", "Sid": ""}]}], "name": ["ecs-jenkins-dr-ecs-task-execution-role"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-ecs-task-execution-role", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.ecs_task_execution_role"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[2, "resource \"aws_iam_role\" \"ecs_task_execution_role\" {\n"], [3, "  name = \"${var.project}-${var.environment}-ecs-task-execution-role\"\n"], [4, "\n"], [5, "  assume_role_policy = jsonencode({\n"], [6, "    Version = \"2012-10-17\",\n"], [7, "    Statement = [\n"], [8, "      {\n"], [9, "        Action = \"sts:AssumeRole\",\n"], [10, "        Principal = {\n"], [11, "          Service = \"ecs-tasks.amazonaws.com\"\n"], [12, "        },\n"], [13, "        Effect = \"Allow\",\n"], [14, "        Sid    = \"\"\n"], [15, "      }\n"], [16, "    ]\n"], [17, "  })\n"], [18, "\n"], [19, "  tags = {\n"], [20, "    Name        = \"${var.project}-${var.environment}-ecs-task-execution-role\"\n"], [21, "    Environment = var.environment\n"], [22, "    Project     = var.project\n"], [23, "  }\n"], [24, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [2, 24], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.ecs_task_execution_role", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-ecs-task-execution-role", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy_attachment": {"ecs_task_execution_role_policy": {"__end_line__": 29, "__start_line__": 26, "policy_arn": ["arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy"], "role": ["ecs-jenkins-dr-ecs-task-execution-role"], "__address__": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role_policy_attachment.ecs_task_execution_role_policy"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[26, "resource \"aws_iam_role_policy_attachment\" \"ecs_task_execution_role_policy\" {\n"], [27, "  role       = aws_iam_role.ecs_task_execution_role.name\n"], [28, "  policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy\"\n"], [29, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [26, 29], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role_policy_attachment.ecs_task_execution_role_policy", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"ecs_task_role": {"__end_line__": 54, "__start_line__": 32, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Principal": {"Service": "ecs-tasks.amazonaws.com"}, "Effect": "Allow", "Sid": ""}]}], "name": ["ecs-jenkins-dr-ecs-task-role"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-ecs-task-role", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.ecs_task_role"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[32, "resource \"aws_iam_role\" \"ecs_task_role\" {\n"], [33, "  name = \"${var.project}-${var.environment}-ecs-task-role\"\n"], [34, "\n"], [35, "  assume_role_policy = jsonencode({\n"], [36, "    Version = \"2012-10-17\",\n"], [37, "    Statement = [\n"], [38, "      {\n"], [39, "        Action = \"sts:AssumeRole\",\n"], [40, "        Principal = {\n"], [41, "          Service = \"ecs-tasks.amazonaws.com\"\n"], [42, "        },\n"], [43, "        Effect = \"Allow\",\n"], [44, "        Sid    = \"\"\n"], [45, "      }\n"], [46, "    ]\n"], [47, "  })\n"], [48, "\n"], [49, "  tags = {\n"], [50, "    Name        = \"${var.project}-${var.environment}-ecs-task-role\"\n"], [51, "    Environment = var.environment\n"], [52, "    Project     = var.project\n"], [53, "  }\n"], [54, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [32, 54], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.ecs_task_role", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-ecs-task-role", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"jenkins_role": {"__end_line__": 79, "__start_line__": 57, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Principal": {"Service": "ec2.amazonaws.com"}, "Effect": "Allow", "Sid": ""}]}], "name": ["ecs-jenkins-dr-jenkins-role"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-role", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.jenkins_role"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[57, "resource \"aws_iam_role\" \"jenkins_role\" {\n"], [58, "  name = \"${var.project}-${var.environment}-jenkins-role\"\n"], [59, "\n"], [60, "  assume_role_policy = jsonencode({\n"], [61, "    Version = \"2012-10-17\",\n"], [62, "    Statement = [\n"], [63, "      {\n"], [64, "        Action = \"sts:AssumeRole\",\n"], [65, "        Principal = {\n"], [66, "          Service = \"ec2.amazonaws.com\"\n"], [67, "        },\n"], [68, "        Effect = \"Allow\",\n"], [69, "        Sid    = \"\"\n"], [70, "      }\n"], [71, "    ]\n"], [72, "  })\n"], [73, "\n"], [74, "  tags = {\n"], [75, "    Name        = \"${var.project}-${var.environment}-jenkins-role\"\n"], [76, "    Environment = var.environment\n"], [77, "    Project     = var.project\n"], [78, "  }\n"], [79, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [57, 79], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.jenkins_role", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-role", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"ecs_execution_role": {"__end_line__": 171, "__start_line__": 156, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Effect": "Allow", "Principal": {"Service": "ecs-tasks.amazonaws.com"}}]}], "name": ["ecs-execution-role"], "__address__": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.ecs_execution_role"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[156, "resource \"aws_iam_role\" \"ecs_execution_role\" {\n"], [157, "  name = \"ecs-execution-role\"\n"], [158, "\n"], [159, "  assume_role_policy = jsonencode({\n"], [160, "    Version = \"2012-10-17\"\n"], [161, "    Statement = [\n"], [162, "      {\n"], [163, "        Action = \"sts:AssumeRole\"\n"], [164, "        Effect = \"Allow\"\n"], [165, "        Principal = {\n"], [166, "          Service = \"ecs-tasks.amazonaws.com\"\n"], [167, "        }\n"], [168, "      }\n"], [169, "    ]\n"], [170, "  })\n"], [171, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [156, 171], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.ecs_execution_role", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy_attachment": {"ecs_execution_role_policy": {"__end_line__": 176, "__start_line__": 173, "policy_arn": ["arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy"], "role": ["ecs-execution-role"], "__address__": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role_policy_attachment.ecs_execution_role_policy"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[173, "resource \"aws_iam_role_policy_attachment\" \"ecs_execution_role_policy\" {\n"], [174, "  role       = aws_iam_role.ecs_execution_role.name\n"], [175, "  policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy\"\n"], [176, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [173, 176], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role_policy_attachment.ecs_execution_role_policy", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"ssm_service_role": {"__end_line__": 200, "__start_line__": 179, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Effect": "Allow", "Principal": {"Service": "ssm.amazonaws.com"}}]}], "name": ["ecs-jenkins-dr-ssm-service-role"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-ssm-service-role", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.ssm_service_role"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[179, "resource \"aws_iam_role\" \"ssm_service_role\" {\n"], [180, "  name = \"${var.project}-${var.environment}-ssm-service-role\"\n"], [181, "\n"], [182, "  assume_role_policy = jsonencode({\n"], [183, "    Version = \"2012-10-17\"\n"], [184, "    Statement = [\n"], [185, "      {\n"], [186, "        Action = \"sts:AssumeRole\"\n"], [187, "        Effect = \"Allow\"\n"], [188, "        Principal = {\n"], [189, "          Service = \"ssm.amazonaws.com\"\n"], [190, "        }\n"], [191, "      }\n"], [192, "    ]\n"], [193, "  })\n"], [194, "\n"], [195, "  tags = {\n"], [196, "    Name        = \"${var.project}-${var.environment}-ssm-service-role\"\n"], [197, "    Environment = var.environment\n"], [198, "    Project     = var.project\n"], [199, "  }\n"], [200, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [179, 200], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.ssm_service_role", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-ssm-service-role", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy_attachment": {"ssm_service_role_policy": {"__end_line__": 205, "__start_line__": 202, "policy_arn": ["arn:aws:iam::aws:policy/service-role/AmazonSSMMaintenanceWindowRole"], "role": ["ecs-jenkins-dr-ssm-service-role"], "__address__": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role_policy_attachment.ssm_service_role_policy"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[202, "resource \"aws_iam_role_policy_attachment\" \"ssm_service_role_policy\" {\n"], [203, "  role       = aws_iam_role.ssm_service_role.name\n"], [204, "  policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonSSMMaintenanceWindowRole\"\n"], [205, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [202, 205], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role_policy_attachment.ssm_service_role_policy", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"ec2_instance_role": {"__end_line__": 229, "__start_line__": 208, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Effect": "Allow", "Principal": {"Service": "ec2.amazonaws.com"}}]}], "name": ["ecs-jenkins-dr-ec2-instance-role"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-ec2-instance-role", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.ec2_instance_role"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[208, "resource \"aws_iam_role\" \"ec2_instance_role\" {\n"], [209, "  name = \"${var.project}-${var.environment}-ec2-instance-role\"\n"], [210, "\n"], [211, "  assume_role_policy = jsonencode({\n"], [212, "    Version = \"2012-10-17\"\n"], [213, "    Statement = [\n"], [214, "      {\n"], [215, "        Action = \"sts:AssumeRole\"\n"], [216, "        Effect = \"Allow\"\n"], [217, "        Principal = {\n"], [218, "          Service = \"ec2.amazonaws.com\"\n"], [219, "        }\n"], [220, "      }\n"], [221, "    ]\n"], [222, "  })\n"], [223, "\n"], [224, "  tags = {\n"], [225, "    Name        = \"${var.project}-${var.environment}-ec2-instance-role\"\n"], [226, "    Environment = var.environment\n"], [227, "    Project     = var.project\n"], [228, "  }\n"], [229, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [208, 229], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.ec2_instance_role", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-ec2-instance-role", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy_attachment": {"ec2_ssm_policy": {"__end_line__": 235, "__start_line__": 232, "policy_arn": ["arn:aws:iam::aws:policy/AmazonSSMManagedInstanceCore"], "role": ["ecs-jenkins-dr-ec2-instance-role"], "__address__": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role_policy_attachment.ec2_ssm_policy"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[232, "resource \"aws_iam_role_policy_attachment\" \"ec2_ssm_policy\" {\n"], [233, "  role       = aws_iam_role.ec2_instance_role.name\n"], [234, "  policy_arn = \"arn:aws:iam::aws:policy/AmazonSSMManagedInstanceCore\"\n"], [235, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [232, 235], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role_policy_attachment.ec2_ssm_policy", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy_attachment": {"ec2_ecs_policy": {"__end_line__": 240, "__start_line__": 237, "policy_arn": ["arn:aws:iam::aws:policy/service-role/AmazonEC2ContainerServiceforEC2Role"], "role": ["ecs-jenkins-dr-ec2-instance-role"], "__address__": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role_policy_attachment.ec2_ecs_policy"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[237, "resource \"aws_iam_role_policy_attachment\" \"ec2_ecs_policy\" {\n"], [238, "  role       = aws_iam_role.ec2_instance_role.name\n"], [239, "  policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonEC2ContainerServiceforEC2Role\"\n"], [240, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [237, 240], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role_policy_attachment.ec2_ecs_policy", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"codedeploy_role": {"__end_line__": 269, "__start_line__": 248, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Effect": "Allow", "Principal": {"Service": "codedeploy.amazonaws.com"}}]}], "name": ["ecs-jenkins-dr-codedeploy-role"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-codedeploy-role", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.codedeploy_role"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[248, "resource \"aws_iam_role\" \"codedeploy_role\" {\n"], [249, "  name = \"${var.project}-${var.environment}-codedeploy-role\"\n"], [250, "\n"], [251, "  assume_role_policy = jsonencode({\n"], [252, "    Version = \"2012-10-17\"\n"], [253, "    Statement = [\n"], [254, "      {\n"], [255, "        Action = \"sts:AssumeRole\"\n"], [256, "        Effect = \"Allow\"\n"], [257, "        Principal = {\n"], [258, "          Service = \"codedeploy.amazonaws.com\"\n"], [259, "        }\n"], [260, "      }\n"], [261, "    ]\n"], [262, "  })\n"], [263, "\n"], [264, "  tags = {\n"], [265, "    Name        = \"${var.project}-${var.environment}-codedeploy-role\"\n"], [266, "    Environment = var.environment\n"], [267, "    Project     = var.project\n"], [268, "  }\n"], [269, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [248, 269], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role.codedeploy_role", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-codedeploy-role", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy_attachment": {"codedeploy_policy": {"__end_line__": 274, "__start_line__": 271, "policy_arn": ["arn:aws:iam::aws:policy/AWSCodeDeployRoleForECS"], "role": ["ecs-jenkins-dr-codedeploy-role"], "__address__": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role_policy_attachment.codedeploy_policy"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[271, "resource \"aws_iam_role_policy_attachment\" \"codedeploy_policy\" {\n"], [272, "  role       = aws_iam_role.codedeploy_role.name\n"], [273, "  policy_arn = \"arn:aws:iam::aws:policy/AWSCodeDeployRoleForECS\"\n"], [274, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [271, 274], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_role_policy_attachment.codedeploy_policy", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"replication": {"__end_line__": 174, "__start_line__": 159, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Effect": "Allow", "Principal": {"Service": "s3.amazonaws.com"}}]}], "name": ["s3-replication-role-prod"], "__address__": "module.ecs_jenkins_github.module.network.aws_iam_role.replication"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[159, "resource \"aws_iam_role\" \"replication\" {\n"], [160, "  name = \"s3-replication-role-${var.environment}\"\n"], [161, "\n"], [162, "  assume_role_policy = jsonencode({\n"], [163, "    Version = \"2012-10-17\"\n"], [164, "    Statement = [\n"], [165, "      {\n"], [166, "        Action = \"sts:AssumeRole\"\n"], [167, "        Effect = \"Allow\"\n"], [168, "        Principal = {\n"], [169, "          Service = \"s3.amazonaws.com\"\n"], [170, "        }\n"], [171, "      },\n"], [172, "    ]\n"], [173, "  })\n"], [174, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [159, 174], "resource": "module.ecs_jenkins_github.module.network.aws_iam_role.replication", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"vpc_flow_logs_role": {"__end_line__": 440, "__start_line__": 425, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Effect": "Allow", "Principal": {"Service": "vpc-flow-logs.amazonaws.com"}}]}], "name": ["vpc-flow-logs-role"], "__address__": "module.ecs_jenkins_github.module.network.aws_iam_role.vpc_flow_logs_role"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[425, "resource \"aws_iam_role\" \"vpc_flow_logs_role\" {\n"], [426, "  name = \"vpc-flow-logs-role\"\n"], [427, "\n"], [428, "  assume_role_policy = jsonencode({\n"], [429, "    Version = \"2012-10-17\"\n"], [430, "    Statement = [\n"], [431, "      {\n"], [432, "        Action = \"sts:AssumeRole\"\n"], [433, "        Effect = \"Allow\"\n"], [434, "        Principal = {\n"], [435, "          Service = \"vpc-flow-logs.amazonaws.com\"\n"], [436, "        }\n"], [437, "      }\n"], [438, "    ]\n"], [439, "  })\n"], [440, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [425, 440], "resource": "module.ecs_jenkins_github.module.network.aws_iam_role.vpc_flow_logs_role", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"replication": {"__end_line__": 174, "__start_line__": 159, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Effect": "Allow", "Principal": {"Service": "s3.amazonaws.com"}}]}], "name": ["s3-replication-role-dr"], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_iam_role.replication"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[159, "resource \"aws_iam_role\" \"replication\" {\n"], [160, "  name = \"s3-replication-role-${var.environment}\"\n"], [161, "\n"], [162, "  assume_role_policy = jsonencode({\n"], [163, "    Version = \"2012-10-17\"\n"], [164, "    Statement = [\n"], [165, "      {\n"], [166, "        Action = \"sts:AssumeRole\"\n"], [167, "        Effect = \"Allow\"\n"], [168, "        Principal = {\n"], [169, "          Service = \"s3.amazonaws.com\"\n"], [170, "        }\n"], [171, "      },\n"], [172, "    ]\n"], [173, "  })\n"], [174, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [159, 174], "resource": "module.ecs_jenkins_github_dr.module.network.aws_iam_role.replication", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"vpc_flow_logs_role": {"__end_line__": 440, "__start_line__": 425, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Effect": "Allow", "Principal": {"Service": "vpc-flow-logs.amazonaws.com"}}]}], "name": ["vpc-flow-logs-role"], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_iam_role.vpc_flow_logs_role"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[425, "resource \"aws_iam_role\" \"vpc_flow_logs_role\" {\n"], [426, "  name = \"vpc-flow-logs-role\"\n"], [427, "\n"], [428, "  assume_role_policy = jsonencode({\n"], [429, "    Version = \"2012-10-17\"\n"], [430, "    Statement = [\n"], [431, "      {\n"], [432, "        Action = \"sts:AssumeRole\"\n"], [433, "        Effect = \"Allow\"\n"], [434, "        Principal = {\n"], [435, "          Service = \"vpc-flow-logs.amazonaws.com\"\n"], [436, "        }\n"], [437, "      }\n"], [438, "    ]\n"], [439, "  })\n"], [440, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [425, 440], "resource": "module.ecs_jenkins_github_dr.module.network.aws_iam_role.vpc_flow_logs_role", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"config_role": {"__end_line__": 394, "__start_line__": 373, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Effect": "Allow", "Principal": {"Service": "config.amazonaws.com"}}]}], "name": ["ecs-jenkins-prod-config-role"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-config-role", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.security.aws_iam_role.config_role"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[373, "resource \"aws_iam_role\" \"config_role\" {\n"], [374, "  name = \"${var.project}-${var.environment}-config-role\"\n"], [375, "\n"], [376, "  assume_role_policy = jsonencode({\n"], [377, "    Version = \"2012-10-17\"\n"], [378, "    Statement = [\n"], [379, "      {\n"], [380, "        Action = \"sts:AssumeRole\"\n"], [381, "        Effect = \"Allow\"\n"], [382, "        Principal = {\n"], [383, "          Service = \"config.amazonaws.com\"\n"], [384, "        }\n"], [385, "      }\n"], [386, "    ]\n"], [387, "  })\n"], [388, "\n"], [389, "  tags = {\n"], [390, "    Name        = \"${var.project}-${var.environment}-config-role\"\n"], [391, "    Environment = var.environment\n"], [392, "    Project     = var.project\n"], [393, "  }\n"], [394, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [373, 394], "resource": "module.ecs_jenkins_github.module.security.aws_iam_role.config_role", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-config-role", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"config_role": {"__end_line__": 394, "__start_line__": 373, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Effect": "Allow", "Principal": {"Service": "config.amazonaws.com"}}]}], "name": ["ecs-jenkins-dr-config-role"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-config-role", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.security.aws_iam_role.config_role"}}}, "evaluated_keys": ["policy_arn", "name", "managed_policy_arns/*", "arn", "managed_policy_arn"]}, "code_block": [[373, "resource \"aws_iam_role\" \"config_role\" {\n"], [374, "  name = \"${var.project}-${var.environment}-config-role\"\n"], [375, "\n"], [376, "  assume_role_policy = jsonencode({\n"], [377, "    Version = \"2012-10-17\"\n"], [378, "    Statement = [\n"], [379, "      {\n"], [380, "        Action = \"sts:AssumeRole\"\n"], [381, "        Effect = \"Allow\"\n"], [382, "        Principal = {\n"], [383, "          Service = \"config.amazonaws.com\"\n"], [384, "        }\n"], [385, "      }\n"], [386, "    ]\n"], [387, "  })\n"], [388, "\n"], [389, "  tags = {\n"], [390, "    Name        = \"${var.project}-${var.environment}-config-role\"\n"], [391, "    Environment = var.environment\n"], [392, "    Project     = var.project\n"], [393, "  }\n"], [394, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [373, 394], "resource": "module.ecs_jenkins_github_dr.module.security.aws_iam_role.config_role", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-config-role", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV2_AWS_75", "bc_check_id": "BC_AWS_NETWORKING_105", "check_name": "Ensure no open CORS policy", "check_result": {"result": "PASSED", "entity": {"aws_lambda_function": {"failover_lambda": {"__end_line__": 270, "__start_line__": 240, "description": ["Lambda function to test and manage failover between primary and DR regions"], "environment": [{"variables": [{"DR_ASG_NAME": "var.dr_asg_name", "DR_HEALTH_CHECK_ID": "aws_route53_health_check.dr.id", "DR_REGION": "var.dr_region", "FAILOVER_MODE": "test", "PRIMARY_ASG_NAME": "var.primary_asg_name", "PRIMARY_HEALTH_CHECK_ID": "aws_route53_health_check.primary.id", "PRIMARY_REGION": "var.primary_region", "SNS_TOPIC_ARN": "aws_sns_topic.failover_notifications.arn"}]}], "function_name": ["${var.project}-${var.environment}-failover-test"], "handler": ["lambda_function.lambda_handler"], "memory_size": [128], "role": ["aws_iam_role.lambda_role.arn"], "runtime": ["python3.9"], "s3_bucket": ["aws_s3_bucket.lambda_code.id"], "s3_key": ["failover_lambda.zip"], "tags": [{"Environment": "var.environment", "Name": "${var.project}-${var.environment}-failover-lambda", "Project": "var.project"}], "timeout": [900], "__address__": "module.lambda_failover.aws_lambda_function.failover_lambda"}}}, "evaluated_keys": ["cors/allow_origins", "resource_type", "cors/allow_methods"]}, "code_block": [[240, "resource \"aws_lambda_function\" \"failover_lambda\" {\n"], [241, "  function_name = \"${var.project}-${var.environment}-failover-test\"\n"], [242, "  description   = \"Lambda function to test and manage failover between primary and DR regions\"\n"], [243, "  role          = aws_iam_role.lambda_role.arn\n"], [244, "  handler       = \"lambda_function.lambda_handler\"\n"], [245, "  runtime       = \"python3.9\"\n"], [246, "  timeout       = 900 # 15 minutes\n"], [247, "  memory_size   = 128\n"], [248, "\n"], [249, "  s3_bucket = aws_s3_bucket.lambda_code.id\n"], [250, "  s3_key    = aws_s3_object.lambda_code.key\n"], [251, "\n"], [252, "  environment {\n"], [253, "    variables = {\n"], [254, "      PRIMARY_HEALTH_CHECK_ID = var.primary_health_check_id\n"], [255, "      DR_HEALTH_CHECK_ID      = var.dr_health_check_id\n"], [256, "      PRIMARY_ASG_NAME        = var.primary_asg_name\n"], [257, "      DR_ASG_NAME             = var.dr_asg_name\n"], [258, "      PRIMARY_REGION          = var.primary_region\n"], [259, "      DR_REGION               = var.dr_region\n"], [260, "      SNS_TOPIC_ARN           = var.sns_topic_arn\n"], [261, "      FAILOVER_MODE           = \"test\" # Default mode\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "  tags = {\n"], [266, "    Name        = \"${var.project}-${var.environment}-failover-lambda\"\n"], [267, "    Environment = var.environment\n"], [268, "    Project     = var.project\n"], [269, "  }\n"], [270, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [240, 270], "resource": "module.lambda_failover.aws_lambda_function.failover_lambda", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Name": "${var.project}-${var.environment}-failover-lambda", "Project": "var.project"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-75", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV2_AWS_74", "bc_check_id": "BC_AWS_NETWORKING_104", "check_name": "Ensure AWS Load Balancers use strong ciphers", "check_result": {"result": "PASSED", "entity": {"aws_lb_listener": {"jenkins": {"__end_line__": 228, "__start_line__": 219, "default_action": [{"target_group_arn": ["aws_lb_target_group.jenkins.arn"], "type": ["forward"]}], "load_balancer_arn": ["aws_lb.jenkins_nlb.arn"], "port": [80], "protocol": ["TCP"], "__address__": "module.ecs_jenkins_github.module.cicd.aws_lb_listener.jenkins"}}}, "evaluated_keys": ["ssl_policy", "protocol"]}, "code_block": [[219, "resource \"aws_lb_listener\" \"jenkins\" {\n"], [220, "  load_balancer_arn = aws_lb.jenkins_nlb.arn\n"], [221, "  port              = 80\n"], [222, "  protocol          = \"TCP\"\n"], [223, "\n"], [224, "  default_action {\n"], [225, "    type             = \"forward\"\n"], [226, "    target_group_arn = aws_lb_target_group.jenkins.arn\n"], [227, "  }\n"], [228, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [219, 228], "resource": "module.ecs_jenkins_github.module.cicd.aws_lb_listener.jenkins", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-74", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV2_AWS_74", "bc_check_id": "BC_AWS_NETWORKING_104", "check_name": "Ensure AWS Load Balancers use strong ciphers", "check_result": {"result": "PASSED", "entity": {"aws_lb_listener": {"jenkins": {"__end_line__": 228, "__start_line__": 219, "default_action": [{"target_group_arn": ["aws_lb_target_group.jenkins.arn"], "type": ["forward"]}], "load_balancer_arn": ["aws_lb.jenkins_nlb.arn"], "port": [80], "protocol": ["TCP"], "__address__": "module.ecs_jenkins_github_dr.module.cicd.aws_lb_listener.jenkins"}}}, "evaluated_keys": ["ssl_policy", "protocol"]}, "code_block": [[219, "resource \"aws_lb_listener\" \"jenkins\" {\n"], [220, "  load_balancer_arn = aws_lb.jenkins_nlb.arn\n"], [221, "  port              = 80\n"], [222, "  protocol          = \"TCP\"\n"], [223, "\n"], [224, "  default_action {\n"], [225, "    type             = \"forward\"\n"], [226, "    target_group_arn = aws_lb_target_group.jenkins.arn\n"], [227, "  }\n"], [228, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [219, 228], "resource": "module.ecs_jenkins_github_dr.module.cicd.aws_lb_listener.jenkins", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-74", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV2_AWS_74", "bc_check_id": "BC_AWS_NETWORKING_104", "check_name": "Ensure AWS Load Balancers use strong ciphers", "check_result": {"result": "PASSED", "entity": {"aws_lb_listener": {"http": {"__end_line__": 87, "__start_line__": 72, "default_action": [{"target_group_arn": ["aws_lb_target_group.target_group.arn"], "type": ["forward"]}], "load_balancer_arn": ["aws_lb.alb.arn"], "port": [80], "protocol": ["HTTP"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-http-listener", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.ecs.aws_lb_listener.http"}}}, "evaluated_keys": ["ssl_policy", "protocol"]}, "code_block": [[72, "resource \"aws_lb_listener\" \"http\" {\n"], [73, "  load_balancer_arn = aws_lb.alb.arn\n"], [74, "  port              = 80\n"], [75, "  protocol          = \"HTTP\"\n"], [76, "\n"], [77, "  default_action {\n"], [78, "    type             = \"forward\"\n"], [79, "    target_group_arn = aws_lb_target_group.target_group.arn\n"], [80, "  }\n"], [81, "\n"], [82, "  tags = {\n"], [83, "    Name        = \"${var.project}-${var.environment}-http-listener\"\n"], [84, "    Environment = var.environment\n"], [85, "    Project     = var.project\n"], [86, "  }\n"], [87, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [72, 87], "resource": "module.ecs_jenkins_github.module.ecs.aws_lb_listener.http", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-http-listener", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-74", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV2_AWS_74", "bc_check_id": "BC_AWS_NETWORKING_104", "check_name": "Ensure AWS Load Balancers use strong ciphers", "check_result": {"result": "PASSED", "entity": {"aws_lb_listener": {"https[0]": {"__end_line__": 276, "__start_line__": 256, "certificate_arn": ["aws_acm_certificate.cert[0].arn"], "default_action": [{"target_group_arn": ["aws_lb_target_group.target_group.arn"], "type": ["forward"]}], "load_balancer_arn": ["aws_lb.alb.arn"], "port": [443], "protocol": ["HTTPS"], "ssl_policy": ["ELBSecurityPolicy-TLS-1-2-2017-01"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-https", "Project": "ecs-jenkins", "SecurityCompliance": "OWASP-TLS-1.2"}], "__address__": "module.ecs_jenkins_github.module.ecs.aws_lb_listener.https[0]"}}}, "evaluated_keys": ["ssl_policy", "protocol"]}, "code_block": [[256, "resource \"aws_lb_listener\" \"https\" {\n"], [257, "  count             = var.create_dummy_cert ? 1 : 0\n"], [258, "  load_balancer_arn = aws_lb.alb.arn\n"], [259, "  port              = 443\n"], [260, "  protocol          = \"HTTPS\"\n"], [261, "  # Use a more secure SSL policy that requires TLS 1.2 minimum (OWASP recommendation)\n"], [262, "  ssl_policy      = \"ELBSecurityPolicy-TLS-1-2-2017-01\"\n"], [263, "  certificate_arn = aws_acm_certificate.cert[0].arn\n"], [264, "\n"], [265, "  default_action {\n"], [266, "    type             = \"forward\"\n"], [267, "    target_group_arn = aws_lb_target_group.target_group.arn\n"], [268, "  }\n"], [269, "\n"], [270, "  tags = {\n"], [271, "    Name               = \"${var.project}-${var.environment}-https\"\n"], [272, "    Environment        = var.environment\n"], [273, "    Project            = var.project\n"], [274, "    SecurityCompliance = \"OWASP-TLS-1.2\"\n"], [275, "  }\n"], [276, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [256, 276], "resource": "module.ecs_jenkins_github.module.ecs.aws_lb_listener.https[0]", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-https", "Project": "ecs-jenkins", "SecurityCompliance": "OWASP-TLS-1.2"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-74", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV2_AWS_74", "bc_check_id": "BC_AWS_NETWORKING_104", "check_name": "Ensure AWS Load Balancers use strong ciphers", "check_result": {"result": "PASSED", "entity": {"aws_lb_listener": {"http_redirect": {"__end_line__": 305, "__start_line__": 279, "default_action": [{"redirect": [{"port": ["443"], "protocol": ["HTTPS"], "status_code": ["HTTP_301"]}], "type": ["redirect"]}], "lifecycle": [{"ignore_changes": [["default_action"]]}], "load_balancer_arn": ["aws_lb.alb.arn"], "port": [80], "protocol": ["HTTP"], "tags": [{"Environment": "prod", "ManagedBy": "Terraform", "Name": "ecs-jenkins-prod-http-redirect", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.ecs.aws_lb_listener.http_redirect"}}}, "evaluated_keys": ["ssl_policy", "protocol"]}, "code_block": [[279, "resource \"aws_lb_listener\" \"http_redirect\" {\n"], [280, "  load_balancer_arn = aws_lb.alb.arn\n"], [281, "  port              = 80\n"], [282, "  protocol          = \"HTTP\"\n"], [283, "\n"], [284, "  default_action {\n"], [285, "    type = \"redirect\"\n"], [286, "\n"], [287, "    redirect {\n"], [288, "      port        = \"443\"\n"], [289, "      protocol    = \"HTTPS\"\n"], [290, "      status_code = \"HTTP_301\"\n"], [291, "    }\n"], [292, "  }\n"], [293, "\n"], [294, "  # Add security headers via response headers policy\n"], [295, "  lifecycle {\n"], [296, "    ignore_changes = [default_action]\n"], [297, "  }\n"], [298, "\n"], [299, "  tags = {\n"], [300, "    Name        = \"${var.project}-${var.environment}-http-redirect\"\n"], [301, "    Environment = var.environment\n"], [302, "    Project     = var.project\n"], [303, "    ManagedBy   = \"Terraform\"\n"], [304, "  }\n"], [305, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [279, 305], "resource": "module.ecs_jenkins_github.module.ecs.aws_lb_listener.http_redirect", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "ManagedBy": "Terraform", "Name": "ecs-jenkins-prod-http-redirect", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-74", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV2_AWS_74", "bc_check_id": "BC_AWS_NETWORKING_104", "check_name": "Ensure AWS Load Balancers use strong ciphers", "check_result": {"result": "PASSED", "entity": {"aws_lb_listener": {"http": {"__end_line__": 87, "__start_line__": 72, "default_action": [{"target_group_arn": ["aws_lb_target_group.target_group.arn"], "type": ["forward"]}], "load_balancer_arn": ["aws_lb.alb.arn"], "port": [80], "protocol": ["HTTP"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-http-listener", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.ecs.aws_lb_listener.http"}}}, "evaluated_keys": ["ssl_policy", "protocol"]}, "code_block": [[72, "resource \"aws_lb_listener\" \"http\" {\n"], [73, "  load_balancer_arn = aws_lb.alb.arn\n"], [74, "  port              = 80\n"], [75, "  protocol          = \"HTTP\"\n"], [76, "\n"], [77, "  default_action {\n"], [78, "    type             = \"forward\"\n"], [79, "    target_group_arn = aws_lb_target_group.target_group.arn\n"], [80, "  }\n"], [81, "\n"], [82, "  tags = {\n"], [83, "    Name        = \"${var.project}-${var.environment}-http-listener\"\n"], [84, "    Environment = var.environment\n"], [85, "    Project     = var.project\n"], [86, "  }\n"], [87, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [72, 87], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_lb_listener.http", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-http-listener", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-74", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV2_AWS_74", "bc_check_id": "BC_AWS_NETWORKING_104", "check_name": "Ensure AWS Load Balancers use strong ciphers", "check_result": {"result": "PASSED", "entity": {"aws_lb_listener": {"https[0]": {"__end_line__": 276, "__start_line__": 256, "certificate_arn": ["aws_acm_certificate.cert[0].arn"], "default_action": [{"target_group_arn": ["aws_lb_target_group.target_group.arn"], "type": ["forward"]}], "load_balancer_arn": ["aws_lb.alb.arn"], "port": [443], "protocol": ["HTTPS"], "ssl_policy": ["ELBSecurityPolicy-TLS-1-2-2017-01"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-https", "Project": "ecs-jenkins", "SecurityCompliance": "OWASP-TLS-1.2"}], "__address__": "module.ecs_jenkins_github_dr.module.ecs.aws_lb_listener.https[0]"}}}, "evaluated_keys": ["ssl_policy", "protocol"]}, "code_block": [[256, "resource \"aws_lb_listener\" \"https\" {\n"], [257, "  count             = var.create_dummy_cert ? 1 : 0\n"], [258, "  load_balancer_arn = aws_lb.alb.arn\n"], [259, "  port              = 443\n"], [260, "  protocol          = \"HTTPS\"\n"], [261, "  # Use a more secure SSL policy that requires TLS 1.2 minimum (OWASP recommendation)\n"], [262, "  ssl_policy      = \"ELBSecurityPolicy-TLS-1-2-2017-01\"\n"], [263, "  certificate_arn = aws_acm_certificate.cert[0].arn\n"], [264, "\n"], [265, "  default_action {\n"], [266, "    type             = \"forward\"\n"], [267, "    target_group_arn = aws_lb_target_group.target_group.arn\n"], [268, "  }\n"], [269, "\n"], [270, "  tags = {\n"], [271, "    Name               = \"${var.project}-${var.environment}-https\"\n"], [272, "    Environment        = var.environment\n"], [273, "    Project            = var.project\n"], [274, "    SecurityCompliance = \"OWASP-TLS-1.2\"\n"], [275, "  }\n"], [276, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [256, 276], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_lb_listener.https[0]", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-https", "Project": "ecs-jenkins", "SecurityCompliance": "OWASP-TLS-1.2"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-74", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV2_AWS_74", "bc_check_id": "BC_AWS_NETWORKING_104", "check_name": "Ensure AWS Load Balancers use strong ciphers", "check_result": {"result": "PASSED", "entity": {"aws_lb_listener": {"http_redirect": {"__end_line__": 305, "__start_line__": 279, "default_action": [{"redirect": [{"port": ["443"], "protocol": ["HTTPS"], "status_code": ["HTTP_301"]}], "type": ["redirect"]}], "lifecycle": [{"ignore_changes": [["default_action"]]}], "load_balancer_arn": ["aws_lb.alb.arn"], "port": [80], "protocol": ["HTTP"], "tags": [{"Environment": "dr", "ManagedBy": "Terraform", "Name": "ecs-jenkins-dr-http-redirect", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.ecs.aws_lb_listener.http_redirect"}}}, "evaluated_keys": ["ssl_policy", "protocol"]}, "code_block": [[279, "resource \"aws_lb_listener\" \"http_redirect\" {\n"], [280, "  load_balancer_arn = aws_lb.alb.arn\n"], [281, "  port              = 80\n"], [282, "  protocol          = \"HTTP\"\n"], [283, "\n"], [284, "  default_action {\n"], [285, "    type = \"redirect\"\n"], [286, "\n"], [287, "    redirect {\n"], [288, "      port        = \"443\"\n"], [289, "      protocol    = \"HTTPS\"\n"], [290, "      status_code = \"HTTP_301\"\n"], [291, "    }\n"], [292, "  }\n"], [293, "\n"], [294, "  # Add security headers via response headers policy\n"], [295, "  lifecycle {\n"], [296, "    ignore_changes = [default_action]\n"], [297, "  }\n"], [298, "\n"], [299, "  tags = {\n"], [300, "    Name        = \"${var.project}-${var.environment}-http-redirect\"\n"], [301, "    Environment = var.environment\n"], [302, "    Project     = var.project\n"], [303, "    ManagedBy   = \"Terraform\"\n"], [304, "  }\n"], [305, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [279, 305], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_lb_listener.http_redirect", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "ManagedBy": "Terraform", "Name": "ecs-jenkins-dr-http-redirect", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-74", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV2_AWS_19", "bc_check_id": "BC_AWS_NETWORKING_48", "check_name": "Ensure that all EIP addresses allocated to a VPC are attached to EC2 instances", "check_result": {"result": "PASSED", "entity": {"aws_eip": {"nat_eip": {"__end_line__": 59, "__start_line__": 53, "domain": ["vpc"], "tags": [{"Name": "nat-eip"}], "__address__": "module.ecs_jenkins_github.module.network.aws_eip.nat_eip"}}}, "evaluated_keys": ["instance_id", "vpc", "resource_type", "domain", "instance"]}, "code_block": [[53, "resource \"aws_eip\" \"nat_eip\" {\n"], [54, "  domain = \"vpc\"\n"], [55, "\n"], [56, "  tags = {\n"], [57, "    Name = \"nat-eip\"\n"], [58, "  }\n"], [59, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [53, 59], "resource": "module.ecs_jenkins_github.module.network.aws_eip.nat_eip", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "nat-eip"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[61, "resource \"aws_nat_gateway\" \"nat_gateway\" {\n"], [62, "  allocation_id = aws_eip.nat_eip.id\n"], [63, "  subnet_id     = aws_subnet.public_subnet[0].id\n"], [64, "\n"], [65, "  tags = {\n"], [66, "    Name = \"main-nat-gateway\"\n"], [67, "  }\n"], [68, "}\n"]], "file_path": "\\..\\network\\main.tf", "file_line_range": [61, 68], "resource": "aws_nat_gateway.nat_gateway", "entity_tags": {"Name": "main-nat-gateway"}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-all-eip-addresses-allocated-to-a-vpc-are-attached-to-ec2-instances", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_19", "bc_check_id": "BC_AWS_NETWORKING_48", "check_name": "Ensure that all EIP addresses allocated to a VPC are attached to EC2 instances", "check_result": {"result": "PASSED", "entity": {"aws_eip": {"nat_eip": {"__end_line__": 59, "__start_line__": 53, "domain": ["vpc"], "tags": [{"Name": "nat-eip"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_eip.nat_eip"}}}, "evaluated_keys": ["instance_id", "vpc", "resource_type", "domain", "instance"]}, "code_block": [[53, "resource \"aws_eip\" \"nat_eip\" {\n"], [54, "  domain = \"vpc\"\n"], [55, "\n"], [56, "  tags = {\n"], [57, "    Name = \"nat-eip\"\n"], [58, "  }\n"], [59, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [53, 59], "resource": "module.ecs_jenkins_github_dr.module.network.aws_eip.nat_eip", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "nat-eip"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[61, "resource \"aws_nat_gateway\" \"nat_gateway\" {\n"], [62, "  allocation_id = aws_eip.nat_eip.id\n"], [63, "  subnet_id     = aws_subnet.public_subnet[0].id\n"], [64, "\n"], [65, "  tags = {\n"], [66, "    Name = \"main-nat-gateway\"\n"], [67, "  }\n"], [68, "}\n"]], "file_path": "\\main.tf", "file_line_range": [61, 68], "resource": "aws_nat_gateway.nat_gateway", "entity_tags": {"Name": "main-nat-gateway"}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-all-eip-addresses-allocated-to-a-vpc-are-attached-to-ec2-instances", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_40", "bc_check_id": "BC_AWS_IAM_73", "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "PASSED", "entity": {"aws_iam_policy": {"jenkins_ecs_policy": {"__end_line__": 122, "__start_line__": 82, "description": ["Policy to allow Jenkins to deploy to ECS"], "name": ["ecs-jenkins-prod-jenkins-ecs-policy"], "policy": [{"Version": "2012-10-17", "Statement": [{"Action": ["ecs:DescribeTaskDefinition", "ecs:RegisterTaskDefinition", "ecs:UpdateService", "ecs:DescribeServices", "ecr:GetAuthorizationToken", "ecr:BatchCheckLayerAvailability", "ecr:GetDownloadUrlForLayer", "ecr:BatchGetImage", "ecr:InitiateLayerUpload", "ecr:UploadLayerPart", "ecr:CompleteLayerUpload", "ecr:PutImage"], "Effect": "Allow", "Resource": "*"}, {"Action": ["iam:PassRole"], "Effect": "Allow", "Resource": "*"}]}], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-ecs-policy", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.iam.aws_iam_policy.jenkins_ecs_policy"}}}, "evaluated_keys": ["policy/Statement[?(@/Effect == Allow)]/Action[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]", "statement[?(@/effect == Allow)]/actions[*]"]}, "code_block": [[82, "resource \"aws_iam_policy\" \"jenkins_ecs_policy\" {\n"], [83, "  name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [84, "  description = \"Policy to allow Jenkins to deploy to ECS\"\n"], [85, "\n"], [86, "  policy = jsonencode({\n"], [87, "    Version = \"2012-10-17\",\n"], [88, "    Statement = [\n"], [89, "      {\n"], [90, "        Action = [\n"], [91, "          \"ecs:DescribeTaskDefinition\",\n"], [92, "          \"ecs:RegisterTaskDefinition\",\n"], [93, "          \"ecs:UpdateService\",\n"], [94, "          \"ecs:DescribeServices\",\n"], [95, "          \"ecr:GetAuthorizationToken\",\n"], [96, "          \"ecr:BatchCheckLayerAvailability\",\n"], [97, "          \"ecr:GetDownloadUrlForLayer\",\n"], [98, "          \"ecr:BatchGetImage\",\n"], [99, "          \"ecr:InitiateLayerUpload\",\n"], [100, "          \"ecr:UploadLayerPart\",\n"], [101, "          \"ecr:CompleteLayerUpload\",\n"], [102, "          \"ecr:PutImage\"\n"], [103, "        ],\n"], [104, "        Effect   = \"Allow\",\n"], [105, "        Resource = \"*\"\n"], [106, "      },\n"], [107, "      {\n"], [108, "        Action = [\n"], [109, "          \"iam:PassRole\"\n"], [110, "        ],\n"], [111, "        Effect   = \"Allow\",\n"], [112, "        Resource = \"*\"\n"], [113, "      }\n"], [114, "    ]\n"], [115, "  })\n"], [116, "\n"], [117, "  tags = {\n"], [118, "    Name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [119, "    Environment = var.environment\n"], [120, "    Project     = var.project\n"], [121, "  }\n"], [122, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [82, 122], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_policy.jenkins_ecs_policy", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-ecs-policy", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-40", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV2_AWS_40", "bc_check_id": "BC_AWS_IAM_73", "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "PASSED", "entity": {"aws_iam_policy": {"prometheus_discovery": {"__end_line__": 150, "__start_line__": 128, "description": ["Allow Prometheus to discover EC2 and ECS targets"], "name": ["prometheus-discovery"], "policy": [{"Version": "2012-10-17", "Statement": [{"Action": ["ec2:DescribeInstances", "ec2:DescribeTags", "ecs:ListTasks", "ecs:DescribeTasks", "ecs:ListServices", "ecs:DescribeServices", "ecs:DescribeTaskDefinition"], "Effect": "Allow", "Resource": "*"}]}], "__address__": "module.ecs_jenkins_github.module.iam.aws_iam_policy.prometheus_discovery"}}}, "evaluated_keys": ["policy/Statement[?(@/Effect == Allow)]/Action[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]", "statement[?(@/effect == Allow)]/actions[*]"]}, "code_block": [[128, "resource \"aws_iam_policy\" \"prometheus_discovery\" {\n"], [129, "  name        = \"prometheus-discovery\"\n"], [130, "  description = \"Allow Prometheus to discover EC2 and ECS targets\"\n"], [131, "\n"], [132, "  policy = jsonencode({\n"], [133, "    Version = \"2012-10-17\"\n"], [134, "    Statement = [\n"], [135, "      {\n"], [136, "        Action = [\n"], [137, "          \"ec2:DescribeInstances\",\n"], [138, "          \"ec2:DescribeTags\",\n"], [139, "          \"ecs:ListTasks\",\n"], [140, "          \"ecs:DescribeTasks\",\n"], [141, "          \"ecs:ListServices\",\n"], [142, "          \"ecs:DescribeServices\",\n"], [143, "          \"ecs:DescribeTaskDefinition\"\n"], [144, "        ]\n"], [145, "        Effect   = \"Allow\"\n"], [146, "        Resource = \"*\"\n"], [147, "      }\n"], [148, "    ]\n"], [149, "  })\n"], [150, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [128, 150], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_policy.prometheus_discovery", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-40", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV2_AWS_40", "bc_check_id": "BC_AWS_IAM_73", "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "PASSED", "entity": {"aws_iam_policy": {"jenkins_ecs_policy": {"__end_line__": 122, "__start_line__": 82, "description": ["Policy to allow Jenkins to deploy to ECS"], "name": ["ecs-jenkins-dr-jenkins-ecs-policy"], "policy": [{"Version": "2012-10-17", "Statement": [{"Action": ["ecs:DescribeTaskDefinition", "ecs:RegisterTaskDefinition", "ecs:UpdateService", "ecs:DescribeServices", "ecr:GetAuthorizationToken", "ecr:BatchCheckLayerAvailability", "ecr:GetDownloadUrlForLayer", "ecr:BatchGetImage", "ecr:InitiateLayerUpload", "ecr:UploadLayerPart", "ecr:CompleteLayerUpload", "ecr:PutImage"], "Effect": "Allow", "Resource": "*"}, {"Action": ["iam:PassRole"], "Effect": "Allow", "Resource": "*"}]}], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-ecs-policy", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.iam.aws_iam_policy.jenkins_ecs_policy"}}}, "evaluated_keys": ["policy/Statement[?(@/Effect == Allow)]/Action[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]", "statement[?(@/effect == Allow)]/actions[*]"]}, "code_block": [[82, "resource \"aws_iam_policy\" \"jenkins_ecs_policy\" {\n"], [83, "  name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [84, "  description = \"Policy to allow Jenkins to deploy to ECS\"\n"], [85, "\n"], [86, "  policy = jsonencode({\n"], [87, "    Version = \"2012-10-17\",\n"], [88, "    Statement = [\n"], [89, "      {\n"], [90, "        Action = [\n"], [91, "          \"ecs:DescribeTaskDefinition\",\n"], [92, "          \"ecs:RegisterTaskDefinition\",\n"], [93, "          \"ecs:UpdateService\",\n"], [94, "          \"ecs:DescribeServices\",\n"], [95, "          \"ecr:GetAuthorizationToken\",\n"], [96, "          \"ecr:BatchCheckLayerAvailability\",\n"], [97, "          \"ecr:GetDownloadUrlForLayer\",\n"], [98, "          \"ecr:BatchGetImage\",\n"], [99, "          \"ecr:InitiateLayerUpload\",\n"], [100, "          \"ecr:UploadLayerPart\",\n"], [101, "          \"ecr:CompleteLayerUpload\",\n"], [102, "          \"ecr:PutImage\"\n"], [103, "        ],\n"], [104, "        Effect   = \"Allow\",\n"], [105, "        Resource = \"*\"\n"], [106, "      },\n"], [107, "      {\n"], [108, "        Action = [\n"], [109, "          \"iam:PassRole\"\n"], [110, "        ],\n"], [111, "        Effect   = \"Allow\",\n"], [112, "        Resource = \"*\"\n"], [113, "      }\n"], [114, "    ]\n"], [115, "  })\n"], [116, "\n"], [117, "  tags = {\n"], [118, "    Name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [119, "    Environment = var.environment\n"], [120, "    Project     = var.project\n"], [121, "  }\n"], [122, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [82, 122], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_policy.jenkins_ecs_policy", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-ecs-policy", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-40", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV2_AWS_40", "bc_check_id": "BC_AWS_IAM_73", "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "PASSED", "entity": {"aws_iam_policy": {"prometheus_discovery": {"__end_line__": 150, "__start_line__": 128, "description": ["Allow Prometheus to discover EC2 and ECS targets"], "name": ["prometheus-discovery"], "policy": [{"Version": "2012-10-17", "Statement": [{"Action": ["ec2:DescribeInstances", "ec2:DescribeTags", "ecs:ListTasks", "ecs:DescribeTasks", "ecs:ListServices", "ecs:DescribeServices", "ecs:DescribeTaskDefinition"], "Effect": "Allow", "Resource": "*"}]}], "__address__": "module.ecs_jenkins_github_dr.module.iam.aws_iam_policy.prometheus_discovery"}}}, "evaluated_keys": ["policy/Statement[?(@/Effect == Allow)]/Action[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]", "statement[?(@/effect == Allow)]/actions[*]"]}, "code_block": [[128, "resource \"aws_iam_policy\" \"prometheus_discovery\" {\n"], [129, "  name        = \"prometheus-discovery\"\n"], [130, "  description = \"Allow Prometheus to discover EC2 and ECS targets\"\n"], [131, "\n"], [132, "  policy = jsonencode({\n"], [133, "    Version = \"2012-10-17\"\n"], [134, "    Statement = [\n"], [135, "      {\n"], [136, "        Action = [\n"], [137, "          \"ec2:DescribeInstances\",\n"], [138, "          \"ec2:DescribeTags\",\n"], [139, "          \"ecs:ListTasks\",\n"], [140, "          \"ecs:DescribeTasks\",\n"], [141, "          \"ecs:ListServices\",\n"], [142, "          \"ecs:DescribeServices\",\n"], [143, "          \"ecs:DescribeTaskDefinition\"\n"], [144, "        ]\n"], [145, "        Effect   = \"Allow\"\n"], [146, "        Resource = \"*\"\n"], [147, "      }\n"], [148, "    ]\n"], [149, "  })\n"], [150, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [128, 150], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_policy.prometheus_discovery", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-40", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV2_AWS_40", "bc_check_id": "BC_AWS_IAM_73", "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "PASSED", "entity": {"aws_iam_policy": {"lambda_policy": {"__end_line__": 231, "__start_line__": 190, "description": ["Policy to allow Lambda functions to perform failover operations"], "name": ["${var.project}-${var.environment}-lambda-policy"], "policy": [{"Version": "2012-10-17", "Statement": [{"Action": ["logs:CreateLogGroup", "logs:CreateLogStream", "logs:PutLogEvents"], "Effect": "Allow", "Resource": "arn:aws:logs:*:*:*"}, {"Action": ["route53:GetHealthCheck", "route53:UpdateHealthCheck"], "Effect": "Allow", "Resource": "*"}, {"Action": ["autoscaling:DescribeAutoScalingGroups", "autoscaling:UpdateAutoScalingGroup"], "Effect": "Allow", "Resource": "*"}, {"Action": ["sns:Publish"], "Effect": "Allow", "Resource": "aws_sns_topic.failover_notifications.arn"}]}], "__address__": "module.lambda_failover.aws_iam_policy.lambda_policy"}}}, "evaluated_keys": ["policy/Statement[?(@/Effect == Allow)]/Action[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]", "statement[?(@/effect == Allow)]/actions[*]"]}, "code_block": [[190, "resource \"aws_iam_policy\" \"lambda_policy\" {\n"], [191, "  name        = \"${var.project}-${var.environment}-lambda-policy\"\n"], [192, "  description = \"Policy to allow Lambda functions to perform failover operations\"\n"], [193, "\n"], [194, "  policy = jsonencode({\n"], [195, "    Version = \"2012-10-17\"\n"], [196, "    Statement = [\n"], [197, "      {\n"], [198, "        Action = [\n"], [199, "          \"logs:CreateLogGroup\",\n"], [200, "          \"logs:CreateLogStream\",\n"], [201, "          \"logs:PutLogEvents\"\n"], [202, "        ]\n"], [203, "        Effect   = \"Allow\"\n"], [204, "        Resource = \"arn:aws:logs:*:*:*\"\n"], [205, "      },\n"], [206, "      {\n"], [207, "        Action = [\n"], [208, "          \"route53:GetHealthCheck\",\n"], [209, "          \"route53:UpdateHealthCheck\"\n"], [210, "        ]\n"], [211, "        Effect   = \"Allow\"\n"], [212, "        Resource = \"*\"\n"], [213, "      },\n"], [214, "      {\n"], [215, "        Action = [\n"], [216, "          \"autoscaling:DescribeAutoScalingGroups\",\n"], [217, "          \"autoscaling:UpdateAutoScalingGroup\"\n"], [218, "        ]\n"], [219, "        Effect   = \"Allow\"\n"], [220, "        Resource = \"*\"\n"], [221, "      },\n"], [222, "      {\n"], [223, "        Action = [\n"], [224, "          \"sns:Publish\"\n"], [225, "        ]\n"], [226, "        Effect   = \"Allow\"\n"], [227, "        Resource = var.sns_topic_arn\n"], [228, "      }\n"], [229, "    ]\n"], [230, "  })\n"], [231, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [190, 231], "resource": "module.lambda_failover.aws_iam_policy.lambda_policy", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-40", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV2_AWS_40", "bc_check_id": "BC_AWS_IAM_73", "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy": {"vpc_flow_logs_policy": {"__end_line__": 462, "__start_line__": 442, "name": ["vpc-flow-logs-policy"], "policy": [{"Version": "2012-10-17", "Statement": [{"Action": ["logs:CreateLogGroup", "logs:CreateLogStream", "logs:PutLogEvents", "logs:DescribeLogGroups", "logs:DescribeLogStreams"], "Effect": "Allow", "Resource": "*"}]}], "role": ["aws_iam_role.vpc_flow_logs_role.id"], "__address__": "module.ecs_jenkins_github.module.network.aws_iam_role_policy.vpc_flow_logs_policy"}}}, "evaluated_keys": ["policy/Statement[?(@/Effect == Allow)]/Action[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]", "statement[?(@/effect == Allow)]/actions[*]"]}, "code_block": [[442, "resource \"aws_iam_role_policy\" \"vpc_flow_logs_policy\" {\n"], [443, "  name = \"vpc-flow-logs-policy\"\n"], [444, "  role = aws_iam_role.vpc_flow_logs_role.id\n"], [445, "\n"], [446, "  policy = jsonencode({\n"], [447, "    Version = \"2012-10-17\"\n"], [448, "    Statement = [\n"], [449, "      {\n"], [450, "        Action = [\n"], [451, "          \"logs:CreateLogGroup\",\n"], [452, "          \"logs:CreateLogStream\",\n"], [453, "          \"logs:PutLogEvents\",\n"], [454, "          \"logs:DescribeLogGroups\",\n"], [455, "          \"logs:DescribeLogStreams\"\n"], [456, "        ]\n"], [457, "        Effect   = \"Allow\"\n"], [458, "        Resource = \"*\"\n"], [459, "      }\n"], [460, "    ]\n"], [461, "  })\n"], [462, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [442, 462], "resource": "module.ecs_jenkins_github.module.network.aws_iam_role_policy.vpc_flow_logs_policy", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-40", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_40", "bc_check_id": "BC_AWS_IAM_73", "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy": {"vpc_flow_logs_policy": {"__end_line__": 462, "__start_line__": 442, "name": ["vpc-flow-logs-policy"], "policy": [{"Version": "2012-10-17", "Statement": [{"Action": ["logs:CreateLogGroup", "logs:CreateLogStream", "logs:PutLogEvents", "logs:DescribeLogGroups", "logs:DescribeLogStreams"], "Effect": "Allow", "Resource": "*"}]}], "role": ["aws_iam_role.vpc_flow_logs_role.id"], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_iam_role_policy.vpc_flow_logs_policy"}}}, "evaluated_keys": ["policy/Statement[?(@/Effect == Allow)]/Action[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]", "statement[?(@/effect == Allow)]/actions[*]"]}, "code_block": [[442, "resource \"aws_iam_role_policy\" \"vpc_flow_logs_policy\" {\n"], [443, "  name = \"vpc-flow-logs-policy\"\n"], [444, "  role = aws_iam_role.vpc_flow_logs_role.id\n"], [445, "\n"], [446, "  policy = jsonencode({\n"], [447, "    Version = \"2012-10-17\"\n"], [448, "    Statement = [\n"], [449, "      {\n"], [450, "        Action = [\n"], [451, "          \"logs:CreateLogGroup\",\n"], [452, "          \"logs:CreateLogStream\",\n"], [453, "          \"logs:PutLogEvents\",\n"], [454, "          \"logs:DescribeLogGroups\",\n"], [455, "          \"logs:DescribeLogStreams\"\n"], [456, "        ]\n"], [457, "        Effect   = \"Allow\"\n"], [458, "        Resource = \"*\"\n"], [459, "      }\n"], [460, "    ]\n"], [461, "  })\n"], [462, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [442, 462], "resource": "module.ecs_jenkins_github_dr.module.network.aws_iam_role_policy.vpc_flow_logs_policy", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-40", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_60", "bc_check_id": "BC_AWS_GENERAL_195", "check_name": "Ensure RDS instance with copy tags to snapshots is enabled", "check_result": {"result": "PASSED", "entity": {"aws_db_instance": {"db_instance": {"__end_line__": 66, "__start_line__": 40, "allocated_storage": [20], "auto_minor_version_upgrade": [true], "backup_retention_period": [7], "copy_tags_to_snapshot": [true], "db_subnet_group_name": ["db-subnet-group"], "deletion_protection": [true], "enabled_cloudwatch_logs_exports": [["postgresql", "upgrade"]], "engine": ["postgres"], "engine_version": ["13"], "final_snapshot_identifier": ["db-final-snapshot"], "iam_database_authentication_enabled": [true], "identifier": ["db-instance"], "instance_class": ["db.t3.micro"], "monitoring_interval": [60], "monitoring_role_arn": ["aws_iam_role.rds_monitoring_role.arn"], "multi_az": [true], "parameter_group_name": ["db-pg"], "password": ["ProdStrongPasswordHere456!"], "skip_final_snapshot": [false], "storage_encrypted": [true], "storage_type": ["gp2"], "username": ["proddbadmin"], "vpc_security_group_ids": [[["aws_security_group.db_security_group.id"]]], "__address__": "module.ecs_jenkins_github.module.database.aws_db_instance.db_instance"}}}, "evaluated_keys": ["copy_tags_to_snapshot", "engine"]}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-60", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV2_AWS_60", "bc_check_id": "BC_AWS_GENERAL_195", "check_name": "Ensure RDS instance with copy tags to snapshots is enabled", "check_result": {"result": "PASSED", "entity": {"aws_db_instance": {"db_instance": {"__end_line__": 66, "__start_line__": 40, "allocated_storage": [20], "auto_minor_version_upgrade": [true], "backup_retention_period": [7], "copy_tags_to_snapshot": [true], "db_subnet_group_name": ["db-subnet-group"], "deletion_protection": [true], "enabled_cloudwatch_logs_exports": [["postgresql", "upgrade"]], "engine": ["postgres"], "engine_version": ["13"], "final_snapshot_identifier": ["db-final-snapshot"], "iam_database_authentication_enabled": [true], "identifier": ["db-instance"], "instance_class": ["db.t3.micro"], "monitoring_interval": [60], "monitoring_role_arn": ["aws_iam_role.rds_monitoring_role.arn"], "multi_az": [true], "parameter_group_name": ["db-pg"], "password": ["var.db_password"], "skip_final_snapshot": [false], "storage_encrypted": [true], "storage_type": ["gp2"], "username": ["var.db_username"], "vpc_security_group_ids": [[["aws_security_group.db_security_group.id"]]], "__address__": "module.ecs_jenkins_github_dr.module.database.aws_db_instance.db_instance"}}}, "evaluated_keys": ["copy_tags_to_snapshot", "engine"]}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github_dr.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-60", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV2_AWS_69", "bc_check_id": "BC_AWS_NETWORKING_93", "check_name": "Ensure AWS RDS database instance configured with encryption in transit", "check_result": {"result": "PASSED", "entity": {"aws_db_instance": {"db_instance": {"__end_line__": 66, "__start_line__": 40, "allocated_storage": [20], "auto_minor_version_upgrade": [true], "backup_retention_period": [7], "copy_tags_to_snapshot": [true], "db_subnet_group_name": ["db-subnet-group"], "deletion_protection": [true], "enabled_cloudwatch_logs_exports": [["postgresql", "upgrade"]], "engine": ["postgres"], "engine_version": ["13"], "final_snapshot_identifier": ["db-final-snapshot"], "iam_database_authentication_enabled": [true], "identifier": ["db-instance"], "instance_class": ["db.t3.micro"], "monitoring_interval": [60], "monitoring_role_arn": ["aws_iam_role.rds_monitoring_role.arn"], "multi_az": [true], "parameter_group_name": ["db-pg"], "password": ["ProdStrongPasswordHere456!"], "skip_final_snapshot": [false], "storage_encrypted": [true], "storage_type": ["gp2"], "username": ["proddbadmin"], "vpc_security_group_ids": [[["aws_security_group.db_security_group.id"]]], "__address__": "module.ecs_jenkins_github.module.database.aws_db_instance.db_instance"}}}, "evaluated_keys": ["parameter[?(@/name=='rds/force_ssl')]/value", "parameter[?(@/name=='db2comm')]/value", "resource_type", "parameter[?(@/name=='require_secure_transport')]/value", "family"]}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-69", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV2_AWS_69", "bc_check_id": "BC_AWS_NETWORKING_93", "check_name": "Ensure AWS RDS database instance configured with encryption in transit", "check_result": {"result": "PASSED", "entity": {"aws_db_instance": {"db_instance": {"__end_line__": 66, "__start_line__": 40, "allocated_storage": [20], "auto_minor_version_upgrade": [true], "backup_retention_period": [7], "copy_tags_to_snapshot": [true], "db_subnet_group_name": ["db-subnet-group"], "deletion_protection": [true], "enabled_cloudwatch_logs_exports": [["postgresql", "upgrade"]], "engine": ["postgres"], "engine_version": ["13"], "final_snapshot_identifier": ["db-final-snapshot"], "iam_database_authentication_enabled": [true], "identifier": ["db-instance"], "instance_class": ["db.t3.micro"], "monitoring_interval": [60], "monitoring_role_arn": ["aws_iam_role.rds_monitoring_role.arn"], "multi_az": [true], "parameter_group_name": ["db-pg"], "password": ["var.db_password"], "skip_final_snapshot": [false], "storage_encrypted": [true], "storage_type": ["gp2"], "username": ["var.db_username"], "vpc_security_group_ids": [[["aws_security_group.db_security_group.id"]]], "__address__": "module.ecs_jenkins_github_dr.module.database.aws_db_instance.db_instance"}}}, "evaluated_keys": ["parameter[?(@/name=='rds/force_ssl')]/value", "parameter[?(@/name=='db2comm')]/value", "resource_type", "parameter[?(@/name=='require_secure_transport')]/value", "family"]}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github_dr.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-69", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV2_AWS_5", "bc_check_id": "BC_AWS_NETWORKING_51", "check_name": "Ensure that Security Groups are attached to another resource", "check_result": {"result": "PASSED", "entity": {"aws_security_group": {"jenkins_sg": {"__end_line__": 35, "__start_line__": 2, "description": ["Security group for Jenkins server"], "egress": [{"cidr_blocks": [["0.0.0.0/0"]], "from_port": [0], "protocol": ["-1"], "to_port": [0]}], "ingress": [{"cidr_blocks": ["0.0.0.0/0"], "description": ["SSH access"], "from_port": [22], "protocol": ["tcp"], "to_port": [22]}, {"cidr_blocks": ["0.0.0.0/0"], "description": ["Jenkins web interface"], "from_port": [8080], "protocol": ["tcp"], "to_port": [8080]}], "name": ["ecs-jenkins-prod-jenkins-sg"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-sg", "Project": "ecs-jenkins"}], "vpc_id": ["aws_vpc.vpc.id"], "__address__": "module.ecs_jenkins_github.module.cicd.aws_security_group.jenkins_sg"}}}, "evaluated_keys": ["resource_type", "networking"]}, "code_block": [[2, "resource \"aws_security_group\" \"jenkins_sg\" {\n"], [3, "  name        = \"${var.project}-${var.environment}-jenkins-sg\"\n"], [4, "  description = \"Security group for Jenkins server\"\n"], [5, "  vpc_id      = var.vpc_id\n"], [6, "\n"], [7, "  ingress {\n"], [8, "    description = \"SSH access\"\n"], [9, "    from_port   = 22\n"], [10, "    to_port     = 22\n"], [11, "    protocol    = \"tcp\"\n"], [12, "    cidr_blocks = var.ssh_allowed_cidr\n"], [13, "  }\n"], [14, "\n"], [15, "  ingress {\n"], [16, "    description = \"Jenkins web interface\"\n"], [17, "    from_port   = 8080\n"], [18, "    to_port     = 8080\n"], [19, "    protocol    = \"tcp\"\n"], [20, "    cidr_blocks = var.web_allowed_cidr\n"], [21, "  }\n"], [22, "\n"], [23, "  egress {\n"], [24, "    from_port   = 0\n"], [25, "    to_port     = 0\n"], [26, "    protocol    = \"-1\"\n"], [27, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [28, "  }\n"], [29, "\n"], [30, "  tags = {\n"], [31, "    Name        = \"${var.project}-${var.environment}-jenkins-sg\"\n"], [32, "    Environment = var.environment\n"], [33, "    Project     = var.project\n"], [34, "  }\n"], [35, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [2, 35], "resource": "module.ecs_jenkins_github.module.cicd.aws_security_group.jenkins_sg", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-sg", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[38, "resource \"aws_launch_template\" \"jenkins\" {\n"], [39, "  name_prefix            = \"${var.project}-${var.environment}-jenkins-\"\n"], [40, "  image_id               = data.aws_ami.amazon_linux_2.id\n"], [41, "  instance_type          = var.instance_type\n"], [42, "  vpc_security_group_ids = [aws_security_group.jenkins_sg.id]\n"], [43, "  key_name               = var.key_name\n"], [44, "\n"], [45, "  iam_instance_profile {\n"], [46, "    name = aws_iam_instance_profile.jenkins_profile.name\n"], [47, "  }\n"], [48, "\n"], [49, "  user_data = base64encode(<<-EOF\n"], [50, "    #!/bin/bash\n"], [51, "    sudo yum update -y\n"], [52, "    sudo amazon-linux-extras install java-openjdk11 -y\n"], [53, "    sudo yum install -y jenkins git docker\n"], [54, "    sudo systemctl start jenkins\n"], [55, "    sudo systemctl enable jenkins\n"], [56, "    sudo systemctl start docker\n"], [57, "    sudo systemctl enable docker\n"], [58, "    sudo usermod -aG docker jenkins\n"], [59, "    sudo systemctl restart jenkins\n"], [60, "\n"], [61, "    # Install AWS CLI\n"], [62, "    curl \"https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip\" -o \"awscliv2.zip\"\n"], [63, "    unzip awscliv2.zip\n"], [64, "    sudo ./aws/install\n"], [65, "\n"], [66, "    # Install Terraform\n"], [67, "    TERRAFORM_VERSION=\"1.0.0\"\n"], [68, "    wget https://releases.hashicorp.com/terraform/$${TERRAFORM_VERSION}/terraform_$${TERRAFORM_VERSION}_linux_amd64.zip\n"], [69, "    unzip terraform_$${TERRAFORM_VERSION}_linux_amd64.zip\n"], [70, "    sudo mv terraform /usr/local/bin/\n"], [71, "\n"], [72, "    # Install SSM Agent\n"], [73, "    sudo yum install -y https://s3.amazonaws.com/ec2-downloads-windows/SSMAgent/latest/linux_amd64/amazon-ssm-agent.rpm\n"], [74, "    sudo systemctl enable amazon-ssm-agent\n"], [75, "    sudo systemctl start amazon-ssm-agent\n"], [76, "  EOF\n"], [77, "  )\n"], [78, "\n"], [79, "  block_device_mappings {\n"], [80, "    device_name = \"/dev/xvda\"\n"], [81, "    ebs {\n"], [82, "      volume_size           = 30\n"], [83, "      volume_type           = \"gp3\"\n"], [84, "      delete_on_termination = true\n"], [85, "      encrypted             = true\n"], [86, "    }\n"], [87, "  }\n"], [88, "\n"], [89, "  metadata_options {\n"], [90, "    http_endpoint               = \"enabled\"\n"], [91, "    http_tokens                 = \"required\" # IMDSv2 required for better security\n"], [92, "    http_put_response_hop_limit = 1\n"], [93, "  }\n"], [94, "\n"], [95, "  monitoring {\n"], [96, "    enabled = true\n"], [97, "  }\n"], [98, "\n"], [99, "  tag_specifications {\n"], [100, "    resource_type = \"instance\"\n"], [101, "    tags = {\n"], [102, "      Name        = \"${var.project}-${var.environment}-jenkins\"\n"], [103, "      Environment = var.environment\n"], [104, "      Project     = var.project\n"], [105, "      ManagedBy   = \"Terraform\"\n"], [106, "    }\n"], [107, "  }\n"], [108, "\n"], [109, "  tag_specifications {\n"], [110, "    resource_type = \"volume\"\n"], [111, "    tags = {\n"], [112, "      Name        = \"${var.project}-${var.environment}-jenkins-volume\"\n"], [113, "      Environment = var.environment\n"], [114, "      Project     = var.project\n"], [115, "    }\n"], [116, "  }\n"], [117, "\n"], [118, "  lifecycle {\n"], [119, "    create_before_destroy = true\n"], [120, "  }\n"], [121, "}\n"]], "file_path": "\\..\\cicd\\main.tf", "file_line_range": [38, 121], "resource": "aws_launch_template.jenkins", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV2_AWS_5", "bc_check_id": "BC_AWS_NETWORKING_51", "check_name": "Ensure that Security Groups are attached to another resource", "check_result": {"result": "PASSED", "entity": {"aws_security_group": {"jenkins_sg": {"__end_line__": 35, "__start_line__": 2, "description": ["Security group for Jenkins server"], "egress": [{"cidr_blocks": [["0.0.0.0/0"]], "from_port": [0], "protocol": ["-1"], "to_port": [0]}], "ingress": [{"cidr_blocks": ["0.0.0.0/0"], "description": ["SSH access"], "from_port": [22], "protocol": ["tcp"], "to_port": [22]}, {"cidr_blocks": ["0.0.0.0/0"], "description": ["Jenkins web interface"], "from_port": [8080], "protocol": ["tcp"], "to_port": [8080]}], "name": ["ecs-jenkins-dr-jenkins-sg"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-sg", "Project": "ecs-jenkins"}], "vpc_id": ["aws_vpc.vpc.id"], "__address__": "module.ecs_jenkins_github_dr.module.cicd.aws_security_group.jenkins_sg"}}}, "evaluated_keys": ["resource_type", "networking"]}, "code_block": [[2, "resource \"aws_security_group\" \"jenkins_sg\" {\n"], [3, "  name        = \"${var.project}-${var.environment}-jenkins-sg\"\n"], [4, "  description = \"Security group for Jenkins server\"\n"], [5, "  vpc_id      = var.vpc_id\n"], [6, "\n"], [7, "  ingress {\n"], [8, "    description = \"SSH access\"\n"], [9, "    from_port   = 22\n"], [10, "    to_port     = 22\n"], [11, "    protocol    = \"tcp\"\n"], [12, "    cidr_blocks = var.ssh_allowed_cidr\n"], [13, "  }\n"], [14, "\n"], [15, "  ingress {\n"], [16, "    description = \"Jenkins web interface\"\n"], [17, "    from_port   = 8080\n"], [18, "    to_port     = 8080\n"], [19, "    protocol    = \"tcp\"\n"], [20, "    cidr_blocks = var.web_allowed_cidr\n"], [21, "  }\n"], [22, "\n"], [23, "  egress {\n"], [24, "    from_port   = 0\n"], [25, "    to_port     = 0\n"], [26, "    protocol    = \"-1\"\n"], [27, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [28, "  }\n"], [29, "\n"], [30, "  tags = {\n"], [31, "    Name        = \"${var.project}-${var.environment}-jenkins-sg\"\n"], [32, "    Environment = var.environment\n"], [33, "    Project     = var.project\n"], [34, "  }\n"], [35, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [2, 35], "resource": "module.ecs_jenkins_github_dr.module.cicd.aws_security_group.jenkins_sg", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-sg", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[38, "resource \"aws_launch_template\" \"jenkins\" {\n"], [39, "  name_prefix            = \"${var.project}-${var.environment}-jenkins-\"\n"], [40, "  image_id               = data.aws_ami.amazon_linux_2.id\n"], [41, "  instance_type          = var.instance_type\n"], [42, "  vpc_security_group_ids = [aws_security_group.jenkins_sg.id]\n"], [43, "  key_name               = var.key_name\n"], [44, "\n"], [45, "  iam_instance_profile {\n"], [46, "    name = aws_iam_instance_profile.jenkins_profile.name\n"], [47, "  }\n"], [48, "\n"], [49, "  user_data = base64encode(<<-EOF\n"], [50, "    #!/bin/bash\n"], [51, "    sudo yum update -y\n"], [52, "    sudo amazon-linux-extras install java-openjdk11 -y\n"], [53, "    sudo yum install -y jenkins git docker\n"], [54, "    sudo systemctl start jenkins\n"], [55, "    sudo systemctl enable jenkins\n"], [56, "    sudo systemctl start docker\n"], [57, "    sudo systemctl enable docker\n"], [58, "    sudo usermod -aG docker jenkins\n"], [59, "    sudo systemctl restart jenkins\n"], [60, "\n"], [61, "    # Install AWS CLI\n"], [62, "    curl \"https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip\" -o \"awscliv2.zip\"\n"], [63, "    unzip awscliv2.zip\n"], [64, "    sudo ./aws/install\n"], [65, "\n"], [66, "    # Install Terraform\n"], [67, "    TERRAFORM_VERSION=\"1.0.0\"\n"], [68, "    wget https://releases.hashicorp.com/terraform/$${TERRAFORM_VERSION}/terraform_$${TERRAFORM_VERSION}_linux_amd64.zip\n"], [69, "    unzip terraform_$${TERRAFORM_VERSION}_linux_amd64.zip\n"], [70, "    sudo mv terraform /usr/local/bin/\n"], [71, "\n"], [72, "    # Install SSM Agent\n"], [73, "    sudo yum install -y https://s3.amazonaws.com/ec2-downloads-windows/SSMAgent/latest/linux_amd64/amazon-ssm-agent.rpm\n"], [74, "    sudo systemctl enable amazon-ssm-agent\n"], [75, "    sudo systemctl start amazon-ssm-agent\n"], [76, "  EOF\n"], [77, "  )\n"], [78, "\n"], [79, "  block_device_mappings {\n"], [80, "    device_name = \"/dev/xvda\"\n"], [81, "    ebs {\n"], [82, "      volume_size           = 30\n"], [83, "      volume_type           = \"gp3\"\n"], [84, "      delete_on_termination = true\n"], [85, "      encrypted             = true\n"], [86, "    }\n"], [87, "  }\n"], [88, "\n"], [89, "  metadata_options {\n"], [90, "    http_endpoint               = \"enabled\"\n"], [91, "    http_tokens                 = \"required\" # IMDSv2 required for better security\n"], [92, "    http_put_response_hop_limit = 1\n"], [93, "  }\n"], [94, "\n"], [95, "  monitoring {\n"], [96, "    enabled = true\n"], [97, "  }\n"], [98, "\n"], [99, "  tag_specifications {\n"], [100, "    resource_type = \"instance\"\n"], [101, "    tags = {\n"], [102, "      Name        = \"${var.project}-${var.environment}-jenkins\"\n"], [103, "      Environment = var.environment\n"], [104, "      Project     = var.project\n"], [105, "      ManagedBy   = \"Terraform\"\n"], [106, "    }\n"], [107, "  }\n"], [108, "\n"], [109, "  tag_specifications {\n"], [110, "    resource_type = \"volume\"\n"], [111, "    tags = {\n"], [112, "      Name        = \"${var.project}-${var.environment}-jenkins-volume\"\n"], [113, "      Environment = var.environment\n"], [114, "      Project     = var.project\n"], [115, "    }\n"], [116, "  }\n"], [117, "\n"], [118, "  lifecycle {\n"], [119, "    create_before_destroy = true\n"], [120, "  }\n"], [121, "}\n"]], "file_path": "\\main.tf", "file_line_range": [38, 121], "resource": "aws_launch_template.jenkins", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV2_AWS_5", "bc_check_id": "BC_AWS_NETWORKING_51", "check_name": "Ensure that Security Groups are attached to another resource", "check_result": {"result": "PASSED", "entity": {"aws_security_group": {"monitoring_sg": {"__end_line__": 42, "__start_line__": 2, "description": ["Security group for Prometheus and Grafana"], "egress": [{"cidr_blocks": [["0.0.0.0/0"]], "description": ["HTTPS to internet"], "from_port": [443], "protocol": ["tcp"], "to_port": [443]}, {"cidr_blocks": [["0.0.0.0/0"]], "description": ["HTTP to internet"], "from_port": [80], "protocol": ["tcp"], "to_port": [80]}], "ingress": [{"description": ["Prometheus UI"], "from_port": [9090], "protocol": ["tcp"], "security_groups": [["aws_security_group.alb_security_group.id"]], "to_port": [9090]}, {"description": ["Grafana UI"], "from_port": [3000], "protocol": ["tcp"], "security_groups": [["aws_security_group.alb_security_group.id"]], "to_port": [3000]}], "name": ["monitoring-sg"], "tags": [{"Name": "monitoring-sg"}], "vpc_id": ["aws_vpc.vpc.id"], "__address__": "module.ecs_jenkins_github.module.monitoring.aws_security_group.monitoring_sg"}}}, "evaluated_keys": ["resource_type", "networking"]}, "code_block": [[2, "resource \"aws_security_group\" \"monitoring_sg\" {\n"], [3, "  name        = \"monitoring-sg\"\n"], [4, "  description = \"Security group for Prometheus and Grafana\"\n"], [5, "  vpc_id      = var.vpc_id\n"], [6, "\n"], [7, "  ingress {\n"], [8, "    description     = \"Prometheus UI\"\n"], [9, "    from_port       = 9090\n"], [10, "    to_port         = 9090\n"], [11, "    protocol        = \"tcp\"\n"], [12, "    security_groups = [var.alb_security_group_id]\n"], [13, "  }\n"], [14, "\n"], [15, "  ingress {\n"], [16, "    description     = \"Grafana UI\"\n"], [17, "    from_port       = 3000\n"], [18, "    to_port         = 3000\n"], [19, "    protocol        = \"tcp\"\n"], [20, "    security_groups = [var.alb_security_group_id]\n"], [21, "  }\n"], [22, "\n"], [23, "  egress {\n"], [24, "    description = \"HTTPS to internet\"\n"], [25, "    from_port   = 443\n"], [26, "    to_port     = 443\n"], [27, "    protocol    = \"tcp\"\n"], [28, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [29, "  }\n"], [30, "\n"], [31, "  egress {\n"], [32, "    description = \"HTTP to internet\"\n"], [33, "    from_port   = 80\n"], [34, "    to_port     = 80\n"], [35, "    protocol    = \"tcp\"\n"], [36, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [37, "  }\n"], [38, "\n"], [39, "  tags = {\n"], [40, "    Name = \"monitoring-sg\"\n"], [41, "  }\n"], [42, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [2, 42], "resource": "module.ecs_jenkins_github.module.monitoring.aws_security_group.monitoring_sg", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "monitoring-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[73, "resource \"aws_ecs_service\" \"prometheus\" {\n"], [74, "  name            = \"prometheus\"\n"], [75, "  cluster         = var.ecs_cluster_id\n"], [76, "  task_definition = aws_ecs_task_definition.prometheus.arn\n"], [77, "  desired_count   = 1\n"], [78, "  launch_type     = \"FARGATE\"\n"], [79, "\n"], [80, "  network_configuration {\n"], [81, "    subnets          = var.private_subnet_ids\n"], [82, "    security_groups  = [aws_security_group.monitoring_sg.id]\n"], [83, "    assign_public_ip = false\n"], [84, "  }\n"], [85, "\n"], [86, "  load_balancer {\n"], [87, "    target_group_arn = aws_lb_target_group.prometheus.arn\n"], [88, "    container_name   = \"prometheus\"\n"], [89, "    container_port   = 9090\n"], [90, "  }\n"], [91, "}\n"]], "file_path": "\\..\\monitoring\\main.tf", "file_line_range": [73, 91], "resource": "aws_ecs_service.prometheus", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV2_AWS_5", "bc_check_id": "BC_AWS_NETWORKING_51", "check_name": "Ensure that Security Groups are attached to another resource", "check_result": {"result": "PASSED", "entity": {"aws_security_group": {"monitoring_sg": {"__end_line__": 42, "__start_line__": 2, "description": ["Security group for Prometheus and Grafana"], "egress": [{"cidr_blocks": [["0.0.0.0/0"]], "description": ["HTTPS to internet"], "from_port": [443], "protocol": ["tcp"], "to_port": [443]}, {"cidr_blocks": [["0.0.0.0/0"]], "description": ["HTTP to internet"], "from_port": [80], "protocol": ["tcp"], "to_port": [80]}], "ingress": [{"description": ["Prometheus UI"], "from_port": [9090], "protocol": ["tcp"], "security_groups": [["aws_security_group.alb_security_group.id"]], "to_port": [9090]}, {"description": ["Grafana UI"], "from_port": [3000], "protocol": ["tcp"], "security_groups": [["aws_security_group.alb_security_group.id"]], "to_port": [3000]}], "name": ["monitoring-sg"], "tags": [{"Name": "monitoring-sg"}], "vpc_id": ["aws_vpc.vpc.id"], "__address__": "module.ecs_jenkins_github_dr.module.monitoring.aws_security_group.monitoring_sg"}}}, "evaluated_keys": ["resource_type", "networking"]}, "code_block": [[2, "resource \"aws_security_group\" \"monitoring_sg\" {\n"], [3, "  name        = \"monitoring-sg\"\n"], [4, "  description = \"Security group for Prometheus and Grafana\"\n"], [5, "  vpc_id      = var.vpc_id\n"], [6, "\n"], [7, "  ingress {\n"], [8, "    description     = \"Prometheus UI\"\n"], [9, "    from_port       = 9090\n"], [10, "    to_port         = 9090\n"], [11, "    protocol        = \"tcp\"\n"], [12, "    security_groups = [var.alb_security_group_id]\n"], [13, "  }\n"], [14, "\n"], [15, "  ingress {\n"], [16, "    description     = \"Grafana UI\"\n"], [17, "    from_port       = 3000\n"], [18, "    to_port         = 3000\n"], [19, "    protocol        = \"tcp\"\n"], [20, "    security_groups = [var.alb_security_group_id]\n"], [21, "  }\n"], [22, "\n"], [23, "  egress {\n"], [24, "    description = \"HTTPS to internet\"\n"], [25, "    from_port   = 443\n"], [26, "    to_port     = 443\n"], [27, "    protocol    = \"tcp\"\n"], [28, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [29, "  }\n"], [30, "\n"], [31, "  egress {\n"], [32, "    description = \"HTTP to internet\"\n"], [33, "    from_port   = 80\n"], [34, "    to_port     = 80\n"], [35, "    protocol    = \"tcp\"\n"], [36, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [37, "  }\n"], [38, "\n"], [39, "  tags = {\n"], [40, "    Name = \"monitoring-sg\"\n"], [41, "  }\n"], [42, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [2, 42], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_security_group.monitoring_sg", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "monitoring-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[73, "resource \"aws_ecs_service\" \"prometheus\" {\n"], [74, "  name            = \"prometheus\"\n"], [75, "  cluster         = var.ecs_cluster_id\n"], [76, "  task_definition = aws_ecs_task_definition.prometheus.arn\n"], [77, "  desired_count   = 1\n"], [78, "  launch_type     = \"FARGATE\"\n"], [79, "\n"], [80, "  network_configuration {\n"], [81, "    subnets          = var.private_subnet_ids\n"], [82, "    security_groups  = [aws_security_group.monitoring_sg.id]\n"], [83, "    assign_public_ip = false\n"], [84, "  }\n"], [85, "\n"], [86, "  load_balancer {\n"], [87, "    target_group_arn = aws_lb_target_group.prometheus.arn\n"], [88, "    container_name   = \"prometheus\"\n"], [89, "    container_port   = 9090\n"], [90, "  }\n"], [91, "}\n"]], "file_path": "\\main.tf", "file_line_range": [73, 91], "resource": "aws_ecs_service.prometheus", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV2_AWS_30", "bc_check_id": "BC_AWS_LOGGING_32", "check_name": "Ensure Postgres RDS as aws_db_instance has Query Logging enabled", "check_result": {"result": "PASSED", "entity": {"aws_db_instance": {"db_instance": {"__end_line__": 66, "__start_line__": 40, "allocated_storage": [20], "auto_minor_version_upgrade": [true], "backup_retention_period": [7], "copy_tags_to_snapshot": [true], "db_subnet_group_name": ["db-subnet-group"], "deletion_protection": [true], "enabled_cloudwatch_logs_exports": [["postgresql", "upgrade"]], "engine": ["postgres"], "engine_version": ["13"], "final_snapshot_identifier": ["db-final-snapshot"], "iam_database_authentication_enabled": [true], "identifier": ["db-instance"], "instance_class": ["db.t3.micro"], "monitoring_interval": [60], "monitoring_role_arn": ["aws_iam_role.rds_monitoring_role.arn"], "multi_az": [true], "parameter_group_name": ["db-pg"], "password": ["ProdStrongPasswordHere456!"], "skip_final_snapshot": [false], "storage_encrypted": [true], "storage_type": ["gp2"], "username": ["proddbadmin"], "vpc_security_group_ids": [[["aws_security_group.db_security_group.id"]]], "__address__": "module.ecs_jenkins_github.module.database.aws_db_instance.db_instance"}}}, "evaluated_keys": ["parameter/*/name", "resource_type", "engine"]}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-postgres-rds-has-query-logging-enabled", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV2_AWS_30", "bc_check_id": "BC_AWS_LOGGING_32", "check_name": "Ensure Postgres RDS as aws_db_instance has Query Logging enabled", "check_result": {"result": "PASSED", "entity": {"aws_db_instance": {"db_instance": {"__end_line__": 66, "__start_line__": 40, "allocated_storage": [20], "auto_minor_version_upgrade": [true], "backup_retention_period": [7], "copy_tags_to_snapshot": [true], "db_subnet_group_name": ["db-subnet-group"], "deletion_protection": [true], "enabled_cloudwatch_logs_exports": [["postgresql", "upgrade"]], "engine": ["postgres"], "engine_version": ["13"], "final_snapshot_identifier": ["db-final-snapshot"], "iam_database_authentication_enabled": [true], "identifier": ["db-instance"], "instance_class": ["db.t3.micro"], "monitoring_interval": [60], "monitoring_role_arn": ["aws_iam_role.rds_monitoring_role.arn"], "multi_az": [true], "parameter_group_name": ["db-pg"], "password": ["var.db_password"], "skip_final_snapshot": [false], "storage_encrypted": [true], "storage_type": ["gp2"], "username": ["var.db_username"], "vpc_security_group_ids": [[["aws_security_group.db_security_group.id"]]], "__address__": "module.ecs_jenkins_github_dr.module.database.aws_db_instance.db_instance"}}}, "evaluated_keys": ["parameter/*/name", "resource_type", "engine"]}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github_dr.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-postgres-rds-has-query-logging-enabled", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV2_AWS_73", "bc_check_id": "BC_AWS_GENERAL_266", "check_name": "Ensure AWS SQS uses CMK not AWS default keys for encryption", "check_result": {"result": "PASSED", "entity": {"aws_sqs_queue": {"dr_notification_queue": {"__end_line__": 44, "__start_line__": 35, "name": ["${var.project}-${var.environment}-dr-notifications"], "provider": ["aws.dr"], "tags": [{"Environment": "var.environment", "Name": "${var.project}-${var.environment}-dr-notifications", "Project": "var.project"}], "__address__": "aws_sqs_queue.dr_notification_queue"}}}, "evaluated_keys": ["kms_master_key_id"]}, "code_block": [[35, "resource \"aws_sqs_queue\" \"dr_notification_queue\" {\n"], [36, "  provider = aws.dr\n"], [37, "  name     = \"${var.project}-${var.environment}-dr-notifications\"\n"], [38, "\n"], [39, "  tags = {\n"], [40, "    Name        = \"${var.project}-${var.environment}-dr-notifications\"\n"], [41, "    Environment = var.environment\n"], [42, "    Project     = var.project\n"], [43, "  }\n"], [44, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\multi-region\\main.tf", "repo_file_path": "/modules/multi-region/main.tf", "file_line_range": [35, 44], "resource": "aws_sqs_queue.dr_notification_queue", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Name": "${var.project}-${var.environment}-dr-notifications", "Project": "var.project"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-73", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\multi-region\\main.tf"}, {"check_id": "CKV2_AWS_11", "bc_check_id": "BC_AWS_LOGGING_9", "check_name": "Ensure VPC flow logging is enabled in all VPCs", "check_result": {"result": "PASSED", "entity": {"aws_vpc": {"vpc": {"__end_line__": 9, "__start_line__": 1, "cidr_block": ["10.1.0.0/16"], "enable_dns_hostnames": [true], "enable_dns_support": [true], "tags": [{"Name": "main-vpc"}], "__address__": "module.ecs_jenkins_github.module.network.aws_vpc.vpc"}}}, "evaluated_keys": ["resource_type", "networking"]}, "code_block": [[1, "resource \"aws_vpc\" \"vpc\" {\n"], [2, "  cidr_block           = var.vpc_cidr\n"], [3, "  enable_dns_hostnames = true\n"], [4, "  enable_dns_support   = true\n"], [5, "\n"], [6, "  tags = {\n"], [7, "    Name = \"main-vpc\"\n"], [8, "  }\n"], [9, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [1, 9], "resource": "module.ecs_jenkins_github.module.network.aws_vpc.vpc", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "main-vpc"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[405, "resource \"aws_flow_log\" \"vpc_flow_log\" {\n"], [406, "  log_destination      = aws_cloudwatch_log_group.vpc_flow_logs.arn\n"], [407, "  log_destination_type = \"cloud-watch-logs\"\n"], [408, "  traffic_type         = \"ALL\"\n"], [409, "  vpc_id               = aws_vpc.vpc.id\n"], [410, "  iam_role_arn         = aws_iam_role.vpc_flow_logs_role.arn\n"], [411, "}\n"]], "file_path": "\\..\\network\\main.tf", "file_line_range": [405, 411], "resource": "aws_flow_log.vpc_flow_log", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-9-enable-vpc-flow-logging", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_11", "bc_check_id": "BC_AWS_LOGGING_9", "check_name": "Ensure VPC flow logging is enabled in all VPCs", "check_result": {"result": "PASSED", "entity": {"aws_vpc": {"vpc": {"__end_line__": 9, "__start_line__": 1, "cidr_block": ["10.2.0.0/16"], "enable_dns_hostnames": [true], "enable_dns_support": [true], "tags": [{"Name": "main-vpc"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_vpc.vpc"}}}, "evaluated_keys": ["resource_type", "networking"]}, "code_block": [[1, "resource \"aws_vpc\" \"vpc\" {\n"], [2, "  cidr_block           = var.vpc_cidr\n"], [3, "  enable_dns_hostnames = true\n"], [4, "  enable_dns_support   = true\n"], [5, "\n"], [6, "  tags = {\n"], [7, "    Name = \"main-vpc\"\n"], [8, "  }\n"], [9, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [1, 9], "resource": "module.ecs_jenkins_github_dr.module.network.aws_vpc.vpc", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "main-vpc"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[405, "resource \"aws_flow_log\" \"vpc_flow_log\" {\n"], [406, "  log_destination      = aws_cloudwatch_log_group.vpc_flow_logs.arn\n"], [407, "  log_destination_type = \"cloud-watch-logs\"\n"], [408, "  traffic_type         = \"ALL\"\n"], [409, "  vpc_id               = aws_vpc.vpc.id\n"], [410, "  iam_role_arn         = aws_iam_role.vpc_flow_logs_role.arn\n"], [411, "}\n"]], "file_path": "\\main.tf", "file_line_range": [405, 411], "resource": "aws_flow_log.vpc_flow_log", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-9-enable-vpc-flow-logging", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_44", "bc_check_id": "BC_AWS_NETWORKING_80", "check_name": "Ensure AWS route table with VPC peering does not contain routes overly permissive to all traffic", "check_result": {"result": "PASSED", "entity": {"aws_route_table": {"public_route_table": {"__end_line__": 81, "__start_line__": 70, "route": [{"cidr_block": ["0.0.0.0/0"], "gateway_id": ["aws_internet_gateway.igw.id"]}], "tags": [{"Name": "public-route-table"}], "vpc_id": ["aws_vpc.vpc.id"], "__address__": "module.ecs_jenkins_github.module.network.aws_route_table.public_route_table"}}}, "evaluated_keys": ["destination_cidr_block", "route/*/ipv6_cidr_block", "destination_ipv6_cidr_block", "route/*/cidr_block", "vpc_peering_connection_id", "route/*/vpc_peering_connection_id"]}, "code_block": [[70, "resource \"aws_route_table\" \"public_route_table\" {\n"], [71, "  vpc_id = aws_vpc.vpc.id\n"], [72, "\n"], [73, "  route {\n"], [74, "    cidr_block = \"0.0.0.0/0\"\n"], [75, "    gateway_id = aws_internet_gateway.igw.id\n"], [76, "  }\n"], [77, "\n"], [78, "  tags = {\n"], [79, "    Name = \"public-route-table\"\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [70, 81], "resource": "module.ecs_jenkins_github.module.network.aws_route_table.public_route_table", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "public-route-table"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-route-table-with-vpc-peering-does-not-contain-routes-overly-permissive-to-all-traffic", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_44", "bc_check_id": "BC_AWS_NETWORKING_80", "check_name": "Ensure AWS route table with VPC peering does not contain routes overly permissive to all traffic", "check_result": {"result": "PASSED", "entity": {"aws_route_table": {"private_route_table": {"__end_line__": 94, "__start_line__": 83, "route": [{"cidr_block": ["0.0.0.0/0"], "nat_gateway_id": ["aws_nat_gateway.nat_gateway.id"]}], "tags": [{"Name": "private-route-table"}], "vpc_id": ["aws_vpc.vpc.id"], "__address__": "module.ecs_jenkins_github.module.network.aws_route_table.private_route_table"}}}, "evaluated_keys": ["destination_cidr_block", "route/*/ipv6_cidr_block", "destination_ipv6_cidr_block", "route/*/cidr_block", "vpc_peering_connection_id", "route/*/vpc_peering_connection_id"]}, "code_block": [[83, "resource \"aws_route_table\" \"private_route_table\" {\n"], [84, "  vpc_id = aws_vpc.vpc.id\n"], [85, "\n"], [86, "  route {\n"], [87, "    cidr_block     = \"0.0.0.0/0\"\n"], [88, "    nat_gateway_id = aws_nat_gateway.nat_gateway.id\n"], [89, "  }\n"], [90, "\n"], [91, "  tags = {\n"], [92, "    Name = \"private-route-table\"\n"], [93, "  }\n"], [94, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [83, 94], "resource": "module.ecs_jenkins_github.module.network.aws_route_table.private_route_table", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "private-route-table"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-route-table-with-vpc-peering-does-not-contain-routes-overly-permissive-to-all-traffic", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_44", "bc_check_id": "BC_AWS_NETWORKING_80", "check_name": "Ensure AWS route table with VPC peering does not contain routes overly permissive to all traffic", "check_result": {"result": "PASSED", "entity": {"aws_route_table": {"public_route_table": {"__end_line__": 81, "__start_line__": 70, "route": [{"cidr_block": ["0.0.0.0/0"], "gateway_id": ["aws_internet_gateway.igw.id"]}], "tags": [{"Name": "public-route-table"}], "vpc_id": ["aws_vpc.vpc.id"], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_route_table.public_route_table"}}}, "evaluated_keys": ["destination_cidr_block", "route/*/ipv6_cidr_block", "destination_ipv6_cidr_block", "route/*/cidr_block", "vpc_peering_connection_id", "route/*/vpc_peering_connection_id"]}, "code_block": [[70, "resource \"aws_route_table\" \"public_route_table\" {\n"], [71, "  vpc_id = aws_vpc.vpc.id\n"], [72, "\n"], [73, "  route {\n"], [74, "    cidr_block = \"0.0.0.0/0\"\n"], [75, "    gateway_id = aws_internet_gateway.igw.id\n"], [76, "  }\n"], [77, "\n"], [78, "  tags = {\n"], [79, "    Name = \"public-route-table\"\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [70, 81], "resource": "module.ecs_jenkins_github_dr.module.network.aws_route_table.public_route_table", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "public-route-table"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-route-table-with-vpc-peering-does-not-contain-routes-overly-permissive-to-all-traffic", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_44", "bc_check_id": "BC_AWS_NETWORKING_80", "check_name": "Ensure AWS route table with VPC peering does not contain routes overly permissive to all traffic", "check_result": {"result": "PASSED", "entity": {"aws_route_table": {"private_route_table": {"__end_line__": 94, "__start_line__": 83, "route": [{"cidr_block": ["0.0.0.0/0"], "nat_gateway_id": ["aws_nat_gateway.nat_gateway.id"]}], "tags": [{"Name": "private-route-table"}], "vpc_id": ["aws_vpc.vpc.id"], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_route_table.private_route_table"}}}, "evaluated_keys": ["destination_cidr_block", "route/*/ipv6_cidr_block", "destination_ipv6_cidr_block", "route/*/cidr_block", "vpc_peering_connection_id", "route/*/vpc_peering_connection_id"]}, "code_block": [[83, "resource \"aws_route_table\" \"private_route_table\" {\n"], [84, "  vpc_id = aws_vpc.vpc.id\n"], [85, "\n"], [86, "  route {\n"], [87, "    cidr_block     = \"0.0.0.0/0\"\n"], [88, "    nat_gateway_id = aws_nat_gateway.nat_gateway.id\n"], [89, "  }\n"], [90, "\n"], [91, "  tags = {\n"], [92, "    Name = \"private-route-table\"\n"], [93, "  }\n"], [94, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [83, 94], "resource": "module.ecs_jenkins_github_dr.module.network.aws_route_table.private_route_table", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "private-route-table"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-route-table-with-vpc-peering-does-not-contain-routes-overly-permissive-to-all-traffic", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_31", "bc_check_id": "BC_AWS_LOGGING_33", "check_name": "Ensure WAF2 has a Logging Configuration", "check_result": {"result": "PASSED", "entity": {"aws_wafv2_web_acl": {"owasp_top10_protection": {"__end_line__": 281, "__start_line__": 20, "default_action": [{"allow": [{}]}], "description": ["WAF WebACL with OWASP Top 10 protections"], "lifecycle": [{"create_before_destroy": [true]}], "name": ["ecs-jenkins-prod-owasp-protection"], "rule": [{"action": [{"block": [{}]}], "name": ["block-known-bad-ips"], "priority": [0], "statement": [{"ip_set_reference_statement": [{"arn": ["aws_wafv2_ip_set.known_bad_ips.arn"]}]}], "visibility_config": [{"cloudwatch_metrics_enabled": [true], "metric_name": ["BlockKnownBadIPs"], "sampled_requests_enabled": [true]}]}, {"name": ["AWS-AWSManagedRulesSQLiRuleSet"], "override_action": [{"none": [{}]}], "priority": [10], "statement": [{"managed_rule_group_statement": [{"name": ["AWSManagedRulesSQLiRuleSet"], "vendor_name": ["AWS"]}]}], "visibility_config": [{"cloudwatch_metrics_enabled": [true], "metric_name": ["AWSManagedRulesSQLiRuleSet"], "sampled_requests_enabled": [true]}]}, {"name": ["AWS-AWSManagedRulesXSSRuleSet"], "override_action": [{"none": [{}]}], "priority": [20], "statement": [{"managed_rule_group_statement": [{"name": ["AWSManagedRulesXSSRuleSet"], "vendor_name": ["AWS"]}]}], "visibility_config": [{"cloudwatch_metrics_enabled": [true], "metric_name": ["AWSManagedRulesXSSRuleSet"], "sampled_requests_enabled": [true]}]}, {"action": [{"block": [{}]}], "name": ["SizeConstraint"], "priority": [30], "statement": [{"size_constraint_statement": [{"comparison_operator": ["GT"], "field_to_match": [{"body": [{}]}], "size": [131072], "text_transformation": [{"priority": [0], "type": ["NONE"]}]}]}], "visibility_config": [{"cloudwatch_metrics_enabled": [true], "metric_name": ["SizeConstraint"], "sampled_requests_enabled": [true]}]}, {"action": [{"block": [{}]}], "name": ["RateBasedRule"], "priority": [40], "statement": [{"rate_based_statement": [{"aggregate_key_type": ["IP"], "limit": [1000]}]}], "visibility_config": [{"cloudwatch_metrics_enabled": [true], "metric_name": ["RateBasedRule"], "sampled_requests_enabled": [true]}]}, {"name": ["AWS-AWSManagedRulesKnownBadInputsRuleSet"], "override_action": [{"none": [{}]}], "priority": [50], "statement": [{"managed_rule_group_statement": [{"name": ["AWSManagedRulesKnownBadInputsRuleSet"], "vendor_name": ["AWS"]}]}], "visibility_config": [{"cloudwatch_metrics_enabled": [true], "metric_name": ["AWSManagedRulesKnownBadInputsRuleSet"], "sampled_requests_enabled": [true]}]}, {"name": ["AWS-AWSManagedRulesCommonRuleSet"], "override_action": [{"none": [{}]}], "priority": [60], "statement": [{"managed_rule_group_statement": [{"name": ["AWSManagedRulesCommonRuleSet"], "vendor_name": ["AWS"]}]}], "visibility_config": [{"cloudwatch_metrics_enabled": [true], "metric_name": ["AWSManagedRulesCommonRuleSet"], "sampled_requests_enabled": [true]}]}, {"name": ["AWS-AWSManagedRulesPHPRuleSet"], "override_action": [{"none": [{}]}], "priority": [70], "statement": [{"managed_rule_group_statement": [{"name": ["AWSManagedRulesPHPRuleSet"], "vendor_name": ["AWS"]}]}], "visibility_config": [{"cloudwatch_metrics_enabled": [true], "metric_name": ["AWSManagedRulesPHPRuleSet"], "sampled_requests_enabled": [true]}]}, {"name": ["AWS-AWSManagedRulesLinuxRuleSet"], "override_action": [{"none": [{}]}], "priority": [80], "statement": [{"managed_rule_group_statement": [{"name": ["AWSManagedRulesLinuxRuleSet"], "vendor_name": ["AWS"]}]}], "visibility_config": [{"cloudwatch_metrics_enabled": [true], "metric_name": ["AWSManagedRulesLinuxRuleSet"], "sampled_requests_enabled": [true]}]}, {"name": ["AWS-AWSManagedRulesBotControlRuleSet"], "override_action": [{"none": [{}]}], "priority": [90], "statement": [{"managed_rule_group_statement": [{"name": ["AWSManagedRulesBotControlRuleSet"], "vendor_name": ["AWS"]}]}], "visibility_config": [{"cloudwatch_metrics_enabled": [true], "metric_name": ["AWSManagedRulesBotControlRuleSet"], "sampled_requests_enabled": [true]}]}], "scope": ["REGIONAL"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-waf", "Project": "ecs-jenkins"}], "visibility_config": [{"cloudwatch_metrics_enabled": [true], "metric_name": ["owasp-top10-protection"], "sampled_requests_enabled": [true]}], "__address__": "module.ecs_jenkins_github.module.security.aws_wafv2_web_acl.owasp_top10_protection"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[20, "resource \"aws_wafv2_web_acl\" \"owasp_top10_protection\" {\n"], [21, "  name        = \"${var.project}-${var.environment}-owasp-protection\"\n"], [22, "  description = \"WAF WebACL with OWASP Top 10 protections\"\n"], [23, "  scope       = \"REGIONAL\"\n"], [24, "\n"], [25, "  default_action {\n"], [26, "    allow {}\n"], [27, "  }\n"], [28, "\n"], [29, "  # Rule #1: Block IPs from blocklist\n"], [30, "  rule {\n"], [31, "    name     = \"block-known-bad-ips\"\n"], [32, "    priority = 0\n"], [33, "\n"], [34, "    action {\n"], [35, "      block {}\n"], [36, "    }\n"], [37, "\n"], [38, "    statement {\n"], [39, "      ip_set_reference_statement {\n"], [40, "        arn = aws_wafv2_ip_set.known_bad_ips.arn\n"], [41, "      }\n"], [42, "    }\n"], [43, "\n"], [44, "    visibility_config {\n"], [45, "      cloudwatch_metrics_enabled = true\n"], [46, "      metric_name                = \"BlockKnownBadIPs\"\n"], [47, "      sampled_requests_enabled   = true\n"], [48, "    }\n"], [49, "  }\n"], [50, "\n"], [51, "  # Rule #2: AWS Managed Rules for SQL Injection\n"], [52, "  rule {\n"], [53, "    name     = \"AWS-AWSManagedRulesSQLiRuleSet\"\n"], [54, "    priority = 10\n"], [55, "\n"], [56, "    override_action {\n"], [57, "      none {}\n"], [58, "    }\n"], [59, "\n"], [60, "    statement {\n"], [61, "      managed_rule_group_statement {\n"], [62, "        name        = \"AWSManagedRulesSQLiRuleSet\"\n"], [63, "        vendor_name = \"AWS\"\n"], [64, "      }\n"], [65, "    }\n"], [66, "\n"], [67, "    visibility_config {\n"], [68, "      cloudwatch_metrics_enabled = true\n"], [69, "      metric_name                = \"AWSManagedRulesSQLiRuleSet\"\n"], [70, "      sampled_requests_enabled   = true\n"], [71, "    }\n"], [72, "  }\n"], [73, "\n"], [74, "  # Rule #3: AWS Managed Rules for XSS Protection\n"], [75, "  rule {\n"], [76, "    name     = \"AWS-AWSManagedRulesXSSRuleSet\"\n"], [77, "    priority = 20\n"], [78, "\n"], [79, "    override_action {\n"], [80, "      none {}\n"], [81, "    }\n"], [82, "\n"], [83, "    statement {\n"], [84, "      managed_rule_group_statement {\n"], [85, "        name        = \"AWSManagedRulesXSSRuleSet\"\n"], [86, "        vendor_name = \"AWS\"\n"], [87, "      }\n"], [88, "    }\n"], [89, "\n"], [90, "    visibility_config {\n"], [91, "      cloudwatch_metrics_enabled = true\n"], [92, "      metric_name                = \"AWSManagedRulesXSSRuleSet\"\n"], [93, "      sampled_requests_enabled   = true\n"], [94, "    }\n"], [95, "  }\n"], [96, "\n"], [97, "  # Rule #4: Size Constraint Rule - Prevents abnormally large requests\n"], [98, "  rule {\n"], [99, "    name     = \"SizeConstraint\"\n"], [100, "    priority = 30\n"], [101, "\n"], [102, "    action {\n"], [103, "      block {}\n"], [104, "    }\n"], [105, "\n"], [106, "    statement {\n"], [107, "      size_constraint_statement {\n"], [108, "        field_to_match {\n"], [109, "          body {}\n"], [110, "        }\n"], [111, "        comparison_operator = \"GT\"\n"], [112, "        size                = var.max_request_size\n"], [113, "        text_transformation {\n"], [114, "          priority = 0\n"], [115, "          type     = \"NONE\"\n"], [116, "        }\n"], [117, "      }\n"], [118, "    }\n"], [119, "\n"], [120, "    visibility_config {\n"], [121, "      cloudwatch_metrics_enabled = true\n"], [122, "      metric_name                = \"SizeConstraint\"\n"], [123, "      sampled_requests_enabled   = true\n"], [124, "    }\n"], [125, "  }\n"], [126, "\n"], [127, "  # Rule #5: Rate-Based Rule for DDoS protection\n"], [128, "  rule {\n"], [129, "    name     = \"RateBasedRule\"\n"], [130, "    priority = 40\n"], [131, "\n"], [132, "    action {\n"], [133, "      block {}\n"], [134, "    }\n"], [135, "\n"], [136, "    statement {\n"], [137, "      rate_based_statement {\n"], [138, "        limit              = var.request_limit\n"], [139, "        aggregate_key_type = \"IP\"\n"], [140, "      }\n"], [141, "    }\n"], [142, "\n"], [143, "    visibility_config {\n"], [144, "      cloudwatch_metrics_enabled = true\n"], [145, "      metric_name                = \"RateBasedRule\"\n"], [146, "      sampled_requests_enabled   = true\n"], [147, "    }\n"], [148, "  }\n"], [149, "\n"], [150, "  # Rule #6: AWS Managed Rules for Known Bad Inputs\n"], [151, "  rule {\n"], [152, "    name     = \"AWS-AWSManagedRulesKnownBadInputsRuleSet\"\n"], [153, "    priority = 50\n"], [154, "\n"], [155, "    override_action {\n"], [156, "      none {}\n"], [157, "    }\n"], [158, "\n"], [159, "    statement {\n"], [160, "      managed_rule_group_statement {\n"], [161, "        name        = \"AWSManagedRulesKnownBadInputsRuleSet\"\n"], [162, "        vendor_name = \"AWS\"\n"], [163, "      }\n"], [164, "    }\n"], [165, "\n"], [166, "    visibility_config {\n"], [167, "      cloudwatch_metrics_enabled = true\n"], [168, "      metric_name                = \"AWSManagedRulesKnownBadInputsRuleSet\"\n"], [169, "      sampled_requests_enabled   = true\n"], [170, "    }\n"], [171, "  }\n"], [172, "\n"], [173, "  # Rule #7: AWS Managed Rules for OWASP Core Ruleset\n"], [174, "  rule {\n"], [175, "    name     = \"AWS-AWSManagedRulesCommonRuleSet\"\n"], [176, "    priority = 60\n"], [177, "\n"], [178, "    override_action {\n"], [179, "      none {}\n"], [180, "    }\n"], [181, "\n"], [182, "    statement {\n"], [183, "      managed_rule_group_statement {\n"], [184, "        name        = \"AWSManagedRulesCommonRuleSet\"\n"], [185, "        vendor_name = \"AWS\"\n"], [186, "      }\n"], [187, "    }\n"], [188, "\n"], [189, "    visibility_config {\n"], [190, "      cloudwatch_metrics_enabled = true\n"], [191, "      metric_name                = \"AWSManagedRulesCommonRuleSet\"\n"], [192, "      sampled_requests_enabled   = true\n"], [193, "    }\n"], [194, "  }\n"], [195, "\n"], [196, "  # Rule #8: AWS Managed Rules for PHP applications\n"], [197, "  rule {\n"], [198, "    name     = \"AWS-AWSManagedRulesPHPRuleSet\"\n"], [199, "    priority = 70\n"], [200, "\n"], [201, "    override_action {\n"], [202, "      none {}\n"], [203, "    }\n"], [204, "\n"], [205, "    statement {\n"], [206, "      managed_rule_group_statement {\n"], [207, "        name        = \"AWSManagedRulesPHPRuleSet\"\n"], [208, "        vendor_name = \"AWS\"\n"], [209, "      }\n"], [210, "    }\n"], [211, "\n"], [212, "    visibility_config {\n"], [213, "      cloudwatch_metrics_enabled = true\n"], [214, "      metric_name                = \"AWSManagedRulesPHPRuleSet\"\n"], [215, "      sampled_requests_enabled   = true\n"], [216, "    }\n"], [217, "  }\n"], [218, "\n"], [219, "  # Rule #9: AWS Managed Rules for Linux OS\n"], [220, "  rule {\n"], [221, "    name     = \"AWS-AWSManagedRulesLinuxRuleSet\"\n"], [222, "    priority = 80\n"], [223, "\n"], [224, "    override_action {\n"], [225, "      none {}\n"], [226, "    }\n"], [227, "\n"], [228, "    statement {\n"], [229, "      managed_rule_group_statement {\n"], [230, "        name        = \"AWSManagedRulesLinuxRuleSet\"\n"], [231, "        vendor_name = \"AWS\"\n"], [232, "      }\n"], [233, "    }\n"], [234, "\n"], [235, "    visibility_config {\n"], [236, "      cloudwatch_metrics_enabled = true\n"], [237, "      metric_name                = \"AWSManagedRulesLinuxRuleSet\"\n"], [238, "      sampled_requests_enabled   = true\n"], [239, "    }\n"], [240, "  }\n"], [241, "\n"], [242, "  # Rule #10: AWS Managed Rules for Bot Control\n"], [243, "  rule {\n"], [244, "    name     = \"AWS-AWSManagedRulesBotControlRuleSet\"\n"], [245, "    priority = 90\n"], [246, "\n"], [247, "    override_action {\n"], [248, "      none {}\n"], [249, "    }\n"], [250, "\n"], [251, "    statement {\n"], [252, "      managed_rule_group_statement {\n"], [253, "        name        = \"AWSManagedRulesBotControlRuleSet\"\n"], [254, "        vendor_name = \"AWS\"\n"], [255, "      }\n"], [256, "    }\n"], [257, "\n"], [258, "    visibility_config {\n"], [259, "      cloudwatch_metrics_enabled = true\n"], [260, "      metric_name                = \"AWSManagedRulesBotControlRuleSet\"\n"], [261, "      sampled_requests_enabled   = true\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "  visibility_config {\n"], [266, "    cloudwatch_metrics_enabled = true\n"], [267, "    metric_name                = \"owasp-top10-protection\"\n"], [268, "    sampled_requests_enabled   = true\n"], [269, "  }\n"], [270, "\n"], [271, "  # Prevent terraform from rebuilding this resource unless actual changes are made\n"], [272, "  lifecycle {\n"], [273, "    create_before_destroy = true\n"], [274, "  }\n"], [275, "\n"], [276, "  tags = {\n"], [277, "    Name        = \"${var.project}-${var.environment}-waf\"\n"], [278, "    Environment = var.environment\n"], [279, "    Project     = var.project\n"], [280, "  }\n"], [281, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [20, 281], "resource": "module.ecs_jenkins_github.module.security.aws_wafv2_web_acl.owasp_top10_protection", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-waf", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[588, "resource \"aws_wafv2_web_acl_logging_configuration\" \"waf_logging\" {\n"], [589, "  log_destination_configs = [aws_s3_bucket.waf_logs.arn]\n"], [590, "  resource_arn            = aws_wafv2_web_acl.owasp_top10_protection.arn\n"], [591, "  redacted_fields {\n"], [592, "    single_header {\n"], [593, "      name = \"authorization\"\n"], [594, "    }\n"], [595, "  }\n"], [596, "}\n"]], "file_path": "\\..\\security\\main.tf", "file_line_range": [588, 596], "resource": "aws_wafv2_web_acl_logging_configuration.waf_logging", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-logging-33", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV2_AWS_31", "bc_check_id": "BC_AWS_LOGGING_33", "check_name": "Ensure WAF2 has a Logging Configuration", "check_result": {"result": "PASSED", "entity": {"aws_wafv2_web_acl": {"owasp_top10_protection": {"__end_line__": 281, "__start_line__": 20, "default_action": [{"allow": [{}]}], "description": ["WAF WebACL with OWASP Top 10 protections"], "lifecycle": [{"create_before_destroy": [true]}], "name": ["ecs-jenkins-dr-owasp-protection"], "rule": [{"action": [{"block": [{}]}], "name": ["block-known-bad-ips"], "priority": [0], "statement": [{"ip_set_reference_statement": [{"arn": ["aws_wafv2_ip_set.known_bad_ips.arn"]}]}], "visibility_config": [{"cloudwatch_metrics_enabled": [true], "metric_name": ["BlockKnownBadIPs"], "sampled_requests_enabled": [true]}]}, {"name": ["AWS-AWSManagedRulesSQLiRuleSet"], "override_action": [{"none": [{}]}], "priority": [10], "statement": [{"managed_rule_group_statement": [{"name": ["AWSManagedRulesSQLiRuleSet"], "vendor_name": ["AWS"]}]}], "visibility_config": [{"cloudwatch_metrics_enabled": [true], "metric_name": ["AWSManagedRulesSQLiRuleSet"], "sampled_requests_enabled": [true]}]}, {"name": ["AWS-AWSManagedRulesXSSRuleSet"], "override_action": [{"none": [{}]}], "priority": [20], "statement": [{"managed_rule_group_statement": [{"name": ["AWSManagedRulesXSSRuleSet"], "vendor_name": ["AWS"]}]}], "visibility_config": [{"cloudwatch_metrics_enabled": [true], "metric_name": ["AWSManagedRulesXSSRuleSet"], "sampled_requests_enabled": [true]}]}, {"action": [{"block": [{}]}], "name": ["SizeConstraint"], "priority": [30], "statement": [{"size_constraint_statement": [{"comparison_operator": ["GT"], "field_to_match": [{"body": [{}]}], "size": [131072], "text_transformation": [{"priority": [0], "type": ["NONE"]}]}]}], "visibility_config": [{"cloudwatch_metrics_enabled": [true], "metric_name": ["SizeConstraint"], "sampled_requests_enabled": [true]}]}, {"action": [{"block": [{}]}], "name": ["RateBasedRule"], "priority": [40], "statement": [{"rate_based_statement": [{"aggregate_key_type": ["IP"], "limit": [1000]}]}], "visibility_config": [{"cloudwatch_metrics_enabled": [true], "metric_name": ["RateBasedRule"], "sampled_requests_enabled": [true]}]}, {"name": ["AWS-AWSManagedRulesKnownBadInputsRuleSet"], "override_action": [{"none": [{}]}], "priority": [50], "statement": [{"managed_rule_group_statement": [{"name": ["AWSManagedRulesKnownBadInputsRuleSet"], "vendor_name": ["AWS"]}]}], "visibility_config": [{"cloudwatch_metrics_enabled": [true], "metric_name": ["AWSManagedRulesKnownBadInputsRuleSet"], "sampled_requests_enabled": [true]}]}, {"name": ["AWS-AWSManagedRulesCommonRuleSet"], "override_action": [{"none": [{}]}], "priority": [60], "statement": [{"managed_rule_group_statement": [{"name": ["AWSManagedRulesCommonRuleSet"], "vendor_name": ["AWS"]}]}], "visibility_config": [{"cloudwatch_metrics_enabled": [true], "metric_name": ["AWSManagedRulesCommonRuleSet"], "sampled_requests_enabled": [true]}]}, {"name": ["AWS-AWSManagedRulesPHPRuleSet"], "override_action": [{"none": [{}]}], "priority": [70], "statement": [{"managed_rule_group_statement": [{"name": ["AWSManagedRulesPHPRuleSet"], "vendor_name": ["AWS"]}]}], "visibility_config": [{"cloudwatch_metrics_enabled": [true], "metric_name": ["AWSManagedRulesPHPRuleSet"], "sampled_requests_enabled": [true]}]}, {"name": ["AWS-AWSManagedRulesLinuxRuleSet"], "override_action": [{"none": [{}]}], "priority": [80], "statement": [{"managed_rule_group_statement": [{"name": ["AWSManagedRulesLinuxRuleSet"], "vendor_name": ["AWS"]}]}], "visibility_config": [{"cloudwatch_metrics_enabled": [true], "metric_name": ["AWSManagedRulesLinuxRuleSet"], "sampled_requests_enabled": [true]}]}, {"name": ["AWS-AWSManagedRulesBotControlRuleSet"], "override_action": [{"none": [{}]}], "priority": [90], "statement": [{"managed_rule_group_statement": [{"name": ["AWSManagedRulesBotControlRuleSet"], "vendor_name": ["AWS"]}]}], "visibility_config": [{"cloudwatch_metrics_enabled": [true], "metric_name": ["AWSManagedRulesBotControlRuleSet"], "sampled_requests_enabled": [true]}]}], "scope": ["REGIONAL"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-waf", "Project": "ecs-jenkins"}], "visibility_config": [{"cloudwatch_metrics_enabled": [true], "metric_name": ["owasp-top10-protection"], "sampled_requests_enabled": [true]}], "__address__": "module.ecs_jenkins_github_dr.module.security.aws_wafv2_web_acl.owasp_top10_protection"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[20, "resource \"aws_wafv2_web_acl\" \"owasp_top10_protection\" {\n"], [21, "  name        = \"${var.project}-${var.environment}-owasp-protection\"\n"], [22, "  description = \"WAF WebACL with OWASP Top 10 protections\"\n"], [23, "  scope       = \"REGIONAL\"\n"], [24, "\n"], [25, "  default_action {\n"], [26, "    allow {}\n"], [27, "  }\n"], [28, "\n"], [29, "  # Rule #1: Block IPs from blocklist\n"], [30, "  rule {\n"], [31, "    name     = \"block-known-bad-ips\"\n"], [32, "    priority = 0\n"], [33, "\n"], [34, "    action {\n"], [35, "      block {}\n"], [36, "    }\n"], [37, "\n"], [38, "    statement {\n"], [39, "      ip_set_reference_statement {\n"], [40, "        arn = aws_wafv2_ip_set.known_bad_ips.arn\n"], [41, "      }\n"], [42, "    }\n"], [43, "\n"], [44, "    visibility_config {\n"], [45, "      cloudwatch_metrics_enabled = true\n"], [46, "      metric_name                = \"BlockKnownBadIPs\"\n"], [47, "      sampled_requests_enabled   = true\n"], [48, "    }\n"], [49, "  }\n"], [50, "\n"], [51, "  # Rule #2: AWS Managed Rules for SQL Injection\n"], [52, "  rule {\n"], [53, "    name     = \"AWS-AWSManagedRulesSQLiRuleSet\"\n"], [54, "    priority = 10\n"], [55, "\n"], [56, "    override_action {\n"], [57, "      none {}\n"], [58, "    }\n"], [59, "\n"], [60, "    statement {\n"], [61, "      managed_rule_group_statement {\n"], [62, "        name        = \"AWSManagedRulesSQLiRuleSet\"\n"], [63, "        vendor_name = \"AWS\"\n"], [64, "      }\n"], [65, "    }\n"], [66, "\n"], [67, "    visibility_config {\n"], [68, "      cloudwatch_metrics_enabled = true\n"], [69, "      metric_name                = \"AWSManagedRulesSQLiRuleSet\"\n"], [70, "      sampled_requests_enabled   = true\n"], [71, "    }\n"], [72, "  }\n"], [73, "\n"], [74, "  # Rule #3: AWS Managed Rules for XSS Protection\n"], [75, "  rule {\n"], [76, "    name     = \"AWS-AWSManagedRulesXSSRuleSet\"\n"], [77, "    priority = 20\n"], [78, "\n"], [79, "    override_action {\n"], [80, "      none {}\n"], [81, "    }\n"], [82, "\n"], [83, "    statement {\n"], [84, "      managed_rule_group_statement {\n"], [85, "        name        = \"AWSManagedRulesXSSRuleSet\"\n"], [86, "        vendor_name = \"AWS\"\n"], [87, "      }\n"], [88, "    }\n"], [89, "\n"], [90, "    visibility_config {\n"], [91, "      cloudwatch_metrics_enabled = true\n"], [92, "      metric_name                = \"AWSManagedRulesXSSRuleSet\"\n"], [93, "      sampled_requests_enabled   = true\n"], [94, "    }\n"], [95, "  }\n"], [96, "\n"], [97, "  # Rule #4: Size Constraint Rule - Prevents abnormally large requests\n"], [98, "  rule {\n"], [99, "    name     = \"SizeConstraint\"\n"], [100, "    priority = 30\n"], [101, "\n"], [102, "    action {\n"], [103, "      block {}\n"], [104, "    }\n"], [105, "\n"], [106, "    statement {\n"], [107, "      size_constraint_statement {\n"], [108, "        field_to_match {\n"], [109, "          body {}\n"], [110, "        }\n"], [111, "        comparison_operator = \"GT\"\n"], [112, "        size                = var.max_request_size\n"], [113, "        text_transformation {\n"], [114, "          priority = 0\n"], [115, "          type     = \"NONE\"\n"], [116, "        }\n"], [117, "      }\n"], [118, "    }\n"], [119, "\n"], [120, "    visibility_config {\n"], [121, "      cloudwatch_metrics_enabled = true\n"], [122, "      metric_name                = \"SizeConstraint\"\n"], [123, "      sampled_requests_enabled   = true\n"], [124, "    }\n"], [125, "  }\n"], [126, "\n"], [127, "  # Rule #5: Rate-Based Rule for DDoS protection\n"], [128, "  rule {\n"], [129, "    name     = \"RateBasedRule\"\n"], [130, "    priority = 40\n"], [131, "\n"], [132, "    action {\n"], [133, "      block {}\n"], [134, "    }\n"], [135, "\n"], [136, "    statement {\n"], [137, "      rate_based_statement {\n"], [138, "        limit              = var.request_limit\n"], [139, "        aggregate_key_type = \"IP\"\n"], [140, "      }\n"], [141, "    }\n"], [142, "\n"], [143, "    visibility_config {\n"], [144, "      cloudwatch_metrics_enabled = true\n"], [145, "      metric_name                = \"RateBasedRule\"\n"], [146, "      sampled_requests_enabled   = true\n"], [147, "    }\n"], [148, "  }\n"], [149, "\n"], [150, "  # Rule #6: AWS Managed Rules for Known Bad Inputs\n"], [151, "  rule {\n"], [152, "    name     = \"AWS-AWSManagedRulesKnownBadInputsRuleSet\"\n"], [153, "    priority = 50\n"], [154, "\n"], [155, "    override_action {\n"], [156, "      none {}\n"], [157, "    }\n"], [158, "\n"], [159, "    statement {\n"], [160, "      managed_rule_group_statement {\n"], [161, "        name        = \"AWSManagedRulesKnownBadInputsRuleSet\"\n"], [162, "        vendor_name = \"AWS\"\n"], [163, "      }\n"], [164, "    }\n"], [165, "\n"], [166, "    visibility_config {\n"], [167, "      cloudwatch_metrics_enabled = true\n"], [168, "      metric_name                = \"AWSManagedRulesKnownBadInputsRuleSet\"\n"], [169, "      sampled_requests_enabled   = true\n"], [170, "    }\n"], [171, "  }\n"], [172, "\n"], [173, "  # Rule #7: AWS Managed Rules for OWASP Core Ruleset\n"], [174, "  rule {\n"], [175, "    name     = \"AWS-AWSManagedRulesCommonRuleSet\"\n"], [176, "    priority = 60\n"], [177, "\n"], [178, "    override_action {\n"], [179, "      none {}\n"], [180, "    }\n"], [181, "\n"], [182, "    statement {\n"], [183, "      managed_rule_group_statement {\n"], [184, "        name        = \"AWSManagedRulesCommonRuleSet\"\n"], [185, "        vendor_name = \"AWS\"\n"], [186, "      }\n"], [187, "    }\n"], [188, "\n"], [189, "    visibility_config {\n"], [190, "      cloudwatch_metrics_enabled = true\n"], [191, "      metric_name                = \"AWSManagedRulesCommonRuleSet\"\n"], [192, "      sampled_requests_enabled   = true\n"], [193, "    }\n"], [194, "  }\n"], [195, "\n"], [196, "  # Rule #8: AWS Managed Rules for PHP applications\n"], [197, "  rule {\n"], [198, "    name     = \"AWS-AWSManagedRulesPHPRuleSet\"\n"], [199, "    priority = 70\n"], [200, "\n"], [201, "    override_action {\n"], [202, "      none {}\n"], [203, "    }\n"], [204, "\n"], [205, "    statement {\n"], [206, "      managed_rule_group_statement {\n"], [207, "        name        = \"AWSManagedRulesPHPRuleSet\"\n"], [208, "        vendor_name = \"AWS\"\n"], [209, "      }\n"], [210, "    }\n"], [211, "\n"], [212, "    visibility_config {\n"], [213, "      cloudwatch_metrics_enabled = true\n"], [214, "      metric_name                = \"AWSManagedRulesPHPRuleSet\"\n"], [215, "      sampled_requests_enabled   = true\n"], [216, "    }\n"], [217, "  }\n"], [218, "\n"], [219, "  # Rule #9: AWS Managed Rules for Linux OS\n"], [220, "  rule {\n"], [221, "    name     = \"AWS-AWSManagedRulesLinuxRuleSet\"\n"], [222, "    priority = 80\n"], [223, "\n"], [224, "    override_action {\n"], [225, "      none {}\n"], [226, "    }\n"], [227, "\n"], [228, "    statement {\n"], [229, "      managed_rule_group_statement {\n"], [230, "        name        = \"AWSManagedRulesLinuxRuleSet\"\n"], [231, "        vendor_name = \"AWS\"\n"], [232, "      }\n"], [233, "    }\n"], [234, "\n"], [235, "    visibility_config {\n"], [236, "      cloudwatch_metrics_enabled = true\n"], [237, "      metric_name                = \"AWSManagedRulesLinuxRuleSet\"\n"], [238, "      sampled_requests_enabled   = true\n"], [239, "    }\n"], [240, "  }\n"], [241, "\n"], [242, "  # Rule #10: AWS Managed Rules for Bot Control\n"], [243, "  rule {\n"], [244, "    name     = \"AWS-AWSManagedRulesBotControlRuleSet\"\n"], [245, "    priority = 90\n"], [246, "\n"], [247, "    override_action {\n"], [248, "      none {}\n"], [249, "    }\n"], [250, "\n"], [251, "    statement {\n"], [252, "      managed_rule_group_statement {\n"], [253, "        name        = \"AWSManagedRulesBotControlRuleSet\"\n"], [254, "        vendor_name = \"AWS\"\n"], [255, "      }\n"], [256, "    }\n"], [257, "\n"], [258, "    visibility_config {\n"], [259, "      cloudwatch_metrics_enabled = true\n"], [260, "      metric_name                = \"AWSManagedRulesBotControlRuleSet\"\n"], [261, "      sampled_requests_enabled   = true\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "  visibility_config {\n"], [266, "    cloudwatch_metrics_enabled = true\n"], [267, "    metric_name                = \"owasp-top10-protection\"\n"], [268, "    sampled_requests_enabled   = true\n"], [269, "  }\n"], [270, "\n"], [271, "  # Prevent terraform from rebuilding this resource unless actual changes are made\n"], [272, "  lifecycle {\n"], [273, "    create_before_destroy = true\n"], [274, "  }\n"], [275, "\n"], [276, "  tags = {\n"], [277, "    Name        = \"${var.project}-${var.environment}-waf\"\n"], [278, "    Environment = var.environment\n"], [279, "    Project     = var.project\n"], [280, "  }\n"], [281, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [20, 281], "resource": "module.ecs_jenkins_github_dr.module.security.aws_wafv2_web_acl.owasp_top10_protection", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-waf", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[588, "resource \"aws_wafv2_web_acl_logging_configuration\" \"waf_logging\" {\n"], [589, "  log_destination_configs = [aws_s3_bucket.waf_logs.arn]\n"], [590, "  resource_arn            = aws_wafv2_web_acl.owasp_top10_protection.arn\n"], [591, "  redacted_fields {\n"], [592, "    single_header {\n"], [593, "      name = \"authorization\"\n"], [594, "    }\n"], [595, "  }\n"], [596, "}\n"]], "file_path": "\\main.tf", "file_line_range": [588, 596], "resource": "aws_wafv2_web_acl_logging_configuration.waf_logging", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-logging-33", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_378", "bc_check_id": "BC_AWS_NETWORKING_103", "check_name": "Ensure AWS Load Balancer doesn't use HTTP protocol", "check_result": {"result": "PASSED", "entity": {"aws_lb_target_group": {"jenkins": {"__end_line__": 210, "__start_line__": 189, "health_check": [{"enabled": [true], "healthy_threshold": [3], "interval": [30], "port": [8080], "protocol": ["TCP"], "unhealthy_threshold": [3]}], "name": ["ecs-jenkins-prod-jenkins-tg"], "port": [8080], "protocol": ["TCP"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-tg", "Project": "ecs-jenkins"}], "target_type": ["instance"], "vpc_id": ["aws_vpc.vpc.id"], "__address__": "module.ecs_jenkins_github.module.cicd.aws_lb_target_group.jenkins"}}}, "evaluated_keys": ["protocol", "resource_type"]}, "code_block": [[189, "resource \"aws_lb_target_group\" \"jenkins\" {\n"], [190, "  name        = \"${var.project}-${var.environment}-jenkins-tg\"\n"], [191, "  port        = 8080\n"], [192, "  protocol    = \"TCP\"\n"], [193, "  vpc_id      = var.vpc_id\n"], [194, "  target_type = \"instance\"\n"], [195, "\n"], [196, "  health_check {\n"], [197, "    enabled             = true\n"], [198, "    interval            = 30\n"], [199, "    port                = 8080\n"], [200, "    protocol            = \"TCP\"\n"], [201, "    healthy_threshold   = 3\n"], [202, "    unhealthy_threshold = 3\n"], [203, "  }\n"], [204, "\n"], [205, "  tags = {\n"], [206, "    Name        = \"${var.project}-${var.environment}-jenkins-tg\"\n"], [207, "    Environment = var.environment\n"], [208, "    Project     = var.project\n"], [209, "  }\n"], [210, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [189, 210], "resource": "module.ecs_jenkins_github.module.cicd.aws_lb_target_group.jenkins", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-tg", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[219, "resource \"aws_lb_listener\" \"jenkins\" {\n"], [220, "  load_balancer_arn = aws_lb.jenkins_nlb.arn\n"], [221, "  port              = 80\n"], [222, "  protocol          = \"TCP\"\n"], [223, "\n"], [224, "  default_action {\n"], [225, "    type             = \"forward\"\n"], [226, "    target_group_arn = aws_lb_target_group.jenkins.arn\n"], [227, "  }\n"], [228, "}\n"]], "file_path": "\\..\\cicd\\main.tf", "file_line_range": [219, 228], "resource": "aws_lb_listener.jenkins", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-378", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_378", "bc_check_id": "BC_AWS_NETWORKING_103", "check_name": "Ensure AWS Load Balancer doesn't use HTTP protocol", "check_result": {"result": "PASSED", "entity": {"aws_lb_target_group": {"jenkins": {"__end_line__": 210, "__start_line__": 189, "health_check": [{"enabled": [true], "healthy_threshold": [3], "interval": [30], "port": [8080], "protocol": ["TCP"], "unhealthy_threshold": [3]}], "name": ["ecs-jenkins-dr-jenkins-tg"], "port": [8080], "protocol": ["TCP"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-tg", "Project": "ecs-jenkins"}], "target_type": ["instance"], "vpc_id": ["aws_vpc.vpc.id"], "__address__": "module.ecs_jenkins_github_dr.module.cicd.aws_lb_target_group.jenkins"}}}, "evaluated_keys": ["protocol", "resource_type"]}, "code_block": [[189, "resource \"aws_lb_target_group\" \"jenkins\" {\n"], [190, "  name        = \"${var.project}-${var.environment}-jenkins-tg\"\n"], [191, "  port        = 8080\n"], [192, "  protocol    = \"TCP\"\n"], [193, "  vpc_id      = var.vpc_id\n"], [194, "  target_type = \"instance\"\n"], [195, "\n"], [196, "  health_check {\n"], [197, "    enabled             = true\n"], [198, "    interval            = 30\n"], [199, "    port                = 8080\n"], [200, "    protocol            = \"TCP\"\n"], [201, "    healthy_threshold   = 3\n"], [202, "    unhealthy_threshold = 3\n"], [203, "  }\n"], [204, "\n"], [205, "  tags = {\n"], [206, "    Name        = \"${var.project}-${var.environment}-jenkins-tg\"\n"], [207, "    Environment = var.environment\n"], [208, "    Project     = var.project\n"], [209, "  }\n"], [210, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [189, 210], "resource": "module.ecs_jenkins_github_dr.module.cicd.aws_lb_target_group.jenkins", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-tg", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[219, "resource \"aws_lb_listener\" \"jenkins\" {\n"], [220, "  load_balancer_arn = aws_lb.jenkins_nlb.arn\n"], [221, "  port              = 80\n"], [222, "  protocol          = \"TCP\"\n"], [223, "\n"], [224, "  default_action {\n"], [225, "    type             = \"forward\"\n"], [226, "    target_group_arn = aws_lb_target_group.jenkins.arn\n"], [227, "  }\n"], [228, "}\n"]], "file_path": "\\main.tf", "file_line_range": [219, 228], "resource": "aws_lb_listener.jenkins", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-378", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs": {"__end_line__": 134, "__start_line__": 126, "bucket": ["alb-logs-prod-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "prod", "Name": "alb-access-logs"}], "__address__": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs"}}}, "evaluated_keys": ["resource_type", "logging"]}, "code_block": [[126, "resource \"aws_s3_bucket\" \"alb_logs\" {\n"], [127, "  bucket        = \"alb-logs-${var.environment}-${random_string.suffix.result}\"\n"], [128, "  force_destroy = true\n"], [129, "\n"], [130, "  tags = {\n"], [131, "    Name        = \"alb-access-logs\"\n"], [132, "    Environment = var.environment\n"], [133, "  }\n"], [134, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [126, 134], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "alb-access-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[245, "resource \"aws_s3_bucket_logging\" \"alb_logs_logging\" {\n"], [246, "  bucket = aws_s3_bucket.alb_logs.id\n"], [247, "\n"], [248, "  target_bucket = aws_s3_bucket.alb_logs_access_logs.id\n"], [249, "  target_prefix = \"log/\"\n"], [250, "}\n"]], "file_path": "\\..\\network\\main.tf", "file_line_range": [245, 250], "resource": "aws_s3_bucket_logging.alb_logs_logging", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs_access_logs": {"__end_line__": 145, "__start_line__": 137, "bucket": ["alb-logs-access-prod-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "prod", "Name": "alb-access-logs-access"}], "__address__": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs_access_logs"}}}, "evaluated_keys": ["resource_type", "logging"]}, "code_block": [[137, "resource \"aws_s3_bucket\" \"alb_logs_access_logs\" {\n"], [138, "  bucket        = \"alb-logs-access-${var.environment}-${random_string.suffix.result}\"\n"], [139, "  force_destroy = true\n"], [140, "\n"], [141, "  tags = {\n"], [142, "    Name        = \"alb-access-logs-access\"\n"], [143, "    Environment = var.environment\n"], [144, "  }\n"], [145, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [137, 145], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs_access_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "alb-access-logs-access"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[261, "resource \"aws_s3_bucket_logging\" \"replication_logs_logging\" {\n"], [262, "  bucket = aws_s3_bucket.replication_logs.id\n"], [263, "\n"], [264, "  target_bucket = aws_s3_bucket.alb_logs_access_logs.id\n"], [265, "  target_prefix = \"replication-log/\"\n"], [266, "}\n"]], "file_path": "\\main.tf", "file_line_range": [261, 266], "resource": "aws_s3_bucket_logging.replication_logs_logging", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"replication_logs": {"__end_line__": 156, "__start_line__": 148, "bucket": ["replication-logs-prod-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "prod", "Name": "replication-logs"}], "__address__": "module.ecs_jenkins_github.module.network.aws_s3_bucket.replication_logs"}}}, "evaluated_keys": ["resource_type", "logging"]}, "code_block": [[148, "resource \"aws_s3_bucket\" \"replication_logs\" {\n"], [149, "  bucket        = \"replication-logs-${var.environment}-${random_string.suffix.result}\"\n"], [150, "  force_destroy = true\n"], [151, "\n"], [152, "  tags = {\n"], [153, "    Name        = \"replication-logs\"\n"], [154, "    Environment = var.environment\n"], [155, "  }\n"], [156, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [148, 156], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.replication_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "replication-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[261, "resource \"aws_s3_bucket_logging\" \"replication_logs_logging\" {\n"], [262, "  bucket = aws_s3_bucket.replication_logs.id\n"], [263, "\n"], [264, "  target_bucket = aws_s3_bucket.alb_logs_access_logs.id\n"], [265, "  target_prefix = \"replication-log/\"\n"], [266, "}\n"]], "file_path": "\\main.tf", "file_line_range": [261, 266], "resource": "aws_s3_bucket_logging.replication_logs_logging", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs": {"__end_line__": 134, "__start_line__": 126, "bucket": ["alb-logs-dr-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "dr", "Name": "alb-access-logs"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs"}}}, "evaluated_keys": ["resource_type", "logging"]}, "code_block": [[126, "resource \"aws_s3_bucket\" \"alb_logs\" {\n"], [127, "  bucket        = \"alb-logs-${var.environment}-${random_string.suffix.result}\"\n"], [128, "  force_destroy = true\n"], [129, "\n"], [130, "  tags = {\n"], [131, "    Name        = \"alb-access-logs\"\n"], [132, "    Environment = var.environment\n"], [133, "  }\n"], [134, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [126, 134], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "alb-access-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[245, "resource \"aws_s3_bucket_logging\" \"alb_logs_logging\" {\n"], [246, "  bucket = aws_s3_bucket.alb_logs.id\n"], [247, "\n"], [248, "  target_bucket = aws_s3_bucket.alb_logs_access_logs.id\n"], [249, "  target_prefix = \"log/\"\n"], [250, "}\n"]], "file_path": "\\main.tf", "file_line_range": [245, 250], "resource": "aws_s3_bucket_logging.alb_logs_logging", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs_access_logs": {"__end_line__": 145, "__start_line__": 137, "bucket": ["alb-logs-access-dr-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "dr", "Name": "alb-access-logs-access"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs_access_logs"}}}, "evaluated_keys": ["resource_type", "logging"]}, "code_block": [[137, "resource \"aws_s3_bucket\" \"alb_logs_access_logs\" {\n"], [138, "  bucket        = \"alb-logs-access-${var.environment}-${random_string.suffix.result}\"\n"], [139, "  force_destroy = true\n"], [140, "\n"], [141, "  tags = {\n"], [142, "    Name        = \"alb-access-logs-access\"\n"], [143, "    Environment = var.environment\n"], [144, "  }\n"], [145, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [137, 145], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs_access_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "alb-access-logs-access"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[261, "resource \"aws_s3_bucket_logging\" \"replication_logs_logging\" {\n"], [262, "  bucket = aws_s3_bucket.replication_logs.id\n"], [263, "\n"], [264, "  target_bucket = aws_s3_bucket.alb_logs_access_logs.id\n"], [265, "  target_prefix = \"replication-log/\"\n"], [266, "}\n"]], "file_path": "\\main.tf", "file_line_range": [261, 266], "resource": "aws_s3_bucket_logging.replication_logs_logging", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"replication_logs": {"__end_line__": 156, "__start_line__": 148, "bucket": ["replication-logs-dr-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "dr", "Name": "replication-logs"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.replication_logs"}}}, "evaluated_keys": ["resource_type", "logging"]}, "code_block": [[148, "resource \"aws_s3_bucket\" \"replication_logs\" {\n"], [149, "  bucket        = \"replication-logs-${var.environment}-${random_string.suffix.result}\"\n"], [150, "  force_destroy = true\n"], [151, "\n"], [152, "  tags = {\n"], [153, "    Name        = \"replication-logs\"\n"], [154, "    Environment = var.environment\n"], [155, "  }\n"], [156, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [148, 156], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.replication_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "replication-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[261, "resource \"aws_s3_bucket_logging\" \"replication_logs_logging\" {\n"], [262, "  bucket = aws_s3_bucket.replication_logs.id\n"], [263, "\n"], [264, "  target_bucket = aws_s3_bucket.alb_logs_access_logs.id\n"], [265, "  target_prefix = \"replication-log/\"\n"], [266, "}\n"]], "file_path": "\\main.tf", "file_line_range": [261, 266], "resource": "aws_s3_bucket_logging.replication_logs_logging", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_57", "bc_check_id": "BC_AWS_S3_2", "check_name": "S3 Bucket has an ACL defined which allows public WRITE access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"patch_logs": {"__end_line__": 207, "__start_line__": 199, "bucket": ["ecs-jenkins-prod-patch-logs-${random_string.suffix.result}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-patch-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.ec2.aws_s3_bucket.patch_logs"}}}, "evaluated_keys": ["access_control_policy/grant", "access_control_policy/grant/*/permission", "access_control_policy/grant/*/grantee/uri", "resource_type", "acl", "access_control_policy"]}, "code_block": [[199, "resource \"aws_s3_bucket\" \"patch_logs\" {\n"], [200, "  bucket = \"${var.project}-${var.environment}-patch-logs-${random_string.suffix.result}\"\n"], [201, "\n"], [202, "  tags = {\n"], [203, "    Name        = \"${var.project}-${var.environment}-patch-logs\"\n"], [204, "    Environment = var.environment\n"], [205, "    Project     = var.project\n"], [206, "  }\n"], [207, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [199, 207], "resource": "module.ecs_jenkins_github.module.ec2.aws_s3_bucket.patch_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-patch-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-2-acl-write-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_57", "bc_check_id": "BC_AWS_S3_2", "check_name": "S3 Bucket has an ACL defined which allows public WRITE access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"patch_logs": {"__end_line__": 207, "__start_line__": 199, "bucket": ["ecs-jenkins-dr-patch-logs-${random_string.suffix.result}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-patch-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.ec2.aws_s3_bucket.patch_logs"}}}, "evaluated_keys": ["access_control_policy/grant", "access_control_policy/grant/*/permission", "access_control_policy/grant/*/grantee/uri", "resource_type", "acl", "access_control_policy"]}, "code_block": [[199, "resource \"aws_s3_bucket\" \"patch_logs\" {\n"], [200, "  bucket = \"${var.project}-${var.environment}-patch-logs-${random_string.suffix.result}\"\n"], [201, "\n"], [202, "  tags = {\n"], [203, "    Name        = \"${var.project}-${var.environment}-patch-logs\"\n"], [204, "    Environment = var.environment\n"], [205, "    Project     = var.project\n"], [206, "  }\n"], [207, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [199, 207], "resource": "module.ecs_jenkins_github_dr.module.ec2.aws_s3_bucket.patch_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-patch-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-2-acl-write-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_57", "bc_check_id": "BC_AWS_S3_2", "check_name": "S3 Bucket has an ACL defined which allows public WRITE access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"lambda_code": {"__end_line__": 18, "__start_line__": 10, "bucket": ["${var.project}-${var.environment}-lambda-${random_string.bucket_suffix.result}"], "tags": [{"Environment": "var.environment", "Name": "${var.project}-${var.environment}-lambda", "Project": "var.project"}], "__address__": "module.lambda_failover.aws_s3_bucket.lambda_code"}}}, "evaluated_keys": ["access_control_policy/grant", "access_control_policy/grant/*/permission", "access_control_policy/grant/*/grantee/uri", "resource_type", "acl", "access_control_policy"]}, "code_block": [[10, "resource \"aws_s3_bucket\" \"lambda_code\" {\n"], [11, "  bucket = \"${var.project}-${var.environment}-lambda-${random_string.bucket_suffix.result}\"\n"], [12, "\n"], [13, "  tags = {\n"], [14, "    Name        = \"${var.project}-${var.environment}-lambda\"\n"], [15, "    Environment = var.environment\n"], [16, "    Project     = var.project\n"], [17, "  }\n"], [18, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [10, 18], "resource": "module.lambda_failover.aws_s3_bucket.lambda_code", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Name": "${var.project}-${var.environment}-lambda", "Project": "var.project"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-2-acl-write-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_57", "bc_check_id": "BC_AWS_S3_2", "check_name": "S3 Bucket has an ACL defined which allows public WRITE access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs": {"__end_line__": 134, "__start_line__": 126, "bucket": ["alb-logs-prod-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "prod", "Name": "alb-access-logs"}], "__address__": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs"}}}, "evaluated_keys": ["access_control_policy/grant", "access_control_policy/grant/*/permission", "access_control_policy/grant/*/grantee/uri", "resource_type", "acl", "access_control_policy"]}, "code_block": [[126, "resource \"aws_s3_bucket\" \"alb_logs\" {\n"], [127, "  bucket        = \"alb-logs-${var.environment}-${random_string.suffix.result}\"\n"], [128, "  force_destroy = true\n"], [129, "\n"], [130, "  tags = {\n"], [131, "    Name        = \"alb-access-logs\"\n"], [132, "    Environment = var.environment\n"], [133, "  }\n"], [134, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [126, 134], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "alb-access-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-2-acl-write-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_57", "bc_check_id": "BC_AWS_S3_2", "check_name": "S3 Bucket has an ACL defined which allows public WRITE access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs_access_logs": {"__end_line__": 145, "__start_line__": 137, "bucket": ["alb-logs-access-prod-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "prod", "Name": "alb-access-logs-access"}], "__address__": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs_access_logs"}}}, "evaluated_keys": ["access_control_policy/grant", "access_control_policy/grant/*/permission", "access_control_policy/grant/*/grantee/uri", "resource_type", "acl", "access_control_policy"]}, "code_block": [[137, "resource \"aws_s3_bucket\" \"alb_logs_access_logs\" {\n"], [138, "  bucket        = \"alb-logs-access-${var.environment}-${random_string.suffix.result}\"\n"], [139, "  force_destroy = true\n"], [140, "\n"], [141, "  tags = {\n"], [142, "    Name        = \"alb-access-logs-access\"\n"], [143, "    Environment = var.environment\n"], [144, "  }\n"], [145, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [137, 145], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs_access_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "alb-access-logs-access"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-2-acl-write-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_57", "bc_check_id": "BC_AWS_S3_2", "check_name": "S3 Bucket has an ACL defined which allows public WRITE access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"replication_logs": {"__end_line__": 156, "__start_line__": 148, "bucket": ["replication-logs-prod-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "prod", "Name": "replication-logs"}], "__address__": "module.ecs_jenkins_github.module.network.aws_s3_bucket.replication_logs"}}}, "evaluated_keys": ["access_control_policy/grant", "access_control_policy/grant/*/permission", "access_control_policy/grant/*/grantee/uri", "resource_type", "acl", "access_control_policy"]}, "code_block": [[148, "resource \"aws_s3_bucket\" \"replication_logs\" {\n"], [149, "  bucket        = \"replication-logs-${var.environment}-${random_string.suffix.result}\"\n"], [150, "  force_destroy = true\n"], [151, "\n"], [152, "  tags = {\n"], [153, "    Name        = \"replication-logs\"\n"], [154, "    Environment = var.environment\n"], [155, "  }\n"], [156, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [148, 156], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.replication_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "replication-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-2-acl-write-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_57", "bc_check_id": "BC_AWS_S3_2", "check_name": "S3 Bucket has an ACL defined which allows public WRITE access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs": {"__end_line__": 134, "__start_line__": 126, "bucket": ["alb-logs-dr-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "dr", "Name": "alb-access-logs"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs"}}}, "evaluated_keys": ["access_control_policy/grant", "access_control_policy/grant/*/permission", "access_control_policy/grant/*/grantee/uri", "resource_type", "acl", "access_control_policy"]}, "code_block": [[126, "resource \"aws_s3_bucket\" \"alb_logs\" {\n"], [127, "  bucket        = \"alb-logs-${var.environment}-${random_string.suffix.result}\"\n"], [128, "  force_destroy = true\n"], [129, "\n"], [130, "  tags = {\n"], [131, "    Name        = \"alb-access-logs\"\n"], [132, "    Environment = var.environment\n"], [133, "  }\n"], [134, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [126, 134], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "alb-access-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-2-acl-write-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_57", "bc_check_id": "BC_AWS_S3_2", "check_name": "S3 Bucket has an ACL defined which allows public WRITE access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs_access_logs": {"__end_line__": 145, "__start_line__": 137, "bucket": ["alb-logs-access-dr-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "dr", "Name": "alb-access-logs-access"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs_access_logs"}}}, "evaluated_keys": ["access_control_policy/grant", "access_control_policy/grant/*/permission", "access_control_policy/grant/*/grantee/uri", "resource_type", "acl", "access_control_policy"]}, "code_block": [[137, "resource \"aws_s3_bucket\" \"alb_logs_access_logs\" {\n"], [138, "  bucket        = \"alb-logs-access-${var.environment}-${random_string.suffix.result}\"\n"], [139, "  force_destroy = true\n"], [140, "\n"], [141, "  tags = {\n"], [142, "    Name        = \"alb-access-logs-access\"\n"], [143, "    Environment = var.environment\n"], [144, "  }\n"], [145, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [137, 145], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs_access_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "alb-access-logs-access"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-2-acl-write-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_57", "bc_check_id": "BC_AWS_S3_2", "check_name": "S3 Bucket has an ACL defined which allows public WRITE access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"replication_logs": {"__end_line__": 156, "__start_line__": 148, "bucket": ["replication-logs-dr-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "dr", "Name": "replication-logs"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.replication_logs"}}}, "evaluated_keys": ["access_control_policy/grant", "access_control_policy/grant/*/permission", "access_control_policy/grant/*/grantee/uri", "resource_type", "acl", "access_control_policy"]}, "code_block": [[148, "resource \"aws_s3_bucket\" \"replication_logs\" {\n"], [149, "  bucket        = \"replication-logs-${var.environment}-${random_string.suffix.result}\"\n"], [150, "  force_destroy = true\n"], [151, "\n"], [152, "  tags = {\n"], [153, "    Name        = \"replication-logs\"\n"], [154, "    Environment = var.environment\n"], [155, "  }\n"], [156, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [148, 156], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.replication_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "replication-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-2-acl-write-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_57", "bc_check_id": "BC_AWS_S3_2", "check_name": "S3 Bucket has an ACL defined which allows public WRITE access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"config_bucket": {"__end_line__": 339, "__start_line__": 330, "bucket": ["ecs-jenkins-prod-config-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-config-bucket", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.security.aws_s3_bucket.config_bucket"}}}, "evaluated_keys": ["access_control_policy/grant", "access_control_policy/grant/*/permission", "access_control_policy/grant/*/grantee/uri", "resource_type", "acl", "access_control_policy"]}, "code_block": [[330, "resource \"aws_s3_bucket\" \"config_bucket\" {\n"], [331, "  bucket        = \"${var.project}-${var.environment}-config-${random_string.bucket_suffix.result}\"\n"], [332, "  force_destroy = var.environment != \"prod\"\n"], [333, "\n"], [334, "  tags = {\n"], [335, "    Name        = \"${var.project}-${var.environment}-config-bucket\"\n"], [336, "    Environment = var.environment\n"], [337, "    Project     = var.project\n"], [338, "  }\n"], [339, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [330, 339], "resource": "module.ecs_jenkins_github.module.security.aws_s3_bucket.config_bucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-config-bucket", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-2-acl-write-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_57", "bc_check_id": "BC_AWS_S3_2", "check_name": "S3 Bucket has an ACL defined which allows public WRITE access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"waf_logs": {"__end_line__": 568, "__start_line__": 559, "bucket": ["ecs-jenkins-prod-waf-logs-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-waf-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.security.aws_s3_bucket.waf_logs"}}}, "evaluated_keys": ["access_control_policy/grant", "access_control_policy/grant/*/permission", "access_control_policy/grant/*/grantee/uri", "resource_type", "acl", "access_control_policy"]}, "code_block": [[559, "resource \"aws_s3_bucket\" \"waf_logs\" {\n"], [560, "  bucket        = \"${var.project}-${var.environment}-waf-logs-${random_string.bucket_suffix.result}\"\n"], [561, "  force_destroy = var.environment != \"prod\"\n"], [562, "\n"], [563, "  tags = {\n"], [564, "    Name        = \"${var.project}-${var.environment}-waf-logs\"\n"], [565, "    Environment = var.environment\n"], [566, "    Project     = var.project\n"], [567, "  }\n"], [568, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [559, 568], "resource": "module.ecs_jenkins_github.module.security.aws_s3_bucket.waf_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-waf-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-2-acl-write-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_57", "bc_check_id": "BC_AWS_S3_2", "check_name": "S3 Bucket has an ACL defined which allows public WRITE access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"config_bucket": {"__end_line__": 339, "__start_line__": 330, "bucket": ["ecs-jenkins-dr-config-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-config-bucket", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.config_bucket"}}}, "evaluated_keys": ["access_control_policy/grant", "access_control_policy/grant/*/permission", "access_control_policy/grant/*/grantee/uri", "resource_type", "acl", "access_control_policy"]}, "code_block": [[330, "resource \"aws_s3_bucket\" \"config_bucket\" {\n"], [331, "  bucket        = \"${var.project}-${var.environment}-config-${random_string.bucket_suffix.result}\"\n"], [332, "  force_destroy = var.environment != \"prod\"\n"], [333, "\n"], [334, "  tags = {\n"], [335, "    Name        = \"${var.project}-${var.environment}-config-bucket\"\n"], [336, "    Environment = var.environment\n"], [337, "    Project     = var.project\n"], [338, "  }\n"], [339, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [330, 339], "resource": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.config_bucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-config-bucket", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-2-acl-write-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_57", "bc_check_id": "BC_AWS_S3_2", "check_name": "S3 Bucket has an ACL defined which allows public WRITE access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"waf_logs": {"__end_line__": 568, "__start_line__": 559, "bucket": ["ecs-jenkins-dr-waf-logs-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-waf-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.waf_logs"}}}, "evaluated_keys": ["access_control_policy/grant", "access_control_policy/grant/*/permission", "access_control_policy/grant/*/grantee/uri", "resource_type", "acl", "access_control_policy"]}, "code_block": [[559, "resource \"aws_s3_bucket\" \"waf_logs\" {\n"], [560, "  bucket        = \"${var.project}-${var.environment}-waf-logs-${random_string.bucket_suffix.result}\"\n"], [561, "  force_destroy = var.environment != \"prod\"\n"], [562, "\n"], [563, "  tags = {\n"], [564, "    Name        = \"${var.project}-${var.environment}-waf-logs\"\n"], [565, "    Environment = var.environment\n"], [566, "    Project     = var.project\n"], [567, "  }\n"], [568, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [559, 568], "resource": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.waf_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-waf-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-2-acl-write-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_20", "bc_check_id": "BC_AWS_S3_1", "check_name": "S3 Bucket has an ACL defined which allows public READ access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"patch_logs": {"__end_line__": 207, "__start_line__": 199, "bucket": ["ecs-jenkins-prod-patch-logs-${random_string.suffix.result}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-patch-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.ec2.aws_s3_bucket.patch_logs"}}}, "evaluated_keys": ["access_control_policy/grant", "access_control_policy/grant/*/grantee/uri", "resource_type", "acl", "access_control_policy"]}, "code_block": [[199, "resource \"aws_s3_bucket\" \"patch_logs\" {\n"], [200, "  bucket = \"${var.project}-${var.environment}-patch-logs-${random_string.suffix.result}\"\n"], [201, "\n"], [202, "  tags = {\n"], [203, "    Name        = \"${var.project}-${var.environment}-patch-logs\"\n"], [204, "    Environment = var.environment\n"], [205, "    Project     = var.project\n"], [206, "  }\n"], [207, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [199, 207], "resource": "module.ecs_jenkins_github.module.ec2.aws_s3_bucket.patch_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-patch-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_20", "bc_check_id": "BC_AWS_S3_1", "check_name": "S3 Bucket has an ACL defined which allows public READ access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"patch_logs": {"__end_line__": 207, "__start_line__": 199, "bucket": ["ecs-jenkins-dr-patch-logs-${random_string.suffix.result}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-patch-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.ec2.aws_s3_bucket.patch_logs"}}}, "evaluated_keys": ["access_control_policy/grant", "access_control_policy/grant/*/grantee/uri", "resource_type", "acl", "access_control_policy"]}, "code_block": [[199, "resource \"aws_s3_bucket\" \"patch_logs\" {\n"], [200, "  bucket = \"${var.project}-${var.environment}-patch-logs-${random_string.suffix.result}\"\n"], [201, "\n"], [202, "  tags = {\n"], [203, "    Name        = \"${var.project}-${var.environment}-patch-logs\"\n"], [204, "    Environment = var.environment\n"], [205, "    Project     = var.project\n"], [206, "  }\n"], [207, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [199, 207], "resource": "module.ecs_jenkins_github_dr.module.ec2.aws_s3_bucket.patch_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-patch-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_20", "bc_check_id": "BC_AWS_S3_1", "check_name": "S3 Bucket has an ACL defined which allows public READ access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"lambda_code": {"__end_line__": 18, "__start_line__": 10, "bucket": ["${var.project}-${var.environment}-lambda-${random_string.bucket_suffix.result}"], "tags": [{"Environment": "var.environment", "Name": "${var.project}-${var.environment}-lambda", "Project": "var.project"}], "__address__": "module.lambda_failover.aws_s3_bucket.lambda_code"}}}, "evaluated_keys": ["access_control_policy/grant", "access_control_policy/grant/*/grantee/uri", "resource_type", "acl", "access_control_policy"]}, "code_block": [[10, "resource \"aws_s3_bucket\" \"lambda_code\" {\n"], [11, "  bucket = \"${var.project}-${var.environment}-lambda-${random_string.bucket_suffix.result}\"\n"], [12, "\n"], [13, "  tags = {\n"], [14, "    Name        = \"${var.project}-${var.environment}-lambda\"\n"], [15, "    Environment = var.environment\n"], [16, "    Project     = var.project\n"], [17, "  }\n"], [18, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [10, 18], "resource": "module.lambda_failover.aws_s3_bucket.lambda_code", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Name": "${var.project}-${var.environment}-lambda", "Project": "var.project"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_20", "bc_check_id": "BC_AWS_S3_1", "check_name": "S3 Bucket has an ACL defined which allows public READ access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs": {"__end_line__": 134, "__start_line__": 126, "bucket": ["alb-logs-prod-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "prod", "Name": "alb-access-logs"}], "__address__": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs"}}}, "evaluated_keys": ["access_control_policy/grant", "access_control_policy/grant/*/grantee/uri", "resource_type", "acl", "access_control_policy"]}, "code_block": [[126, "resource \"aws_s3_bucket\" \"alb_logs\" {\n"], [127, "  bucket        = \"alb-logs-${var.environment}-${random_string.suffix.result}\"\n"], [128, "  force_destroy = true\n"], [129, "\n"], [130, "  tags = {\n"], [131, "    Name        = \"alb-access-logs\"\n"], [132, "    Environment = var.environment\n"], [133, "  }\n"], [134, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [126, 134], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "alb-access-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_20", "bc_check_id": "BC_AWS_S3_1", "check_name": "S3 Bucket has an ACL defined which allows public READ access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs_access_logs": {"__end_line__": 145, "__start_line__": 137, "bucket": ["alb-logs-access-prod-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "prod", "Name": "alb-access-logs-access"}], "__address__": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs_access_logs"}}}, "evaluated_keys": ["access_control_policy/grant", "access_control_policy/grant/*/grantee/uri", "resource_type", "acl", "access_control_policy"]}, "code_block": [[137, "resource \"aws_s3_bucket\" \"alb_logs_access_logs\" {\n"], [138, "  bucket        = \"alb-logs-access-${var.environment}-${random_string.suffix.result}\"\n"], [139, "  force_destroy = true\n"], [140, "\n"], [141, "  tags = {\n"], [142, "    Name        = \"alb-access-logs-access\"\n"], [143, "    Environment = var.environment\n"], [144, "  }\n"], [145, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [137, 145], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs_access_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "alb-access-logs-access"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_20", "bc_check_id": "BC_AWS_S3_1", "check_name": "S3 Bucket has an ACL defined which allows public READ access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"replication_logs": {"__end_line__": 156, "__start_line__": 148, "bucket": ["replication-logs-prod-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "prod", "Name": "replication-logs"}], "__address__": "module.ecs_jenkins_github.module.network.aws_s3_bucket.replication_logs"}}}, "evaluated_keys": ["access_control_policy/grant", "access_control_policy/grant/*/grantee/uri", "resource_type", "acl", "access_control_policy"]}, "code_block": [[148, "resource \"aws_s3_bucket\" \"replication_logs\" {\n"], [149, "  bucket        = \"replication-logs-${var.environment}-${random_string.suffix.result}\"\n"], [150, "  force_destroy = true\n"], [151, "\n"], [152, "  tags = {\n"], [153, "    Name        = \"replication-logs\"\n"], [154, "    Environment = var.environment\n"], [155, "  }\n"], [156, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [148, 156], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.replication_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "replication-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_20", "bc_check_id": "BC_AWS_S3_1", "check_name": "S3 Bucket has an ACL defined which allows public READ access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs": {"__end_line__": 134, "__start_line__": 126, "bucket": ["alb-logs-dr-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "dr", "Name": "alb-access-logs"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs"}}}, "evaluated_keys": ["access_control_policy/grant", "access_control_policy/grant/*/grantee/uri", "resource_type", "acl", "access_control_policy"]}, "code_block": [[126, "resource \"aws_s3_bucket\" \"alb_logs\" {\n"], [127, "  bucket        = \"alb-logs-${var.environment}-${random_string.suffix.result}\"\n"], [128, "  force_destroy = true\n"], [129, "\n"], [130, "  tags = {\n"], [131, "    Name        = \"alb-access-logs\"\n"], [132, "    Environment = var.environment\n"], [133, "  }\n"], [134, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [126, 134], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "alb-access-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_20", "bc_check_id": "BC_AWS_S3_1", "check_name": "S3 Bucket has an ACL defined which allows public READ access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs_access_logs": {"__end_line__": 145, "__start_line__": 137, "bucket": ["alb-logs-access-dr-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "dr", "Name": "alb-access-logs-access"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs_access_logs"}}}, "evaluated_keys": ["access_control_policy/grant", "access_control_policy/grant/*/grantee/uri", "resource_type", "acl", "access_control_policy"]}, "code_block": [[137, "resource \"aws_s3_bucket\" \"alb_logs_access_logs\" {\n"], [138, "  bucket        = \"alb-logs-access-${var.environment}-${random_string.suffix.result}\"\n"], [139, "  force_destroy = true\n"], [140, "\n"], [141, "  tags = {\n"], [142, "    Name        = \"alb-access-logs-access\"\n"], [143, "    Environment = var.environment\n"], [144, "  }\n"], [145, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [137, 145], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs_access_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "alb-access-logs-access"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_20", "bc_check_id": "BC_AWS_S3_1", "check_name": "S3 Bucket has an ACL defined which allows public READ access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"replication_logs": {"__end_line__": 156, "__start_line__": 148, "bucket": ["replication-logs-dr-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "dr", "Name": "replication-logs"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.replication_logs"}}}, "evaluated_keys": ["access_control_policy/grant", "access_control_policy/grant/*/grantee/uri", "resource_type", "acl", "access_control_policy"]}, "code_block": [[148, "resource \"aws_s3_bucket\" \"replication_logs\" {\n"], [149, "  bucket        = \"replication-logs-${var.environment}-${random_string.suffix.result}\"\n"], [150, "  force_destroy = true\n"], [151, "\n"], [152, "  tags = {\n"], [153, "    Name        = \"replication-logs\"\n"], [154, "    Environment = var.environment\n"], [155, "  }\n"], [156, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [148, 156], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.replication_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "replication-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_20", "bc_check_id": "BC_AWS_S3_1", "check_name": "S3 Bucket has an ACL defined which allows public READ access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"config_bucket": {"__end_line__": 339, "__start_line__": 330, "bucket": ["ecs-jenkins-prod-config-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-config-bucket", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.security.aws_s3_bucket.config_bucket"}}}, "evaluated_keys": ["access_control_policy/grant", "access_control_policy/grant/*/grantee/uri", "resource_type", "acl", "access_control_policy"]}, "code_block": [[330, "resource \"aws_s3_bucket\" \"config_bucket\" {\n"], [331, "  bucket        = \"${var.project}-${var.environment}-config-${random_string.bucket_suffix.result}\"\n"], [332, "  force_destroy = var.environment != \"prod\"\n"], [333, "\n"], [334, "  tags = {\n"], [335, "    Name        = \"${var.project}-${var.environment}-config-bucket\"\n"], [336, "    Environment = var.environment\n"], [337, "    Project     = var.project\n"], [338, "  }\n"], [339, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [330, 339], "resource": "module.ecs_jenkins_github.module.security.aws_s3_bucket.config_bucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-config-bucket", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_20", "bc_check_id": "BC_AWS_S3_1", "check_name": "S3 Bucket has an ACL defined which allows public READ access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"waf_logs": {"__end_line__": 568, "__start_line__": 559, "bucket": ["ecs-jenkins-prod-waf-logs-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-waf-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.security.aws_s3_bucket.waf_logs"}}}, "evaluated_keys": ["access_control_policy/grant", "access_control_policy/grant/*/grantee/uri", "resource_type", "acl", "access_control_policy"]}, "code_block": [[559, "resource \"aws_s3_bucket\" \"waf_logs\" {\n"], [560, "  bucket        = \"${var.project}-${var.environment}-waf-logs-${random_string.bucket_suffix.result}\"\n"], [561, "  force_destroy = var.environment != \"prod\"\n"], [562, "\n"], [563, "  tags = {\n"], [564, "    Name        = \"${var.project}-${var.environment}-waf-logs\"\n"], [565, "    Environment = var.environment\n"], [566, "    Project     = var.project\n"], [567, "  }\n"], [568, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [559, 568], "resource": "module.ecs_jenkins_github.module.security.aws_s3_bucket.waf_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-waf-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_20", "bc_check_id": "BC_AWS_S3_1", "check_name": "S3 Bucket has an ACL defined which allows public READ access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"config_bucket": {"__end_line__": 339, "__start_line__": 330, "bucket": ["ecs-jenkins-dr-config-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-config-bucket", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.config_bucket"}}}, "evaluated_keys": ["access_control_policy/grant", "access_control_policy/grant/*/grantee/uri", "resource_type", "acl", "access_control_policy"]}, "code_block": [[330, "resource \"aws_s3_bucket\" \"config_bucket\" {\n"], [331, "  bucket        = \"${var.project}-${var.environment}-config-${random_string.bucket_suffix.result}\"\n"], [332, "  force_destroy = var.environment != \"prod\"\n"], [333, "\n"], [334, "  tags = {\n"], [335, "    Name        = \"${var.project}-${var.environment}-config-bucket\"\n"], [336, "    Environment = var.environment\n"], [337, "    Project     = var.project\n"], [338, "  }\n"], [339, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [330, 339], "resource": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.config_bucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-config-bucket", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_20", "bc_check_id": "BC_AWS_S3_1", "check_name": "S3 Bucket has an ACL defined which allows public READ access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"waf_logs": {"__end_line__": 568, "__start_line__": 559, "bucket": ["ecs-jenkins-dr-waf-logs-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-waf-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.waf_logs"}}}, "evaluated_keys": ["access_control_policy/grant", "access_control_policy/grant/*/grantee/uri", "resource_type", "acl", "access_control_policy"]}, "code_block": [[559, "resource \"aws_s3_bucket\" \"waf_logs\" {\n"], [560, "  bucket        = \"${var.project}-${var.environment}-waf-logs-${random_string.bucket_suffix.result}\"\n"], [561, "  force_destroy = var.environment != \"prod\"\n"], [562, "\n"], [563, "  tags = {\n"], [564, "    Name        = \"${var.project}-${var.environment}-waf-logs\"\n"], [565, "    Environment = var.environment\n"], [566, "    Project     = var.project\n"], [567, "  }\n"], [568, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [559, 568], "resource": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.waf_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-waf-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV2_AWS_61", "bc_check_id": "BC_AWS_LOGGING_35", "check_name": "Ensure that an S3 bucket has a lifecycle configuration", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"patch_logs": {"__end_line__": 207, "__start_line__": 199, "bucket": ["ecs-jenkins-prod-patch-logs-${random_string.suffix.result}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-patch-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.ec2.aws_s3_bucket.patch_logs"}}}, "evaluated_keys": ["lifecycle_rule", "resource_type"]}, "code_block": [[199, "resource \"aws_s3_bucket\" \"patch_logs\" {\n"], [200, "  bucket = \"${var.project}-${var.environment}-patch-logs-${random_string.suffix.result}\"\n"], [201, "\n"], [202, "  tags = {\n"], [203, "    Name        = \"${var.project}-${var.environment}-patch-logs\"\n"], [204, "    Environment = var.environment\n"], [205, "    Project     = var.project\n"], [206, "  }\n"], [207, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [199, 207], "resource": "module.ecs_jenkins_github.module.ec2.aws_s3_bucket.patch_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-patch-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[209, "resource \"aws_s3_bucket_lifecycle_configuration\" \"patch_logs_lifecycle\" {\n"], [210, "  bucket = aws_s3_bucket.patch_logs.id\n"], [211, "\n"], [212, "  rule {\n"], [213, "    id     = \"DeleteOldLogs\"\n"], [214, "    status = \"Enabled\"\n"], [215, "\n"], [216, "    expiration {\n"], [217, "      days = 90\n"], [218, "    }\n"], [219, "  }\n"], [220, "}\n"]], "file_path": "\\..\\ec2\\main.tf", "file_line_range": [209, 220], "resource": "aws_s3_bucket_lifecycle_configuration.patch_logs_lifecycle", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV2_AWS_61", "bc_check_id": "BC_AWS_LOGGING_35", "check_name": "Ensure that an S3 bucket has a lifecycle configuration", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"patch_logs": {"__end_line__": 207, "__start_line__": 199, "bucket": ["ecs-jenkins-dr-patch-logs-${random_string.suffix.result}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-patch-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.ec2.aws_s3_bucket.patch_logs"}}}, "evaluated_keys": ["lifecycle_rule", "resource_type"]}, "code_block": [[199, "resource \"aws_s3_bucket\" \"patch_logs\" {\n"], [200, "  bucket = \"${var.project}-${var.environment}-patch-logs-${random_string.suffix.result}\"\n"], [201, "\n"], [202, "  tags = {\n"], [203, "    Name        = \"${var.project}-${var.environment}-patch-logs\"\n"], [204, "    Environment = var.environment\n"], [205, "    Project     = var.project\n"], [206, "  }\n"], [207, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [199, 207], "resource": "module.ecs_jenkins_github_dr.module.ec2.aws_s3_bucket.patch_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-patch-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[209, "resource \"aws_s3_bucket_lifecycle_configuration\" \"patch_logs_lifecycle\" {\n"], [210, "  bucket = aws_s3_bucket.patch_logs.id\n"], [211, "\n"], [212, "  rule {\n"], [213, "    id     = \"DeleteOldLogs\"\n"], [214, "    status = \"Enabled\"\n"], [215, "\n"], [216, "    expiration {\n"], [217, "      days = 90\n"], [218, "    }\n"], [219, "  }\n"], [220, "}\n"]], "file_path": "\\main.tf", "file_line_range": [209, 220], "resource": "aws_s3_bucket_lifecycle_configuration.patch_logs_lifecycle", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV2_AWS_61", "bc_check_id": "BC_AWS_LOGGING_35", "check_name": "Ensure that an S3 bucket has a lifecycle configuration", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs": {"__end_line__": 134, "__start_line__": 126, "bucket": ["alb-logs-prod-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "prod", "Name": "alb-access-logs"}], "__address__": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs"}}}, "evaluated_keys": ["lifecycle_rule", "resource_type"]}, "code_block": [[126, "resource \"aws_s3_bucket\" \"alb_logs\" {\n"], [127, "  bucket        = \"alb-logs-${var.environment}-${random_string.suffix.result}\"\n"], [128, "  force_destroy = true\n"], [129, "\n"], [130, "  tags = {\n"], [131, "    Name        = \"alb-access-logs\"\n"], [132, "    Environment = var.environment\n"], [133, "  }\n"], [134, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [126, 134], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "alb-access-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[339, "resource \"aws_s3_bucket_lifecycle_configuration\" \"alb_logs_lifecycle\" {\n"], [340, "  bucket = aws_s3_bucket.alb_logs.id\n"], [341, "\n"], [342, "  rule {\n"], [343, "    id     = \"log\"\n"], [344, "    status = \"Enabled\"\n"], [345, "\n"], [346, "    expiration {\n"], [347, "      days = 90 # Keep logs for 90 days\n"], [348, "    }\n"], [349, "  }\n"], [350, "}\n"]], "file_path": "\\..\\network\\main.tf", "file_line_range": [339, 350], "resource": "aws_s3_bucket_lifecycle_configuration.alb_logs_lifecycle", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_61", "bc_check_id": "BC_AWS_LOGGING_35", "check_name": "Ensure that an S3 bucket has a lifecycle configuration", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs_access_logs": {"__end_line__": 145, "__start_line__": 137, "bucket": ["alb-logs-access-prod-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "prod", "Name": "alb-access-logs-access"}], "__address__": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs_access_logs"}}}, "evaluated_keys": ["lifecycle_rule", "resource_type"]}, "code_block": [[137, "resource \"aws_s3_bucket\" \"alb_logs_access_logs\" {\n"], [138, "  bucket        = \"alb-logs-access-${var.environment}-${random_string.suffix.result}\"\n"], [139, "  force_destroy = true\n"], [140, "\n"], [141, "  tags = {\n"], [142, "    Name        = \"alb-access-logs-access\"\n"], [143, "    Environment = var.environment\n"], [144, "  }\n"], [145, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [137, 145], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs_access_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "alb-access-logs-access"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[353, "resource \"aws_s3_bucket_lifecycle_configuration\" \"alb_logs_access_lifecycle\" {\n"], [354, "  bucket = aws_s3_bucket.alb_logs_access_logs.id\n"], [355, "\n"], [356, "  rule {\n"], [357, "    id     = \"access-logs\"\n"], [358, "    status = \"Enabled\"\n"], [359, "\n"], [360, "    expiration {\n"], [361, "      days = 90 # Keep access logs for 90 days\n"], [362, "    }\n"], [363, "  }\n"], [364, "}\n"]], "file_path": "\\main.tf", "file_line_range": [353, 364], "resource": "aws_s3_bucket_lifecycle_configuration.alb_logs_access_lifecycle", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_61", "bc_check_id": "BC_AWS_LOGGING_35", "check_name": "Ensure that an S3 bucket has a lifecycle configuration", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"replication_logs": {"__end_line__": 156, "__start_line__": 148, "bucket": ["replication-logs-prod-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "prod", "Name": "replication-logs"}], "__address__": "module.ecs_jenkins_github.module.network.aws_s3_bucket.replication_logs"}}}, "evaluated_keys": ["lifecycle_rule", "resource_type"]}, "code_block": [[148, "resource \"aws_s3_bucket\" \"replication_logs\" {\n"], [149, "  bucket        = \"replication-logs-${var.environment}-${random_string.suffix.result}\"\n"], [150, "  force_destroy = true\n"], [151, "\n"], [152, "  tags = {\n"], [153, "    Name        = \"replication-logs\"\n"], [154, "    Environment = var.environment\n"], [155, "  }\n"], [156, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [148, 156], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.replication_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "replication-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[367, "resource \"aws_s3_bucket_lifecycle_configuration\" \"replication_logs_lifecycle\" {\n"], [368, "  bucket = aws_s3_bucket.replication_logs.id\n"], [369, "\n"], [370, "  rule {\n"], [371, "    id     = \"replication-logs\"\n"], [372, "    status = \"Enabled\"\n"], [373, "\n"], [374, "    expiration {\n"], [375, "      days = 90 # Keep replication logs for 90 days\n"], [376, "    }\n"], [377, "  }\n"], [378, "}\n"]], "file_path": "\\main.tf", "file_line_range": [367, 378], "resource": "aws_s3_bucket_lifecycle_configuration.replication_logs_lifecycle", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_61", "bc_check_id": "BC_AWS_LOGGING_35", "check_name": "Ensure that an S3 bucket has a lifecycle configuration", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs": {"__end_line__": 134, "__start_line__": 126, "bucket": ["alb-logs-dr-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "dr", "Name": "alb-access-logs"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs"}}}, "evaluated_keys": ["lifecycle_rule", "resource_type"]}, "code_block": [[126, "resource \"aws_s3_bucket\" \"alb_logs\" {\n"], [127, "  bucket        = \"alb-logs-${var.environment}-${random_string.suffix.result}\"\n"], [128, "  force_destroy = true\n"], [129, "\n"], [130, "  tags = {\n"], [131, "    Name        = \"alb-access-logs\"\n"], [132, "    Environment = var.environment\n"], [133, "  }\n"], [134, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [126, 134], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "alb-access-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[339, "resource \"aws_s3_bucket_lifecycle_configuration\" \"alb_logs_lifecycle\" {\n"], [340, "  bucket = aws_s3_bucket.alb_logs.id\n"], [341, "\n"], [342, "  rule {\n"], [343, "    id     = \"log\"\n"], [344, "    status = \"Enabled\"\n"], [345, "\n"], [346, "    expiration {\n"], [347, "      days = 90 # Keep logs for 90 days\n"], [348, "    }\n"], [349, "  }\n"], [350, "}\n"]], "file_path": "\\main.tf", "file_line_range": [339, 350], "resource": "aws_s3_bucket_lifecycle_configuration.alb_logs_lifecycle", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_61", "bc_check_id": "BC_AWS_LOGGING_35", "check_name": "Ensure that an S3 bucket has a lifecycle configuration", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs_access_logs": {"__end_line__": 145, "__start_line__": 137, "bucket": ["alb-logs-access-dr-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "dr", "Name": "alb-access-logs-access"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs_access_logs"}}}, "evaluated_keys": ["lifecycle_rule", "resource_type"]}, "code_block": [[137, "resource \"aws_s3_bucket\" \"alb_logs_access_logs\" {\n"], [138, "  bucket        = \"alb-logs-access-${var.environment}-${random_string.suffix.result}\"\n"], [139, "  force_destroy = true\n"], [140, "\n"], [141, "  tags = {\n"], [142, "    Name        = \"alb-access-logs-access\"\n"], [143, "    Environment = var.environment\n"], [144, "  }\n"], [145, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [137, 145], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs_access_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "alb-access-logs-access"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[353, "resource \"aws_s3_bucket_lifecycle_configuration\" \"alb_logs_access_lifecycle\" {\n"], [354, "  bucket = aws_s3_bucket.alb_logs_access_logs.id\n"], [355, "\n"], [356, "  rule {\n"], [357, "    id     = \"access-logs\"\n"], [358, "    status = \"Enabled\"\n"], [359, "\n"], [360, "    expiration {\n"], [361, "      days = 90 # Keep access logs for 90 days\n"], [362, "    }\n"], [363, "  }\n"], [364, "}\n"]], "file_path": "\\main.tf", "file_line_range": [353, 364], "resource": "aws_s3_bucket_lifecycle_configuration.alb_logs_access_lifecycle", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_61", "bc_check_id": "BC_AWS_LOGGING_35", "check_name": "Ensure that an S3 bucket has a lifecycle configuration", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"replication_logs": {"__end_line__": 156, "__start_line__": 148, "bucket": ["replication-logs-dr-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "dr", "Name": "replication-logs"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.replication_logs"}}}, "evaluated_keys": ["lifecycle_rule", "resource_type"]}, "code_block": [[148, "resource \"aws_s3_bucket\" \"replication_logs\" {\n"], [149, "  bucket        = \"replication-logs-${var.environment}-${random_string.suffix.result}\"\n"], [150, "  force_destroy = true\n"], [151, "\n"], [152, "  tags = {\n"], [153, "    Name        = \"replication-logs\"\n"], [154, "    Environment = var.environment\n"], [155, "  }\n"], [156, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [148, 156], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.replication_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "replication-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[367, "resource \"aws_s3_bucket_lifecycle_configuration\" \"replication_logs_lifecycle\" {\n"], [368, "  bucket = aws_s3_bucket.replication_logs.id\n"], [369, "\n"], [370, "  rule {\n"], [371, "    id     = \"replication-logs\"\n"], [372, "    status = \"Enabled\"\n"], [373, "\n"], [374, "    expiration {\n"], [375, "      days = 90 # Keep replication logs for 90 days\n"], [376, "    }\n"], [377, "  }\n"], [378, "}\n"]], "file_path": "\\main.tf", "file_line_range": [367, 378], "resource": "aws_s3_bucket_lifecycle_configuration.replication_logs_lifecycle", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_21", "bc_check_id": "BC_AWS_S3_16", "check_name": "Ensure all data stored in the S3 bucket have versioning enabled", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs": {"__end_line__": 134, "__start_line__": 126, "bucket": ["alb-logs-prod-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "prod", "Name": "alb-access-logs"}], "__address__": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs"}}}, "evaluated_keys": ["versioning_configuration/status", "resource_type", "versioning/enabled"]}, "code_block": [[126, "resource \"aws_s3_bucket\" \"alb_logs\" {\n"], [127, "  bucket        = \"alb-logs-${var.environment}-${random_string.suffix.result}\"\n"], [128, "  force_destroy = true\n"], [129, "\n"], [130, "  tags = {\n"], [131, "    Name        = \"alb-access-logs\"\n"], [132, "    Environment = var.environment\n"], [133, "  }\n"], [134, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [126, 134], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "alb-access-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[226, "resource \"aws_s3_bucket_versioning\" \"alb_logs_versioning\" {\n"], [227, "  bucket = aws_s3_bucket.alb_logs.id\n"], [228, "  versioning_configuration {\n"], [229, "    status = \"Enabled\"\n"], [230, "  }\n"], [231, "}\n"]], "file_path": "\\..\\network\\main.tf", "file_line_range": [226, 231], "resource": "aws_s3_bucket_versioning.alb_logs_versioning", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_21", "bc_check_id": "BC_AWS_S3_16", "check_name": "Ensure all data stored in the S3 bucket have versioning enabled", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs_access_logs": {"__end_line__": 145, "__start_line__": 137, "bucket": ["alb-logs-access-prod-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "prod", "Name": "alb-access-logs-access"}], "__address__": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs_access_logs"}}}, "evaluated_keys": ["versioning_configuration/status", "resource_type", "versioning/enabled"]}, "code_block": [[137, "resource \"aws_s3_bucket\" \"alb_logs_access_logs\" {\n"], [138, "  bucket        = \"alb-logs-access-${var.environment}-${random_string.suffix.result}\"\n"], [139, "  force_destroy = true\n"], [140, "\n"], [141, "  tags = {\n"], [142, "    Name        = \"alb-access-logs-access\"\n"], [143, "    Environment = var.environment\n"], [144, "  }\n"], [145, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [137, 145], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs_access_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "alb-access-logs-access"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[269, "resource \"aws_s3_bucket_versioning\" \"alb_logs_access_versioning\" {\n"], [270, "  bucket = aws_s3_bucket.alb_logs_access_logs.id\n"], [271, "  versioning_configuration {\n"], [272, "    status = \"Enabled\"\n"], [273, "  }\n"], [274, "}\n"]], "file_path": "\\main.tf", "file_line_range": [269, 274], "resource": "aws_s3_bucket_versioning.alb_logs_access_versioning", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_21", "bc_check_id": "BC_AWS_S3_16", "check_name": "Ensure all data stored in the S3 bucket have versioning enabled", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"replication_logs": {"__end_line__": 156, "__start_line__": 148, "bucket": ["replication-logs-prod-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "prod", "Name": "replication-logs"}], "__address__": "module.ecs_jenkins_github.module.network.aws_s3_bucket.replication_logs"}}}, "evaluated_keys": ["versioning_configuration/status", "resource_type", "versioning/enabled"]}, "code_block": [[148, "resource \"aws_s3_bucket\" \"replication_logs\" {\n"], [149, "  bucket        = \"replication-logs-${var.environment}-${random_string.suffix.result}\"\n"], [150, "  force_destroy = true\n"], [151, "\n"], [152, "  tags = {\n"], [153, "    Name        = \"replication-logs\"\n"], [154, "    Environment = var.environment\n"], [155, "  }\n"], [156, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [148, 156], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.replication_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "replication-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[299, "resource \"aws_s3_bucket_versioning\" \"replication_logs_versioning\" {\n"], [300, "  bucket = aws_s3_bucket.replication_logs.id\n"], [301, "  versioning_configuration {\n"], [302, "    status = \"Enabled\"\n"], [303, "  }\n"], [304, "}\n"]], "file_path": "\\main.tf", "file_line_range": [299, 304], "resource": "aws_s3_bucket_versioning.replication_logs_versioning", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_21", "bc_check_id": "BC_AWS_S3_16", "check_name": "Ensure all data stored in the S3 bucket have versioning enabled", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs": {"__end_line__": 134, "__start_line__": 126, "bucket": ["alb-logs-dr-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "dr", "Name": "alb-access-logs"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs"}}}, "evaluated_keys": ["versioning_configuration/status", "resource_type", "versioning/enabled"]}, "code_block": [[126, "resource \"aws_s3_bucket\" \"alb_logs\" {\n"], [127, "  bucket        = \"alb-logs-${var.environment}-${random_string.suffix.result}\"\n"], [128, "  force_destroy = true\n"], [129, "\n"], [130, "  tags = {\n"], [131, "    Name        = \"alb-access-logs\"\n"], [132, "    Environment = var.environment\n"], [133, "  }\n"], [134, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [126, 134], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "alb-access-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[226, "resource \"aws_s3_bucket_versioning\" \"alb_logs_versioning\" {\n"], [227, "  bucket = aws_s3_bucket.alb_logs.id\n"], [228, "  versioning_configuration {\n"], [229, "    status = \"Enabled\"\n"], [230, "  }\n"], [231, "}\n"]], "file_path": "\\main.tf", "file_line_range": [226, 231], "resource": "aws_s3_bucket_versioning.alb_logs_versioning", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_21", "bc_check_id": "BC_AWS_S3_16", "check_name": "Ensure all data stored in the S3 bucket have versioning enabled", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs_access_logs": {"__end_line__": 145, "__start_line__": 137, "bucket": ["alb-logs-access-dr-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "dr", "Name": "alb-access-logs-access"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs_access_logs"}}}, "evaluated_keys": ["versioning_configuration/status", "resource_type", "versioning/enabled"]}, "code_block": [[137, "resource \"aws_s3_bucket\" \"alb_logs_access_logs\" {\n"], [138, "  bucket        = \"alb-logs-access-${var.environment}-${random_string.suffix.result}\"\n"], [139, "  force_destroy = true\n"], [140, "\n"], [141, "  tags = {\n"], [142, "    Name        = \"alb-access-logs-access\"\n"], [143, "    Environment = var.environment\n"], [144, "  }\n"], [145, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [137, 145], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs_access_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "alb-access-logs-access"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[269, "resource \"aws_s3_bucket_versioning\" \"alb_logs_access_versioning\" {\n"], [270, "  bucket = aws_s3_bucket.alb_logs_access_logs.id\n"], [271, "  versioning_configuration {\n"], [272, "    status = \"Enabled\"\n"], [273, "  }\n"], [274, "}\n"]], "file_path": "\\main.tf", "file_line_range": [269, 274], "resource": "aws_s3_bucket_versioning.alb_logs_access_versioning", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_21", "bc_check_id": "BC_AWS_S3_16", "check_name": "Ensure all data stored in the S3 bucket have versioning enabled", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"replication_logs": {"__end_line__": 156, "__start_line__": 148, "bucket": ["replication-logs-dr-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "dr", "Name": "replication-logs"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.replication_logs"}}}, "evaluated_keys": ["versioning_configuration/status", "resource_type", "versioning/enabled"]}, "code_block": [[148, "resource \"aws_s3_bucket\" \"replication_logs\" {\n"], [149, "  bucket        = \"replication-logs-${var.environment}-${random_string.suffix.result}\"\n"], [150, "  force_destroy = true\n"], [151, "\n"], [152, "  tags = {\n"], [153, "    Name        = \"replication-logs\"\n"], [154, "    Environment = var.environment\n"], [155, "  }\n"], [156, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [148, 156], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.replication_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "replication-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[299, "resource \"aws_s3_bucket_versioning\" \"replication_logs_versioning\" {\n"], [300, "  bucket = aws_s3_bucket.replication_logs.id\n"], [301, "  versioning_configuration {\n"], [302, "    status = \"Enabled\"\n"], [303, "  }\n"], [304, "}\n"]], "file_path": "\\main.tf", "file_line_range": [299, 304], "resource": "aws_s3_bucket_versioning.replication_logs_versioning", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_6", "bc_check_id": "BC_AWS_NETWORKING_52", "check_name": "Ensure that S3 bucket has a Public Access block", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"replication_logs": {"__end_line__": 156, "__start_line__": 148, "bucket": ["replication-logs-prod-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "prod", "Name": "replication-logs"}], "__address__": "module.ecs_jenkins_github.module.network.aws_s3_bucket.replication_logs"}}}, "evaluated_keys": ["block_public_acls", "block_public_policy", "resource_type"]}, "code_block": [[148, "resource \"aws_s3_bucket\" \"replication_logs\" {\n"], [149, "  bucket        = \"replication-logs-${var.environment}-${random_string.suffix.result}\"\n"], [150, "  force_destroy = true\n"], [151, "\n"], [152, "  tags = {\n"], [153, "    Name        = \"replication-logs\"\n"], [154, "    Environment = var.environment\n"], [155, "  }\n"], [156, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [148, 156], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.replication_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "replication-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[307, "resource \"aws_s3_bucket_public_access_block\" \"replication_logs_public_access\" {\n"], [308, "  bucket = aws_s3_bucket.replication_logs.id\n"], [309, "\n"], [310, "  block_public_acls       = true\n"], [311, "  block_public_policy     = true\n"], [312, "  ignore_public_acls      = true\n"], [313, "  restrict_public_buckets = true\n"], [314, "}\n"]], "file_path": "\\..\\network\\main.tf", "file_line_range": [307, 314], "resource": "aws_s3_bucket_public_access_block.replication_logs_public_access", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_6", "bc_check_id": "BC_AWS_NETWORKING_52", "check_name": "Ensure that S3 bucket has a Public Access block", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs": {"__end_line__": 134, "__start_line__": 126, "bucket": ["alb-logs-prod-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "prod", "Name": "alb-access-logs"}], "__address__": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs"}}}, "evaluated_keys": ["block_public_acls", "block_public_policy", "resource_type"]}, "code_block": [[126, "resource \"aws_s3_bucket\" \"alb_logs\" {\n"], [127, "  bucket        = \"alb-logs-${var.environment}-${random_string.suffix.result}\"\n"], [128, "  force_destroy = true\n"], [129, "\n"], [130, "  tags = {\n"], [131, "    Name        = \"alb-access-logs\"\n"], [132, "    Environment = var.environment\n"], [133, "  }\n"], [134, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [126, 134], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "alb-access-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[317, "resource \"aws_s3_bucket_public_access_block\" \"alb_logs_public_access\" {\n"], [318, "  bucket = aws_s3_bucket.alb_logs.id\n"], [319, "\n"], [320, "  block_public_acls       = true\n"], [321, "  block_public_policy     = true\n"], [322, "  ignore_public_acls      = true\n"], [323, "  restrict_public_buckets = true\n"], [324, "}\n"]], "file_path": "\\main.tf", "file_line_range": [317, 324], "resource": "aws_s3_bucket_public_access_block.alb_logs_public_access", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_6", "bc_check_id": "BC_AWS_NETWORKING_52", "check_name": "Ensure that S3 bucket has a Public Access block", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs_access_logs": {"__end_line__": 145, "__start_line__": 137, "bucket": ["alb-logs-access-prod-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "prod", "Name": "alb-access-logs-access"}], "__address__": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs_access_logs"}}}, "evaluated_keys": ["block_public_acls", "block_public_policy", "resource_type"]}, "code_block": [[137, "resource \"aws_s3_bucket\" \"alb_logs_access_logs\" {\n"], [138, "  bucket        = \"alb-logs-access-${var.environment}-${random_string.suffix.result}\"\n"], [139, "  force_destroy = true\n"], [140, "\n"], [141, "  tags = {\n"], [142, "    Name        = \"alb-access-logs-access\"\n"], [143, "    Environment = var.environment\n"], [144, "  }\n"], [145, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [137, 145], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs_access_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "alb-access-logs-access"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[327, "resource \"aws_s3_bucket_public_access_block\" \"alb_logs_access_public_access\" {\n"], [328, "  bucket = aws_s3_bucket.alb_logs_access_logs.id\n"], [329, "\n"], [330, "  block_public_acls       = true\n"], [331, "  block_public_policy     = true\n"], [332, "  ignore_public_acls      = true\n"], [333, "  restrict_public_buckets = true\n"], [334, "}\n"]], "file_path": "\\main.tf", "file_line_range": [327, 334], "resource": "aws_s3_bucket_public_access_block.alb_logs_access_public_access", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_6", "bc_check_id": "BC_AWS_NETWORKING_52", "check_name": "Ensure that S3 bucket has a Public Access block", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"replication_logs": {"__end_line__": 156, "__start_line__": 148, "bucket": ["replication-logs-dr-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "dr", "Name": "replication-logs"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.replication_logs"}}}, "evaluated_keys": ["block_public_acls", "block_public_policy", "resource_type"]}, "code_block": [[148, "resource \"aws_s3_bucket\" \"replication_logs\" {\n"], [149, "  bucket        = \"replication-logs-${var.environment}-${random_string.suffix.result}\"\n"], [150, "  force_destroy = true\n"], [151, "\n"], [152, "  tags = {\n"], [153, "    Name        = \"replication-logs\"\n"], [154, "    Environment = var.environment\n"], [155, "  }\n"], [156, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [148, 156], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.replication_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "replication-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[307, "resource \"aws_s3_bucket_public_access_block\" \"replication_logs_public_access\" {\n"], [308, "  bucket = aws_s3_bucket.replication_logs.id\n"], [309, "\n"], [310, "  block_public_acls       = true\n"], [311, "  block_public_policy     = true\n"], [312, "  ignore_public_acls      = true\n"], [313, "  restrict_public_buckets = true\n"], [314, "}\n"]], "file_path": "\\main.tf", "file_line_range": [307, 314], "resource": "aws_s3_bucket_public_access_block.replication_logs_public_access", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_6", "bc_check_id": "BC_AWS_NETWORKING_52", "check_name": "Ensure that S3 bucket has a Public Access block", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs": {"__end_line__": 134, "__start_line__": 126, "bucket": ["alb-logs-dr-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "dr", "Name": "alb-access-logs"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs"}}}, "evaluated_keys": ["block_public_acls", "block_public_policy", "resource_type"]}, "code_block": [[126, "resource \"aws_s3_bucket\" \"alb_logs\" {\n"], [127, "  bucket        = \"alb-logs-${var.environment}-${random_string.suffix.result}\"\n"], [128, "  force_destroy = true\n"], [129, "\n"], [130, "  tags = {\n"], [131, "    Name        = \"alb-access-logs\"\n"], [132, "    Environment = var.environment\n"], [133, "  }\n"], [134, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [126, 134], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "alb-access-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[317, "resource \"aws_s3_bucket_public_access_block\" \"alb_logs_public_access\" {\n"], [318, "  bucket = aws_s3_bucket.alb_logs.id\n"], [319, "\n"], [320, "  block_public_acls       = true\n"], [321, "  block_public_policy     = true\n"], [322, "  ignore_public_acls      = true\n"], [323, "  restrict_public_buckets = true\n"], [324, "}\n"]], "file_path": "\\main.tf", "file_line_range": [317, 324], "resource": "aws_s3_bucket_public_access_block.alb_logs_public_access", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_6", "bc_check_id": "BC_AWS_NETWORKING_52", "check_name": "Ensure that S3 bucket has a Public Access block", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs_access_logs": {"__end_line__": 145, "__start_line__": 137, "bucket": ["alb-logs-access-dr-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "dr", "Name": "alb-access-logs-access"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs_access_logs"}}}, "evaluated_keys": ["block_public_acls", "block_public_policy", "resource_type"]}, "code_block": [[137, "resource \"aws_s3_bucket\" \"alb_logs_access_logs\" {\n"], [138, "  bucket        = \"alb-logs-access-${var.environment}-${random_string.suffix.result}\"\n"], [139, "  force_destroy = true\n"], [140, "\n"], [141, "  tags = {\n"], [142, "    Name        = \"alb-access-logs-access\"\n"], [143, "    Environment = var.environment\n"], [144, "  }\n"], [145, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [137, 145], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs_access_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "alb-access-logs-access"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[327, "resource \"aws_s3_bucket_public_access_block\" \"alb_logs_access_public_access\" {\n"], [328, "  bucket = aws_s3_bucket.alb_logs_access_logs.id\n"], [329, "\n"], [330, "  block_public_acls       = true\n"], [331, "  block_public_policy     = true\n"], [332, "  ignore_public_acls      = true\n"], [333, "  restrict_public_buckets = true\n"], [334, "}\n"]], "file_path": "\\main.tf", "file_line_range": [327, 334], "resource": "aws_s3_bucket_public_access_block.alb_logs_access_public_access", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_6", "bc_check_id": "BC_AWS_NETWORKING_52", "check_name": "Ensure that S3 bucket has a Public Access block", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"config_bucket": {"__end_line__": 339, "__start_line__": 330, "bucket": ["ecs-jenkins-prod-config-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-config-bucket", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.security.aws_s3_bucket.config_bucket"}}}, "evaluated_keys": ["block_public_acls", "block_public_policy", "resource_type"]}, "code_block": [[330, "resource \"aws_s3_bucket\" \"config_bucket\" {\n"], [331, "  bucket        = \"${var.project}-${var.environment}-config-${random_string.bucket_suffix.result}\"\n"], [332, "  force_destroy = var.environment != \"prod\"\n"], [333, "\n"], [334, "  tags = {\n"], [335, "    Name        = \"${var.project}-${var.environment}-config-bucket\"\n"], [336, "    Environment = var.environment\n"], [337, "    Project     = var.project\n"], [338, "  }\n"], [339, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [330, 339], "resource": "module.ecs_jenkins_github.module.security.aws_s3_bucket.config_bucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-config-bucket", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[342, "resource \"aws_s3_bucket_public_access_block\" \"config_bucket_block\" {\n"], [343, "  bucket                  = aws_s3_bucket.config_bucket.id\n"], [344, "  block_public_acls       = true\n"], [345, "  block_public_policy     = true\n"], [346, "  ignore_public_acls      = true\n"], [347, "  restrict_public_buckets = true\n"], [348, "}\n"]], "file_path": "\\..\\security\\main.tf", "file_line_range": [342, 348], "resource": "aws_s3_bucket_public_access_block.config_bucket_block", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV2_AWS_6", "bc_check_id": "BC_AWS_NETWORKING_52", "check_name": "Ensure that S3 bucket has a Public Access block", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"waf_logs": {"__end_line__": 568, "__start_line__": 559, "bucket": ["ecs-jenkins-prod-waf-logs-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-waf-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.security.aws_s3_bucket.waf_logs"}}}, "evaluated_keys": ["block_public_acls", "block_public_policy", "resource_type"]}, "code_block": [[559, "resource \"aws_s3_bucket\" \"waf_logs\" {\n"], [560, "  bucket        = \"${var.project}-${var.environment}-waf-logs-${random_string.bucket_suffix.result}\"\n"], [561, "  force_destroy = var.environment != \"prod\"\n"], [562, "\n"], [563, "  tags = {\n"], [564, "    Name        = \"${var.project}-${var.environment}-waf-logs\"\n"], [565, "    Environment = var.environment\n"], [566, "    Project     = var.project\n"], [567, "  }\n"], [568, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [559, 568], "resource": "module.ecs_jenkins_github.module.security.aws_s3_bucket.waf_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-waf-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[570, "resource \"aws_s3_bucket_public_access_block\" \"waf_logs_block\" {\n"], [571, "  bucket                  = aws_s3_bucket.waf_logs.id\n"], [572, "  block_public_acls       = true\n"], [573, "  block_public_policy     = true\n"], [574, "  ignore_public_acls      = true\n"], [575, "  restrict_public_buckets = true\n"], [576, "}\n"]], "file_path": "\\main.tf", "file_line_range": [570, 576], "resource": "aws_s3_bucket_public_access_block.waf_logs_block", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV2_AWS_6", "bc_check_id": "BC_AWS_NETWORKING_52", "check_name": "Ensure that S3 bucket has a Public Access block", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"config_bucket": {"__end_line__": 339, "__start_line__": 330, "bucket": ["ecs-jenkins-dr-config-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-config-bucket", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.config_bucket"}}}, "evaluated_keys": ["block_public_acls", "block_public_policy", "resource_type"]}, "code_block": [[330, "resource \"aws_s3_bucket\" \"config_bucket\" {\n"], [331, "  bucket        = \"${var.project}-${var.environment}-config-${random_string.bucket_suffix.result}\"\n"], [332, "  force_destroy = var.environment != \"prod\"\n"], [333, "\n"], [334, "  tags = {\n"], [335, "    Name        = \"${var.project}-${var.environment}-config-bucket\"\n"], [336, "    Environment = var.environment\n"], [337, "    Project     = var.project\n"], [338, "  }\n"], [339, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [330, 339], "resource": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.config_bucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-config-bucket", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[342, "resource \"aws_s3_bucket_public_access_block\" \"config_bucket_block\" {\n"], [343, "  bucket                  = aws_s3_bucket.config_bucket.id\n"], [344, "  block_public_acls       = true\n"], [345, "  block_public_policy     = true\n"], [346, "  ignore_public_acls      = true\n"], [347, "  restrict_public_buckets = true\n"], [348, "}\n"]], "file_path": "\\main.tf", "file_line_range": [342, 348], "resource": "aws_s3_bucket_public_access_block.config_bucket_block", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV2_AWS_6", "bc_check_id": "BC_AWS_NETWORKING_52", "check_name": "Ensure that S3 bucket has a Public Access block", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"waf_logs": {"__end_line__": 568, "__start_line__": 559, "bucket": ["ecs-jenkins-dr-waf-logs-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-waf-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.waf_logs"}}}, "evaluated_keys": ["block_public_acls", "block_public_policy", "resource_type"]}, "code_block": [[559, "resource \"aws_s3_bucket\" \"waf_logs\" {\n"], [560, "  bucket        = \"${var.project}-${var.environment}-waf-logs-${random_string.bucket_suffix.result}\"\n"], [561, "  force_destroy = var.environment != \"prod\"\n"], [562, "\n"], [563, "  tags = {\n"], [564, "    Name        = \"${var.project}-${var.environment}-waf-logs\"\n"], [565, "    Environment = var.environment\n"], [566, "    Project     = var.project\n"], [567, "  }\n"], [568, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [559, 568], "resource": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.waf_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-waf-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[570, "resource \"aws_s3_bucket_public_access_block\" \"waf_logs_block\" {\n"], [571, "  bucket                  = aws_s3_bucket.waf_logs.id\n"], [572, "  block_public_acls       = true\n"], [573, "  block_public_policy     = true\n"], [574, "  ignore_public_acls      = true\n"], [575, "  restrict_public_buckets = true\n"], [576, "}\n"]], "file_path": "\\main.tf", "file_line_range": [570, 576], "resource": "aws_s3_bucket_public_access_block.waf_logs_block", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs": {"__end_line__": 134, "__start_line__": 126, "bucket": ["alb-logs-prod-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "prod", "Name": "alb-access-logs"}], "__address__": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[126, "resource \"aws_s3_bucket\" \"alb_logs\" {\n"], [127, "  bucket        = \"alb-logs-${var.environment}-${random_string.suffix.result}\"\n"], [128, "  force_destroy = true\n"], [129, "\n"], [130, "  tags = {\n"], [131, "    Name        = \"alb-access-logs\"\n"], [132, "    Environment = var.environment\n"], [133, "  }\n"], [134, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [126, 134], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "alb-access-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[234, "resource \"aws_s3_bucket_server_side_encryption_configuration\" \"alb_logs_encryption\" {\n"], [235, "  bucket = aws_s3_bucket.alb_logs.id\n"], [236, "  rule {\n"], [237, "    apply_server_side_encryption_by_default {\n"], [238, "      kms_master_key_id = aws_kms_key.s3_kms_key.arn\n"], [239, "      sse_algorithm     = \"aws:kms\"\n"], [240, "    }\n"], [241, "  }\n"], [242, "}\n"]], "file_path": "\\..\\network\\main.tf", "file_line_range": [234, 242], "resource": "aws_s3_bucket_server_side_encryption_configuration.alb_logs_encryption", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs_access_logs": {"__end_line__": 145, "__start_line__": 137, "bucket": ["alb-logs-access-prod-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "prod", "Name": "alb-access-logs-access"}], "__address__": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs_access_logs"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[137, "resource \"aws_s3_bucket\" \"alb_logs_access_logs\" {\n"], [138, "  bucket        = \"alb-logs-access-${var.environment}-${random_string.suffix.result}\"\n"], [139, "  force_destroy = true\n"], [140, "\n"], [141, "  tags = {\n"], [142, "    Name        = \"alb-access-logs-access\"\n"], [143, "    Environment = var.environment\n"], [144, "  }\n"], [145, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [137, 145], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs_access_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "alb-access-logs-access"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[277, "resource \"aws_s3_bucket_server_side_encryption_configuration\" \"alb_logs_access_encryption\" {\n"], [278, "  bucket = aws_s3_bucket.alb_logs_access_logs.id\n"], [279, "  rule {\n"], [280, "    apply_server_side_encryption_by_default {\n"], [281, "      kms_master_key_id = aws_kms_key.s3_kms_key.arn\n"], [282, "      sse_algorithm     = \"aws:kms\"\n"], [283, "    }\n"], [284, "  }\n"], [285, "}\n"]], "file_path": "\\main.tf", "file_line_range": [277, 285], "resource": "aws_s3_bucket_server_side_encryption_configuration.alb_logs_access_encryption", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"replication_logs": {"__end_line__": 156, "__start_line__": 148, "bucket": ["replication-logs-prod-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "prod", "Name": "replication-logs"}], "__address__": "module.ecs_jenkins_github.module.network.aws_s3_bucket.replication_logs"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[148, "resource \"aws_s3_bucket\" \"replication_logs\" {\n"], [149, "  bucket        = \"replication-logs-${var.environment}-${random_string.suffix.result}\"\n"], [150, "  force_destroy = true\n"], [151, "\n"], [152, "  tags = {\n"], [153, "    Name        = \"replication-logs\"\n"], [154, "    Environment = var.environment\n"], [155, "  }\n"], [156, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [148, 156], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.replication_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "replication-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[288, "resource \"aws_s3_bucket_server_side_encryption_configuration\" \"replication_logs_encryption\" {\n"], [289, "  bucket = aws_s3_bucket.replication_logs.id\n"], [290, "  rule {\n"], [291, "    apply_server_side_encryption_by_default {\n"], [292, "      kms_master_key_id = aws_kms_key.s3_kms_key.arn\n"], [293, "      sse_algorithm     = \"aws:kms\"\n"], [294, "    }\n"], [295, "  }\n"], [296, "}\n"]], "file_path": "\\main.tf", "file_line_range": [288, 296], "resource": "aws_s3_bucket_server_side_encryption_configuration.replication_logs_encryption", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs": {"__end_line__": 134, "__start_line__": 126, "bucket": ["alb-logs-dr-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "dr", "Name": "alb-access-logs"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[126, "resource \"aws_s3_bucket\" \"alb_logs\" {\n"], [127, "  bucket        = \"alb-logs-${var.environment}-${random_string.suffix.result}\"\n"], [128, "  force_destroy = true\n"], [129, "\n"], [130, "  tags = {\n"], [131, "    Name        = \"alb-access-logs\"\n"], [132, "    Environment = var.environment\n"], [133, "  }\n"], [134, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [126, 134], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "alb-access-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[234, "resource \"aws_s3_bucket_server_side_encryption_configuration\" \"alb_logs_encryption\" {\n"], [235, "  bucket = aws_s3_bucket.alb_logs.id\n"], [236, "  rule {\n"], [237, "    apply_server_side_encryption_by_default {\n"], [238, "      kms_master_key_id = aws_kms_key.s3_kms_key.arn\n"], [239, "      sse_algorithm     = \"aws:kms\"\n"], [240, "    }\n"], [241, "  }\n"], [242, "}\n"]], "file_path": "\\main.tf", "file_line_range": [234, 242], "resource": "aws_s3_bucket_server_side_encryption_configuration.alb_logs_encryption", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs_access_logs": {"__end_line__": 145, "__start_line__": 137, "bucket": ["alb-logs-access-dr-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "dr", "Name": "alb-access-logs-access"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs_access_logs"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[137, "resource \"aws_s3_bucket\" \"alb_logs_access_logs\" {\n"], [138, "  bucket        = \"alb-logs-access-${var.environment}-${random_string.suffix.result}\"\n"], [139, "  force_destroy = true\n"], [140, "\n"], [141, "  tags = {\n"], [142, "    Name        = \"alb-access-logs-access\"\n"], [143, "    Environment = var.environment\n"], [144, "  }\n"], [145, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [137, 145], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs_access_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "alb-access-logs-access"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[277, "resource \"aws_s3_bucket_server_side_encryption_configuration\" \"alb_logs_access_encryption\" {\n"], [278, "  bucket = aws_s3_bucket.alb_logs_access_logs.id\n"], [279, "  rule {\n"], [280, "    apply_server_side_encryption_by_default {\n"], [281, "      kms_master_key_id = aws_kms_key.s3_kms_key.arn\n"], [282, "      sse_algorithm     = \"aws:kms\"\n"], [283, "    }\n"], [284, "  }\n"], [285, "}\n"]], "file_path": "\\main.tf", "file_line_range": [277, 285], "resource": "aws_s3_bucket_server_side_encryption_configuration.alb_logs_access_encryption", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"replication_logs": {"__end_line__": 156, "__start_line__": 148, "bucket": ["replication-logs-dr-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "dr", "Name": "replication-logs"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.replication_logs"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[148, "resource \"aws_s3_bucket\" \"replication_logs\" {\n"], [149, "  bucket        = \"replication-logs-${var.environment}-${random_string.suffix.result}\"\n"], [150, "  force_destroy = true\n"], [151, "\n"], [152, "  tags = {\n"], [153, "    Name        = \"replication-logs\"\n"], [154, "    Environment = var.environment\n"], [155, "  }\n"], [156, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [148, 156], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.replication_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "replication-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[288, "resource \"aws_s3_bucket_server_side_encryption_configuration\" \"replication_logs_encryption\" {\n"], [289, "  bucket = aws_s3_bucket.replication_logs.id\n"], [290, "  rule {\n"], [291, "    apply_server_side_encryption_by_default {\n"], [292, "      kms_master_key_id = aws_kms_key.s3_kms_key.arn\n"], [293, "      sse_algorithm     = \"aws:kms\"\n"], [294, "    }\n"], [295, "  }\n"], [296, "}\n"]], "file_path": "\\main.tf", "file_line_range": [288, 296], "resource": "aws_s3_bucket_server_side_encryption_configuration.replication_logs_encryption", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_12", "bc_check_id": "BC_AWS_NETWORKING_4", "check_name": "Ensure the default security group of every VPC restricts all traffic", "check_result": {"result": "PASSED", "entity": {"aws_vpc": {"vpc": {"__end_line__": 9, "__start_line__": 1, "cidr_block": ["10.1.0.0/16"], "enable_dns_hostnames": [true], "enable_dns_support": [true], "tags": [{"Name": "main-vpc"}], "__address__": "module.ecs_jenkins_github.module.network.aws_vpc.vpc"}}}, "evaluated_keys": ["ingress/protocol", "egress/cidr_blocks", "egress/to_port", "ingress/self", "egress/protocol", "ingress/from_port", "resource_type", "egress/from_port", "ingress/to_port"]}, "code_block": [[1, "resource \"aws_vpc\" \"vpc\" {\n"], [2, "  cidr_block           = var.vpc_cidr\n"], [3, "  enable_dns_hostnames = true\n"], [4, "  enable_dns_support   = true\n"], [5, "\n"], [6, "  tags = {\n"], [7, "    Name = \"main-vpc\"\n"], [8, "  }\n"], [9, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [1, 9], "resource": "module.ecs_jenkins_github.module.network.aws_vpc.vpc", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "main-vpc"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[586, "resource \"aws_default_security_group\" \"default\" {\n"], [587, "  vpc_id = aws_vpc.vpc.id\n"], [588, "\n"], [589, "  # No ingress or egress rules - effectively blocking all traffic\n"], [590, "}\n"]], "file_path": "\\..\\network\\main.tf", "file_line_range": [586, 590], "resource": "aws_default_security_group.default", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-4", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_12", "bc_check_id": "BC_AWS_NETWORKING_4", "check_name": "Ensure the default security group of every VPC restricts all traffic", "check_result": {"result": "PASSED", "entity": {"aws_vpc": {"vpc": {"__end_line__": 9, "__start_line__": 1, "cidr_block": ["10.2.0.0/16"], "enable_dns_hostnames": [true], "enable_dns_support": [true], "tags": [{"Name": "main-vpc"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_vpc.vpc"}}}, "evaluated_keys": ["ingress/protocol", "egress/cidr_blocks", "egress/to_port", "ingress/self", "egress/protocol", "ingress/from_port", "resource_type", "egress/from_port", "ingress/to_port"]}, "code_block": [[1, "resource \"aws_vpc\" \"vpc\" {\n"], [2, "  cidr_block           = var.vpc_cidr\n"], [3, "  enable_dns_hostnames = true\n"], [4, "  enable_dns_support   = true\n"], [5, "\n"], [6, "  tags = {\n"], [7, "    Name = \"main-vpc\"\n"], [8, "  }\n"], [9, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [1, 9], "resource": "module.ecs_jenkins_github_dr.module.network.aws_vpc.vpc", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "main-vpc"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[586, "resource \"aws_default_security_group\" \"default\" {\n"], [587, "  vpc_id = aws_vpc.vpc.id\n"], [588, "\n"], [589, "  # No ingress or egress rules - effectively blocking all traffic\n"], [590, "}\n"]], "file_path": "\\main.tf", "file_line_range": [586, 590], "resource": "aws_default_security_group.default", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-4", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_19", "bc_check_id": "BC_AWS_S3_14", "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"patch_logs": {"__end_line__": 207, "__start_line__": 199, "bucket": ["ecs-jenkins-prod-patch-logs-${random_string.suffix.result}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-patch-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.ec2.aws_s3_bucket.patch_logs"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[199, "resource \"aws_s3_bucket\" \"patch_logs\" {\n"], [200, "  bucket = \"${var.project}-${var.environment}-patch-logs-${random_string.suffix.result}\"\n"], [201, "\n"], [202, "  tags = {\n"], [203, "    Name        = \"${var.project}-${var.environment}-patch-logs\"\n"], [204, "    Environment = var.environment\n"], [205, "    Project     = var.project\n"], [206, "  }\n"], [207, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [199, 207], "resource": "module.ecs_jenkins_github.module.ec2.aws_s3_bucket.patch_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-patch-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-14-data-encrypted-at-rest", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_19", "bc_check_id": "BC_AWS_S3_14", "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"patch_logs": {"__end_line__": 207, "__start_line__": 199, "bucket": ["ecs-jenkins-dr-patch-logs-${random_string.suffix.result}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-patch-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.ec2.aws_s3_bucket.patch_logs"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[199, "resource \"aws_s3_bucket\" \"patch_logs\" {\n"], [200, "  bucket = \"${var.project}-${var.environment}-patch-logs-${random_string.suffix.result}\"\n"], [201, "\n"], [202, "  tags = {\n"], [203, "    Name        = \"${var.project}-${var.environment}-patch-logs\"\n"], [204, "    Environment = var.environment\n"], [205, "    Project     = var.project\n"], [206, "  }\n"], [207, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [199, 207], "resource": "module.ecs_jenkins_github_dr.module.ec2.aws_s3_bucket.patch_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-patch-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-14-data-encrypted-at-rest", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_19", "bc_check_id": "BC_AWS_S3_14", "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"lambda_code": {"__end_line__": 18, "__start_line__": 10, "bucket": ["${var.project}-${var.environment}-lambda-${random_string.bucket_suffix.result}"], "tags": [{"Environment": "var.environment", "Name": "${var.project}-${var.environment}-lambda", "Project": "var.project"}], "__address__": "module.lambda_failover.aws_s3_bucket.lambda_code"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[10, "resource \"aws_s3_bucket\" \"lambda_code\" {\n"], [11, "  bucket = \"${var.project}-${var.environment}-lambda-${random_string.bucket_suffix.result}\"\n"], [12, "\n"], [13, "  tags = {\n"], [14, "    Name        = \"${var.project}-${var.environment}-lambda\"\n"], [15, "    Environment = var.environment\n"], [16, "    Project     = var.project\n"], [17, "  }\n"], [18, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [10, 18], "resource": "module.lambda_failover.aws_s3_bucket.lambda_code", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Name": "${var.project}-${var.environment}-lambda", "Project": "var.project"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-14-data-encrypted-at-rest", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_19", "bc_check_id": "BC_AWS_S3_14", "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs": {"__end_line__": 134, "__start_line__": 126, "bucket": ["alb-logs-prod-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "prod", "Name": "alb-access-logs"}], "__address__": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[126, "resource \"aws_s3_bucket\" \"alb_logs\" {\n"], [127, "  bucket        = \"alb-logs-${var.environment}-${random_string.suffix.result}\"\n"], [128, "  force_destroy = true\n"], [129, "\n"], [130, "  tags = {\n"], [131, "    Name        = \"alb-access-logs\"\n"], [132, "    Environment = var.environment\n"], [133, "  }\n"], [134, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [126, 134], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "alb-access-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[234, "resource \"aws_s3_bucket_server_side_encryption_configuration\" \"alb_logs_encryption\" {\n"], [235, "  bucket = aws_s3_bucket.alb_logs.id\n"], [236, "  rule {\n"], [237, "    apply_server_side_encryption_by_default {\n"], [238, "      kms_master_key_id = aws_kms_key.s3_kms_key.arn\n"], [239, "      sse_algorithm     = \"aws:kms\"\n"], [240, "    }\n"], [241, "  }\n"], [242, "}\n"]], "file_path": "\\..\\network\\main.tf", "file_line_range": [234, 242], "resource": "aws_s3_bucket_server_side_encryption_configuration.alb_logs_encryption", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-14-data-encrypted-at-rest", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_19", "bc_check_id": "BC_AWS_S3_14", "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs_access_logs": {"__end_line__": 145, "__start_line__": 137, "bucket": ["alb-logs-access-prod-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "prod", "Name": "alb-access-logs-access"}], "__address__": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs_access_logs"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[137, "resource \"aws_s3_bucket\" \"alb_logs_access_logs\" {\n"], [138, "  bucket        = \"alb-logs-access-${var.environment}-${random_string.suffix.result}\"\n"], [139, "  force_destroy = true\n"], [140, "\n"], [141, "  tags = {\n"], [142, "    Name        = \"alb-access-logs-access\"\n"], [143, "    Environment = var.environment\n"], [144, "  }\n"], [145, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [137, 145], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs_access_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "alb-access-logs-access"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[277, "resource \"aws_s3_bucket_server_side_encryption_configuration\" \"alb_logs_access_encryption\" {\n"], [278, "  bucket = aws_s3_bucket.alb_logs_access_logs.id\n"], [279, "  rule {\n"], [280, "    apply_server_side_encryption_by_default {\n"], [281, "      kms_master_key_id = aws_kms_key.s3_kms_key.arn\n"], [282, "      sse_algorithm     = \"aws:kms\"\n"], [283, "    }\n"], [284, "  }\n"], [285, "}\n"]], "file_path": "\\main.tf", "file_line_range": [277, 285], "resource": "aws_s3_bucket_server_side_encryption_configuration.alb_logs_access_encryption", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-14-data-encrypted-at-rest", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_19", "bc_check_id": "BC_AWS_S3_14", "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"replication_logs": {"__end_line__": 156, "__start_line__": 148, "bucket": ["replication-logs-prod-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "prod", "Name": "replication-logs"}], "__address__": "module.ecs_jenkins_github.module.network.aws_s3_bucket.replication_logs"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[148, "resource \"aws_s3_bucket\" \"replication_logs\" {\n"], [149, "  bucket        = \"replication-logs-${var.environment}-${random_string.suffix.result}\"\n"], [150, "  force_destroy = true\n"], [151, "\n"], [152, "  tags = {\n"], [153, "    Name        = \"replication-logs\"\n"], [154, "    Environment = var.environment\n"], [155, "  }\n"], [156, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [148, 156], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.replication_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "replication-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[288, "resource \"aws_s3_bucket_server_side_encryption_configuration\" \"replication_logs_encryption\" {\n"], [289, "  bucket = aws_s3_bucket.replication_logs.id\n"], [290, "  rule {\n"], [291, "    apply_server_side_encryption_by_default {\n"], [292, "      kms_master_key_id = aws_kms_key.s3_kms_key.arn\n"], [293, "      sse_algorithm     = \"aws:kms\"\n"], [294, "    }\n"], [295, "  }\n"], [296, "}\n"]], "file_path": "\\main.tf", "file_line_range": [288, 296], "resource": "aws_s3_bucket_server_side_encryption_configuration.replication_logs_encryption", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-14-data-encrypted-at-rest", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_19", "bc_check_id": "BC_AWS_S3_14", "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs": {"__end_line__": 134, "__start_line__": 126, "bucket": ["alb-logs-dr-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "dr", "Name": "alb-access-logs"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[126, "resource \"aws_s3_bucket\" \"alb_logs\" {\n"], [127, "  bucket        = \"alb-logs-${var.environment}-${random_string.suffix.result}\"\n"], [128, "  force_destroy = true\n"], [129, "\n"], [130, "  tags = {\n"], [131, "    Name        = \"alb-access-logs\"\n"], [132, "    Environment = var.environment\n"], [133, "  }\n"], [134, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [126, 134], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "alb-access-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[234, "resource \"aws_s3_bucket_server_side_encryption_configuration\" \"alb_logs_encryption\" {\n"], [235, "  bucket = aws_s3_bucket.alb_logs.id\n"], [236, "  rule {\n"], [237, "    apply_server_side_encryption_by_default {\n"], [238, "      kms_master_key_id = aws_kms_key.s3_kms_key.arn\n"], [239, "      sse_algorithm     = \"aws:kms\"\n"], [240, "    }\n"], [241, "  }\n"], [242, "}\n"]], "file_path": "\\main.tf", "file_line_range": [234, 242], "resource": "aws_s3_bucket_server_side_encryption_configuration.alb_logs_encryption", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-14-data-encrypted-at-rest", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_19", "bc_check_id": "BC_AWS_S3_14", "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"alb_logs_access_logs": {"__end_line__": 145, "__start_line__": 137, "bucket": ["alb-logs-access-dr-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "dr", "Name": "alb-access-logs-access"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs_access_logs"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[137, "resource \"aws_s3_bucket\" \"alb_logs_access_logs\" {\n"], [138, "  bucket        = \"alb-logs-access-${var.environment}-${random_string.suffix.result}\"\n"], [139, "  force_destroy = true\n"], [140, "\n"], [141, "  tags = {\n"], [142, "    Name        = \"alb-access-logs-access\"\n"], [143, "    Environment = var.environment\n"], [144, "  }\n"], [145, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [137, 145], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs_access_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "alb-access-logs-access"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[277, "resource \"aws_s3_bucket_server_side_encryption_configuration\" \"alb_logs_access_encryption\" {\n"], [278, "  bucket = aws_s3_bucket.alb_logs_access_logs.id\n"], [279, "  rule {\n"], [280, "    apply_server_side_encryption_by_default {\n"], [281, "      kms_master_key_id = aws_kms_key.s3_kms_key.arn\n"], [282, "      sse_algorithm     = \"aws:kms\"\n"], [283, "    }\n"], [284, "  }\n"], [285, "}\n"]], "file_path": "\\main.tf", "file_line_range": [277, 285], "resource": "aws_s3_bucket_server_side_encryption_configuration.alb_logs_access_encryption", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-14-data-encrypted-at-rest", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_19", "bc_check_id": "BC_AWS_S3_14", "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"replication_logs": {"__end_line__": 156, "__start_line__": 148, "bucket": ["replication-logs-dr-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "dr", "Name": "replication-logs"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.replication_logs"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[148, "resource \"aws_s3_bucket\" \"replication_logs\" {\n"], [149, "  bucket        = \"replication-logs-${var.environment}-${random_string.suffix.result}\"\n"], [150, "  force_destroy = true\n"], [151, "\n"], [152, "  tags = {\n"], [153, "    Name        = \"replication-logs\"\n"], [154, "    Environment = var.environment\n"], [155, "  }\n"], [156, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [148, 156], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.replication_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "replication-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[288, "resource \"aws_s3_bucket_server_side_encryption_configuration\" \"replication_logs_encryption\" {\n"], [289, "  bucket = aws_s3_bucket.replication_logs.id\n"], [290, "  rule {\n"], [291, "    apply_server_side_encryption_by_default {\n"], [292, "      kms_master_key_id = aws_kms_key.s3_kms_key.arn\n"], [293, "      sse_algorithm     = \"aws:kms\"\n"], [294, "    }\n"], [295, "  }\n"], [296, "}\n"]], "file_path": "\\main.tf", "file_line_range": [288, 296], "resource": "aws_s3_bucket_server_side_encryption_configuration.replication_logs_encryption", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-14-data-encrypted-at-rest", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_19", "bc_check_id": "BC_AWS_S3_14", "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"config_bucket": {"__end_line__": 339, "__start_line__": 330, "bucket": ["ecs-jenkins-prod-config-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-config-bucket", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.security.aws_s3_bucket.config_bucket"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[330, "resource \"aws_s3_bucket\" \"config_bucket\" {\n"], [331, "  bucket        = \"${var.project}-${var.environment}-config-${random_string.bucket_suffix.result}\"\n"], [332, "  force_destroy = var.environment != \"prod\"\n"], [333, "\n"], [334, "  tags = {\n"], [335, "    Name        = \"${var.project}-${var.environment}-config-bucket\"\n"], [336, "    Environment = var.environment\n"], [337, "    Project     = var.project\n"], [338, "  }\n"], [339, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [330, 339], "resource": "module.ecs_jenkins_github.module.security.aws_s3_bucket.config_bucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-config-bucket", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[351, "resource \"aws_s3_bucket_server_side_encryption_configuration\" \"config_bucket_encryption\" {\n"], [352, "  bucket = aws_s3_bucket.config_bucket.id\n"], [353, "\n"], [354, "  rule {\n"], [355, "    apply_server_side_encryption_by_default {\n"], [356, "      sse_algorithm = \"AES256\"\n"], [357, "    }\n"], [358, "  }\n"], [359, "}\n"]], "file_path": "\\..\\security\\main.tf", "file_line_range": [351, 359], "resource": "aws_s3_bucket_server_side_encryption_configuration.config_bucket_encryption", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-14-data-encrypted-at-rest", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_19", "bc_check_id": "BC_AWS_S3_14", "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"waf_logs": {"__end_line__": 568, "__start_line__": 559, "bucket": ["ecs-jenkins-prod-waf-logs-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-waf-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.security.aws_s3_bucket.waf_logs"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[559, "resource \"aws_s3_bucket\" \"waf_logs\" {\n"], [560, "  bucket        = \"${var.project}-${var.environment}-waf-logs-${random_string.bucket_suffix.result}\"\n"], [561, "  force_destroy = var.environment != \"prod\"\n"], [562, "\n"], [563, "  tags = {\n"], [564, "    Name        = \"${var.project}-${var.environment}-waf-logs\"\n"], [565, "    Environment = var.environment\n"], [566, "    Project     = var.project\n"], [567, "  }\n"], [568, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [559, 568], "resource": "module.ecs_jenkins_github.module.security.aws_s3_bucket.waf_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-waf-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[578, "resource \"aws_s3_bucket_server_side_encryption_configuration\" \"waf_logs_encryption\" {\n"], [579, "  bucket = aws_s3_bucket.waf_logs.id\n"], [580, "\n"], [581, "  rule {\n"], [582, "    apply_server_side_encryption_by_default {\n"], [583, "      sse_algorithm = \"AES256\"\n"], [584, "    }\n"], [585, "  }\n"], [586, "}\n"]], "file_path": "\\main.tf", "file_line_range": [578, 586], "resource": "aws_s3_bucket_server_side_encryption_configuration.waf_logs_encryption", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-14-data-encrypted-at-rest", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_19", "bc_check_id": "BC_AWS_S3_14", "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"config_bucket": {"__end_line__": 339, "__start_line__": 330, "bucket": ["ecs-jenkins-dr-config-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-config-bucket", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.config_bucket"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[330, "resource \"aws_s3_bucket\" \"config_bucket\" {\n"], [331, "  bucket        = \"${var.project}-${var.environment}-config-${random_string.bucket_suffix.result}\"\n"], [332, "  force_destroy = var.environment != \"prod\"\n"], [333, "\n"], [334, "  tags = {\n"], [335, "    Name        = \"${var.project}-${var.environment}-config-bucket\"\n"], [336, "    Environment = var.environment\n"], [337, "    Project     = var.project\n"], [338, "  }\n"], [339, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [330, 339], "resource": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.config_bucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-config-bucket", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[351, "resource \"aws_s3_bucket_server_side_encryption_configuration\" \"config_bucket_encryption\" {\n"], [352, "  bucket = aws_s3_bucket.config_bucket.id\n"], [353, "\n"], [354, "  rule {\n"], [355, "    apply_server_side_encryption_by_default {\n"], [356, "      sse_algorithm = \"AES256\"\n"], [357, "    }\n"], [358, "  }\n"], [359, "}\n"]], "file_path": "\\main.tf", "file_line_range": [351, 359], "resource": "aws_s3_bucket_server_side_encryption_configuration.config_bucket_encryption", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-14-data-encrypted-at-rest", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_19", "bc_check_id": "BC_AWS_S3_14", "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"waf_logs": {"__end_line__": 568, "__start_line__": 559, "bucket": ["ecs-jenkins-dr-waf-logs-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-waf-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.waf_logs"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[559, "resource \"aws_s3_bucket\" \"waf_logs\" {\n"], [560, "  bucket        = \"${var.project}-${var.environment}-waf-logs-${random_string.bucket_suffix.result}\"\n"], [561, "  force_destroy = var.environment != \"prod\"\n"], [562, "\n"], [563, "  tags = {\n"], [564, "    Name        = \"${var.project}-${var.environment}-waf-logs\"\n"], [565, "    Environment = var.environment\n"], [566, "    Project     = var.project\n"], [567, "  }\n"], [568, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [559, 568], "resource": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.waf_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-waf-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[578, "resource \"aws_s3_bucket_server_side_encryption_configuration\" \"waf_logs_encryption\" {\n"], [579, "  bucket = aws_s3_bucket.waf_logs.id\n"], [580, "\n"], [581, "  rule {\n"], [582, "    apply_server_side_encryption_by_default {\n"], [583, "      sse_algorithm = \"AES256\"\n"], [584, "    }\n"], [585, "  }\n"], [586, "}\n"]], "file_path": "\\main.tf", "file_line_range": [578, 586], "resource": "aws_s3_bucket_server_side_encryption_configuration.waf_logs_encryption", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-14-data-encrypted-at-rest", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}], "failed_checks": [{"check_id": "CKV_AWS_382", "bc_check_id": "BC_AWS_IAM_93", "check_name": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "check_result": {"result": "FAILED", "evaluated_keys": ["egress/[0]/from_port", "egress/[0]/to_port", "egress/[0]/cidr_blocks", "egress/[0]/ipv6_cidr_blocks"]}, "code_block": [[2, "resource \"aws_security_group\" \"jenkins_sg\" {\n"], [3, "  name        = \"${var.project}-${var.environment}-jenkins-sg\"\n"], [4, "  description = \"Security group for Jenkins server\"\n"], [5, "  vpc_id      = var.vpc_id\n"], [6, "\n"], [7, "  ingress {\n"], [8, "    description = \"SSH access\"\n"], [9, "    from_port   = 22\n"], [10, "    to_port     = 22\n"], [11, "    protocol    = \"tcp\"\n"], [12, "    cidr_blocks = var.ssh_allowed_cidr\n"], [13, "  }\n"], [14, "\n"], [15, "  ingress {\n"], [16, "    description = \"Jenkins web interface\"\n"], [17, "    from_port   = 8080\n"], [18, "    to_port     = 8080\n"], [19, "    protocol    = \"tcp\"\n"], [20, "    cidr_blocks = var.web_allowed_cidr\n"], [21, "  }\n"], [22, "\n"], [23, "  egress {\n"], [24, "    from_port   = 0\n"], [25, "    to_port     = 0\n"], [26, "    protocol    = \"-1\"\n"], [27, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [28, "  }\n"], [29, "\n"], [30, "  tags = {\n"], [31, "    Name        = \"${var.project}-${var.environment}-jenkins-sg\"\n"], [32, "    Environment = var.environment\n"], [33, "    Project     = var.project\n"], [34, "  }\n"], [35, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [2, 35], "resource": "module.ecs_jenkins_github.module.cicd.aws_security_group.jenkins_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedEgressAny", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-sg", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_91", "bc_check_id": "BC_AWS_LOGGING_22", "check_name": "Ensure the ELBv2 (Application/Network) has access logging enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["access_logs/0/enabled/0"]}, "code_block": [[175, "resource \"aws_lb\" \"jenkins_nlb\" {\n"], [176, "  name               = \"${var.project}-${var.environment}-jenkins-nlb\"\n"], [177, "  internal           = false\n"], [178, "  load_balancer_type = \"network\"\n"], [179, "  subnets            = [var.subnet_id]\n"], [180, "\n"], [181, "  tags = {\n"], [182, "    Name        = \"${var.project}-${var.environment}-jenkins-nlb\"\n"], [183, "    Environment = var.environment\n"], [184, "    Project     = var.project\n"], [185, "  }\n"], [186, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [175, 186], "resource": "module.ecs_jenkins_github.module.cicd.aws_lb.jenkins_nlb", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ELBv2AccessLogs", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-nlb", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-logging-22", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_152", "bc_check_id": "BC_AWS_NETWORKING_55", "check_name": "Ensure that Load Balancer (Network/Gateway) has cross-zone load balancing enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["enable_cross_zone_load_balancing"]}, "code_block": [[175, "resource \"aws_lb\" \"jenkins_nlb\" {\n"], [176, "  name               = \"${var.project}-${var.environment}-jenkins-nlb\"\n"], [177, "  internal           = false\n"], [178, "  load_balancer_type = \"network\"\n"], [179, "  subnets            = [var.subnet_id]\n"], [180, "\n"], [181, "  tags = {\n"], [182, "    Name        = \"${var.project}-${var.environment}-jenkins-nlb\"\n"], [183, "    Environment = var.environment\n"], [184, "    Project     = var.project\n"], [185, "  }\n"], [186, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [175, 186], "resource": "module.ecs_jenkins_github.module.cicd.aws_lb.jenkins_nlb", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LBCrossZone", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-nlb", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-load-balancer-networkgateway-has-cross-zone-load-balancing-enabled", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_150", "bc_check_id": "BC_AWS_NETWORKING_62", "check_name": "Ensure that Load Balancer has deletion protection enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["enable_deletion_protection"]}, "code_block": [[175, "resource \"aws_lb\" \"jenkins_nlb\" {\n"], [176, "  name               = \"${var.project}-${var.environment}-jenkins-nlb\"\n"], [177, "  internal           = false\n"], [178, "  load_balancer_type = \"network\"\n"], [179, "  subnets            = [var.subnet_id]\n"], [180, "\n"], [181, "  tags = {\n"], [182, "    Name        = \"${var.project}-${var.environment}-jenkins-nlb\"\n"], [183, "    Environment = var.environment\n"], [184, "    Project     = var.project\n"], [185, "  }\n"], [186, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [175, 186], "resource": "module.ecs_jenkins_github.module.cicd.aws_lb.jenkins_nlb", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LBDeletionProtection", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-nlb", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-150", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_382", "bc_check_id": "BC_AWS_IAM_93", "check_name": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "check_result": {"result": "FAILED", "evaluated_keys": ["egress/[0]/from_port", "egress/[0]/to_port", "egress/[0]/cidr_blocks", "egress/[0]/ipv6_cidr_blocks"]}, "code_block": [[2, "resource \"aws_security_group\" \"jenkins_sg\" {\n"], [3, "  name        = \"${var.project}-${var.environment}-jenkins-sg\"\n"], [4, "  description = \"Security group for Jenkins server\"\n"], [5, "  vpc_id      = var.vpc_id\n"], [6, "\n"], [7, "  ingress {\n"], [8, "    description = \"SSH access\"\n"], [9, "    from_port   = 22\n"], [10, "    to_port     = 22\n"], [11, "    protocol    = \"tcp\"\n"], [12, "    cidr_blocks = var.ssh_allowed_cidr\n"], [13, "  }\n"], [14, "\n"], [15, "  ingress {\n"], [16, "    description = \"Jenkins web interface\"\n"], [17, "    from_port   = 8080\n"], [18, "    to_port     = 8080\n"], [19, "    protocol    = \"tcp\"\n"], [20, "    cidr_blocks = var.web_allowed_cidr\n"], [21, "  }\n"], [22, "\n"], [23, "  egress {\n"], [24, "    from_port   = 0\n"], [25, "    to_port     = 0\n"], [26, "    protocol    = \"-1\"\n"], [27, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [28, "  }\n"], [29, "\n"], [30, "  tags = {\n"], [31, "    Name        = \"${var.project}-${var.environment}-jenkins-sg\"\n"], [32, "    Environment = var.environment\n"], [33, "    Project     = var.project\n"], [34, "  }\n"], [35, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [2, 35], "resource": "module.ecs_jenkins_github_dr.module.cicd.aws_security_group.jenkins_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedEgressAny", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-sg", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_91", "bc_check_id": "BC_AWS_LOGGING_22", "check_name": "Ensure the ELBv2 (Application/Network) has access logging enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["access_logs/0/enabled/0"]}, "code_block": [[175, "resource \"aws_lb\" \"jenkins_nlb\" {\n"], [176, "  name               = \"${var.project}-${var.environment}-jenkins-nlb\"\n"], [177, "  internal           = false\n"], [178, "  load_balancer_type = \"network\"\n"], [179, "  subnets            = [var.subnet_id]\n"], [180, "\n"], [181, "  tags = {\n"], [182, "    Name        = \"${var.project}-${var.environment}-jenkins-nlb\"\n"], [183, "    Environment = var.environment\n"], [184, "    Project     = var.project\n"], [185, "  }\n"], [186, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [175, 186], "resource": "module.ecs_jenkins_github_dr.module.cicd.aws_lb.jenkins_nlb", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ELBv2AccessLogs", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-nlb", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-logging-22", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_152", "bc_check_id": "BC_AWS_NETWORKING_55", "check_name": "Ensure that Load Balancer (Network/Gateway) has cross-zone load balancing enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["enable_cross_zone_load_balancing"]}, "code_block": [[175, "resource \"aws_lb\" \"jenkins_nlb\" {\n"], [176, "  name               = \"${var.project}-${var.environment}-jenkins-nlb\"\n"], [177, "  internal           = false\n"], [178, "  load_balancer_type = \"network\"\n"], [179, "  subnets            = [var.subnet_id]\n"], [180, "\n"], [181, "  tags = {\n"], [182, "    Name        = \"${var.project}-${var.environment}-jenkins-nlb\"\n"], [183, "    Environment = var.environment\n"], [184, "    Project     = var.project\n"], [185, "  }\n"], [186, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [175, 186], "resource": "module.ecs_jenkins_github_dr.module.cicd.aws_lb.jenkins_nlb", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LBCrossZone", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-nlb", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-load-balancer-networkgateway-has-cross-zone-load-balancing-enabled", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_150", "bc_check_id": "BC_AWS_NETWORKING_62", "check_name": "Ensure that Load Balancer has deletion protection enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["enable_deletion_protection"]}, "code_block": [[175, "resource \"aws_lb\" \"jenkins_nlb\" {\n"], [176, "  name               = \"${var.project}-${var.environment}-jenkins-nlb\"\n"], [177, "  internal           = false\n"], [178, "  load_balancer_type = \"network\"\n"], [179, "  subnets            = [var.subnet_id]\n"], [180, "\n"], [181, "  tags = {\n"], [182, "    Name        = \"${var.project}-${var.environment}-jenkins-nlb\"\n"], [183, "    Environment = var.environment\n"], [184, "    Project     = var.project\n"], [185, "  }\n"], [186, "}\n"]], "file_path": "\\modules\\cicd\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [175, 186], "resource": "module.ecs_jenkins_github_dr.module.cicd.aws_lb.jenkins_nlb", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LBDeletionProtection", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-nlb", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [67, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-150", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV_AWS_353", "bc_check_id": "BC_AWS_LOGGING_47", "check_name": "Ensure that RDS instances have performance insights enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["performance_insights_enabled"]}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSInstancePerformanceInsights", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-353", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_353", "bc_check_id": "BC_AWS_LOGGING_47", "check_name": "Ensure that RDS instances have performance insights enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["performance_insights_enabled"]}, "code_block": [[40, "resource \"aws_db_instance\" \"db_instance\" {\n"], [41, "  identifier                = \"db-instance\"\n"], [42, "  allocated_storage         = 20\n"], [43, "  storage_type              = \"gp2\"\n"], [44, "  engine                    = \"postgres\"\n"], [45, "  engine_version            = \"13\"\n"], [46, "  instance_class            = \"db.t3.micro\"\n"], [47, "  username                  = var.db_username\n"], [48, "  password                  = var.db_password\n"], [49, "  parameter_group_name      = aws_db_parameter_group.db_pg.name\n"], [50, "  skip_final_snapshot       = false\n"], [51, "  final_snapshot_identifier = \"db-final-snapshot\"\n"], [52, "  db_subnet_group_name      = aws_db_subnet_group.db_subnet_group.name\n"], [53, "  vpc_security_group_ids    = [var.db_security_group]\n"], [54, "\n"], [55, "  # Security enhancements\n"], [56, "  storage_encrypted                   = true\n"], [57, "  multi_az                            = true\n"], [58, "  backup_retention_period             = 7\n"], [59, "  monitoring_interval                 = 60\n"], [60, "  monitoring_role_arn                 = aws_iam_role.rds_monitoring_role.arn\n"], [61, "  deletion_protection                 = true\n"], [62, "  auto_minor_version_upgrade          = true\n"], [63, "  iam_database_authentication_enabled = true\n"], [64, "  copy_tags_to_snapshot               = true\n"], [65, "  enabled_cloudwatch_logs_exports     = [\"postgresql\", \"upgrade\"]\n"], [66, "}\n"]], "file_path": "\\modules\\database\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf", "repo_file_path": "/modules/database/main.tf", "file_line_range": [40, 66], "resource": "module.ecs_jenkins_github_dr.module.database.aws_db_instance.db_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSInstancePerformanceInsights", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [36, 47], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-353", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\database\\main.tf"}, {"check_id": "CKV_AWS_300", "bc_check_id": "BC_AWS_GENERAL_214", "check_name": "Ensure S3 lifecycle configuration sets period for aborting failed uploads", "check_result": {"result": "FAILED", "evaluated_keys": ["rule"]}, "code_block": [[209, "resource \"aws_s3_bucket_lifecycle_configuration\" \"patch_logs_lifecycle\" {\n"], [210, "  bucket = aws_s3_bucket.patch_logs.id\n"], [211, "\n"], [212, "  rule {\n"], [213, "    id     = \"DeleteOldLogs\"\n"], [214, "    status = \"Enabled\"\n"], [215, "\n"], [216, "    expiration {\n"], [217, "      days = 90\n"], [218, "    }\n"], [219, "  }\n"], [220, "}\n"]], "file_path": "\\modules\\ec2\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [209, 220], "resource": "module.ecs_jenkins_github.module.ec2.aws_s3_bucket_lifecycle_configuration.patch_logs_lifecycle", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3AbortIncompleteUploads", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [79, 102], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-300", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_300", "bc_check_id": "BC_AWS_GENERAL_214", "check_name": "Ensure S3 lifecycle configuration sets period for aborting failed uploads", "check_result": {"result": "FAILED", "evaluated_keys": ["rule"]}, "code_block": [[209, "resource \"aws_s3_bucket_lifecycle_configuration\" \"patch_logs_lifecycle\" {\n"], [210, "  bucket = aws_s3_bucket.patch_logs.id\n"], [211, "\n"], [212, "  rule {\n"], [213, "    id     = \"DeleteOldLogs\"\n"], [214, "    status = \"Enabled\"\n"], [215, "\n"], [216, "    expiration {\n"], [217, "      days = 90\n"], [218, "    }\n"], [219, "  }\n"], [220, "}\n"]], "file_path": "\\modules\\ec2\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [209, 220], "resource": "module.ecs_jenkins_github_dr.module.ec2.aws_s3_bucket_lifecycle_configuration.patch_logs_lifecycle", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3AbortIncompleteUploads", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [79, 102], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-300", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[18, "resource \"aws_cloudwatch_log_group\" \"ecs_logs\" {\n"], [19, "  name              = \"/ecs/${var.project}-${var.environment}\"\n"], [20, "  retention_in_days = 30\n"], [21, "\n"], [22, "  tags = {\n"], [23, "    Name        = \"${var.project}-${var.environment}-ecs-logs\"\n"], [24, "    Environment = var.environment\n"], [25, "    Project     = var.project\n"], [26, "  }\n"], [27, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [18, 27], "resource": "module.ecs_jenkins_github.module.ecs.aws_cloudwatch_log_group.ecs_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-ecs-logs", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_338", "bc_check_id": "BC_AWS_LOGGING_46", "check_name": "Ensure CloudWatch log groups retains logs for at least 1 year", "check_result": {"result": "FAILED", "evaluated_keys": ["retention_in_days"]}, "code_block": [[18, "resource \"aws_cloudwatch_log_group\" \"ecs_logs\" {\n"], [19, "  name              = \"/ecs/${var.project}-${var.environment}\"\n"], [20, "  retention_in_days = 30\n"], [21, "\n"], [22, "  tags = {\n"], [23, "    Name        = \"${var.project}-${var.environment}-ecs-logs\"\n"], [24, "    Environment = var.environment\n"], [25, "    Project     = var.project\n"], [26, "  }\n"], [27, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [18, 27], "resource": "module.ecs_jenkins_github.module.ecs.aws_cloudwatch_log_group.ecs_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetentionYear", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-ecs-logs", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_131", "bc_check_id": "BC_AWS_NETWORKING_41", "check_name": "Ensure that ALB drops HTTP headers", "check_result": {"result": "FAILED", "evaluated_keys": ["drop_invalid_header_fields"]}, "code_block": [[30, "resource \"aws_lb\" \"alb\" {\n"], [31, "  name               = \"${var.project}-${var.environment}-alb\"\n"], [32, "  internal           = false\n"], [33, "  load_balancer_type = \"application\"\n"], [34, "  security_groups    = [var.alb_security_group]\n"], [35, "  subnets            = var.public_subnets\n"], [36, "\n"], [37, "  enable_deletion_protection = false\n"], [38, "\n"], [39, "  tags = {\n"], [40, "    Name        = \"${var.project}-${var.environment}-alb\"\n"], [41, "    Environment = var.environment\n"], [42, "    Project     = var.project\n"], [43, "  }\n"], [44, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [30, 44], "resource": "module.ecs_jenkins_github.module.ecs.aws_lb.alb", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ALBDropHttpHeaders", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-alb", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-alb-drops-http-headers", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_91", "bc_check_id": "BC_AWS_LOGGING_22", "check_name": "Ensure the ELBv2 (Application/Network) has access logging enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["access_logs/0/enabled/0"]}, "code_block": [[30, "resource \"aws_lb\" \"alb\" {\n"], [31, "  name               = \"${var.project}-${var.environment}-alb\"\n"], [32, "  internal           = false\n"], [33, "  load_balancer_type = \"application\"\n"], [34, "  security_groups    = [var.alb_security_group]\n"], [35, "  subnets            = var.public_subnets\n"], [36, "\n"], [37, "  enable_deletion_protection = false\n"], [38, "\n"], [39, "  tags = {\n"], [40, "    Name        = \"${var.project}-${var.environment}-alb\"\n"], [41, "    Environment = var.environment\n"], [42, "    Project     = var.project\n"], [43, "  }\n"], [44, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [30, 44], "resource": "module.ecs_jenkins_github.module.ecs.aws_lb.alb", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ELBv2AccessLogs", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-alb", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-logging-22", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_150", "bc_check_id": "BC_AWS_NETWORKING_62", "check_name": "Ensure that Load Balancer has deletion protection enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["enable_deletion_protection"]}, "code_block": [[30, "resource \"aws_lb\" \"alb\" {\n"], [31, "  name               = \"${var.project}-${var.environment}-alb\"\n"], [32, "  internal           = false\n"], [33, "  load_balancer_type = \"application\"\n"], [34, "  security_groups    = [var.alb_security_group]\n"], [35, "  subnets            = var.public_subnets\n"], [36, "\n"], [37, "  enable_deletion_protection = false\n"], [38, "\n"], [39, "  tags = {\n"], [40, "    Name        = \"${var.project}-${var.environment}-alb\"\n"], [41, "    Environment = var.environment\n"], [42, "    Project     = var.project\n"], [43, "  }\n"], [44, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [30, 44], "resource": "module.ecs_jenkins_github.module.ecs.aws_lb.alb", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LBDeletionProtection", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-alb", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-150", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_2", "bc_check_id": "BC_AWS_NETWORKING_29", "check_name": "Ensure ALB protocol is HTTPS", "check_result": {"result": "FAILED", "evaluated_keys": ["protocol"]}, "code_block": [[72, "resource \"aws_lb_listener\" \"http\" {\n"], [73, "  load_balancer_arn = aws_lb.alb.arn\n"], [74, "  port              = 80\n"], [75, "  protocol          = \"HTTP\"\n"], [76, "\n"], [77, "  default_action {\n"], [78, "    type             = \"forward\"\n"], [79, "    target_group_arn = aws_lb_target_group.target_group.arn\n"], [80, "  }\n"], [81, "\n"], [82, "  tags = {\n"], [83, "    Name        = \"${var.project}-${var.environment}-http-listener\"\n"], [84, "    Environment = var.environment\n"], [85, "    Project     = var.project\n"], [86, "  }\n"], [87, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [72, 87], "resource": "module.ecs_jenkins_github.module.ecs.aws_lb_listener.http", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ALBListenerHTTPS", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-http-listener", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-29", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_336", "bc_check_id": "BC_AWS_GENERAL_241", "check_name": "Ensure ECS containers are limited to read-only access to root filesystems", "check_result": {"result": "FAILED", "evaluated_keys": ["container_definitions/[0]/[0]/readonlyRootFilesystem"]}, "code_block": [[90, "resource \"aws_ecs_task_definition\" \"task_definition\" {\n"], [91, "  family                   = \"${var.project}-${var.environment}-task\"\n"], [92, "  network_mode             = \"awsvpc\"\n"], [93, "  requires_compatibilities = [\"FARGATE\"]\n"], [94, "  cpu                      = \"256\"\n"], [95, "  memory                   = \"512\"\n"], [96, "  execution_role_arn       = var.ecs_task_execution_role\n"], [97, "  task_role_arn            = var.ecs_task_role\n"], [98, "\n"], [99, "  container_definitions = jsonencode([\n"], [100, "    {\n"], [101, "      name      = \"${var.project}-${var.environment}-container\"\n"], [102, "      image     = \"nginx:latest\" # This is a placeholder image\n"], [103, "      essential = true\n"], [104, "      portMappings = [\n"], [105, "        {\n"], [106, "          containerPort = 80\n"], [107, "          hostPort      = 80\n"], [108, "          protocol      = \"tcp\"\n"], [109, "        }\n"], [110, "      ]\n"], [111, "      logConfiguration = {\n"], [112, "        logDriver = \"awslogs\"\n"], [113, "        options = {\n"], [114, "          \"awslogs-group\"         = aws_cloudwatch_log_group.ecs_logs.name\n"], [115, "          \"awslogs-region\"        = data.aws_region.current.id\n"], [116, "          \"awslogs-stream-prefix\" = \"ecs\"\n"], [117, "        }\n"], [118, "      }\n"], [119, "    }\n"], [120, "  ])\n"], [121, "\n"], [122, "  tags = {\n"], [123, "    Name        = \"${var.project}-${var.environment}-task\"\n"], [124, "    Environment = var.environment\n"], [125, "    Project     = var.project\n"], [126, "  }\n"], [127, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [90, 127], "resource": "module.ecs_jenkins_github.module.ecs.aws_ecs_task_definition.task_definition", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSContainerReadOnlyRoot", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-task", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-336", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_126", "bc_check_id": "BC_AWS_LOGGING_26", "check_name": "Ensure that detailed monitoring is enabled for EC2 instances", "check_result": {"result": "FAILED", "evaluated_keys": ["monitoring"]}, "code_block": [[159, "resource \"aws_instance\" \"jenkins\" {\n"], [160, "  count = var.create_jenkins ? 1 : 0\n"], [161, "\n"], [162, "  ami                    = data.aws_ami.amazon_linux_2.id\n"], [163, "  instance_type          = \"t3.medium\"\n"], [164, "  subnet_id              = var.public_subnets[0]\n"], [165, "  vpc_security_group_ids = [var.jenkins_security_group]\n"], [166, "  key_name               = var.key_name\n"], [167, "\n"], [168, "  user_data = <<-EOF\n"], [169, "    #!/bin/bash\n"], [170, "    sudo yum update -y\n"], [171, "    sudo amazon-linux-extras install java-openjdk11 -y\n"], [172, "    sudo yum install -y jenkins git docker\n"], [173, "    sudo systemctl start jenkins\n"], [174, "    sudo systemctl enable jenkins\n"], [175, "    sudo systemctl start docker\n"], [176, "    sudo systemctl enable docker\n"], [177, "    sudo usermod -aG docker jenkins\n"], [178, "    sudo systemctl restart jenkins\n"], [179, "  EOF\n"], [180, "\n"], [181, "  tags = {\n"], [182, "    Name        = \"${var.project}-${var.environment}-jenkins\"\n"], [183, "    Environment = var.environment\n"], [184, "    Project     = var.project\n"], [185, "  }\n"], [186, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [159, 186], "resource": "module.ecs_jenkins_github.module.ecs.aws_instance.jenkins[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2DetailedMonitoringEnabled", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/ensure-that-detailed-monitoring-is-enabled-for-ec2-instances", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_135", "bc_check_id": "BC_AWS_GENERAL_68", "check_name": "Ensure that EC2 is EBS optimized", "check_result": {"result": "FAILED", "evaluated_keys": ["ebs_optimized"]}, "code_block": [[159, "resource \"aws_instance\" \"jenkins\" {\n"], [160, "  count = var.create_jenkins ? 1 : 0\n"], [161, "\n"], [162, "  ami                    = data.aws_ami.amazon_linux_2.id\n"], [163, "  instance_type          = \"t3.medium\"\n"], [164, "  subnet_id              = var.public_subnets[0]\n"], [165, "  vpc_security_group_ids = [var.jenkins_security_group]\n"], [166, "  key_name               = var.key_name\n"], [167, "\n"], [168, "  user_data = <<-EOF\n"], [169, "    #!/bin/bash\n"], [170, "    sudo yum update -y\n"], [171, "    sudo amazon-linux-extras install java-openjdk11 -y\n"], [172, "    sudo yum install -y jenkins git docker\n"], [173, "    sudo systemctl start jenkins\n"], [174, "    sudo systemctl enable jenkins\n"], [175, "    sudo systemctl start docker\n"], [176, "    sudo systemctl enable docker\n"], [177, "    sudo usermod -aG docker jenkins\n"], [178, "    sudo systemctl restart jenkins\n"], [179, "  EOF\n"], [180, "\n"], [181, "  tags = {\n"], [182, "    Name        = \"${var.project}-${var.environment}-jenkins\"\n"], [183, "    Environment = var.environment\n"], [184, "    Project     = var.project\n"], [185, "  }\n"], [186, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [159, 186], "resource": "module.ecs_jenkins_github.module.ecs.aws_instance.jenkins[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2EBSOptimized", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-ec2-is-ebs-optimized", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_79", "bc_check_id": "BC_AWS_GENERAL_31", "check_name": "Ensure Instance Metadata Service Version 1 is not enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["metadata_options/[0]/http_tokens"]}, "code_block": [[159, "resource \"aws_instance\" \"jenkins\" {\n"], [160, "  count = var.create_jenkins ? 1 : 0\n"], [161, "\n"], [162, "  ami                    = data.aws_ami.amazon_linux_2.id\n"], [163, "  instance_type          = \"t3.medium\"\n"], [164, "  subnet_id              = var.public_subnets[0]\n"], [165, "  vpc_security_group_ids = [var.jenkins_security_group]\n"], [166, "  key_name               = var.key_name\n"], [167, "\n"], [168, "  user_data = <<-EOF\n"], [169, "    #!/bin/bash\n"], [170, "    sudo yum update -y\n"], [171, "    sudo amazon-linux-extras install java-openjdk11 -y\n"], [172, "    sudo yum install -y jenkins git docker\n"], [173, "    sudo systemctl start jenkins\n"], [174, "    sudo systemctl enable jenkins\n"], [175, "    sudo systemctl start docker\n"], [176, "    sudo systemctl enable docker\n"], [177, "    sudo usermod -aG docker jenkins\n"], [178, "    sudo systemctl restart jenkins\n"], [179, "  EOF\n"], [180, "\n"], [181, "  tags = {\n"], [182, "    Name        = \"${var.project}-${var.environment}-jenkins\"\n"], [183, "    Environment = var.environment\n"], [184, "    Project     = var.project\n"], [185, "  }\n"], [186, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [159, 186], "resource": "module.ecs_jenkins_github.module.ecs.aws_instance.jenkins[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IMDSv1Disabled", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-31", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_8", "bc_check_id": "BC_AWS_GENERAL_13", "check_name": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["root_block_device"]}, "code_block": [[159, "resource \"aws_instance\" \"jenkins\" {\n"], [160, "  count = var.create_jenkins ? 1 : 0\n"], [161, "\n"], [162, "  ami                    = data.aws_ami.amazon_linux_2.id\n"], [163, "  instance_type          = \"t3.medium\"\n"], [164, "  subnet_id              = var.public_subnets[0]\n"], [165, "  vpc_security_group_ids = [var.jenkins_security_group]\n"], [166, "  key_name               = var.key_name\n"], [167, "\n"], [168, "  user_data = <<-EOF\n"], [169, "    #!/bin/bash\n"], [170, "    sudo yum update -y\n"], [171, "    sudo amazon-linux-extras install java-openjdk11 -y\n"], [172, "    sudo yum install -y jenkins git docker\n"], [173, "    sudo systemctl start jenkins\n"], [174, "    sudo systemctl enable jenkins\n"], [175, "    sudo systemctl start docker\n"], [176, "    sudo systemctl enable docker\n"], [177, "    sudo usermod -aG docker jenkins\n"], [178, "    sudo systemctl restart jenkins\n"], [179, "  EOF\n"], [180, "\n"], [181, "  tags = {\n"], [182, "    Name        = \"${var.project}-${var.environment}-jenkins\"\n"], [183, "    Environment = var.environment\n"], [184, "    Project     = var.project\n"], [185, "  }\n"], [186, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [159, 186], "resource": "module.ecs_jenkins_github.module.ecs.aws_instance.jenkins[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LaunchConfigurationEBSEncryption", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-13", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[18, "resource \"aws_cloudwatch_log_group\" \"ecs_logs\" {\n"], [19, "  name              = \"/ecs/${var.project}-${var.environment}\"\n"], [20, "  retention_in_days = 30\n"], [21, "\n"], [22, "  tags = {\n"], [23, "    Name        = \"${var.project}-${var.environment}-ecs-logs\"\n"], [24, "    Environment = var.environment\n"], [25, "    Project     = var.project\n"], [26, "  }\n"], [27, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [18, 27], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_cloudwatch_log_group.ecs_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-ecs-logs", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_338", "bc_check_id": "BC_AWS_LOGGING_46", "check_name": "Ensure CloudWatch log groups retains logs for at least 1 year", "check_result": {"result": "FAILED", "evaluated_keys": ["retention_in_days"]}, "code_block": [[18, "resource \"aws_cloudwatch_log_group\" \"ecs_logs\" {\n"], [19, "  name              = \"/ecs/${var.project}-${var.environment}\"\n"], [20, "  retention_in_days = 30\n"], [21, "\n"], [22, "  tags = {\n"], [23, "    Name        = \"${var.project}-${var.environment}-ecs-logs\"\n"], [24, "    Environment = var.environment\n"], [25, "    Project     = var.project\n"], [26, "  }\n"], [27, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [18, 27], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_cloudwatch_log_group.ecs_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetentionYear", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-ecs-logs", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_131", "bc_check_id": "BC_AWS_NETWORKING_41", "check_name": "Ensure that ALB drops HTTP headers", "check_result": {"result": "FAILED", "evaluated_keys": ["drop_invalid_header_fields"]}, "code_block": [[30, "resource \"aws_lb\" \"alb\" {\n"], [31, "  name               = \"${var.project}-${var.environment}-alb\"\n"], [32, "  internal           = false\n"], [33, "  load_balancer_type = \"application\"\n"], [34, "  security_groups    = [var.alb_security_group]\n"], [35, "  subnets            = var.public_subnets\n"], [36, "\n"], [37, "  enable_deletion_protection = false\n"], [38, "\n"], [39, "  tags = {\n"], [40, "    Name        = \"${var.project}-${var.environment}-alb\"\n"], [41, "    Environment = var.environment\n"], [42, "    Project     = var.project\n"], [43, "  }\n"], [44, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [30, 44], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_lb.alb", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ALBDropHttpHeaders", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-alb", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-alb-drops-http-headers", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_91", "bc_check_id": "BC_AWS_LOGGING_22", "check_name": "Ensure the ELBv2 (Application/Network) has access logging enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["access_logs/0/enabled/0"]}, "code_block": [[30, "resource \"aws_lb\" \"alb\" {\n"], [31, "  name               = \"${var.project}-${var.environment}-alb\"\n"], [32, "  internal           = false\n"], [33, "  load_balancer_type = \"application\"\n"], [34, "  security_groups    = [var.alb_security_group]\n"], [35, "  subnets            = var.public_subnets\n"], [36, "\n"], [37, "  enable_deletion_protection = false\n"], [38, "\n"], [39, "  tags = {\n"], [40, "    Name        = \"${var.project}-${var.environment}-alb\"\n"], [41, "    Environment = var.environment\n"], [42, "    Project     = var.project\n"], [43, "  }\n"], [44, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [30, 44], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_lb.alb", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ELBv2AccessLogs", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-alb", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-logging-22", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_150", "bc_check_id": "BC_AWS_NETWORKING_62", "check_name": "Ensure that Load Balancer has deletion protection enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["enable_deletion_protection"]}, "code_block": [[30, "resource \"aws_lb\" \"alb\" {\n"], [31, "  name               = \"${var.project}-${var.environment}-alb\"\n"], [32, "  internal           = false\n"], [33, "  load_balancer_type = \"application\"\n"], [34, "  security_groups    = [var.alb_security_group]\n"], [35, "  subnets            = var.public_subnets\n"], [36, "\n"], [37, "  enable_deletion_protection = false\n"], [38, "\n"], [39, "  tags = {\n"], [40, "    Name        = \"${var.project}-${var.environment}-alb\"\n"], [41, "    Environment = var.environment\n"], [42, "    Project     = var.project\n"], [43, "  }\n"], [44, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [30, 44], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_lb.alb", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LBDeletionProtection", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-alb", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-150", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_2", "bc_check_id": "BC_AWS_NETWORKING_29", "check_name": "Ensure ALB protocol is HTTPS", "check_result": {"result": "FAILED", "evaluated_keys": ["protocol"]}, "code_block": [[72, "resource \"aws_lb_listener\" \"http\" {\n"], [73, "  load_balancer_arn = aws_lb.alb.arn\n"], [74, "  port              = 80\n"], [75, "  protocol          = \"HTTP\"\n"], [76, "\n"], [77, "  default_action {\n"], [78, "    type             = \"forward\"\n"], [79, "    target_group_arn = aws_lb_target_group.target_group.arn\n"], [80, "  }\n"], [81, "\n"], [82, "  tags = {\n"], [83, "    Name        = \"${var.project}-${var.environment}-http-listener\"\n"], [84, "    Environment = var.environment\n"], [85, "    Project     = var.project\n"], [86, "  }\n"], [87, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [72, 87], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_lb_listener.http", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ALBListenerHTTPS", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-http-listener", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-29", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_336", "bc_check_id": "BC_AWS_GENERAL_241", "check_name": "Ensure ECS containers are limited to read-only access to root filesystems", "check_result": {"result": "FAILED", "evaluated_keys": ["container_definitions/[0]/[0]/readonlyRootFilesystem"]}, "code_block": [[90, "resource \"aws_ecs_task_definition\" \"task_definition\" {\n"], [91, "  family                   = \"${var.project}-${var.environment}-task\"\n"], [92, "  network_mode             = \"awsvpc\"\n"], [93, "  requires_compatibilities = [\"FARGATE\"]\n"], [94, "  cpu                      = \"256\"\n"], [95, "  memory                   = \"512\"\n"], [96, "  execution_role_arn       = var.ecs_task_execution_role\n"], [97, "  task_role_arn            = var.ecs_task_role\n"], [98, "\n"], [99, "  container_definitions = jsonencode([\n"], [100, "    {\n"], [101, "      name      = \"${var.project}-${var.environment}-container\"\n"], [102, "      image     = \"nginx:latest\" # This is a placeholder image\n"], [103, "      essential = true\n"], [104, "      portMappings = [\n"], [105, "        {\n"], [106, "          containerPort = 80\n"], [107, "          hostPort      = 80\n"], [108, "          protocol      = \"tcp\"\n"], [109, "        }\n"], [110, "      ]\n"], [111, "      logConfiguration = {\n"], [112, "        logDriver = \"awslogs\"\n"], [113, "        options = {\n"], [114, "          \"awslogs-group\"         = aws_cloudwatch_log_group.ecs_logs.name\n"], [115, "          \"awslogs-region\"        = data.aws_region.current.id\n"], [116, "          \"awslogs-stream-prefix\" = \"ecs\"\n"], [117, "        }\n"], [118, "      }\n"], [119, "    }\n"], [120, "  ])\n"], [121, "\n"], [122, "  tags = {\n"], [123, "    Name        = \"${var.project}-${var.environment}-task\"\n"], [124, "    Environment = var.environment\n"], [125, "    Project     = var.project\n"], [126, "  }\n"], [127, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [90, 127], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_ecs_task_definition.task_definition", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSContainerReadOnlyRoot", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-task", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-336", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_126", "bc_check_id": "BC_AWS_LOGGING_26", "check_name": "Ensure that detailed monitoring is enabled for EC2 instances", "check_result": {"result": "FAILED", "evaluated_keys": ["monitoring"]}, "code_block": [[159, "resource \"aws_instance\" \"jenkins\" {\n"], [160, "  count = var.create_jenkins ? 1 : 0\n"], [161, "\n"], [162, "  ami                    = data.aws_ami.amazon_linux_2.id\n"], [163, "  instance_type          = \"t3.medium\"\n"], [164, "  subnet_id              = var.public_subnets[0]\n"], [165, "  vpc_security_group_ids = [var.jenkins_security_group]\n"], [166, "  key_name               = var.key_name\n"], [167, "\n"], [168, "  user_data = <<-EOF\n"], [169, "    #!/bin/bash\n"], [170, "    sudo yum update -y\n"], [171, "    sudo amazon-linux-extras install java-openjdk11 -y\n"], [172, "    sudo yum install -y jenkins git docker\n"], [173, "    sudo systemctl start jenkins\n"], [174, "    sudo systemctl enable jenkins\n"], [175, "    sudo systemctl start docker\n"], [176, "    sudo systemctl enable docker\n"], [177, "    sudo usermod -aG docker jenkins\n"], [178, "    sudo systemctl restart jenkins\n"], [179, "  EOF\n"], [180, "\n"], [181, "  tags = {\n"], [182, "    Name        = \"${var.project}-${var.environment}-jenkins\"\n"], [183, "    Environment = var.environment\n"], [184, "    Project     = var.project\n"], [185, "  }\n"], [186, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [159, 186], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_instance.jenkins[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2DetailedMonitoringEnabled", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/ensure-that-detailed-monitoring-is-enabled-for-ec2-instances", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_135", "bc_check_id": "BC_AWS_GENERAL_68", "check_name": "Ensure that EC2 is EBS optimized", "check_result": {"result": "FAILED", "evaluated_keys": ["ebs_optimized"]}, "code_block": [[159, "resource \"aws_instance\" \"jenkins\" {\n"], [160, "  count = var.create_jenkins ? 1 : 0\n"], [161, "\n"], [162, "  ami                    = data.aws_ami.amazon_linux_2.id\n"], [163, "  instance_type          = \"t3.medium\"\n"], [164, "  subnet_id              = var.public_subnets[0]\n"], [165, "  vpc_security_group_ids = [var.jenkins_security_group]\n"], [166, "  key_name               = var.key_name\n"], [167, "\n"], [168, "  user_data = <<-EOF\n"], [169, "    #!/bin/bash\n"], [170, "    sudo yum update -y\n"], [171, "    sudo amazon-linux-extras install java-openjdk11 -y\n"], [172, "    sudo yum install -y jenkins git docker\n"], [173, "    sudo systemctl start jenkins\n"], [174, "    sudo systemctl enable jenkins\n"], [175, "    sudo systemctl start docker\n"], [176, "    sudo systemctl enable docker\n"], [177, "    sudo usermod -aG docker jenkins\n"], [178, "    sudo systemctl restart jenkins\n"], [179, "  EOF\n"], [180, "\n"], [181, "  tags = {\n"], [182, "    Name        = \"${var.project}-${var.environment}-jenkins\"\n"], [183, "    Environment = var.environment\n"], [184, "    Project     = var.project\n"], [185, "  }\n"], [186, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [159, 186], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_instance.jenkins[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2EBSOptimized", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-ec2-is-ebs-optimized", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_79", "bc_check_id": "BC_AWS_GENERAL_31", "check_name": "Ensure Instance Metadata Service Version 1 is not enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["metadata_options/[0]/http_tokens"]}, "code_block": [[159, "resource \"aws_instance\" \"jenkins\" {\n"], [160, "  count = var.create_jenkins ? 1 : 0\n"], [161, "\n"], [162, "  ami                    = data.aws_ami.amazon_linux_2.id\n"], [163, "  instance_type          = \"t3.medium\"\n"], [164, "  subnet_id              = var.public_subnets[0]\n"], [165, "  vpc_security_group_ids = [var.jenkins_security_group]\n"], [166, "  key_name               = var.key_name\n"], [167, "\n"], [168, "  user_data = <<-EOF\n"], [169, "    #!/bin/bash\n"], [170, "    sudo yum update -y\n"], [171, "    sudo amazon-linux-extras install java-openjdk11 -y\n"], [172, "    sudo yum install -y jenkins git docker\n"], [173, "    sudo systemctl start jenkins\n"], [174, "    sudo systemctl enable jenkins\n"], [175, "    sudo systemctl start docker\n"], [176, "    sudo systemctl enable docker\n"], [177, "    sudo usermod -aG docker jenkins\n"], [178, "    sudo systemctl restart jenkins\n"], [179, "  EOF\n"], [180, "\n"], [181, "  tags = {\n"], [182, "    Name        = \"${var.project}-${var.environment}-jenkins\"\n"], [183, "    Environment = var.environment\n"], [184, "    Project     = var.project\n"], [185, "  }\n"], [186, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [159, 186], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_instance.jenkins[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IMDSv1Disabled", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-31", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_8", "bc_check_id": "BC_AWS_GENERAL_13", "check_name": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["root_block_device"]}, "code_block": [[159, "resource \"aws_instance\" \"jenkins\" {\n"], [160, "  count = var.create_jenkins ? 1 : 0\n"], [161, "\n"], [162, "  ami                    = data.aws_ami.amazon_linux_2.id\n"], [163, "  instance_type          = \"t3.medium\"\n"], [164, "  subnet_id              = var.public_subnets[0]\n"], [165, "  vpc_security_group_ids = [var.jenkins_security_group]\n"], [166, "  key_name               = var.key_name\n"], [167, "\n"], [168, "  user_data = <<-EOF\n"], [169, "    #!/bin/bash\n"], [170, "    sudo yum update -y\n"], [171, "    sudo amazon-linux-extras install java-openjdk11 -y\n"], [172, "    sudo yum install -y jenkins git docker\n"], [173, "    sudo systemctl start jenkins\n"], [174, "    sudo systemctl enable jenkins\n"], [175, "    sudo systemctl start docker\n"], [176, "    sudo systemctl enable docker\n"], [177, "    sudo usermod -aG docker jenkins\n"], [178, "    sudo systemctl restart jenkins\n"], [179, "  EOF\n"], [180, "\n"], [181, "  tags = {\n"], [182, "    Name        = \"${var.project}-${var.environment}-jenkins\"\n"], [183, "    Environment = var.environment\n"], [184, "    Project     = var.project\n"], [185, "  }\n"], [186, "}\n"]], "file_path": "\\modules\\ecs\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [159, 186], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_instance.jenkins[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LaunchConfigurationEBSEncryption", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [49, 65], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-13", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_289", "bc_check_id": "BC_AWS_IAM_84", "check_name": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "check_result": {"result": "FAILED", "evaluated_keys": ["policy/Statement/[1]/Action"]}, "code_block": [[82, "resource \"aws_iam_policy\" \"jenkins_ecs_policy\" {\n"], [83, "  name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [84, "  description = \"Policy to allow Jenkins to deploy to ECS\"\n"], [85, "\n"], [86, "  policy = jsonencode({\n"], [87, "    Version = \"2012-10-17\",\n"], [88, "    Statement = [\n"], [89, "      {\n"], [90, "        Action = [\n"], [91, "          \"ecs:DescribeTaskDefinition\",\n"], [92, "          \"ecs:RegisterTaskDefinition\",\n"], [93, "          \"ecs:UpdateService\",\n"], [94, "          \"ecs:DescribeServices\",\n"], [95, "          \"ecr:GetAuthorizationToken\",\n"], [96, "          \"ecr:BatchCheckLayerAvailability\",\n"], [97, "          \"ecr:GetDownloadUrlForLayer\",\n"], [98, "          \"ecr:BatchGetImage\",\n"], [99, "          \"ecr:InitiateLayerUpload\",\n"], [100, "          \"ecr:UploadLayerPart\",\n"], [101, "          \"ecr:CompleteLayerUpload\",\n"], [102, "          \"ecr:PutImage\"\n"], [103, "        ],\n"], [104, "        Effect   = \"Allow\",\n"], [105, "        Resource = \"*\"\n"], [106, "      },\n"], [107, "      {\n"], [108, "        Action = [\n"], [109, "          \"iam:PassRole\"\n"], [110, "        ],\n"], [111, "        Effect   = \"Allow\",\n"], [112, "        Resource = \"*\"\n"], [113, "      }\n"], [114, "    ]\n"], [115, "  })\n"], [116, "\n"], [117, "  tags = {\n"], [118, "    Name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [119, "    Environment = var.environment\n"], [120, "    Project     = var.project\n"], [121, "  }\n"], [122, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [82, 122], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_policy.jenkins_ecs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-ecs-policy", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-289", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_355", "bc_check_id": "BC_AWS_IAM_88", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "check_result": {"result": "FAILED", "evaluated_keys": ["policy/Statement/[0]/Action"]}, "code_block": [[82, "resource \"aws_iam_policy\" \"jenkins_ecs_policy\" {\n"], [83, "  name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [84, "  description = \"Policy to allow Jenkins to deploy to ECS\"\n"], [85, "\n"], [86, "  policy = jsonencode({\n"], [87, "    Version = \"2012-10-17\",\n"], [88, "    Statement = [\n"], [89, "      {\n"], [90, "        Action = [\n"], [91, "          \"ecs:DescribeTaskDefinition\",\n"], [92, "          \"ecs:RegisterTaskDefinition\",\n"], [93, "          \"ecs:UpdateService\",\n"], [94, "          \"ecs:DescribeServices\",\n"], [95, "          \"ecr:GetAuthorizationToken\",\n"], [96, "          \"ecr:BatchCheckLayerAvailability\",\n"], [97, "          \"ecr:GetDownloadUrlForLayer\",\n"], [98, "          \"ecr:BatchGetImage\",\n"], [99, "          \"ecr:InitiateLayerUpload\",\n"], [100, "          \"ecr:UploadLayerPart\",\n"], [101, "          \"ecr:CompleteLayerUpload\",\n"], [102, "          \"ecr:PutImage\"\n"], [103, "        ],\n"], [104, "        Effect   = \"Allow\",\n"], [105, "        Resource = \"*\"\n"], [106, "      },\n"], [107, "      {\n"], [108, "        Action = [\n"], [109, "          \"iam:PassRole\"\n"], [110, "        ],\n"], [111, "        Effect   = \"Allow\",\n"], [112, "        Resource = \"*\"\n"], [113, "      }\n"], [114, "    ]\n"], [115, "  })\n"], [116, "\n"], [117, "  tags = {\n"], [118, "    Name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [119, "    Environment = var.environment\n"], [120, "    Project     = var.project\n"], [121, "  }\n"], [122, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [82, 122], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_policy.jenkins_ecs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarResourcePolicyDocument", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-ecs-policy", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-355", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_290", "bc_check_id": "BC_AWS_IAM_85", "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "FAILED", "evaluated_keys": ["policy/Statement/[0]/Action"]}, "code_block": [[82, "resource \"aws_iam_policy\" \"jenkins_ecs_policy\" {\n"], [83, "  name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [84, "  description = \"Policy to allow Jenkins to deploy to ECS\"\n"], [85, "\n"], [86, "  policy = jsonencode({\n"], [87, "    Version = \"2012-10-17\",\n"], [88, "    Statement = [\n"], [89, "      {\n"], [90, "        Action = [\n"], [91, "          \"ecs:DescribeTaskDefinition\",\n"], [92, "          \"ecs:RegisterTaskDefinition\",\n"], [93, "          \"ecs:UpdateService\",\n"], [94, "          \"ecs:DescribeServices\",\n"], [95, "          \"ecr:GetAuthorizationToken\",\n"], [96, "          \"ecr:BatchCheckLayerAvailability\",\n"], [97, "          \"ecr:GetDownloadUrlForLayer\",\n"], [98, "          \"ecr:BatchGetImage\",\n"], [99, "          \"ecr:InitiateLayerUpload\",\n"], [100, "          \"ecr:UploadLayerPart\",\n"], [101, "          \"ecr:CompleteLayerUpload\",\n"], [102, "          \"ecr:PutImage\"\n"], [103, "        ],\n"], [104, "        Effect   = \"Allow\",\n"], [105, "        Resource = \"*\"\n"], [106, "      },\n"], [107, "      {\n"], [108, "        Action = [\n"], [109, "          \"iam:PassRole\"\n"], [110, "        ],\n"], [111, "        Effect   = \"Allow\",\n"], [112, "        Resource = \"*\"\n"], [113, "      }\n"], [114, "    ]\n"], [115, "  })\n"], [116, "\n"], [117, "  tags = {\n"], [118, "    Name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [119, "    Environment = var.environment\n"], [120, "    Project     = var.project\n"], [121, "  }\n"], [122, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [82, 122], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_policy.jenkins_ecs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-ecs-policy", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-290", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_355", "bc_check_id": "BC_AWS_IAM_88", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "check_result": {"result": "FAILED", "evaluated_keys": ["policy/Statement/[0]/Action"]}, "code_block": [[128, "resource \"aws_iam_policy\" \"prometheus_discovery\" {\n"], [129, "  name        = \"prometheus-discovery\"\n"], [130, "  description = \"Allow Prometheus to discover EC2 and ECS targets\"\n"], [131, "\n"], [132, "  policy = jsonencode({\n"], [133, "    Version = \"2012-10-17\"\n"], [134, "    Statement = [\n"], [135, "      {\n"], [136, "        Action = [\n"], [137, "          \"ec2:DescribeInstances\",\n"], [138, "          \"ec2:DescribeTags\",\n"], [139, "          \"ecs:ListTasks\",\n"], [140, "          \"ecs:DescribeTasks\",\n"], [141, "          \"ecs:ListServices\",\n"], [142, "          \"ecs:DescribeServices\",\n"], [143, "          \"ecs:DescribeTaskDefinition\"\n"], [144, "        ]\n"], [145, "        Effect   = \"Allow\"\n"], [146, "        Resource = \"*\"\n"], [147, "      }\n"], [148, "    ]\n"], [149, "  })\n"], [150, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [128, 150], "resource": "module.ecs_jenkins_github.module.iam.aws_iam_policy.prometheus_discovery", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarResourcePolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-355", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_289", "bc_check_id": "BC_AWS_IAM_84", "check_name": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "check_result": {"result": "FAILED", "evaluated_keys": ["policy/Statement/[1]/Action"]}, "code_block": [[82, "resource \"aws_iam_policy\" \"jenkins_ecs_policy\" {\n"], [83, "  name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [84, "  description = \"Policy to allow Jenkins to deploy to ECS\"\n"], [85, "\n"], [86, "  policy = jsonencode({\n"], [87, "    Version = \"2012-10-17\",\n"], [88, "    Statement = [\n"], [89, "      {\n"], [90, "        Action = [\n"], [91, "          \"ecs:DescribeTaskDefinition\",\n"], [92, "          \"ecs:RegisterTaskDefinition\",\n"], [93, "          \"ecs:UpdateService\",\n"], [94, "          \"ecs:DescribeServices\",\n"], [95, "          \"ecr:GetAuthorizationToken\",\n"], [96, "          \"ecr:BatchCheckLayerAvailability\",\n"], [97, "          \"ecr:GetDownloadUrlForLayer\",\n"], [98, "          \"ecr:BatchGetImage\",\n"], [99, "          \"ecr:InitiateLayerUpload\",\n"], [100, "          \"ecr:UploadLayerPart\",\n"], [101, "          \"ecr:CompleteLayerUpload\",\n"], [102, "          \"ecr:PutImage\"\n"], [103, "        ],\n"], [104, "        Effect   = \"Allow\",\n"], [105, "        Resource = \"*\"\n"], [106, "      },\n"], [107, "      {\n"], [108, "        Action = [\n"], [109, "          \"iam:PassRole\"\n"], [110, "        ],\n"], [111, "        Effect   = \"Allow\",\n"], [112, "        Resource = \"*\"\n"], [113, "      }\n"], [114, "    ]\n"], [115, "  })\n"], [116, "\n"], [117, "  tags = {\n"], [118, "    Name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [119, "    Environment = var.environment\n"], [120, "    Project     = var.project\n"], [121, "  }\n"], [122, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [82, 122], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_policy.jenkins_ecs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-ecs-policy", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-289", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_355", "bc_check_id": "BC_AWS_IAM_88", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "check_result": {"result": "FAILED", "evaluated_keys": ["policy/Statement/[0]/Action"]}, "code_block": [[82, "resource \"aws_iam_policy\" \"jenkins_ecs_policy\" {\n"], [83, "  name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [84, "  description = \"Policy to allow Jenkins to deploy to ECS\"\n"], [85, "\n"], [86, "  policy = jsonencode({\n"], [87, "    Version = \"2012-10-17\",\n"], [88, "    Statement = [\n"], [89, "      {\n"], [90, "        Action = [\n"], [91, "          \"ecs:DescribeTaskDefinition\",\n"], [92, "          \"ecs:RegisterTaskDefinition\",\n"], [93, "          \"ecs:UpdateService\",\n"], [94, "          \"ecs:DescribeServices\",\n"], [95, "          \"ecr:GetAuthorizationToken\",\n"], [96, "          \"ecr:BatchCheckLayerAvailability\",\n"], [97, "          \"ecr:GetDownloadUrlForLayer\",\n"], [98, "          \"ecr:BatchGetImage\",\n"], [99, "          \"ecr:InitiateLayerUpload\",\n"], [100, "          \"ecr:UploadLayerPart\",\n"], [101, "          \"ecr:CompleteLayerUpload\",\n"], [102, "          \"ecr:PutImage\"\n"], [103, "        ],\n"], [104, "        Effect   = \"Allow\",\n"], [105, "        Resource = \"*\"\n"], [106, "      },\n"], [107, "      {\n"], [108, "        Action = [\n"], [109, "          \"iam:PassRole\"\n"], [110, "        ],\n"], [111, "        Effect   = \"Allow\",\n"], [112, "        Resource = \"*\"\n"], [113, "      }\n"], [114, "    ]\n"], [115, "  })\n"], [116, "\n"], [117, "  tags = {\n"], [118, "    Name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [119, "    Environment = var.environment\n"], [120, "    Project     = var.project\n"], [121, "  }\n"], [122, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [82, 122], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_policy.jenkins_ecs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarResourcePolicyDocument", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-ecs-policy", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-355", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_290", "bc_check_id": "BC_AWS_IAM_85", "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "FAILED", "evaluated_keys": ["policy/Statement/[0]/Action"]}, "code_block": [[82, "resource \"aws_iam_policy\" \"jenkins_ecs_policy\" {\n"], [83, "  name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [84, "  description = \"Policy to allow Jenkins to deploy to ECS\"\n"], [85, "\n"], [86, "  policy = jsonencode({\n"], [87, "    Version = \"2012-10-17\",\n"], [88, "    Statement = [\n"], [89, "      {\n"], [90, "        Action = [\n"], [91, "          \"ecs:DescribeTaskDefinition\",\n"], [92, "          \"ecs:RegisterTaskDefinition\",\n"], [93, "          \"ecs:UpdateService\",\n"], [94, "          \"ecs:DescribeServices\",\n"], [95, "          \"ecr:GetAuthorizationToken\",\n"], [96, "          \"ecr:BatchCheckLayerAvailability\",\n"], [97, "          \"ecr:GetDownloadUrlForLayer\",\n"], [98, "          \"ecr:BatchGetImage\",\n"], [99, "          \"ecr:InitiateLayerUpload\",\n"], [100, "          \"ecr:UploadLayerPart\",\n"], [101, "          \"ecr:CompleteLayerUpload\",\n"], [102, "          \"ecr:PutImage\"\n"], [103, "        ],\n"], [104, "        Effect   = \"Allow\",\n"], [105, "        Resource = \"*\"\n"], [106, "      },\n"], [107, "      {\n"], [108, "        Action = [\n"], [109, "          \"iam:PassRole\"\n"], [110, "        ],\n"], [111, "        Effect   = \"Allow\",\n"], [112, "        Resource = \"*\"\n"], [113, "      }\n"], [114, "    ]\n"], [115, "  })\n"], [116, "\n"], [117, "  tags = {\n"], [118, "    Name        = \"${var.project}-${var.environment}-jenkins-ecs-policy\"\n"], [119, "    Environment = var.environment\n"], [120, "    Project     = var.project\n"], [121, "  }\n"], [122, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [82, 122], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_policy.jenkins_ecs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-ecs-policy", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-290", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_355", "bc_check_id": "BC_AWS_IAM_88", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "check_result": {"result": "FAILED", "evaluated_keys": ["policy/Statement/[0]/Action"]}, "code_block": [[128, "resource \"aws_iam_policy\" \"prometheus_discovery\" {\n"], [129, "  name        = \"prometheus-discovery\"\n"], [130, "  description = \"Allow Prometheus to discover EC2 and ECS targets\"\n"], [131, "\n"], [132, "  policy = jsonencode({\n"], [133, "    Version = \"2012-10-17\"\n"], [134, "    Statement = [\n"], [135, "      {\n"], [136, "        Action = [\n"], [137, "          \"ec2:DescribeInstances\",\n"], [138, "          \"ec2:DescribeTags\",\n"], [139, "          \"ecs:ListTasks\",\n"], [140, "          \"ecs:DescribeTasks\",\n"], [141, "          \"ecs:ListServices\",\n"], [142, "          \"ecs:DescribeServices\",\n"], [143, "          \"ecs:DescribeTaskDefinition\"\n"], [144, "        ]\n"], [145, "        Effect   = \"Allow\"\n"], [146, "        Resource = \"*\"\n"], [147, "      }\n"], [148, "    ]\n"], [149, "  })\n"], [150, "}\n"]], "file_path": "\\modules\\iam\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf", "repo_file_path": "/modules/iam/main.tf", "file_line_range": [128, 150], "resource": "module.ecs_jenkins_github_dr.module.iam.aws_iam_policy.prometheus_discovery", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarResourcePolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [29, 34], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-355", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\iam\\main.tf"}, {"check_id": "CKV_AWS_355", "bc_check_id": "BC_AWS_IAM_88", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "check_result": {"result": "FAILED", "evaluated_keys": ["policy/Statement/[1]/Action"]}, "code_block": [[190, "resource \"aws_iam_policy\" \"lambda_policy\" {\n"], [191, "  name        = \"${var.project}-${var.environment}-lambda-policy\"\n"], [192, "  description = \"Policy to allow Lambda functions to perform failover operations\"\n"], [193, "\n"], [194, "  policy = jsonencode({\n"], [195, "    Version = \"2012-10-17\"\n"], [196, "    Statement = [\n"], [197, "      {\n"], [198, "        Action = [\n"], [199, "          \"logs:CreateLogGroup\",\n"], [200, "          \"logs:CreateLogStream\",\n"], [201, "          \"logs:PutLogEvents\"\n"], [202, "        ]\n"], [203, "        Effect   = \"Allow\"\n"], [204, "        Resource = \"arn:aws:logs:*:*:*\"\n"], [205, "      },\n"], [206, "      {\n"], [207, "        Action = [\n"], [208, "          \"route53:GetHealthCheck\",\n"], [209, "          \"route53:UpdateHealthCheck\"\n"], [210, "        ]\n"], [211, "        Effect   = \"Allow\"\n"], [212, "        Resource = \"*\"\n"], [213, "      },\n"], [214, "      {\n"], [215, "        Action = [\n"], [216, "          \"autoscaling:DescribeAutoScalingGroups\",\n"], [217, "          \"autoscaling:UpdateAutoScalingGroup\"\n"], [218, "        ]\n"], [219, "        Effect   = \"Allow\"\n"], [220, "        Resource = \"*\"\n"], [221, "      },\n"], [222, "      {\n"], [223, "        Action = [\n"], [224, "          \"sns:Publish\"\n"], [225, "        ]\n"], [226, "        Effect   = \"Allow\"\n"], [227, "        Resource = var.sns_topic_arn\n"], [228, "      }\n"], [229, "    ]\n"], [230, "  })\n"], [231, "}\n"]], "file_path": "\\modules\\lambda\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [190, 231], "resource": "module.lambda_failover.aws_iam_policy.lambda_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarResourcePolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\modules\\multi-region\\main.tf", "caller_file_line_range": [66, 79], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-355", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_290", "bc_check_id": "BC_AWS_IAM_85", "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "FAILED", "evaluated_keys": ["policy/Statement/[1]/Action"]}, "code_block": [[190, "resource \"aws_iam_policy\" \"lambda_policy\" {\n"], [191, "  name        = \"${var.project}-${var.environment}-lambda-policy\"\n"], [192, "  description = \"Policy to allow Lambda functions to perform failover operations\"\n"], [193, "\n"], [194, "  policy = jsonencode({\n"], [195, "    Version = \"2012-10-17\"\n"], [196, "    Statement = [\n"], [197, "      {\n"], [198, "        Action = [\n"], [199, "          \"logs:CreateLogGroup\",\n"], [200, "          \"logs:CreateLogStream\",\n"], [201, "          \"logs:PutLogEvents\"\n"], [202, "        ]\n"], [203, "        Effect   = \"Allow\"\n"], [204, "        Resource = \"arn:aws:logs:*:*:*\"\n"], [205, "      },\n"], [206, "      {\n"], [207, "        Action = [\n"], [208, "          \"route53:GetHealthCheck\",\n"], [209, "          \"route53:UpdateHealthCheck\"\n"], [210, "        ]\n"], [211, "        Effect   = \"Allow\"\n"], [212, "        Resource = \"*\"\n"], [213, "      },\n"], [214, "      {\n"], [215, "        Action = [\n"], [216, "          \"autoscaling:DescribeAutoScalingGroups\",\n"], [217, "          \"autoscaling:UpdateAutoScalingGroup\"\n"], [218, "        ]\n"], [219, "        Effect   = \"Allow\"\n"], [220, "        Resource = \"*\"\n"], [221, "      },\n"], [222, "      {\n"], [223, "        Action = [\n"], [224, "          \"sns:Publish\"\n"], [225, "        ]\n"], [226, "        Effect   = \"Allow\"\n"], [227, "        Resource = var.sns_topic_arn\n"], [228, "      }\n"], [229, "    ]\n"], [230, "  })\n"], [231, "}\n"]], "file_path": "\\modules\\lambda\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [190, 231], "resource": "module.lambda_failover.aws_iam_policy.lambda_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\modules\\multi-region\\main.tf", "caller_file_line_range": [66, 79], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-290", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_363", "bc_check_id": "BC_AWS_GENERAL_259", "check_name": "Ensure Lambda Runtime is not deprecated", "check_result": {"result": "FAILED", "evaluated_keys": ["runtime"]}, "code_block": [[240, "resource \"aws_lambda_function\" \"failover_lambda\" {\n"], [241, "  function_name = \"${var.project}-${var.environment}-failover-test\"\n"], [242, "  description   = \"Lambda function to test and manage failover between primary and DR regions\"\n"], [243, "  role          = aws_iam_role.lambda_role.arn\n"], [244, "  handler       = \"lambda_function.lambda_handler\"\n"], [245, "  runtime       = \"python3.9\"\n"], [246, "  timeout       = 900 # 15 minutes\n"], [247, "  memory_size   = 128\n"], [248, "\n"], [249, "  s3_bucket = aws_s3_bucket.lambda_code.id\n"], [250, "  s3_key    = aws_s3_object.lambda_code.key\n"], [251, "\n"], [252, "  environment {\n"], [253, "    variables = {\n"], [254, "      PRIMARY_HEALTH_CHECK_ID = var.primary_health_check_id\n"], [255, "      DR_HEALTH_CHECK_ID      = var.dr_health_check_id\n"], [256, "      PRIMARY_ASG_NAME        = var.primary_asg_name\n"], [257, "      DR_ASG_NAME             = var.dr_asg_name\n"], [258, "      PRIMARY_REGION          = var.primary_region\n"], [259, "      DR_REGION               = var.dr_region\n"], [260, "      SNS_TOPIC_ARN           = var.sns_topic_arn\n"], [261, "      FAILOVER_MODE           = \"test\" # Default mode\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "  tags = {\n"], [266, "    Name        = \"${var.project}-${var.environment}-failover-lambda\"\n"], [267, "    Environment = var.environment\n"], [268, "    Project     = var.project\n"], [269, "  }\n"], [270, "}\n"]], "file_path": "\\modules\\lambda\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [240, 270], "resource": "module.lambda_failover.aws_lambda_function.failover_lambda", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.DeprecatedLambdaRuntime", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Name": "${var.project}-${var.environment}-failover-lambda", "Project": "var.project"}, "caller_file_path": "\\modules\\multi-region\\main.tf", "caller_file_line_range": [66, 79], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-363", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_272", "bc_check_id": "BC_AWS_General_201", "check_name": "Ensure AWS Lambda function is configured to validate code-signing", "check_result": {"result": "FAILED", "evaluated_keys": ["code_signing_config_arn"]}, "code_block": [[240, "resource \"aws_lambda_function\" \"failover_lambda\" {\n"], [241, "  function_name = \"${var.project}-${var.environment}-failover-test\"\n"], [242, "  description   = \"Lambda function to test and manage failover between primary and DR regions\"\n"], [243, "  role          = aws_iam_role.lambda_role.arn\n"], [244, "  handler       = \"lambda_function.lambda_handler\"\n"], [245, "  runtime       = \"python3.9\"\n"], [246, "  timeout       = 900 # 15 minutes\n"], [247, "  memory_size   = 128\n"], [248, "\n"], [249, "  s3_bucket = aws_s3_bucket.lambda_code.id\n"], [250, "  s3_key    = aws_s3_object.lambda_code.key\n"], [251, "\n"], [252, "  environment {\n"], [253, "    variables = {\n"], [254, "      PRIMARY_HEALTH_CHECK_ID = var.primary_health_check_id\n"], [255, "      DR_HEALTH_CHECK_ID      = var.dr_health_check_id\n"], [256, "      PRIMARY_ASG_NAME        = var.primary_asg_name\n"], [257, "      DR_ASG_NAME             = var.dr_asg_name\n"], [258, "      PRIMARY_REGION          = var.primary_region\n"], [259, "      DR_REGION               = var.dr_region\n"], [260, "      SNS_TOPIC_ARN           = var.sns_topic_arn\n"], [261, "      FAILOVER_MODE           = \"test\" # Default mode\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "  tags = {\n"], [266, "    Name        = \"${var.project}-${var.environment}-failover-lambda\"\n"], [267, "    Environment = var.environment\n"], [268, "    Project     = var.project\n"], [269, "  }\n"], [270, "}\n"]], "file_path": "\\modules\\lambda\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [240, 270], "resource": "module.lambda_failover.aws_lambda_function.failover_lambda", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaCodeSigningConfigured", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Name": "${var.project}-${var.environment}-failover-lambda", "Project": "var.project"}, "caller_file_path": "\\modules\\multi-region\\main.tf", "caller_file_line_range": [66, 79], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-272", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["dead_letter_config/[0]/target_arn"]}, "code_block": [[240, "resource \"aws_lambda_function\" \"failover_lambda\" {\n"], [241, "  function_name = \"${var.project}-${var.environment}-failover-test\"\n"], [242, "  description   = \"Lambda function to test and manage failover between primary and DR regions\"\n"], [243, "  role          = aws_iam_role.lambda_role.arn\n"], [244, "  handler       = \"lambda_function.lambda_handler\"\n"], [245, "  runtime       = \"python3.9\"\n"], [246, "  timeout       = 900 # 15 minutes\n"], [247, "  memory_size   = 128\n"], [248, "\n"], [249, "  s3_bucket = aws_s3_bucket.lambda_code.id\n"], [250, "  s3_key    = aws_s3_object.lambda_code.key\n"], [251, "\n"], [252, "  environment {\n"], [253, "    variables = {\n"], [254, "      PRIMARY_HEALTH_CHECK_ID = var.primary_health_check_id\n"], [255, "      DR_HEALTH_CHECK_ID      = var.dr_health_check_id\n"], [256, "      PRIMARY_ASG_NAME        = var.primary_asg_name\n"], [257, "      DR_ASG_NAME             = var.dr_asg_name\n"], [258, "      PRIMARY_REGION          = var.primary_region\n"], [259, "      DR_REGION               = var.dr_region\n"], [260, "      SNS_TOPIC_ARN           = var.sns_topic_arn\n"], [261, "      FAILOVER_MODE           = \"test\" # Default mode\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "  tags = {\n"], [266, "    Name        = \"${var.project}-${var.environment}-failover-lambda\"\n"], [267, "    Environment = var.environment\n"], [268, "    Project     = var.project\n"], [269, "  }\n"], [270, "}\n"]], "file_path": "\\modules\\lambda\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [240, 270], "resource": "module.lambda_failover.aws_lambda_function.failover_lambda", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Name": "${var.project}-${var.environment}-failover-lambda", "Project": "var.project"}, "caller_file_path": "\\modules\\multi-region\\main.tf", "caller_file_line_range": [66, 79], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environmental variable", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_arn"]}, "code_block": [[240, "resource \"aws_lambda_function\" \"failover_lambda\" {\n"], [241, "  function_name = \"${var.project}-${var.environment}-failover-test\"\n"], [242, "  description   = \"Lambda function to test and manage failover between primary and DR regions\"\n"], [243, "  role          = aws_iam_role.lambda_role.arn\n"], [244, "  handler       = \"lambda_function.lambda_handler\"\n"], [245, "  runtime       = \"python3.9\"\n"], [246, "  timeout       = 900 # 15 minutes\n"], [247, "  memory_size   = 128\n"], [248, "\n"], [249, "  s3_bucket = aws_s3_bucket.lambda_code.id\n"], [250, "  s3_key    = aws_s3_object.lambda_code.key\n"], [251, "\n"], [252, "  environment {\n"], [253, "    variables = {\n"], [254, "      PRIMARY_HEALTH_CHECK_ID = var.primary_health_check_id\n"], [255, "      DR_HEALTH_CHECK_ID      = var.dr_health_check_id\n"], [256, "      PRIMARY_ASG_NAME        = var.primary_asg_name\n"], [257, "      DR_ASG_NAME             = var.dr_asg_name\n"], [258, "      PRIMARY_REGION          = var.primary_region\n"], [259, "      DR_REGION               = var.dr_region\n"], [260, "      SNS_TOPIC_ARN           = var.sns_topic_arn\n"], [261, "      FAILOVER_MODE           = \"test\" # Default mode\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "  tags = {\n"], [266, "    Name        = \"${var.project}-${var.environment}-failover-lambda\"\n"], [267, "    Environment = var.environment\n"], [268, "    Project     = var.project\n"], [269, "  }\n"], [270, "}\n"]], "file_path": "\\modules\\lambda\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [240, 270], "resource": "module.lambda_failover.aws_lambda_function.failover_lambda", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Name": "${var.project}-${var.environment}-failover-lambda", "Project": "var.project"}, "caller_file_path": "\\modules\\multi-region\\main.tf", "caller_file_line_range": [66, 79], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["reserved_concurrent_executions/[0]"]}, "code_block": [[240, "resource \"aws_lambda_function\" \"failover_lambda\" {\n"], [241, "  function_name = \"${var.project}-${var.environment}-failover-test\"\n"], [242, "  description   = \"Lambda function to test and manage failover between primary and DR regions\"\n"], [243, "  role          = aws_iam_role.lambda_role.arn\n"], [244, "  handler       = \"lambda_function.lambda_handler\"\n"], [245, "  runtime       = \"python3.9\"\n"], [246, "  timeout       = 900 # 15 minutes\n"], [247, "  memory_size   = 128\n"], [248, "\n"], [249, "  s3_bucket = aws_s3_bucket.lambda_code.id\n"], [250, "  s3_key    = aws_s3_object.lambda_code.key\n"], [251, "\n"], [252, "  environment {\n"], [253, "    variables = {\n"], [254, "      PRIMARY_HEALTH_CHECK_ID = var.primary_health_check_id\n"], [255, "      DR_HEALTH_CHECK_ID      = var.dr_health_check_id\n"], [256, "      PRIMARY_ASG_NAME        = var.primary_asg_name\n"], [257, "      DR_ASG_NAME             = var.dr_asg_name\n"], [258, "      PRIMARY_REGION          = var.primary_region\n"], [259, "      DR_REGION               = var.dr_region\n"], [260, "      SNS_TOPIC_ARN           = var.sns_topic_arn\n"], [261, "      FAILOVER_MODE           = \"test\" # Default mode\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "  tags = {\n"], [266, "    Name        = \"${var.project}-${var.environment}-failover-lambda\"\n"], [267, "    Environment = var.environment\n"], [268, "    Project     = var.project\n"], [269, "  }\n"], [270, "}\n"]], "file_path": "\\modules\\lambda\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [240, 270], "resource": "module.lambda_failover.aws_lambda_function.failover_lambda", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Name": "${var.project}-${var.environment}-failover-lambda", "Project": "var.project"}, "caller_file_path": "\\modules\\multi-region\\main.tf", "caller_file_line_range": [66, 79], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["vpc_config"]}, "code_block": [[240, "resource \"aws_lambda_function\" \"failover_lambda\" {\n"], [241, "  function_name = \"${var.project}-${var.environment}-failover-test\"\n"], [242, "  description   = \"Lambda function to test and manage failover between primary and DR regions\"\n"], [243, "  role          = aws_iam_role.lambda_role.arn\n"], [244, "  handler       = \"lambda_function.lambda_handler\"\n"], [245, "  runtime       = \"python3.9\"\n"], [246, "  timeout       = 900 # 15 minutes\n"], [247, "  memory_size   = 128\n"], [248, "\n"], [249, "  s3_bucket = aws_s3_bucket.lambda_code.id\n"], [250, "  s3_key    = aws_s3_object.lambda_code.key\n"], [251, "\n"], [252, "  environment {\n"], [253, "    variables = {\n"], [254, "      PRIMARY_HEALTH_CHECK_ID = var.primary_health_check_id\n"], [255, "      DR_HEALTH_CHECK_ID      = var.dr_health_check_id\n"], [256, "      PRIMARY_ASG_NAME        = var.primary_asg_name\n"], [257, "      DR_ASG_NAME             = var.dr_asg_name\n"], [258, "      PRIMARY_REGION          = var.primary_region\n"], [259, "      DR_REGION               = var.dr_region\n"], [260, "      SNS_TOPIC_ARN           = var.sns_topic_arn\n"], [261, "      FAILOVER_MODE           = \"test\" # Default mode\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "  tags = {\n"], [266, "    Name        = \"${var.project}-${var.environment}-failover-lambda\"\n"], [267, "    Environment = var.environment\n"], [268, "    Project     = var.project\n"], [269, "  }\n"], [270, "}\n"]], "file_path": "\\modules\\lambda\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [240, 270], "resource": "module.lambda_failover.aws_lambda_function.failover_lambda", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Name": "${var.project}-${var.environment}-failover-lambda", "Project": "var.project"}, "caller_file_path": "\\modules\\multi-region\\main.tf", "caller_file_line_range": [66, 79], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_50", "bc_check_id": "BC_AWS_SERVERLESS_4", "check_name": "X-Ray tracing is enabled for Lambda", "check_result": {"result": "FAILED", "evaluated_keys": ["tracing_config/[0]/mode"]}, "code_block": [[240, "resource \"aws_lambda_function\" \"failover_lambda\" {\n"], [241, "  function_name = \"${var.project}-${var.environment}-failover-test\"\n"], [242, "  description   = \"Lambda function to test and manage failover between primary and DR regions\"\n"], [243, "  role          = aws_iam_role.lambda_role.arn\n"], [244, "  handler       = \"lambda_function.lambda_handler\"\n"], [245, "  runtime       = \"python3.9\"\n"], [246, "  timeout       = 900 # 15 minutes\n"], [247, "  memory_size   = 128\n"], [248, "\n"], [249, "  s3_bucket = aws_s3_bucket.lambda_code.id\n"], [250, "  s3_key    = aws_s3_object.lambda_code.key\n"], [251, "\n"], [252, "  environment {\n"], [253, "    variables = {\n"], [254, "      PRIMARY_HEALTH_CHECK_ID = var.primary_health_check_id\n"], [255, "      DR_HEALTH_CHECK_ID      = var.dr_health_check_id\n"], [256, "      PRIMARY_ASG_NAME        = var.primary_asg_name\n"], [257, "      DR_ASG_NAME             = var.dr_asg_name\n"], [258, "      PRIMARY_REGION          = var.primary_region\n"], [259, "      DR_REGION               = var.dr_region\n"], [260, "      SNS_TOPIC_ARN           = var.sns_topic_arn\n"], [261, "      FAILOVER_MODE           = \"test\" # Default mode\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "  tags = {\n"], [266, "    Name        = \"${var.project}-${var.environment}-failover-lambda\"\n"], [267, "    Environment = var.environment\n"], [268, "    Project     = var.project\n"], [269, "  }\n"], [270, "}\n"]], "file_path": "\\modules\\lambda\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [240, 270], "resource": "module.lambda_failover.aws_lambda_function.failover_lambda", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaXrayEnabled", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Name": "${var.project}-${var.environment}-failover-lambda", "Project": "var.project"}, "caller_file_path": "\\modules\\multi-region\\main.tf", "caller_file_line_range": [66, 79], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-4", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_336", "bc_check_id": "BC_AWS_GENERAL_241", "check_name": "Ensure ECS containers are limited to read-only access to root filesystems", "check_result": {"result": "FAILED", "evaluated_keys": ["container_definitions/[0]/[0]/readonlyRootFilesystem"]}, "code_block": [[1, "resource \"aws_ecs_task_definition\" \"grafana\" {\n"], [2, "  family                   = \"grafana\"\n"], [3, "  network_mode             = \"awsvpc\"\n"], [4, "  requires_compatibilities = [\"FARGATE\"]\n"], [5, "  cpu                      = var.grafana_cpu\n"], [6, "  memory                   = var.grafana_memory\n"], [7, "  execution_role_arn       = var.execution_role_arn\n"], [8, "  task_role_arn            = var.task_role_arn\n"], [9, "\n"], [10, "  container_definitions = jsonencode([\n"], [11, "    {\n"], [12, "      name      = \"grafana\"\n"], [13, "      image     = \"grafana/grafana:9.5.1\"\n"], [14, "      essential = true\n"], [15, "\n"], [16, "      portMappings = [\n"], [17, "        {\n"], [18, "          containerPort = 3000\n"], [19, "          hostPort      = 3000\n"], [20, "          protocol      = \"tcp\"\n"], [21, "        }\n"], [22, "      ]\n"], [23, "\n"], [24, "      environment = [\n"], [25, "        {\n"], [26, "          name  = \"GF_AUTH_ANONYMOUS_ENABLED\"\n"], [27, "          value = \"false\"\n"], [28, "        },\n"], [29, "        {\n"], [30, "          name  = \"GF_SECURITY_ADMIN_PASSWORD\"\n"], [31, "          value = var.grafana_admin_password\n"], [32, "        },\n"], [33, "        {\n"], [34, "          name  = \"GF_INSTALL_PLUGINS\"\n"], [35, "          value = \"grafana-clock-panel,grafana-simple-json-datasource\"\n"], [36, "        },\n"], [37, "        {\n"], [38, "          name  = \"GF_SERVER_ROOT_URL\"\n"], [39, "          value = \"https://${var.domain_name}/grafana\"\n"], [40, "        },\n"], [41, "        {\n"], [42, "          name  = \"GF_SERVER_SERVE_FROM_SUB_PATH\"\n"], [43, "          value = \"true\"\n"], [44, "        }\n"], [45, "      ]\n"], [46, "\n"], [47, "      mountPoints = [\n"], [48, "        {\n"], [49, "          sourceVolume  = \"grafana-data\"\n"], [50, "          containerPath = \"/var/lib/grafana\"\n"], [51, "          readOnly      = false\n"], [52, "        }\n"], [53, "      ]\n"], [54, "\n"], [55, "      logConfiguration = {\n"], [56, "        logDriver = \"awslogs\",\n"], [57, "        options = {\n"], [58, "          \"awslogs-group\"         = aws_cloudwatch_log_group.grafana_logs.name,\n"], [59, "          \"awslogs-region\"        = var.aws_region,\n"], [60, "          \"awslogs-stream-prefix\" = \"grafana\"\n"], [61, "        }\n"], [62, "      }\n"], [63, "    }\n"], [64, "  ])\n"], [65, "\n"], [66, "  volume {\n"], [67, "    name = \"grafana-data\"\n"], [68, "    efs_volume_configuration {\n"], [69, "      file_system_id     = aws_efs_file_system.monitoring_data.id\n"], [70, "      transit_encryption = \"ENABLED\"\n"], [71, "      authorization_config {\n"], [72, "        access_point_id = aws_efs_access_point.grafana_ap.id\n"], [73, "        iam             = \"ENABLED\"\n"], [74, "      }\n"], [75, "    }\n"], [76, "  }\n"], [77, "\n"], [78, "  tags = {\n"], [79, "    Name        = \"grafana\"\n"], [80, "    Environment = var.environment\n"], [81, "  }\n"], [82, "}\n"]], "file_path": "\\modules\\monitoring\\grafana.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf", "repo_file_path": "/modules/monitoring/grafana.tf", "file_line_range": [1, 82], "resource": "module.ecs_jenkins_github.module.monitoring.aws_ecs_task_definition.grafana", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSContainerReadOnlyRoot", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "grafana"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-336", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf"}, {"check_id": "CKV_AWS_336", "bc_check_id": "BC_AWS_GENERAL_241", "check_name": "Ensure ECS containers are limited to read-only access to root filesystems", "check_result": {"result": "FAILED", "evaluated_keys": ["container_definitions/[0]/[0]/readonlyRootFilesystem"]}, "code_block": [[1, "resource \"aws_ecs_task_definition\" \"grafana\" {\n"], [2, "  family                   = \"grafana\"\n"], [3, "  network_mode             = \"awsvpc\"\n"], [4, "  requires_compatibilities = [\"FARGATE\"]\n"], [5, "  cpu                      = var.grafana_cpu\n"], [6, "  memory                   = var.grafana_memory\n"], [7, "  execution_role_arn       = var.execution_role_arn\n"], [8, "  task_role_arn            = var.task_role_arn\n"], [9, "\n"], [10, "  container_definitions = jsonencode([\n"], [11, "    {\n"], [12, "      name      = \"grafana\"\n"], [13, "      image     = \"grafana/grafana:9.5.1\"\n"], [14, "      essential = true\n"], [15, "\n"], [16, "      portMappings = [\n"], [17, "        {\n"], [18, "          containerPort = 3000\n"], [19, "          hostPort      = 3000\n"], [20, "          protocol      = \"tcp\"\n"], [21, "        }\n"], [22, "      ]\n"], [23, "\n"], [24, "      environment = [\n"], [25, "        {\n"], [26, "          name  = \"GF_AUTH_ANONYMOUS_ENABLED\"\n"], [27, "          value = \"false\"\n"], [28, "        },\n"], [29, "        {\n"], [30, "          name  = \"GF_SECURITY_ADMIN_PASSWORD\"\n"], [31, "          value = var.grafana_admin_password\n"], [32, "        },\n"], [33, "        {\n"], [34, "          name  = \"GF_INSTALL_PLUGINS\"\n"], [35, "          value = \"grafana-clock-panel,grafana-simple-json-datasource\"\n"], [36, "        },\n"], [37, "        {\n"], [38, "          name  = \"GF_SERVER_ROOT_URL\"\n"], [39, "          value = \"https://${var.domain_name}/grafana\"\n"], [40, "        },\n"], [41, "        {\n"], [42, "          name  = \"GF_SERVER_SERVE_FROM_SUB_PATH\"\n"], [43, "          value = \"true\"\n"], [44, "        }\n"], [45, "      ]\n"], [46, "\n"], [47, "      mountPoints = [\n"], [48, "        {\n"], [49, "          sourceVolume  = \"grafana-data\"\n"], [50, "          containerPath = \"/var/lib/grafana\"\n"], [51, "          readOnly      = false\n"], [52, "        }\n"], [53, "      ]\n"], [54, "\n"], [55, "      logConfiguration = {\n"], [56, "        logDriver = \"awslogs\",\n"], [57, "        options = {\n"], [58, "          \"awslogs-group\"         = aws_cloudwatch_log_group.grafana_logs.name,\n"], [59, "          \"awslogs-region\"        = var.aws_region,\n"], [60, "          \"awslogs-stream-prefix\" = \"grafana\"\n"], [61, "        }\n"], [62, "      }\n"], [63, "    }\n"], [64, "  ])\n"], [65, "\n"], [66, "  volume {\n"], [67, "    name = \"grafana-data\"\n"], [68, "    efs_volume_configuration {\n"], [69, "      file_system_id     = aws_efs_file_system.monitoring_data.id\n"], [70, "      transit_encryption = \"ENABLED\"\n"], [71, "      authorization_config {\n"], [72, "        access_point_id = aws_efs_access_point.grafana_ap.id\n"], [73, "        iam             = \"ENABLED\"\n"], [74, "      }\n"], [75, "    }\n"], [76, "  }\n"], [77, "\n"], [78, "  tags = {\n"], [79, "    Name        = \"grafana\"\n"], [80, "    Environment = var.environment\n"], [81, "  }\n"], [82, "}\n"]], "file_path": "\\modules\\monitoring\\grafana.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf", "repo_file_path": "/modules/monitoring/grafana.tf", "file_line_range": [1, 82], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_ecs_task_definition.grafana", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSContainerReadOnlyRoot", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "grafana"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-336", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf"}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[45, "resource \"aws_cloudwatch_log_group\" \"prometheus_logs\" {\n"], [46, "  name              = \"/ecs/prometheus\"\n"], [47, "  retention_in_days = 30\n"], [48, "}\n"]], "file_path": "\\modules\\monitoring\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [45, 48], "resource": "module.ecs_jenkins_github.module.monitoring.aws_cloudwatch_log_group.prometheus_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_338", "bc_check_id": "BC_AWS_LOGGING_46", "check_name": "Ensure CloudWatch log groups retains logs for at least 1 year", "check_result": {"result": "FAILED", "evaluated_keys": ["retention_in_days"]}, "code_block": [[45, "resource \"aws_cloudwatch_log_group\" \"prometheus_logs\" {\n"], [46, "  name              = \"/ecs/prometheus\"\n"], [47, "  retention_in_days = 30\n"], [48, "}\n"]], "file_path": "\\modules\\monitoring\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [45, 48], "resource": "module.ecs_jenkins_github.module.monitoring.aws_cloudwatch_log_group.prometheus_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetentionYear", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[50, "resource \"aws_cloudwatch_log_group\" \"grafana_logs\" {\n"], [51, "  name              = \"/ecs/grafana\"\n"], [52, "  retention_in_days = 30\n"], [53, "}\n"]], "file_path": "\\modules\\monitoring\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [50, 53], "resource": "module.ecs_jenkins_github.module.monitoring.aws_cloudwatch_log_group.grafana_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_338", "bc_check_id": "BC_AWS_LOGGING_46", "check_name": "Ensure CloudWatch log groups retains logs for at least 1 year", "check_result": {"result": "FAILED", "evaluated_keys": ["retention_in_days"]}, "code_block": [[50, "resource \"aws_cloudwatch_log_group\" \"grafana_logs\" {\n"], [51, "  name              = \"/ecs/grafana\"\n"], [52, "  retention_in_days = 30\n"], [53, "}\n"]], "file_path": "\\modules\\monitoring\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [50, 53], "resource": "module.ecs_jenkins_github.module.monitoring.aws_cloudwatch_log_group.grafana_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetentionYear", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_184", "bc_check_id": "BC_AWS_GENERAL_104", "check_name": "Ensure resource is encrypted by KMS using a customer managed Key (CMK)", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[56, "resource \"aws_efs_file_system\" \"monitoring_data\" {\n"], [57, "  encrypted        = true\n"], [58, "  performance_mode = \"generalPurpose\"\n"], [59, "\n"], [60, "  tags = {\n"], [61, "    Name = \"monitoring-data\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "\\modules\\monitoring\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [56, 63], "resource": "module.ecs_jenkins_github.module.monitoring.aws_efs_file_system.monitoring_data", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EFSFileSystemEncryptedWithCMK", "fixed_definition": null, "entity_tags": {"Name": "monitoring-data"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-104", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[45, "resource \"aws_cloudwatch_log_group\" \"prometheus_logs\" {\n"], [46, "  name              = \"/ecs/prometheus\"\n"], [47, "  retention_in_days = 30\n"], [48, "}\n"]], "file_path": "\\modules\\monitoring\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [45, 48], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_cloudwatch_log_group.prometheus_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_338", "bc_check_id": "BC_AWS_LOGGING_46", "check_name": "Ensure CloudWatch log groups retains logs for at least 1 year", "check_result": {"result": "FAILED", "evaluated_keys": ["retention_in_days"]}, "code_block": [[45, "resource \"aws_cloudwatch_log_group\" \"prometheus_logs\" {\n"], [46, "  name              = \"/ecs/prometheus\"\n"], [47, "  retention_in_days = 30\n"], [48, "}\n"]], "file_path": "\\modules\\monitoring\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [45, 48], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_cloudwatch_log_group.prometheus_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetentionYear", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[50, "resource \"aws_cloudwatch_log_group\" \"grafana_logs\" {\n"], [51, "  name              = \"/ecs/grafana\"\n"], [52, "  retention_in_days = 30\n"], [53, "}\n"]], "file_path": "\\modules\\monitoring\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [50, 53], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_cloudwatch_log_group.grafana_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_338", "bc_check_id": "BC_AWS_LOGGING_46", "check_name": "Ensure CloudWatch log groups retains logs for at least 1 year", "check_result": {"result": "FAILED", "evaluated_keys": ["retention_in_days"]}, "code_block": [[50, "resource \"aws_cloudwatch_log_group\" \"grafana_logs\" {\n"], [51, "  name              = \"/ecs/grafana\"\n"], [52, "  retention_in_days = 30\n"], [53, "}\n"]], "file_path": "\\modules\\monitoring\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [50, 53], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_cloudwatch_log_group.grafana_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetentionYear", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_184", "bc_check_id": "BC_AWS_GENERAL_104", "check_name": "Ensure resource is encrypted by KMS using a customer managed Key (CMK)", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[56, "resource \"aws_efs_file_system\" \"monitoring_data\" {\n"], [57, "  encrypted        = true\n"], [58, "  performance_mode = \"generalPurpose\"\n"], [59, "\n"], [60, "  tags = {\n"], [61, "    Name = \"monitoring-data\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "\\modules\\monitoring\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [56, 63], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_efs_file_system.monitoring_data", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EFSFileSystemEncryptedWithCMK", "fixed_definition": null, "entity_tags": {"Name": "monitoring-data"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-104", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_26", "bc_check_id": "BC_AWS_GENERAL_15", "check_name": "Ensure all data stored in the SNS topic is encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_master_key_id"]}, "code_block": [[2, "resource \"aws_sns_topic\" \"infrastructure_alerts\" {\n"], [3, "  name = \"${var.project}-${var.environment}-infrastructure-alerts\"\n"], [4, "\n"], [5, "  tags = {\n"], [6, "    Name        = \"${var.project}-${var.environment}-infrastructure-alerts\"\n"], [7, "    Environment = var.environment\n"], [8, "    Project     = var.project\n"], [9, "  }\n"], [10, "}\n"]], "file_path": "\\modules\\monitoring\\sns.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\sns.tf", "repo_file_path": "/modules/monitoring/sns.tf", "file_line_range": [2, 10], "resource": "module.ecs_jenkins_github.module.monitoring.aws_sns_topic.infrastructure_alerts", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SNSTopicEncryption", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-infrastructure-alerts", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-15", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\sns.tf"}, {"check_id": "CKV_AWS_26", "bc_check_id": "BC_AWS_GENERAL_15", "check_name": "Ensure all data stored in the SNS topic is encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_master_key_id"]}, "code_block": [[2, "resource \"aws_sns_topic\" \"infrastructure_alerts\" {\n"], [3, "  name = \"${var.project}-${var.environment}-infrastructure-alerts\"\n"], [4, "\n"], [5, "  tags = {\n"], [6, "    Name        = \"${var.project}-${var.environment}-infrastructure-alerts\"\n"], [7, "    Environment = var.environment\n"], [8, "    Project     = var.project\n"], [9, "  }\n"], [10, "}\n"]], "file_path": "\\modules\\monitoring\\sns.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\sns.tf", "repo_file_path": "/modules/monitoring/sns.tf", "file_line_range": [2, 10], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_sns_topic.infrastructure_alerts", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SNSTopicEncryption", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-infrastructure-alerts", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [104, 119], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-15", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\sns.tf"}, {"check_id": "CKV_AWS_26", "bc_check_id": "BC_AWS_GENERAL_15", "check_name": "Ensure all data stored in the SNS topic is encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_master_key_id"]}, "code_block": [[16, "resource \"aws_sns_topic\" \"failover_notifications\" {\n"], [17, "  provider = aws.primary\n"], [18, "  name     = \"${var.project}-${var.environment}-failover-notifications\"\n"], [19, "\n"], [20, "  tags = {\n"], [21, "    Name        = \"${var.project}-${var.environment}-failover-notifications\"\n"], [22, "    Environment = var.environment\n"], [23, "    Project     = var.project\n"], [24, "  }\n"], [25, "}\n"]], "file_path": "\\modules\\multi-region\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\multi-region\\main.tf", "repo_file_path": "/modules/multi-region/main.tf", "file_line_range": [16, 25], "resource": "aws_sns_topic.failover_notifications", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SNSTopicEncryption", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Name": "${var.project}-${var.environment}-failover-notifications", "Project": "var.project"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-15", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\multi-region\\main.tf"}, {"check_id": "CKV_AWS_27", "bc_check_id": "BC_AWS_GENERAL_16", "check_name": "Ensure all data stored in the SQS queue is encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["sqs_managed_sse_enabled", "kms_master_key_id"]}, "code_block": [[35, "resource \"aws_sqs_queue\" \"dr_notification_queue\" {\n"], [36, "  provider = aws.dr\n"], [37, "  name     = \"${var.project}-${var.environment}-dr-notifications\"\n"], [38, "\n"], [39, "  tags = {\n"], [40, "    Name        = \"${var.project}-${var.environment}-dr-notifications\"\n"], [41, "    Environment = var.environment\n"], [42, "    Project     = var.project\n"], [43, "  }\n"], [44, "}\n"]], "file_path": "\\modules\\multi-region\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\multi-region\\main.tf", "repo_file_path": "/modules/multi-region/main.tf", "file_line_range": [35, 44], "resource": "aws_sqs_queue.dr_notification_queue", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SQSQueueEncryption", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Name": "${var.project}-${var.environment}-dr-notifications", "Project": "var.project"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-16-encrypt-sqs-queue", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\multi-region\\main.tf"}, {"check_id": "CKV_AWS_300", "bc_check_id": "BC_AWS_GENERAL_214", "check_name": "Ensure S3 lifecycle configuration sets period for aborting failed uploads", "check_result": {"result": "FAILED", "evaluated_keys": ["rule"]}, "code_block": [[339, "resource \"aws_s3_bucket_lifecycle_configuration\" \"alb_logs_lifecycle\" {\n"], [340, "  bucket = aws_s3_bucket.alb_logs.id\n"], [341, "\n"], [342, "  rule {\n"], [343, "    id     = \"log\"\n"], [344, "    status = \"Enabled\"\n"], [345, "\n"], [346, "    expiration {\n"], [347, "      days = 90 # Keep logs for 90 days\n"], [348, "    }\n"], [349, "  }\n"], [350, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [339, 350], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket_lifecycle_configuration.alb_logs_lifecycle", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3AbortIncompleteUploads", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-300", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_300", "bc_check_id": "BC_AWS_GENERAL_214", "check_name": "Ensure S3 lifecycle configuration sets period for aborting failed uploads", "check_result": {"result": "FAILED", "evaluated_keys": ["rule"]}, "code_block": [[353, "resource \"aws_s3_bucket_lifecycle_configuration\" \"alb_logs_access_lifecycle\" {\n"], [354, "  bucket = aws_s3_bucket.alb_logs_access_logs.id\n"], [355, "\n"], [356, "  rule {\n"], [357, "    id     = \"access-logs\"\n"], [358, "    status = \"Enabled\"\n"], [359, "\n"], [360, "    expiration {\n"], [361, "      days = 90 # Keep access logs for 90 days\n"], [362, "    }\n"], [363, "  }\n"], [364, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [353, 364], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket_lifecycle_configuration.alb_logs_access_lifecycle", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3AbortIncompleteUploads", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-300", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_300", "bc_check_id": "BC_AWS_GENERAL_214", "check_name": "Ensure S3 lifecycle configuration sets period for aborting failed uploads", "check_result": {"result": "FAILED", "evaluated_keys": ["rule"]}, "code_block": [[367, "resource \"aws_s3_bucket_lifecycle_configuration\" \"replication_logs_lifecycle\" {\n"], [368, "  bucket = aws_s3_bucket.replication_logs.id\n"], [369, "\n"], [370, "  rule {\n"], [371, "    id     = \"replication-logs\"\n"], [372, "    status = \"Enabled\"\n"], [373, "\n"], [374, "    expiration {\n"], [375, "      days = 90 # Keep replication logs for 90 days\n"], [376, "    }\n"], [377, "  }\n"], [378, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [367, 378], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket_lifecycle_configuration.replication_logs_lifecycle", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3AbortIncompleteUploads", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-300", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_355", "bc_check_id": "BC_AWS_IAM_88", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "check_result": {"result": "FAILED", "evaluated_keys": ["policy/Statement/[0]/Action"]}, "code_block": [[442, "resource \"aws_iam_role_policy\" \"vpc_flow_logs_policy\" {\n"], [443, "  name = \"vpc-flow-logs-policy\"\n"], [444, "  role = aws_iam_role.vpc_flow_logs_role.id\n"], [445, "\n"], [446, "  policy = jsonencode({\n"], [447, "    Version = \"2012-10-17\"\n"], [448, "    Statement = [\n"], [449, "      {\n"], [450, "        Action = [\n"], [451, "          \"logs:CreateLogGroup\",\n"], [452, "          \"logs:CreateLogStream\",\n"], [453, "          \"logs:PutLogEvents\",\n"], [454, "          \"logs:DescribeLogGroups\",\n"], [455, "          \"logs:DescribeLogStreams\"\n"], [456, "        ]\n"], [457, "        Effect   = \"Allow\"\n"], [458, "        Resource = \"*\"\n"], [459, "      }\n"], [460, "    ]\n"], [461, "  })\n"], [462, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [442, 462], "resource": "module.ecs_jenkins_github.module.network.aws_iam_role_policy.vpc_flow_logs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarResourcePolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-355", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_290", "bc_check_id": "BC_AWS_IAM_85", "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "FAILED", "evaluated_keys": ["policy/Statement/[0]/Action"]}, "code_block": [[442, "resource \"aws_iam_role_policy\" \"vpc_flow_logs_policy\" {\n"], [443, "  name = \"vpc-flow-logs-policy\"\n"], [444, "  role = aws_iam_role.vpc_flow_logs_role.id\n"], [445, "\n"], [446, "  policy = jsonencode({\n"], [447, "    Version = \"2012-10-17\"\n"], [448, "    Statement = [\n"], [449, "      {\n"], [450, "        Action = [\n"], [451, "          \"logs:CreateLogGroup\",\n"], [452, "          \"logs:CreateLogStream\",\n"], [453, "          \"logs:PutLogEvents\",\n"], [454, "          \"logs:DescribeLogGroups\",\n"], [455, "          \"logs:DescribeLogStreams\"\n"], [456, "        ]\n"], [457, "        Effect   = \"Allow\"\n"], [458, "        Resource = \"*\"\n"], [459, "      }\n"], [460, "    ]\n"], [461, "  })\n"], [462, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [442, 462], "resource": "module.ecs_jenkins_github.module.network.aws_iam_role_policy.vpc_flow_logs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-290", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_260", "bc_check_id": "BC_AWS_NETWORKING_67", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "check_result": {"result": "FAILED", "evaluated_keys": ["ingress/[1]/from_port", "ingress/[1]/to_port", "ingress/[1]/cidr_blocks", "ingress/[1]/ipv6_cidr_blocks"]}, "code_block": [[465, "resource \"aws_security_group\" \"alb_security_group\" {\n"], [466, "  name        = \"alb-security-group\"\n"], [467, "  description = \"Security group for application load balancer\"\n"], [468, "  vpc_id      = aws_vpc.vpc.id\n"], [469, "\n"], [470, "  # Allow incoming HTTPS traffic only\n"], [471, "  ingress {\n"], [472, "    description = \"HTTPS from internet\"\n"], [473, "    from_port   = 443\n"], [474, "    to_port     = 443\n"], [475, "    protocol    = \"tcp\"\n"], [476, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [477, "  }\n"], [478, "\n"], [479, "  # HTTP for redirection only (will be redirected to HTTPS)\n"], [480, "  ingress {\n"], [481, "    description = \"HTTP from internet (for redirection to HTTPS)\"\n"], [482, "    from_port   = 80\n"], [483, "    to_port     = 80\n"], [484, "    protocol    = \"tcp\"\n"], [485, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [486, "  }\n"], [487, "\n"], [488, "  # Restricted egress rules\n"], [489, "  egress {\n"], [490, "    description = \"HTTP to ECS services\"\n"], [491, "    from_port   = 80\n"], [492, "    to_port     = 80\n"], [493, "    protocol    = \"tcp\"\n"], [494, "    cidr_blocks = [aws_vpc.vpc.cidr_block] # Allow traffic to any private IP in the VPC\n"], [495, "  }\n"], [496, "\n"], [497, "  egress {\n"], [498, "    description = \"HTTPS to internet for external resources\"\n"], [499, "    from_port   = 443\n"], [500, "    to_port     = 443\n"], [501, "    protocol    = \"tcp\"\n"], [502, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [503, "  }\n"], [504, "\n"], [505, "  tags = {\n"], [506, "    Name = \"alb-security-group\"\n"], [507, "  }\n"], [508, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [465, 508], "resource": "module.ecs_jenkins_github.module.network.aws_security_group.alb_security_group", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress80", "fixed_definition": null, "entity_tags": {"Name": "alb-security-group"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_300", "bc_check_id": "BC_AWS_GENERAL_214", "check_name": "Ensure S3 lifecycle configuration sets period for aborting failed uploads", "check_result": {"result": "FAILED", "evaluated_keys": ["rule"]}, "code_block": [[339, "resource \"aws_s3_bucket_lifecycle_configuration\" \"alb_logs_lifecycle\" {\n"], [340, "  bucket = aws_s3_bucket.alb_logs.id\n"], [341, "\n"], [342, "  rule {\n"], [343, "    id     = \"log\"\n"], [344, "    status = \"Enabled\"\n"], [345, "\n"], [346, "    expiration {\n"], [347, "      days = 90 # Keep logs for 90 days\n"], [348, "    }\n"], [349, "  }\n"], [350, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [339, 350], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket_lifecycle_configuration.alb_logs_lifecycle", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3AbortIncompleteUploads", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-300", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_300", "bc_check_id": "BC_AWS_GENERAL_214", "check_name": "Ensure S3 lifecycle configuration sets period for aborting failed uploads", "check_result": {"result": "FAILED", "evaluated_keys": ["rule"]}, "code_block": [[353, "resource \"aws_s3_bucket_lifecycle_configuration\" \"alb_logs_access_lifecycle\" {\n"], [354, "  bucket = aws_s3_bucket.alb_logs_access_logs.id\n"], [355, "\n"], [356, "  rule {\n"], [357, "    id     = \"access-logs\"\n"], [358, "    status = \"Enabled\"\n"], [359, "\n"], [360, "    expiration {\n"], [361, "      days = 90 # Keep access logs for 90 days\n"], [362, "    }\n"], [363, "  }\n"], [364, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [353, 364], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket_lifecycle_configuration.alb_logs_access_lifecycle", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3AbortIncompleteUploads", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-300", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_300", "bc_check_id": "BC_AWS_GENERAL_214", "check_name": "Ensure S3 lifecycle configuration sets period for aborting failed uploads", "check_result": {"result": "FAILED", "evaluated_keys": ["rule"]}, "code_block": [[367, "resource \"aws_s3_bucket_lifecycle_configuration\" \"replication_logs_lifecycle\" {\n"], [368, "  bucket = aws_s3_bucket.replication_logs.id\n"], [369, "\n"], [370, "  rule {\n"], [371, "    id     = \"replication-logs\"\n"], [372, "    status = \"Enabled\"\n"], [373, "\n"], [374, "    expiration {\n"], [375, "      days = 90 # Keep replication logs for 90 days\n"], [376, "    }\n"], [377, "  }\n"], [378, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [367, 378], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket_lifecycle_configuration.replication_logs_lifecycle", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3AbortIncompleteUploads", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-300", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_355", "bc_check_id": "BC_AWS_IAM_88", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "check_result": {"result": "FAILED", "evaluated_keys": ["policy/Statement/[0]/Action"]}, "code_block": [[442, "resource \"aws_iam_role_policy\" \"vpc_flow_logs_policy\" {\n"], [443, "  name = \"vpc-flow-logs-policy\"\n"], [444, "  role = aws_iam_role.vpc_flow_logs_role.id\n"], [445, "\n"], [446, "  policy = jsonencode({\n"], [447, "    Version = \"2012-10-17\"\n"], [448, "    Statement = [\n"], [449, "      {\n"], [450, "        Action = [\n"], [451, "          \"logs:CreateLogGroup\",\n"], [452, "          \"logs:CreateLogStream\",\n"], [453, "          \"logs:PutLogEvents\",\n"], [454, "          \"logs:DescribeLogGroups\",\n"], [455, "          \"logs:DescribeLogStreams\"\n"], [456, "        ]\n"], [457, "        Effect   = \"Allow\"\n"], [458, "        Resource = \"*\"\n"], [459, "      }\n"], [460, "    ]\n"], [461, "  })\n"], [462, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [442, 462], "resource": "module.ecs_jenkins_github_dr.module.network.aws_iam_role_policy.vpc_flow_logs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarResourcePolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-355", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_290", "bc_check_id": "BC_AWS_IAM_85", "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "FAILED", "evaluated_keys": ["policy/Statement/[0]/Action"]}, "code_block": [[442, "resource \"aws_iam_role_policy\" \"vpc_flow_logs_policy\" {\n"], [443, "  name = \"vpc-flow-logs-policy\"\n"], [444, "  role = aws_iam_role.vpc_flow_logs_role.id\n"], [445, "\n"], [446, "  policy = jsonencode({\n"], [447, "    Version = \"2012-10-17\"\n"], [448, "    Statement = [\n"], [449, "      {\n"], [450, "        Action = [\n"], [451, "          \"logs:CreateLogGroup\",\n"], [452, "          \"logs:CreateLogStream\",\n"], [453, "          \"logs:PutLogEvents\",\n"], [454, "          \"logs:DescribeLogGroups\",\n"], [455, "          \"logs:DescribeLogStreams\"\n"], [456, "        ]\n"], [457, "        Effect   = \"Allow\"\n"], [458, "        Resource = \"*\"\n"], [459, "      }\n"], [460, "    ]\n"], [461, "  })\n"], [462, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [442, 462], "resource": "module.ecs_jenkins_github_dr.module.network.aws_iam_role_policy.vpc_flow_logs_policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-290", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_260", "bc_check_id": "BC_AWS_NETWORKING_67", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "check_result": {"result": "FAILED", "evaluated_keys": ["ingress/[1]/from_port", "ingress/[1]/to_port", "ingress/[1]/cidr_blocks", "ingress/[1]/ipv6_cidr_blocks"]}, "code_block": [[465, "resource \"aws_security_group\" \"alb_security_group\" {\n"], [466, "  name        = \"alb-security-group\"\n"], [467, "  description = \"Security group for application load balancer\"\n"], [468, "  vpc_id      = aws_vpc.vpc.id\n"], [469, "\n"], [470, "  # Allow incoming HTTPS traffic only\n"], [471, "  ingress {\n"], [472, "    description = \"HTTPS from internet\"\n"], [473, "    from_port   = 443\n"], [474, "    to_port     = 443\n"], [475, "    protocol    = \"tcp\"\n"], [476, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [477, "  }\n"], [478, "\n"], [479, "  # HTTP for redirection only (will be redirected to HTTPS)\n"], [480, "  ingress {\n"], [481, "    description = \"HTTP from internet (for redirection to HTTPS)\"\n"], [482, "    from_port   = 80\n"], [483, "    to_port     = 80\n"], [484, "    protocol    = \"tcp\"\n"], [485, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [486, "  }\n"], [487, "\n"], [488, "  # Restricted egress rules\n"], [489, "  egress {\n"], [490, "    description = \"HTTP to ECS services\"\n"], [491, "    from_port   = 80\n"], [492, "    to_port     = 80\n"], [493, "    protocol    = \"tcp\"\n"], [494, "    cidr_blocks = [aws_vpc.vpc.cidr_block] # Allow traffic to any private IP in the VPC\n"], [495, "  }\n"], [496, "\n"], [497, "  egress {\n"], [498, "    description = \"HTTPS to internet for external resources\"\n"], [499, "    from_port   = 443\n"], [500, "    to_port     = 443\n"], [501, "    protocol    = \"tcp\"\n"], [502, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [503, "  }\n"], [504, "\n"], [505, "  tags = {\n"], [506, "    Name = \"alb-security-group\"\n"], [507, "  }\n"], [508, "}\n"]], "file_path": "\\modules\\network\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [465, 508], "resource": "module.ecs_jenkins_github_dr.module.network.aws_security_group.alb_security_group", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress80", "fixed_definition": null, "entity_tags": {"Name": "alb-security-group"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [18, 27], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_26", "bc_check_id": "BC_AWS_GENERAL_15", "check_name": "Ensure all data stored in the SNS topic is encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_master_key_id"]}, "code_block": [[362, "resource \"aws_sns_topic\" \"security_alerts\" {\n"], [363, "  name = \"${var.project}-${var.environment}-security-alerts\"\n"], [364, "\n"], [365, "  tags = {\n"], [366, "    Name        = \"${var.project}-${var.environment}-security-alerts\"\n"], [367, "    Environment = var.environment\n"], [368, "    Project     = var.project\n"], [369, "  }\n"], [370, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [362, 370], "resource": "module.ecs_jenkins_github.module.security.aws_sns_topic.security_alerts", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SNSTopicEncryption", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-security-alerts", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-15", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_26", "bc_check_id": "BC_AWS_GENERAL_15", "check_name": "Ensure all data stored in the SNS topic is encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_master_key_id"]}, "code_block": [[362, "resource \"aws_sns_topic\" \"security_alerts\" {\n"], [363, "  name = \"${var.project}-${var.environment}-security-alerts\"\n"], [364, "\n"], [365, "  tags = {\n"], [366, "    Name        = \"${var.project}-${var.environment}-security-alerts\"\n"], [367, "    Environment = var.environment\n"], [368, "    Project     = var.project\n"], [369, "  }\n"], [370, "}\n"]], "file_path": "\\modules\\security\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [362, 370], "resource": "module.ecs_jenkins_github_dr.module.security.aws_sns_topic.security_alerts", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SNSTopicEncryption", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-security-alerts", "Project": "ecs-jenkins"}, "caller_file_path": "\\main.tf", "caller_file_line_range": [122, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-15", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV2_AWS_20", "bc_check_id": "BC_AWS_NETWORKING_49", "check_name": "Ensure that ALB redirects HTTP requests into HTTPS ones", "check_result": {"result": "FAILED", "entity": {"aws_lb": {"jenkins_nlb": {"__end_line__": 186, "__start_line__": 175, "internal": [false], "load_balancer_type": ["network"], "name": ["ecs-jenkins-prod-jenkins-nlb"], "subnets": [["${${aws_subnet.public_subnet.*.id}[\"0\"]}"]], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-nlb", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.cicd.aws_lb.jenkins_nlb"}}}, "evaluated_keys": ["port", "default_action/redirect/*/protocol", "protocol", "resource_type", "default_action/type", "default_action/redirect/*/port"]}, "code_block": [[175, "resource \"aws_lb\" \"jenkins_nlb\" {\n"], [176, "  name               = \"${var.project}-${var.environment}-jenkins-nlb\"\n"], [177, "  internal           = false\n"], [178, "  load_balancer_type = \"network\"\n"], [179, "  subnets            = [var.subnet_id]\n"], [180, "\n"], [181, "  tags = {\n"], [182, "    Name        = \"${var.project}-${var.environment}-jenkins-nlb\"\n"], [183, "    Environment = var.environment\n"], [184, "    Project     = var.project\n"], [185, "  }\n"], [186, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [175, 186], "resource": "module.ecs_jenkins_github.module.cicd.aws_lb.jenkins_nlb", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-nlb", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[219, "resource \"aws_lb_listener\" \"jenkins\" {\n"], [220, "  load_balancer_arn = aws_lb.jenkins_nlb.arn\n"], [221, "  port              = 80\n"], [222, "  protocol          = \"TCP\"\n"], [223, "\n"], [224, "  default_action {\n"], [225, "    type             = \"forward\"\n"], [226, "    target_group_arn = aws_lb_target_group.jenkins.arn\n"], [227, "  }\n"], [228, "}\n"]], "file_path": "\\..\\cicd\\main.tf", "file_line_range": [219, 228], "resource": "aws_lb_listener.jenkins", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-alb-redirects-http-requests-into-https-ones", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV2_AWS_20", "bc_check_id": "BC_AWS_NETWORKING_49", "check_name": "Ensure that ALB redirects HTTP requests into HTTPS ones", "check_result": {"result": "FAILED", "entity": {"aws_lb": {"jenkins_nlb": {"__end_line__": 186, "__start_line__": 175, "internal": [false], "load_balancer_type": ["network"], "name": ["ecs-jenkins-dr-jenkins-nlb"], "subnets": [["${${aws_subnet.public_subnet.*.id}[\"0\"]}"]], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-nlb", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.cicd.aws_lb.jenkins_nlb"}}}, "evaluated_keys": ["port", "default_action/redirect/*/protocol", "protocol", "resource_type", "default_action/type", "default_action/redirect/*/port"]}, "code_block": [[175, "resource \"aws_lb\" \"jenkins_nlb\" {\n"], [176, "  name               = \"${var.project}-${var.environment}-jenkins-nlb\"\n"], [177, "  internal           = false\n"], [178, "  load_balancer_type = \"network\"\n"], [179, "  subnets            = [var.subnet_id]\n"], [180, "\n"], [181, "  tags = {\n"], [182, "    Name        = \"${var.project}-${var.environment}-jenkins-nlb\"\n"], [183, "    Environment = var.environment\n"], [184, "    Project     = var.project\n"], [185, "  }\n"], [186, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [175, 186], "resource": "module.ecs_jenkins_github_dr.module.cicd.aws_lb.jenkins_nlb", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-nlb", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[219, "resource \"aws_lb_listener\" \"jenkins\" {\n"], [220, "  load_balancer_arn = aws_lb.jenkins_nlb.arn\n"], [221, "  port              = 80\n"], [222, "  protocol          = \"TCP\"\n"], [223, "\n"], [224, "  default_action {\n"], [225, "    type             = \"forward\"\n"], [226, "    target_group_arn = aws_lb_target_group.jenkins.arn\n"], [227, "  }\n"], [228, "}\n"]], "file_path": "\\main.tf", "file_line_range": [219, 228], "resource": "aws_lb_listener.jenkins", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-alb-redirects-http-requests-into-https-ones", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV2_AWS_20", "bc_check_id": "BC_AWS_NETWORKING_49", "check_name": "Ensure that ALB redirects HTTP requests into HTTPS ones", "check_result": {"result": "FAILED", "entity": {"aws_lb": {"alb": {"__end_line__": 44, "__start_line__": 30, "enable_deletion_protection": [false], "internal": [false], "load_balancer_type": ["application"], "name": ["ecs-jenkins-prod-alb"], "security_groups": [[["aws_security_group.alb_security_group.id"]]], "subnets": ["aws_subnet.public_subnet.*.id"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-alb", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.ecs.aws_lb.alb"}}}, "evaluated_keys": ["port", "default_action/redirect/*/protocol", "protocol", "resource_type", "default_action/type", "default_action/redirect/*/port"]}, "code_block": [[30, "resource \"aws_lb\" \"alb\" {\n"], [31, "  name               = \"${var.project}-${var.environment}-alb\"\n"], [32, "  internal           = false\n"], [33, "  load_balancer_type = \"application\"\n"], [34, "  security_groups    = [var.alb_security_group]\n"], [35, "  subnets            = var.public_subnets\n"], [36, "\n"], [37, "  enable_deletion_protection = false\n"], [38, "\n"], [39, "  tags = {\n"], [40, "    Name        = \"${var.project}-${var.environment}-alb\"\n"], [41, "    Environment = var.environment\n"], [42, "    Project     = var.project\n"], [43, "  }\n"], [44, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [30, 44], "resource": "module.ecs_jenkins_github.module.ecs.aws_lb.alb", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-alb", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[279, "resource \"aws_lb_listener\" \"http_redirect\" {\n"], [280, "  load_balancer_arn = aws_lb.alb.arn\n"], [281, "  port              = 80\n"], [282, "  protocol          = \"HTTP\"\n"], [283, "\n"], [284, "  default_action {\n"], [285, "    type = \"redirect\"\n"], [286, "\n"], [287, "    redirect {\n"], [288, "      port        = \"443\"\n"], [289, "      protocol    = \"HTTPS\"\n"], [290, "      status_code = \"HTTP_301\"\n"], [291, "    }\n"], [292, "  }\n"], [293, "\n"], [294, "  # Add security headers via response headers policy\n"], [295, "  lifecycle {\n"], [296, "    ignore_changes = [default_action]\n"], [297, "  }\n"], [298, "\n"], [299, "  tags = {\n"], [300, "    Name        = \"${var.project}-${var.environment}-http-redirect\"\n"], [301, "    Environment = var.environment\n"], [302, "    Project     = var.project\n"], [303, "    ManagedBy   = \"Terraform\"\n"], [304, "  }\n"], [305, "}\n"]], "file_path": "\\..\\ecs\\main.tf", "file_line_range": [279, 305], "resource": "aws_lb_listener.http_redirect", "entity_tags": {"Environment": "prod", "ManagedBy": "Terraform", "Name": "ecs-jenkins-prod-http-redirect", "Project": "ecs-jenkins"}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-alb-redirects-http-requests-into-https-ones", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV2_AWS_20", "bc_check_id": "BC_AWS_NETWORKING_49", "check_name": "Ensure that ALB redirects HTTP requests into HTTPS ones", "check_result": {"result": "FAILED", "entity": {"aws_lb": {"alb": {"__end_line__": 44, "__start_line__": 30, "enable_deletion_protection": [false], "internal": [false], "load_balancer_type": ["application"], "name": ["ecs-jenkins-dr-alb"], "security_groups": [[["aws_security_group.alb_security_group.id"]]], "subnets": ["aws_subnet.public_subnet.*.id"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-alb", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.ecs.aws_lb.alb"}}}, "evaluated_keys": ["port", "default_action/redirect/*/protocol", "protocol", "resource_type", "default_action/type", "default_action/redirect/*/port"]}, "code_block": [[30, "resource \"aws_lb\" \"alb\" {\n"], [31, "  name               = \"${var.project}-${var.environment}-alb\"\n"], [32, "  internal           = false\n"], [33, "  load_balancer_type = \"application\"\n"], [34, "  security_groups    = [var.alb_security_group]\n"], [35, "  subnets            = var.public_subnets\n"], [36, "\n"], [37, "  enable_deletion_protection = false\n"], [38, "\n"], [39, "  tags = {\n"], [40, "    Name        = \"${var.project}-${var.environment}-alb\"\n"], [41, "    Environment = var.environment\n"], [42, "    Project     = var.project\n"], [43, "  }\n"], [44, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [30, 44], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_lb.alb", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-alb", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[279, "resource \"aws_lb_listener\" \"http_redirect\" {\n"], [280, "  load_balancer_arn = aws_lb.alb.arn\n"], [281, "  port              = 80\n"], [282, "  protocol          = \"HTTP\"\n"], [283, "\n"], [284, "  default_action {\n"], [285, "    type = \"redirect\"\n"], [286, "\n"], [287, "    redirect {\n"], [288, "      port        = \"443\"\n"], [289, "      protocol    = \"HTTPS\"\n"], [290, "      status_code = \"HTTP_301\"\n"], [291, "    }\n"], [292, "  }\n"], [293, "\n"], [294, "  # Add security headers via response headers policy\n"], [295, "  lifecycle {\n"], [296, "    ignore_changes = [default_action]\n"], [297, "  }\n"], [298, "\n"], [299, "  tags = {\n"], [300, "    Name        = \"${var.project}-${var.environment}-http-redirect\"\n"], [301, "    Environment = var.environment\n"], [302, "    Project     = var.project\n"], [303, "    ManagedBy   = \"Terraform\"\n"], [304, "  }\n"], [305, "}\n"]], "file_path": "\\main.tf", "file_line_range": [279, 305], "resource": "aws_lb_listener.http_redirect", "entity_tags": {"Environment": "dr", "ManagedBy": "Terraform", "Name": "ecs-jenkins-dr-http-redirect", "Project": "ecs-jenkins"}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-alb-redirects-http-requests-into-https-ones", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV2_AWS_28", "bc_check_id": "BC_AWS_NETWORKING_58", "check_name": "Ensure public facing ALB are protected by WAF", "check_result": {"result": "FAILED", "entity": {"aws_lb": {"alb": {"__end_line__": 44, "__start_line__": 30, "enable_deletion_protection": [false], "internal": [false], "load_balancer_type": ["application"], "name": ["ecs-jenkins-prod-alb"], "security_groups": [[["aws_security_group.alb_security_group.id"]]], "subnets": ["aws_subnet.public_subnet.*.id"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-alb", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.ecs.aws_lb.alb"}}}, "evaluated_keys": ["resource_type", "load_balancer_type", "internal"]}, "code_block": [[30, "resource \"aws_lb\" \"alb\" {\n"], [31, "  name               = \"${var.project}-${var.environment}-alb\"\n"], [32, "  internal           = false\n"], [33, "  load_balancer_type = \"application\"\n"], [34, "  security_groups    = [var.alb_security_group]\n"], [35, "  subnets            = var.public_subnets\n"], [36, "\n"], [37, "  enable_deletion_protection = false\n"], [38, "\n"], [39, "  tags = {\n"], [40, "    Name        = \"${var.project}-${var.environment}-alb\"\n"], [41, "    Environment = var.environment\n"], [42, "    Project     = var.project\n"], [43, "  }\n"], [44, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [30, 44], "resource": "module.ecs_jenkins_github.module.ecs.aws_lb.alb", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-alb", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-public-facing-alb-are-protected-by-waf", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV2_AWS_28", "bc_check_id": "BC_AWS_NETWORKING_58", "check_name": "Ensure public facing ALB are protected by WAF", "check_result": {"result": "FAILED", "entity": {"aws_lb": {"alb": {"__end_line__": 44, "__start_line__": 30, "enable_deletion_protection": [false], "internal": [false], "load_balancer_type": ["application"], "name": ["ecs-jenkins-dr-alb"], "security_groups": [[["aws_security_group.alb_security_group.id"]]], "subnets": ["aws_subnet.public_subnet.*.id"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-alb", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.ecs.aws_lb.alb"}}}, "evaluated_keys": ["resource_type", "load_balancer_type", "internal"]}, "code_block": [[30, "resource \"aws_lb\" \"alb\" {\n"], [31, "  name               = \"${var.project}-${var.environment}-alb\"\n"], [32, "  internal           = false\n"], [33, "  load_balancer_type = \"application\"\n"], [34, "  security_groups    = [var.alb_security_group]\n"], [35, "  subnets            = var.public_subnets\n"], [36, "\n"], [37, "  enable_deletion_protection = false\n"], [38, "\n"], [39, "  tags = {\n"], [40, "    Name        = \"${var.project}-${var.environment}-alb\"\n"], [41, "    Environment = var.environment\n"], [42, "    Project     = var.project\n"], [43, "  }\n"], [44, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [30, 44], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_lb.alb", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-alb", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-public-facing-alb-are-protected-by-waf", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV2_AWS_34", "bc_check_id": "BC_AWS_GENERAL_143", "check_name": "AWS SSM Parameter should be Encrypted", "check_result": {"result": "FAILED", "entity": {"aws_ssm_parameter": {"jenkins_url": {"__end_line__": 259, "__start_line__": 248, "description": ["Jenkins URL"], "name": ["/ecs-jenkins/prod/jenkins-url"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-url", "Project": "ecs-jenkins"}], "type": ["String"], "value": ["http://${aws_lb.jenkins_nlb.dns_name}"], "__address__": "module.ecs_jenkins_github.module.cicd.aws_ssm_parameter.jenkins_url"}}}, "evaluated_keys": ["type"]}, "code_block": [[248, "resource \"aws_ssm_parameter\" \"jenkins_url\" {\n"], [249, "  name        = \"/${var.project}/${var.environment}/jenkins-url\"\n"], [250, "  description = \"Jenkins URL\"\n"], [251, "  type        = \"String\"\n"], [252, "  value       = \"http://${aws_lb.jenkins_nlb.dns_name}\"\n"], [253, "\n"], [254, "  tags = {\n"], [255, "    Name        = \"${var.project}-${var.environment}-jenkins-url\"\n"], [256, "    Environment = var.environment\n"], [257, "    Project     = var.project\n"], [258, "  }\n"], [259, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [248, 259], "resource": "module.ecs_jenkins_github.module.cicd.aws_ssm_parameter.jenkins_url", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins-url", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-ssm-parameter-is-encrypted", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV2_AWS_34", "bc_check_id": "BC_AWS_GENERAL_143", "check_name": "AWS SSM Parameter should be Encrypted", "check_result": {"result": "FAILED", "entity": {"aws_ssm_parameter": {"jenkins_url": {"__end_line__": 259, "__start_line__": 248, "description": ["Jenkins URL"], "name": ["/ecs-jenkins/dr/jenkins-url"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-url", "Project": "ecs-jenkins"}], "type": ["String"], "value": ["http://${aws_lb.jenkins_nlb.dns_name}"], "__address__": "module.ecs_jenkins_github_dr.module.cicd.aws_ssm_parameter.jenkins_url"}}}, "evaluated_keys": ["type"]}, "code_block": [[248, "resource \"aws_ssm_parameter\" \"jenkins_url\" {\n"], [249, "  name        = \"/${var.project}/${var.environment}/jenkins-url\"\n"], [250, "  description = \"Jenkins URL\"\n"], [251, "  type        = \"String\"\n"], [252, "  value       = \"http://${aws_lb.jenkins_nlb.dns_name}\"\n"], [253, "\n"], [254, "  tags = {\n"], [255, "    Name        = \"${var.project}-${var.environment}-jenkins-url\"\n"], [256, "    Environment = var.environment\n"], [257, "    Project     = var.project\n"], [258, "  }\n"], [259, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [248, 259], "resource": "module.ecs_jenkins_github_dr.module.cicd.aws_ssm_parameter.jenkins_url", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins-url", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-ssm-parameter-is-encrypted", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV2_AWS_34", "bc_check_id": "BC_AWS_GENERAL_143", "check_name": "AWS SSM Parameter should be Encrypted", "check_result": {"result": "FAILED", "entity": {"aws_ssm_parameter": {"failover_mode": {"__end_line__": 92, "__start_line__": 82, "name": ["/${var.project}/${var.environment}/failover-mode"], "provider": ["aws.primary"], "tags": [{"Environment": "var.environment", "Project": "var.project"}], "type": ["String"], "value": ["normal"], "__address__": "aws_ssm_parameter.failover_mode"}}}, "evaluated_keys": ["type"]}, "code_block": [[82, "resource \"aws_ssm_parameter\" \"failover_mode\" {\n"], [83, "  provider = aws.primary\n"], [84, "  name     = \"/${var.project}/${var.environment}/failover-mode\"\n"], [85, "  type     = \"String\"\n"], [86, "  value    = \"normal\" # Can be \"normal\", \"test\", \"activate_dr\", \"restore\"\n"], [87, "\n"], [88, "  tags = {\n"], [89, "    Environment = var.environment\n"], [90, "    Project     = var.project\n"], [91, "  }\n"], [92, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\multi-region\\main.tf", "repo_file_path": "/modules/multi-region/main.tf", "file_line_range": [82, 92], "resource": "aws_ssm_parameter.failover_mode", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Project": "var.project"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-ssm-parameter-is-encrypted", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\multi-region\\main.tf"}, {"check_id": "CKV2_AWS_34", "bc_check_id": "BC_AWS_GENERAL_143", "check_name": "AWS SSM Parameter should be Encrypted", "check_result": {"result": "FAILED", "entity": {"aws_ssm_parameter": {"replication_status": {"__end_line__": 105, "__start_line__": 95, "name": ["/${var.project}/${var.environment}/replication-status"], "provider": ["aws.primary"], "tags": [{"Environment": "var.environment", "Project": "var.project"}], "type": ["String"], "value": ["healthy"], "__address__": "aws_ssm_parameter.replication_status"}}}, "evaluated_keys": ["type"]}, "code_block": [[95, "resource \"aws_ssm_parameter\" \"replication_status\" {\n"], [96, "  provider = aws.primary\n"], [97, "  name     = \"/${var.project}/${var.environment}/replication-status\"\n"], [98, "  type     = \"String\"\n"], [99, "  value    = \"healthy\" # Status of data replication between regions\n"], [100, "\n"], [101, "  tags = {\n"], [102, "    Environment = var.environment\n"], [103, "    Project     = var.project\n"], [104, "  }\n"], [105, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\multi-region\\main.tf", "repo_file_path": "/modules/multi-region/main.tf", "file_line_range": [95, 105], "resource": "aws_ssm_parameter.replication_status", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Project": "var.project"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-ssm-parameter-is-encrypted", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\multi-region\\main.tf"}, {"check_id": "CKV2_AWS_41", "bc_check_id": "BC_AWS_IAM_69", "check_name": "Ensure an IAM role is attached to EC2 instance", "check_result": {"result": "FAILED", "entity": {"aws_instance": {"jenkins[0]": {"__end_line__": 186, "__start_line__": 159, "ami": ["data.aws_ami.amazon_linux_2.id"], "instance_type": ["t3.medium"], "key_name": [""], "subnet_id": ["${${aws_subnet.public_subnet.*.id}[\"0\"]}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins", "Project": "ecs-jenkins"}], "user_data": ["#!/bin/bash\nsudo yum update -y\nsudo amazon-linux-extras install java-openjdk11 -y\nsudo yum install -y jenkins git docker\nsudo systemctl start jenkins\nsudo systemctl enable jenkins\nsudo systemctl start docker\nsudo systemctl enable docker\nsudo usermod -aG docker jenkins\nsudo systemctl restart jenkins"], "vpc_security_group_ids": [[""]], "__address__": "module.ecs_jenkins_github.module.ecs.aws_instance.jenkins[0]"}}}, "evaluated_keys": ["iam_instance_profile"]}, "code_block": [[159, "resource \"aws_instance\" \"jenkins\" {\n"], [160, "  count = var.create_jenkins ? 1 : 0\n"], [161, "\n"], [162, "  ami                    = data.aws_ami.amazon_linux_2.id\n"], [163, "  instance_type          = \"t3.medium\"\n"], [164, "  subnet_id              = var.public_subnets[0]\n"], [165, "  vpc_security_group_ids = [var.jenkins_security_group]\n"], [166, "  key_name               = var.key_name\n"], [167, "\n"], [168, "  user_data = <<-EOF\n"], [169, "    #!/bin/bash\n"], [170, "    sudo yum update -y\n"], [171, "    sudo amazon-linux-extras install java-openjdk11 -y\n"], [172, "    sudo yum install -y jenkins git docker\n"], [173, "    sudo systemctl start jenkins\n"], [174, "    sudo systemctl enable jenkins\n"], [175, "    sudo systemctl start docker\n"], [176, "    sudo systemctl enable docker\n"], [177, "    sudo usermod -aG docker jenkins\n"], [178, "    sudo systemctl restart jenkins\n"], [179, "  EOF\n"], [180, "\n"], [181, "  tags = {\n"], [182, "    Name        = \"${var.project}-${var.environment}-jenkins\"\n"], [183, "    Environment = var.environment\n"], [184, "    Project     = var.project\n"], [185, "  }\n"], [186, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [159, 186], "resource": "module.ecs_jenkins_github.module.ecs.aws_instance.jenkins[0]", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-jenkins", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-an-iam-role-is-attached-to-ec2-instance", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV2_AWS_41", "bc_check_id": "BC_AWS_IAM_69", "check_name": "Ensure an IAM role is attached to EC2 instance", "check_result": {"result": "FAILED", "entity": {"aws_instance": {"jenkins[0]": {"__end_line__": 186, "__start_line__": 159, "ami": ["data.aws_ami.amazon_linux_2.id"], "instance_type": ["t3.medium"], "key_name": [""], "subnet_id": ["${${aws_subnet.public_subnet.*.id}[\"0\"]}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins", "Project": "ecs-jenkins"}], "user_data": ["#!/bin/bash\nsudo yum update -y\nsudo amazon-linux-extras install java-openjdk11 -y\nsudo yum install -y jenkins git docker\nsudo systemctl start jenkins\nsudo systemctl enable jenkins\nsudo systemctl start docker\nsudo systemctl enable docker\nsudo usermod -aG docker jenkins\nsudo systemctl restart jenkins"], "vpc_security_group_ids": [[""]], "__address__": "module.ecs_jenkins_github_dr.module.ecs.aws_instance.jenkins[0]"}}}, "evaluated_keys": ["iam_instance_profile"]}, "code_block": [[159, "resource \"aws_instance\" \"jenkins\" {\n"], [160, "  count = var.create_jenkins ? 1 : 0\n"], [161, "\n"], [162, "  ami                    = data.aws_ami.amazon_linux_2.id\n"], [163, "  instance_type          = \"t3.medium\"\n"], [164, "  subnet_id              = var.public_subnets[0]\n"], [165, "  vpc_security_group_ids = [var.jenkins_security_group]\n"], [166, "  key_name               = var.key_name\n"], [167, "\n"], [168, "  user_data = <<-EOF\n"], [169, "    #!/bin/bash\n"], [170, "    sudo yum update -y\n"], [171, "    sudo amazon-linux-extras install java-openjdk11 -y\n"], [172, "    sudo yum install -y jenkins git docker\n"], [173, "    sudo systemctl start jenkins\n"], [174, "    sudo systemctl enable jenkins\n"], [175, "    sudo systemctl start docker\n"], [176, "    sudo systemctl enable docker\n"], [177, "    sudo usermod -aG docker jenkins\n"], [178, "    sudo systemctl restart jenkins\n"], [179, "  EOF\n"], [180, "\n"], [181, "  tags = {\n"], [182, "    Name        = \"${var.project}-${var.environment}-jenkins\"\n"], [183, "    Environment = var.environment\n"], [184, "    Project     = var.project\n"], [185, "  }\n"], [186, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [159, 186], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_instance.jenkins[0]", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-jenkins", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-an-iam-role-is-attached-to-ec2-instance", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV2_AWS_48", "bc_check_id": "BC_AWS_GENERAL_183", "check_name": "Ensure AWS Config must record all possible resources", "check_result": {"result": "FAILED", "entity": {"aws_config_configuration_recorder": {"recorder": {"__end_line__": 313, "__start_line__": 296, "name": ["ecs-jenkins-prod-config-recorder"], "recording_group": [{"all_supported": [true], "resource_types": [["AWS::EC2::Instance", "AWS::EC2::SecurityGroup", "AWS::ECS::Cluster", "AWS::ElasticLoadBalancingV2::LoadBalancer", "AWS::IAM::Policy", "AWS::IAM::Role", "AWS::RDS::DBInstance", "AWS::S3::Bucket"]]}], "role_arn": ["aws_iam_role.config_role.arn"], "__address__": "module.ecs_jenkins_github.module.security.aws_config_configuration_recorder.recorder"}}}, "evaluated_keys": ["recording_group/include_global_resource_types"]}, "code_block": [[296, "resource \"aws_config_configuration_recorder\" \"recorder\" {\n"], [297, "  name     = \"${var.project}-${var.environment}-config-recorder\"\n"], [298, "  role_arn = aws_iam_role.config_role.arn\n"], [299, "\n"], [300, "  recording_group {\n"], [301, "    all_supported = true\n"], [302, "    resource_types = [\n"], [303, "      \"AWS::EC2::Instance\",\n"], [304, "      \"AWS::EC2::SecurityGroup\",\n"], [305, "      \"AWS::ECS::Cluster\",\n"], [306, "      \"AWS::ElasticLoadBalancingV2::LoadBalancer\",\n"], [307, "      \"AWS::S3::Bucket\",\n"], [308, "      \"AWS::RDS::DBInstance\",\n"], [309, "      \"AWS::IAM::Role\",\n"], [310, "      \"AWS::IAM::Policy\"\n"], [311, "    ]\n"], [312, "  }\n"], [313, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [296, 313], "resource": "module.ecs_jenkins_github.module.security.aws_config_configuration_recorder.recorder", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-config-must-record-all-possible-resources", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV2_AWS_48", "bc_check_id": "BC_AWS_GENERAL_183", "check_name": "Ensure AWS Config must record all possible resources", "check_result": {"result": "FAILED", "entity": {"aws_config_configuration_recorder": {"recorder": {"__end_line__": 313, "__start_line__": 296, "name": ["ecs-jenkins-dr-config-recorder"], "recording_group": [{"all_supported": [true], "resource_types": [["AWS::EC2::Instance", "AWS::EC2::SecurityGroup", "AWS::ECS::Cluster", "AWS::ElasticLoadBalancingV2::LoadBalancer", "AWS::IAM::Policy", "AWS::IAM::Role", "AWS::RDS::DBInstance", "AWS::S3::Bucket"]]}], "role_arn": ["aws_iam_role.config_role.arn"], "__address__": "module.ecs_jenkins_github_dr.module.security.aws_config_configuration_recorder.recorder"}}}, "evaluated_keys": ["recording_group/include_global_resource_types"]}, "code_block": [[296, "resource \"aws_config_configuration_recorder\" \"recorder\" {\n"], [297, "  name     = \"${var.project}-${var.environment}-config-recorder\"\n"], [298, "  role_arn = aws_iam_role.config_role.arn\n"], [299, "\n"], [300, "  recording_group {\n"], [301, "    all_supported = true\n"], [302, "    resource_types = [\n"], [303, "      \"AWS::EC2::Instance\",\n"], [304, "      \"AWS::EC2::SecurityGroup\",\n"], [305, "      \"AWS::ECS::Cluster\",\n"], [306, "      \"AWS::ElasticLoadBalancingV2::LoadBalancer\",\n"], [307, "      \"AWS::S3::Bucket\",\n"], [308, "      \"AWS::RDS::DBInstance\",\n"], [309, "      \"AWS::IAM::Role\",\n"], [310, "      \"AWS::IAM::Policy\"\n"], [311, "    ]\n"], [312, "  }\n"], [313, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [296, 313], "resource": "module.ecs_jenkins_github_dr.module.security.aws_config_configuration_recorder.recorder", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-config-must-record-all-possible-resources", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_103", "bc_check_id": "BC_AWS_GENERAL_43", "check_name": "Ensure that load balancer is using at least TLS 1.2", "check_result": {"result": "FAILED", "entity": {"aws_lb_listener": {"http": {"__end_line__": 87, "__start_line__": 72, "default_action": [{"target_group_arn": ["aws_lb_target_group.target_group.arn"], "type": ["forward"]}], "load_balancer_arn": ["aws_lb.alb.arn"], "port": [80], "protocol": ["HTTP"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-http-listener", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.ecs.aws_lb_listener.http"}}}, "evaluated_keys": ["ssl_policy", "default_action/redirect/protocol", "load_balancer_type", "protocol", "resource_type", "default_action/type"]}, "code_block": [[72, "resource \"aws_lb_listener\" \"http\" {\n"], [73, "  load_balancer_arn = aws_lb.alb.arn\n"], [74, "  port              = 80\n"], [75, "  protocol          = \"HTTP\"\n"], [76, "\n"], [77, "  default_action {\n"], [78, "    type             = \"forward\"\n"], [79, "    target_group_arn = aws_lb_target_group.target_group.arn\n"], [80, "  }\n"], [81, "\n"], [82, "  tags = {\n"], [83, "    Name        = \"${var.project}-${var.environment}-http-listener\"\n"], [84, "    Environment = var.environment\n"], [85, "    Project     = var.project\n"], [86, "  }\n"], [87, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [72, 87], "resource": "module.ecs_jenkins_github.module.ecs.aws_lb_listener.http", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-http-listener", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-43", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_103", "bc_check_id": "BC_AWS_GENERAL_43", "check_name": "Ensure that load balancer is using at least TLS 1.2", "check_result": {"result": "FAILED", "entity": {"aws_lb_listener": {"http": {"__end_line__": 87, "__start_line__": 72, "default_action": [{"target_group_arn": ["aws_lb_target_group.target_group.arn"], "type": ["forward"]}], "load_balancer_arn": ["aws_lb.alb.arn"], "port": [80], "protocol": ["HTTP"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-http-listener", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.ecs.aws_lb_listener.http"}}}, "evaluated_keys": ["ssl_policy", "default_action/redirect/protocol", "load_balancer_type", "protocol", "resource_type", "default_action/type"]}, "code_block": [[72, "resource \"aws_lb_listener\" \"http\" {\n"], [73, "  load_balancer_arn = aws_lb.alb.arn\n"], [74, "  port              = 80\n"], [75, "  protocol          = \"HTTP\"\n"], [76, "\n"], [77, "  default_action {\n"], [78, "    type             = \"forward\"\n"], [79, "    target_group_arn = aws_lb_target_group.target_group.arn\n"], [80, "  }\n"], [81, "\n"], [82, "  tags = {\n"], [83, "    Name        = \"${var.project}-${var.environment}-http-listener\"\n"], [84, "    Environment = var.environment\n"], [85, "    Project     = var.project\n"], [86, "  }\n"], [87, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [72, 87], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_lb_listener.http", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-http-listener", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-43", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV2_AWS_3", "bc_check_id": "BC_AWS_GENERAL_66", "check_name": "Ensure GuardDuty is enabled to specific org/region", "check_result": {"result": "FAILED", "entity": {"aws_guardduty_detector": {"security_detector": {"__end_line__": 527, "__start_line__": 517, "enable": [true], "finding_publishing_frequency": ["SIX_HOURS"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-guardduty", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.security.aws_guardduty_detector.security_detector"}}}, "evaluated_keys": ["enable", "auto_enable_organization_members", "resource_type", "auto_enable"]}, "code_block": [[517, "resource \"aws_guardduty_detector\" \"security_detector\" {\n"], [518, "  enable = true\n"], [519, "\n"], [520, "  finding_publishing_frequency = \"SIX_HOURS\"\n"], [521, "\n"], [522, "  tags = {\n"], [523, "    Name        = \"${var.project}-${var.environment}-guardduty\"\n"], [524, "    Environment = var.environment\n"], [525, "    Project     = var.project\n"], [526, "  }\n"], [527, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [517, 527], "resource": "module.ecs_jenkins_github.module.security.aws_guardduty_detector.security_detector", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-guardduty", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-guardduty-is-enabled-to-specific-orgregion", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV2_AWS_3", "bc_check_id": "BC_AWS_GENERAL_66", "check_name": "Ensure GuardDuty is enabled to specific org/region", "check_result": {"result": "FAILED", "entity": {"aws_guardduty_detector": {"security_detector": {"__end_line__": 527, "__start_line__": 517, "enable": [true], "finding_publishing_frequency": ["SIX_HOURS"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-guardduty", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.security.aws_guardduty_detector.security_detector"}}}, "evaluated_keys": ["enable", "auto_enable_organization_members", "resource_type", "auto_enable"]}, "code_block": [[517, "resource \"aws_guardduty_detector\" \"security_detector\" {\n"], [518, "  enable = true\n"], [519, "\n"], [520, "  finding_publishing_frequency = \"SIX_HOURS\"\n"], [521, "\n"], [522, "  tags = {\n"], [523, "    Name        = \"${var.project}-${var.environment}-guardduty\"\n"], [524, "    Environment = var.environment\n"], [525, "    Project     = var.project\n"], [526, "  }\n"], [527, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [517, 527], "resource": "module.ecs_jenkins_github_dr.module.security.aws_guardduty_detector.security_detector", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-guardduty", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-guardduty-is-enabled-to-specific-orgregion", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV2_AWS_15", "bc_check_id": "BC_AWS_NETWORKING_46", "check_name": "Ensure that auto Scaling groups that are associated with a load balancer are using Elastic Load Balancing health checks.", "check_result": {"result": "FAILED", "entity": {"aws_autoscaling_attachment": {"jenkins": {"__end_line__": 216, "__start_line__": 213, "autoscaling_group_name": ["ecs-jenkins-prod-jenkins-asg"], "lb_target_group_arn": ["aws_lb_target_group.jenkins.arn"], "__address__": "module.ecs_jenkins_github.module.cicd.aws_autoscaling_attachment.jenkins"}}}, "evaluated_keys": ["health_check", "resource_type", "health_check_type"]}, "code_block": [[213, "resource \"aws_autoscaling_attachment\" \"jenkins\" {\n"], [214, "  autoscaling_group_name = aws_autoscaling_group.jenkins.name\n"], [215, "  lb_target_group_arn    = aws_lb_target_group.jenkins.arn\n"], [216, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [213, 216], "resource": "module.ecs_jenkins_github.module.cicd.aws_autoscaling_attachment.jenkins", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-auto-scaling-groups-that-are-associated-with-a-load-balancer-are-using-elastic-load-balancing-health-checks", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV2_AWS_15", "bc_check_id": "BC_AWS_NETWORKING_46", "check_name": "Ensure that auto Scaling groups that are associated with a load balancer are using Elastic Load Balancing health checks.", "check_result": {"result": "FAILED", "entity": {"aws_autoscaling_attachment": {"jenkins": {"__end_line__": 216, "__start_line__": 213, "autoscaling_group_name": ["ecs-jenkins-dr-jenkins-asg"], "lb_target_group_arn": ["aws_lb_target_group.jenkins.arn"], "__address__": "module.ecs_jenkins_github_dr.module.cicd.aws_autoscaling_attachment.jenkins"}}}, "evaluated_keys": ["health_check", "resource_type", "health_check_type"]}, "code_block": [[213, "resource \"aws_autoscaling_attachment\" \"jenkins\" {\n"], [214, "  autoscaling_group_name = aws_autoscaling_group.jenkins.name\n"], [215, "  lb_target_group_arn    = aws_lb_target_group.jenkins.arn\n"], [216, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf", "repo_file_path": "/modules/cicd/main.tf", "file_line_range": [213, 216], "resource": "module.ecs_jenkins_github_dr.module.cicd.aws_autoscaling_attachment.jenkins", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-auto-scaling-groups-that-are-associated-with-a-load-balancer-are-using-elastic-load-balancing-health-checks", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\cicd\\main.tf"}, {"check_id": "CKV2_AWS_62", "bc_check_id": "BC_AWS_LOGGING_36", "check_name": "Ensure S3 buckets should have event notifications enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"patch_logs": {"__end_line__": 207, "__start_line__": 199, "bucket": ["ecs-jenkins-prod-patch-logs-${random_string.suffix.result}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-patch-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.ec2.aws_s3_bucket.patch_logs"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[199, "resource \"aws_s3_bucket\" \"patch_logs\" {\n"], [200, "  bucket = \"${var.project}-${var.environment}-patch-logs-${random_string.suffix.result}\"\n"], [201, "\n"], [202, "  tags = {\n"], [203, "    Name        = \"${var.project}-${var.environment}-patch-logs\"\n"], [204, "    Environment = var.environment\n"], [205, "    Project     = var.project\n"], [206, "  }\n"], [207, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [199, 207], "resource": "module.ecs_jenkins_github.module.ec2.aws_s3_bucket.patch_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-patch-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV2_AWS_62", "bc_check_id": "BC_AWS_LOGGING_36", "check_name": "Ensure S3 buckets should have event notifications enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"patch_logs": {"__end_line__": 207, "__start_line__": 199, "bucket": ["ecs-jenkins-dr-patch-logs-${random_string.suffix.result}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-patch-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.ec2.aws_s3_bucket.patch_logs"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[199, "resource \"aws_s3_bucket\" \"patch_logs\" {\n"], [200, "  bucket = \"${var.project}-${var.environment}-patch-logs-${random_string.suffix.result}\"\n"], [201, "\n"], [202, "  tags = {\n"], [203, "    Name        = \"${var.project}-${var.environment}-patch-logs\"\n"], [204, "    Environment = var.environment\n"], [205, "    Project     = var.project\n"], [206, "  }\n"], [207, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [199, 207], "resource": "module.ecs_jenkins_github_dr.module.ec2.aws_s3_bucket.patch_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-patch-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV2_AWS_62", "bc_check_id": "BC_AWS_LOGGING_36", "check_name": "Ensure S3 buckets should have event notifications enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"lambda_code": {"__end_line__": 18, "__start_line__": 10, "bucket": ["${var.project}-${var.environment}-lambda-${random_string.bucket_suffix.result}"], "tags": [{"Environment": "var.environment", "Name": "${var.project}-${var.environment}-lambda", "Project": "var.project"}], "__address__": "module.lambda_failover.aws_s3_bucket.lambda_code"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[10, "resource \"aws_s3_bucket\" \"lambda_code\" {\n"], [11, "  bucket = \"${var.project}-${var.environment}-lambda-${random_string.bucket_suffix.result}\"\n"], [12, "\n"], [13, "  tags = {\n"], [14, "    Name        = \"${var.project}-${var.environment}-lambda\"\n"], [15, "    Environment = var.environment\n"], [16, "    Project     = var.project\n"], [17, "  }\n"], [18, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [10, 18], "resource": "module.lambda_failover.aws_s3_bucket.lambda_code", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Name": "${var.project}-${var.environment}-lambda", "Project": "var.project"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV2_AWS_62", "bc_check_id": "BC_AWS_LOGGING_36", "check_name": "Ensure S3 buckets should have event notifications enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"alb_logs": {"__end_line__": 134, "__start_line__": 126, "bucket": ["alb-logs-prod-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "prod", "Name": "alb-access-logs"}], "__address__": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[126, "resource \"aws_s3_bucket\" \"alb_logs\" {\n"], [127, "  bucket        = \"alb-logs-${var.environment}-${random_string.suffix.result}\"\n"], [128, "  force_destroy = true\n"], [129, "\n"], [130, "  tags = {\n"], [131, "    Name        = \"alb-access-logs\"\n"], [132, "    Environment = var.environment\n"], [133, "  }\n"], [134, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [126, 134], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "alb-access-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_62", "bc_check_id": "BC_AWS_LOGGING_36", "check_name": "Ensure S3 buckets should have event notifications enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"alb_logs_access_logs": {"__end_line__": 145, "__start_line__": 137, "bucket": ["alb-logs-access-prod-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "prod", "Name": "alb-access-logs-access"}], "__address__": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs_access_logs"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[137, "resource \"aws_s3_bucket\" \"alb_logs_access_logs\" {\n"], [138, "  bucket        = \"alb-logs-access-${var.environment}-${random_string.suffix.result}\"\n"], [139, "  force_destroy = true\n"], [140, "\n"], [141, "  tags = {\n"], [142, "    Name        = \"alb-access-logs-access\"\n"], [143, "    Environment = var.environment\n"], [144, "  }\n"], [145, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [137, 145], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs_access_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "alb-access-logs-access"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_62", "bc_check_id": "BC_AWS_LOGGING_36", "check_name": "Ensure S3 buckets should have event notifications enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"replication_logs": {"__end_line__": 156, "__start_line__": 148, "bucket": ["replication-logs-prod-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "prod", "Name": "replication-logs"}], "__address__": "module.ecs_jenkins_github.module.network.aws_s3_bucket.replication_logs"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[148, "resource \"aws_s3_bucket\" \"replication_logs\" {\n"], [149, "  bucket        = \"replication-logs-${var.environment}-${random_string.suffix.result}\"\n"], [150, "  force_destroy = true\n"], [151, "\n"], [152, "  tags = {\n"], [153, "    Name        = \"replication-logs\"\n"], [154, "    Environment = var.environment\n"], [155, "  }\n"], [156, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [148, 156], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.replication_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "replication-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_62", "bc_check_id": "BC_AWS_LOGGING_36", "check_name": "Ensure S3 buckets should have event notifications enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"alb_logs": {"__end_line__": 134, "__start_line__": 126, "bucket": ["alb-logs-dr-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "dr", "Name": "alb-access-logs"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[126, "resource \"aws_s3_bucket\" \"alb_logs\" {\n"], [127, "  bucket        = \"alb-logs-${var.environment}-${random_string.suffix.result}\"\n"], [128, "  force_destroy = true\n"], [129, "\n"], [130, "  tags = {\n"], [131, "    Name        = \"alb-access-logs\"\n"], [132, "    Environment = var.environment\n"], [133, "  }\n"], [134, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [126, 134], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "alb-access-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_62", "bc_check_id": "BC_AWS_LOGGING_36", "check_name": "Ensure S3 buckets should have event notifications enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"alb_logs_access_logs": {"__end_line__": 145, "__start_line__": 137, "bucket": ["alb-logs-access-dr-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "dr", "Name": "alb-access-logs-access"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs_access_logs"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[137, "resource \"aws_s3_bucket\" \"alb_logs_access_logs\" {\n"], [138, "  bucket        = \"alb-logs-access-${var.environment}-${random_string.suffix.result}\"\n"], [139, "  force_destroy = true\n"], [140, "\n"], [141, "  tags = {\n"], [142, "    Name        = \"alb-access-logs-access\"\n"], [143, "    Environment = var.environment\n"], [144, "  }\n"], [145, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [137, 145], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs_access_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "alb-access-logs-access"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_62", "bc_check_id": "BC_AWS_LOGGING_36", "check_name": "Ensure S3 buckets should have event notifications enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"replication_logs": {"__end_line__": 156, "__start_line__": 148, "bucket": ["replication-logs-dr-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "dr", "Name": "replication-logs"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.replication_logs"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[148, "resource \"aws_s3_bucket\" \"replication_logs\" {\n"], [149, "  bucket        = \"replication-logs-${var.environment}-${random_string.suffix.result}\"\n"], [150, "  force_destroy = true\n"], [151, "\n"], [152, "  tags = {\n"], [153, "    Name        = \"replication-logs\"\n"], [154, "    Environment = var.environment\n"], [155, "  }\n"], [156, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [148, 156], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.replication_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "replication-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_62", "bc_check_id": "BC_AWS_LOGGING_36", "check_name": "Ensure S3 buckets should have event notifications enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"config_bucket": {"__end_line__": 339, "__start_line__": 330, "bucket": ["ecs-jenkins-prod-config-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-config-bucket", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.security.aws_s3_bucket.config_bucket"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[330, "resource \"aws_s3_bucket\" \"config_bucket\" {\n"], [331, "  bucket        = \"${var.project}-${var.environment}-config-${random_string.bucket_suffix.result}\"\n"], [332, "  force_destroy = var.environment != \"prod\"\n"], [333, "\n"], [334, "  tags = {\n"], [335, "    Name        = \"${var.project}-${var.environment}-config-bucket\"\n"], [336, "    Environment = var.environment\n"], [337, "    Project     = var.project\n"], [338, "  }\n"], [339, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [330, 339], "resource": "module.ecs_jenkins_github.module.security.aws_s3_bucket.config_bucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-config-bucket", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV2_AWS_62", "bc_check_id": "BC_AWS_LOGGING_36", "check_name": "Ensure S3 buckets should have event notifications enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"waf_logs": {"__end_line__": 568, "__start_line__": 559, "bucket": ["ecs-jenkins-prod-waf-logs-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-waf-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.security.aws_s3_bucket.waf_logs"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[559, "resource \"aws_s3_bucket\" \"waf_logs\" {\n"], [560, "  bucket        = \"${var.project}-${var.environment}-waf-logs-${random_string.bucket_suffix.result}\"\n"], [561, "  force_destroy = var.environment != \"prod\"\n"], [562, "\n"], [563, "  tags = {\n"], [564, "    Name        = \"${var.project}-${var.environment}-waf-logs\"\n"], [565, "    Environment = var.environment\n"], [566, "    Project     = var.project\n"], [567, "  }\n"], [568, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [559, 568], "resource": "module.ecs_jenkins_github.module.security.aws_s3_bucket.waf_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-waf-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV2_AWS_62", "bc_check_id": "BC_AWS_LOGGING_36", "check_name": "Ensure S3 buckets should have event notifications enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"config_bucket": {"__end_line__": 339, "__start_line__": 330, "bucket": ["ecs-jenkins-dr-config-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-config-bucket", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.config_bucket"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[330, "resource \"aws_s3_bucket\" \"config_bucket\" {\n"], [331, "  bucket        = \"${var.project}-${var.environment}-config-${random_string.bucket_suffix.result}\"\n"], [332, "  force_destroy = var.environment != \"prod\"\n"], [333, "\n"], [334, "  tags = {\n"], [335, "    Name        = \"${var.project}-${var.environment}-config-bucket\"\n"], [336, "    Environment = var.environment\n"], [337, "    Project     = var.project\n"], [338, "  }\n"], [339, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [330, 339], "resource": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.config_bucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-config-bucket", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV2_AWS_62", "bc_check_id": "BC_AWS_LOGGING_36", "check_name": "Ensure S3 buckets should have event notifications enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"waf_logs": {"__end_line__": 568, "__start_line__": 559, "bucket": ["ecs-jenkins-dr-waf-logs-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-waf-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.waf_logs"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[559, "resource \"aws_s3_bucket\" \"waf_logs\" {\n"], [560, "  bucket        = \"${var.project}-${var.environment}-waf-logs-${random_string.bucket_suffix.result}\"\n"], [561, "  force_destroy = var.environment != \"prod\"\n"], [562, "\n"], [563, "  tags = {\n"], [564, "    Name        = \"${var.project}-${var.environment}-waf-logs\"\n"], [565, "    Environment = var.environment\n"], [566, "    Project     = var.project\n"], [567, "  }\n"], [568, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [559, 568], "resource": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.waf_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-waf-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV2_AWS_38", "bc_check_id": "BC_AWS_NETWORKING_83", "check_name": "Ensure Domain Name System Security Extensions (DNSSEC) signing is enabled for Amazon Route 53 public hosted zones", "check_result": {"result": "FAILED", "entity": {"aws_route53_zone": {"main": {"__end_line__": 13, "__start_line__": 4, "name": ["var.domain_name"], "tags": [{"Environment": "var.environment", "ManagedBy": "Terraform", "Name": "${var.project}-${var.environment}-zone", "Project": "var.project"}], "__address__": "module.route53_failover.aws_route53_zone.main"}}}, "evaluated_keys": ["vpc", "resource_type"]}, "code_block": [[4, "resource \"aws_route53_zone\" \"main\" {\n"], [5, "  name = var.domain_name\n"], [6, "\n"], [7, "  tags = {\n"], [8, "    Name        = \"${var.project}-${var.environment}-zone\"\n"], [9, "    Environment = var.environment\n"], [10, "    Project     = var.project\n"], [11, "    ManagedBy   = \"Terraform\"\n"], [12, "  }\n"], [13, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\route53\\main.tf", "repo_file_path": "/modules/route53/main.tf", "file_line_range": [4, 13], "resource": "module.route53_failover.aws_route53_zone.main", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "ManagedBy": "Terraform", "Name": "${var.project}-${var.environment}-zone", "Project": "var.project"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-38", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\route53\\main.tf"}, {"check_id": "CKV2_AWS_64", "bc_check_id": "BC_AWS_IAM_76", "check_name": "Ensure KMS key Policy is defined", "check_result": {"result": "FAILED", "entity": {"aws_kms_key": {"s3_kms_key": {"__end_line__": 123, "__start_line__": 115, "deletion_window_in_days": [10], "description": ["KMS key for S3 bucket encryption"], "enable_key_rotation": [true], "tags": [{"Environment": "prod", "Name": "s3-kms-key-prod"}], "__address__": "module.ecs_jenkins_github.module.network.aws_kms_key.s3_kms_key"}}}, "evaluated_keys": ["resource_type", "policy"]}, "code_block": [[115, "resource \"aws_kms_key\" \"s3_kms_key\" {\n"], [116, "  description             = \"KMS key for S3 bucket encryption\"\n"], [117, "  deletion_window_in_days = 10\n"], [118, "  enable_key_rotation     = true\n"], [119, "  tags = {\n"], [120, "    Name        = \"s3-kms-key-${var.environment}\"\n"], [121, "    Environment = var.environment\n"], [122, "  }\n"], [123, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [115, 123], "resource": "module.ecs_jenkins_github.module.network.aws_kms_key.s3_kms_key", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "s3-kms-key-prod"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-64", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_64", "bc_check_id": "BC_AWS_IAM_76", "check_name": "Ensure KMS key Policy is defined", "check_result": {"result": "FAILED", "entity": {"aws_kms_key": {"logs_key": {"__end_line__": 423, "__start_line__": 419, "deletion_window_in_days": [30], "description": ["KMS key for VPC flow logs"], "enable_key_rotation": [true], "__address__": "module.ecs_jenkins_github.module.network.aws_kms_key.logs_key"}}}, "evaluated_keys": ["resource_type", "policy"]}, "code_block": [[419, "resource \"aws_kms_key\" \"logs_key\" {\n"], [420, "  description             = \"KMS key for VPC flow logs\"\n"], [421, "  deletion_window_in_days = 30\n"], [422, "  enable_key_rotation     = true\n"], [423, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [419, 423], "resource": "module.ecs_jenkins_github.module.network.aws_kms_key.logs_key", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-64", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_64", "bc_check_id": "BC_AWS_IAM_76", "check_name": "Ensure KMS key Policy is defined", "check_result": {"result": "FAILED", "entity": {"aws_kms_key": {"s3_kms_key": {"__end_line__": 123, "__start_line__": 115, "deletion_window_in_days": [10], "description": ["KMS key for S3 bucket encryption"], "enable_key_rotation": [true], "tags": [{"Environment": "dr", "Name": "s3-kms-key-dr"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_kms_key.s3_kms_key"}}}, "evaluated_keys": ["resource_type", "policy"]}, "code_block": [[115, "resource \"aws_kms_key\" \"s3_kms_key\" {\n"], [116, "  description             = \"KMS key for S3 bucket encryption\"\n"], [117, "  deletion_window_in_days = 10\n"], [118, "  enable_key_rotation     = true\n"], [119, "  tags = {\n"], [120, "    Name        = \"s3-kms-key-${var.environment}\"\n"], [121, "    Environment = var.environment\n"], [122, "  }\n"], [123, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [115, 123], "resource": "module.ecs_jenkins_github_dr.module.network.aws_kms_key.s3_kms_key", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "s3-kms-key-dr"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-64", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_64", "bc_check_id": "BC_AWS_IAM_76", "check_name": "Ensure KMS key Policy is defined", "check_result": {"result": "FAILED", "entity": {"aws_kms_key": {"logs_key": {"__end_line__": 423, "__start_line__": 419, "deletion_window_in_days": [30], "description": ["KMS key for VPC flow logs"], "enable_key_rotation": [true], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_kms_key.logs_key"}}}, "evaluated_keys": ["resource_type", "policy"]}, "code_block": [[419, "resource \"aws_kms_key\" \"logs_key\" {\n"], [420, "  description             = \"KMS key for VPC flow logs\"\n"], [421, "  deletion_window_in_days = 30\n"], [422, "  enable_key_rotation     = true\n"], [423, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [419, 423], "resource": "module.ecs_jenkins_github_dr.module.network.aws_kms_key.logs_key", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-64", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_39", "bc_check_id": "BC_AWS_LOGGING_34", "check_name": "Ensure Domain Name System (DNS) query logging is enabled for Amazon Route 53 hosted zones", "check_result": {"result": "FAILED", "entity": {"aws_route53_zone": {"main": {"__end_line__": 13, "__start_line__": 4, "name": ["var.domain_name"], "tags": [{"Environment": "var.environment", "ManagedBy": "Terraform", "Name": "${var.project}-${var.environment}-zone", "Project": "var.project"}], "__address__": "module.route53_failover.aws_route53_zone.main"}}}, "evaluated_keys": ["vpc", "resource_type"]}, "code_block": [[4, "resource \"aws_route53_zone\" \"main\" {\n"], [5, "  name = var.domain_name\n"], [6, "\n"], [7, "  tags = {\n"], [8, "    Name        = \"${var.project}-${var.environment}-zone\"\n"], [9, "    Environment = var.environment\n"], [10, "    Project     = var.project\n"], [11, "    ManagedBy   = \"Terraform\"\n"], [12, "  }\n"], [13, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\route53\\main.tf", "repo_file_path": "/modules/route53/main.tf", "file_line_range": [4, 13], "resource": "module.route53_failover.aws_route53_zone.main", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "ManagedBy": "Terraform", "Name": "${var.project}-${var.environment}-zone", "Project": "var.project"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-39", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\route53\\main.tf"}, {"check_id": "CKV2_AWS_5", "bc_check_id": "BC_AWS_NETWORKING_51", "check_name": "Ensure that Security Groups are attached to another resource", "check_result": {"result": "FAILED", "entity": {"aws_security_group": {"alb_security_group": {"__end_line__": 508, "__start_line__": 465, "description": ["Security group for application load balancer"], "egress": [{"cidr_blocks": [["10.1.0.0/16"]], "description": ["HTTP to ECS services"], "from_port": [80], "protocol": ["tcp"], "to_port": [80]}, {"cidr_blocks": [["0.0.0.0/0"]], "description": ["HTTPS to internet for external resources"], "from_port": [443], "protocol": ["tcp"], "to_port": [443]}], "ingress": [{"cidr_blocks": [["0.0.0.0/0"]], "description": ["HTTPS from internet"], "from_port": [443], "protocol": ["tcp"], "to_port": [443]}, {"cidr_blocks": [["0.0.0.0/0"]], "description": ["HTTP from internet (for redirection to HTTPS)"], "from_port": [80], "protocol": ["tcp"], "to_port": [80]}], "name": ["alb-security-group"], "tags": [{"Name": "alb-security-group"}], "vpc_id": ["aws_vpc.vpc.id"], "__address__": "module.ecs_jenkins_github.module.network.aws_security_group.alb_security_group"}}}, "evaluated_keys": ["resource_type", "networking"]}, "code_block": [[465, "resource \"aws_security_group\" \"alb_security_group\" {\n"], [466, "  name        = \"alb-security-group\"\n"], [467, "  description = \"Security group for application load balancer\"\n"], [468, "  vpc_id      = aws_vpc.vpc.id\n"], [469, "\n"], [470, "  # Allow incoming HTTPS traffic only\n"], [471, "  ingress {\n"], [472, "    description = \"HTTPS from internet\"\n"], [473, "    from_port   = 443\n"], [474, "    to_port     = 443\n"], [475, "    protocol    = \"tcp\"\n"], [476, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [477, "  }\n"], [478, "\n"], [479, "  # HTTP for redirection only (will be redirected to HTTPS)\n"], [480, "  ingress {\n"], [481, "    description = \"HTTP from internet (for redirection to HTTPS)\"\n"], [482, "    from_port   = 80\n"], [483, "    to_port     = 80\n"], [484, "    protocol    = \"tcp\"\n"], [485, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [486, "  }\n"], [487, "\n"], [488, "  # Restricted egress rules\n"], [489, "  egress {\n"], [490, "    description = \"HTTP to ECS services\"\n"], [491, "    from_port   = 80\n"], [492, "    to_port     = 80\n"], [493, "    protocol    = \"tcp\"\n"], [494, "    cidr_blocks = [aws_vpc.vpc.cidr_block] # Allow traffic to any private IP in the VPC\n"], [495, "  }\n"], [496, "\n"], [497, "  egress {\n"], [498, "    description = \"HTTPS to internet for external resources\"\n"], [499, "    from_port   = 443\n"], [500, "    to_port     = 443\n"], [501, "    protocol    = \"tcp\"\n"], [502, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [503, "  }\n"], [504, "\n"], [505, "  tags = {\n"], [506, "    Name = \"alb-security-group\"\n"], [507, "  }\n"], [508, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [465, 508], "resource": "module.ecs_jenkins_github.module.network.aws_security_group.alb_security_group", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "alb-security-group"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_5", "bc_check_id": "BC_AWS_NETWORKING_51", "check_name": "Ensure that Security Groups are attached to another resource", "check_result": {"result": "FAILED", "entity": {"aws_security_group": {"ecs_security_group": {"__end_line__": 554, "__start_line__": 511, "description": ["Security group for ECS Fargate tasks"], "egress": [{"cidr_blocks": [["0.0.0.0/0"]], "description": ["HTTPS to internet for external resources"], "from_port": [443], "protocol": ["tcp"], "to_port": [443]}, {"description": ["Database access"], "from_port": [5432], "protocol": ["tcp"], "security_groups": [["aws_security_group.db_security_group.id"]], "to_port": [5432]}], "ingress": [{"cidr_blocks": [["10.1.0.0/16"]], "description": ["HTTP from VPC"], "from_port": [80], "protocol": ["tcp"], "to_port": [80]}, {"description": ["Inter-container communication"], "from_port": [8080], "protocol": ["tcp"], "self": [true], "to_port": [8080]}], "name": ["ecs-security-group"], "tags": [{"Name": "ecs-security-group"}], "vpc_id": ["aws_vpc.vpc.id"], "__address__": "module.ecs_jenkins_github.module.network.aws_security_group.ecs_security_group"}}}, "evaluated_keys": ["resource_type", "networking"]}, "code_block": [[511, "resource \"aws_security_group\" \"ecs_security_group\" {\n"], [512, "  name        = \"ecs-security-group\"\n"], [513, "  description = \"Security group for ECS Fargate tasks\"\n"], [514, "  vpc_id      = aws_vpc.vpc.id\n"], [515, "\n"], [516, "  # Allow incoming HTTP traffic from VPC CIDR\n"], [517, "  ingress {\n"], [518, "    description = \"HTTP from VPC\"\n"], [519, "    from_port   = 80\n"], [520, "    to_port     = 80\n"], [521, "    protocol    = \"tcp\"\n"], [522, "    cidr_blocks = [aws_vpc.vpc.cidr_block]\n"], [523, "  }\n"], [524, "\n"], [525, "  # Allow internal traffic for service discovery\n"], [526, "  ingress {\n"], [527, "    description = \"Inter-container communication\"\n"], [528, "    from_port   = 8080\n"], [529, "    to_port     = 8080\n"], [530, "    protocol    = \"tcp\"\n"], [531, "    self        = true\n"], [532, "  }\n"], [533, "\n"], [534, "  # Restricted egress rules\n"], [535, "  egress {\n"], [536, "    description = \"HTTPS to internet for external resources\"\n"], [537, "    from_port   = 443\n"], [538, "    to_port     = 443\n"], [539, "    protocol    = \"tcp\"\n"], [540, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [541, "  }\n"], [542, "\n"], [543, "  egress {\n"], [544, "    description     = \"Database access\"\n"], [545, "    from_port       = 5432\n"], [546, "    to_port         = 5432\n"], [547, "    protocol        = \"tcp\"\n"], [548, "    security_groups = [aws_security_group.db_security_group.id]\n"], [549, "  }\n"], [550, "\n"], [551, "  tags = {\n"], [552, "    Name = \"ecs-security-group\"\n"], [553, "  }\n"], [554, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [511, 554], "resource": "module.ecs_jenkins_github.module.network.aws_security_group.ecs_security_group", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "ecs-security-group"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_5", "bc_check_id": "BC_AWS_NETWORKING_51", "check_name": "Ensure that Security Groups are attached to another resource", "check_result": {"result": "FAILED", "entity": {"aws_security_group": {"db_security_group": {"__end_line__": 583, "__start_line__": 557, "description": ["Security group for database instances"], "egress": [{"cidr_blocks": [["10.1.0.0/16"]], "description": ["Response traffic to VPC"], "from_port": [1024], "protocol": ["tcp"], "to_port": [65535]}], "ingress": [{"cidr_blocks": [["10.1.0.0/16"]], "description": ["Database port from VPC"], "from_port": [5432], "protocol": ["tcp"], "to_port": [5432]}], "name": ["db-security-group"], "tags": [{"Name": "db-security-group"}], "vpc_id": ["aws_vpc.vpc.id"], "__address__": "module.ecs_jenkins_github.module.network.aws_security_group.db_security_group"}}}, "evaluated_keys": ["resource_type", "networking"]}, "code_block": [[557, "resource \"aws_security_group\" \"db_security_group\" {\n"], [558, "  name        = \"db-security-group\"\n"], [559, "  description = \"Security group for database instances\"\n"], [560, "  vpc_id      = aws_vpc.vpc.id\n"], [561, "\n"], [562, "  # Allow incoming database traffic from VPC\n"], [563, "  ingress {\n"], [564, "    description = \"Database port from VPC\"\n"], [565, "    from_port   = 5432\n"], [566, "    to_port     = 5432\n"], [567, "    protocol    = \"tcp\"\n"], [568, "    cidr_blocks = [aws_vpc.vpc.cidr_block]\n"], [569, "  }\n"], [570, "\n"], [571, "  # Allow response traffic to VPC\n"], [572, "  egress {\n"], [573, "    description = \"Response traffic to VPC\"\n"], [574, "    from_port   = 1024\n"], [575, "    to_port     = 65535\n"], [576, "    protocol    = \"tcp\"\n"], [577, "    cidr_blocks = [aws_vpc.vpc.cidr_block]\n"], [578, "  }\n"], [579, "\n"], [580, "  tags = {\n"], [581, "    Name = \"db-security-group\"\n"], [582, "  }\n"], [583, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [557, 583], "resource": "module.ecs_jenkins_github.module.network.aws_security_group.db_security_group", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "db-security-group"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_5", "bc_check_id": "BC_AWS_NETWORKING_51", "check_name": "Ensure that Security Groups are attached to another resource", "check_result": {"result": "FAILED", "entity": {"aws_security_group": {"alb_security_group": {"__end_line__": 508, "__start_line__": 465, "description": ["Security group for application load balancer"], "egress": [{"cidr_blocks": [["10.2.0.0/16"]], "description": ["HTTP to ECS services"], "from_port": [80], "protocol": ["tcp"], "to_port": [80]}, {"cidr_blocks": [["0.0.0.0/0"]], "description": ["HTTPS to internet for external resources"], "from_port": [443], "protocol": ["tcp"], "to_port": [443]}], "ingress": [{"cidr_blocks": [["0.0.0.0/0"]], "description": ["HTTPS from internet"], "from_port": [443], "protocol": ["tcp"], "to_port": [443]}, {"cidr_blocks": [["0.0.0.0/0"]], "description": ["HTTP from internet (for redirection to HTTPS)"], "from_port": [80], "protocol": ["tcp"], "to_port": [80]}], "name": ["alb-security-group"], "tags": [{"Name": "alb-security-group"}], "vpc_id": ["aws_vpc.vpc.id"], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_security_group.alb_security_group"}}}, "evaluated_keys": ["resource_type", "networking"]}, "code_block": [[465, "resource \"aws_security_group\" \"alb_security_group\" {\n"], [466, "  name        = \"alb-security-group\"\n"], [467, "  description = \"Security group for application load balancer\"\n"], [468, "  vpc_id      = aws_vpc.vpc.id\n"], [469, "\n"], [470, "  # Allow incoming HTTPS traffic only\n"], [471, "  ingress {\n"], [472, "    description = \"HTTPS from internet\"\n"], [473, "    from_port   = 443\n"], [474, "    to_port     = 443\n"], [475, "    protocol    = \"tcp\"\n"], [476, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [477, "  }\n"], [478, "\n"], [479, "  # HTTP for redirection only (will be redirected to HTTPS)\n"], [480, "  ingress {\n"], [481, "    description = \"HTTP from internet (for redirection to HTTPS)\"\n"], [482, "    from_port   = 80\n"], [483, "    to_port     = 80\n"], [484, "    protocol    = \"tcp\"\n"], [485, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [486, "  }\n"], [487, "\n"], [488, "  # Restricted egress rules\n"], [489, "  egress {\n"], [490, "    description = \"HTTP to ECS services\"\n"], [491, "    from_port   = 80\n"], [492, "    to_port     = 80\n"], [493, "    protocol    = \"tcp\"\n"], [494, "    cidr_blocks = [aws_vpc.vpc.cidr_block] # Allow traffic to any private IP in the VPC\n"], [495, "  }\n"], [496, "\n"], [497, "  egress {\n"], [498, "    description = \"HTTPS to internet for external resources\"\n"], [499, "    from_port   = 443\n"], [500, "    to_port     = 443\n"], [501, "    protocol    = \"tcp\"\n"], [502, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [503, "  }\n"], [504, "\n"], [505, "  tags = {\n"], [506, "    Name = \"alb-security-group\"\n"], [507, "  }\n"], [508, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [465, 508], "resource": "module.ecs_jenkins_github_dr.module.network.aws_security_group.alb_security_group", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "alb-security-group"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_5", "bc_check_id": "BC_AWS_NETWORKING_51", "check_name": "Ensure that Security Groups are attached to another resource", "check_result": {"result": "FAILED", "entity": {"aws_security_group": {"ecs_security_group": {"__end_line__": 554, "__start_line__": 511, "description": ["Security group for ECS Fargate tasks"], "egress": [{"cidr_blocks": [["0.0.0.0/0"]], "description": ["HTTPS to internet for external resources"], "from_port": [443], "protocol": ["tcp"], "to_port": [443]}, {"description": ["Database access"], "from_port": [5432], "protocol": ["tcp"], "security_groups": [["aws_security_group.db_security_group.id"]], "to_port": [5432]}], "ingress": [{"cidr_blocks": [["10.2.0.0/16"]], "description": ["HTTP from VPC"], "from_port": [80], "protocol": ["tcp"], "to_port": [80]}, {"description": ["Inter-container communication"], "from_port": [8080], "protocol": ["tcp"], "self": [true], "to_port": [8080]}], "name": ["ecs-security-group"], "tags": [{"Name": "ecs-security-group"}], "vpc_id": ["aws_vpc.vpc.id"], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_security_group.ecs_security_group"}}}, "evaluated_keys": ["resource_type", "networking"]}, "code_block": [[511, "resource \"aws_security_group\" \"ecs_security_group\" {\n"], [512, "  name        = \"ecs-security-group\"\n"], [513, "  description = \"Security group for ECS Fargate tasks\"\n"], [514, "  vpc_id      = aws_vpc.vpc.id\n"], [515, "\n"], [516, "  # Allow incoming HTTP traffic from VPC CIDR\n"], [517, "  ingress {\n"], [518, "    description = \"HTTP from VPC\"\n"], [519, "    from_port   = 80\n"], [520, "    to_port     = 80\n"], [521, "    protocol    = \"tcp\"\n"], [522, "    cidr_blocks = [aws_vpc.vpc.cidr_block]\n"], [523, "  }\n"], [524, "\n"], [525, "  # Allow internal traffic for service discovery\n"], [526, "  ingress {\n"], [527, "    description = \"Inter-container communication\"\n"], [528, "    from_port   = 8080\n"], [529, "    to_port     = 8080\n"], [530, "    protocol    = \"tcp\"\n"], [531, "    self        = true\n"], [532, "  }\n"], [533, "\n"], [534, "  # Restricted egress rules\n"], [535, "  egress {\n"], [536, "    description = \"HTTPS to internet for external resources\"\n"], [537, "    from_port   = 443\n"], [538, "    to_port     = 443\n"], [539, "    protocol    = \"tcp\"\n"], [540, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [541, "  }\n"], [542, "\n"], [543, "  egress {\n"], [544, "    description     = \"Database access\"\n"], [545, "    from_port       = 5432\n"], [546, "    to_port         = 5432\n"], [547, "    protocol        = \"tcp\"\n"], [548, "    security_groups = [aws_security_group.db_security_group.id]\n"], [549, "  }\n"], [550, "\n"], [551, "  tags = {\n"], [552, "    Name = \"ecs-security-group\"\n"], [553, "  }\n"], [554, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [511, 554], "resource": "module.ecs_jenkins_github_dr.module.network.aws_security_group.ecs_security_group", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "ecs-security-group"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV2_AWS_5", "bc_check_id": "BC_AWS_NETWORKING_51", "check_name": "Ensure that Security Groups are attached to another resource", "check_result": {"result": "FAILED", "entity": {"aws_security_group": {"db_security_group": {"__end_line__": 583, "__start_line__": 557, "description": ["Security group for database instances"], "egress": [{"cidr_blocks": [["10.2.0.0/16"]], "description": ["Response traffic to VPC"], "from_port": [1024], "protocol": ["tcp"], "to_port": [65535]}], "ingress": [{"cidr_blocks": [["10.2.0.0/16"]], "description": ["Database port from VPC"], "from_port": [5432], "protocol": ["tcp"], "to_port": [5432]}], "name": ["db-security-group"], "tags": [{"Name": "db-security-group"}], "vpc_id": ["aws_vpc.vpc.id"], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_security_group.db_security_group"}}}, "evaluated_keys": ["resource_type", "networking"]}, "code_block": [[557, "resource \"aws_security_group\" \"db_security_group\" {\n"], [558, "  name        = \"db-security-group\"\n"], [559, "  description = \"Security group for database instances\"\n"], [560, "  vpc_id      = aws_vpc.vpc.id\n"], [561, "\n"], [562, "  # Allow incoming database traffic from VPC\n"], [563, "  ingress {\n"], [564, "    description = \"Database port from VPC\"\n"], [565, "    from_port   = 5432\n"], [566, "    to_port     = 5432\n"], [567, "    protocol    = \"tcp\"\n"], [568, "    cidr_blocks = [aws_vpc.vpc.cidr_block]\n"], [569, "  }\n"], [570, "\n"], [571, "  # Allow response traffic to VPC\n"], [572, "  egress {\n"], [573, "    description = \"Response traffic to VPC\"\n"], [574, "    from_port   = 1024\n"], [575, "    to_port     = 65535\n"], [576, "    protocol    = \"tcp\"\n"], [577, "    cidr_blocks = [aws_vpc.vpc.cidr_block]\n"], [578, "  }\n"], [579, "\n"], [580, "  tags = {\n"], [581, "    Name = \"db-security-group\"\n"], [582, "  }\n"], [583, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [557, 583], "resource": "module.ecs_jenkins_github_dr.module.network.aws_security_group.db_security_group", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "db-security-group"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_378", "bc_check_id": "BC_AWS_NETWORKING_103", "check_name": "Ensure AWS Load Balancer doesn't use HTTP protocol", "check_result": {"result": "FAILED", "entity": {"aws_lb_target_group": {"target_group": {"__end_line__": 70, "__start_line__": 46, "health_check": [{"enabled": [true], "healthy_threshold": [3], "interval": [30], "matcher": ["200"], "path": ["/"], "port": ["traffic-port"], "protocol": ["HTTP"], "timeout": [5], "unhealthy_threshold": [3]}], "name": ["ecs-jenkins-prod-tg"], "port": [80], "protocol": ["HTTP"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-tg", "Project": "ecs-jenkins"}], "target_type": ["ip"], "vpc_id": ["aws_vpc.vpc.id"], "__address__": "module.ecs_jenkins_github.module.ecs.aws_lb_target_group.target_group"}}}, "evaluated_keys": ["protocol", "resource_type"]}, "code_block": [[46, "resource \"aws_lb_target_group\" \"target_group\" {\n"], [47, "  name        = \"${var.project}-${var.environment}-tg\"\n"], [48, "  port        = 80\n"], [49, "  protocol    = \"HTTP\"\n"], [50, "  vpc_id      = var.vpc_id\n"], [51, "  target_type = \"ip\"\n"], [52, "\n"], [53, "  health_check {\n"], [54, "    enabled             = true\n"], [55, "    interval            = 30\n"], [56, "    path                = \"/\"\n"], [57, "    port                = \"traffic-port\"\n"], [58, "    healthy_threshold   = 3\n"], [59, "    unhealthy_threshold = 3\n"], [60, "    timeout             = 5\n"], [61, "    protocol            = \"HTTP\"\n"], [62, "    matcher             = \"200\"\n"], [63, "  }\n"], [64, "\n"], [65, "  tags = {\n"], [66, "    Name        = \"${var.project}-${var.environment}-tg\"\n"], [67, "    Environment = var.environment\n"], [68, "    Project     = var.project\n"], [69, "  }\n"], [70, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [46, 70], "resource": "module.ecs_jenkins_github.module.ecs.aws_lb_target_group.target_group", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-tg", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[256, "resource \"aws_lb_listener\" \"https\" {\n"], [257, "  count             = var.create_dummy_cert ? 1 : 0\n"], [258, "  load_balancer_arn = aws_lb.alb.arn\n"], [259, "  port              = 443\n"], [260, "  protocol          = \"HTTPS\"\n"], [261, "  # Use a more secure SSL policy that requires TLS 1.2 minimum (OWASP recommendation)\n"], [262, "  ssl_policy      = \"ELBSecurityPolicy-TLS-1-2-2017-01\"\n"], [263, "  certificate_arn = aws_acm_certificate.cert[0].arn\n"], [264, "\n"], [265, "  default_action {\n"], [266, "    type             = \"forward\"\n"], [267, "    target_group_arn = aws_lb_target_group.target_group.arn\n"], [268, "  }\n"], [269, "\n"], [270, "  tags = {\n"], [271, "    Name               = \"${var.project}-${var.environment}-https\"\n"], [272, "    Environment        = var.environment\n"], [273, "    Project            = var.project\n"], [274, "    SecurityCompliance = \"OWASP-TLS-1.2\"\n"], [275, "  }\n"], [276, "}\n"]], "file_path": "\\..\\ecs\\main.tf", "file_line_range": [256, 276], "resource": "aws_lb_listener.https[0]", "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-https", "Project": "ecs-jenkins", "SecurityCompliance": "OWASP-TLS-1.2"}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-378", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_378", "bc_check_id": "BC_AWS_NETWORKING_103", "check_name": "Ensure AWS Load Balancer doesn't use HTTP protocol", "check_result": {"result": "FAILED", "entity": {"aws_lb_target_group": {"target_group": {"__end_line__": 70, "__start_line__": 46, "health_check": [{"enabled": [true], "healthy_threshold": [3], "interval": [30], "matcher": ["200"], "path": ["/"], "port": ["traffic-port"], "protocol": ["HTTP"], "timeout": [5], "unhealthy_threshold": [3]}], "name": ["ecs-jenkins-dr-tg"], "port": [80], "protocol": ["HTTP"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-tg", "Project": "ecs-jenkins"}], "target_type": ["ip"], "vpc_id": ["aws_vpc.vpc.id"], "__address__": "module.ecs_jenkins_github_dr.module.ecs.aws_lb_target_group.target_group"}}}, "evaluated_keys": ["protocol", "resource_type"]}, "code_block": [[46, "resource \"aws_lb_target_group\" \"target_group\" {\n"], [47, "  name        = \"${var.project}-${var.environment}-tg\"\n"], [48, "  port        = 80\n"], [49, "  protocol    = \"HTTP\"\n"], [50, "  vpc_id      = var.vpc_id\n"], [51, "  target_type = \"ip\"\n"], [52, "\n"], [53, "  health_check {\n"], [54, "    enabled             = true\n"], [55, "    interval            = 30\n"], [56, "    path                = \"/\"\n"], [57, "    port                = \"traffic-port\"\n"], [58, "    healthy_threshold   = 3\n"], [59, "    unhealthy_threshold = 3\n"], [60, "    timeout             = 5\n"], [61, "    protocol            = \"HTTP\"\n"], [62, "    matcher             = \"200\"\n"], [63, "  }\n"], [64, "\n"], [65, "  tags = {\n"], [66, "    Name        = \"${var.project}-${var.environment}-tg\"\n"], [67, "    Environment = var.environment\n"], [68, "    Project     = var.project\n"], [69, "  }\n"], [70, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "repo_file_path": "/modules/ecs/main.tf", "file_line_range": [46, 70], "resource": "module.ecs_jenkins_github_dr.module.ecs.aws_lb_target_group.target_group", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-tg", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[256, "resource \"aws_lb_listener\" \"https\" {\n"], [257, "  count             = var.create_dummy_cert ? 1 : 0\n"], [258, "  load_balancer_arn = aws_lb.alb.arn\n"], [259, "  port              = 443\n"], [260, "  protocol          = \"HTTPS\"\n"], [261, "  # Use a more secure SSL policy that requires TLS 1.2 minimum (OWASP recommendation)\n"], [262, "  ssl_policy      = \"ELBSecurityPolicy-TLS-1-2-2017-01\"\n"], [263, "  certificate_arn = aws_acm_certificate.cert[0].arn\n"], [264, "\n"], [265, "  default_action {\n"], [266, "    type             = \"forward\"\n"], [267, "    target_group_arn = aws_lb_target_group.target_group.arn\n"], [268, "  }\n"], [269, "\n"], [270, "  tags = {\n"], [271, "    Name               = \"${var.project}-${var.environment}-https\"\n"], [272, "    Environment        = var.environment\n"], [273, "    Project            = var.project\n"], [274, "    SecurityCompliance = \"OWASP-TLS-1.2\"\n"], [275, "  }\n"], [276, "}\n"]], "file_path": "\\main.tf", "file_line_range": [256, 276], "resource": "aws_lb_listener.https[0]", "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-https", "Project": "ecs-jenkins", "SecurityCompliance": "OWASP-TLS-1.2"}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-378", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ecs\\main.tf"}, {"check_id": "CKV_AWS_378", "bc_check_id": "BC_AWS_NETWORKING_103", "check_name": "Ensure AWS Load Balancer doesn't use HTTP protocol", "check_result": {"result": "FAILED", "entity": {"aws_lb_target_group": {"grafana": {"__end_line__": 139, "__start_line__": 124, "health_check": [{"healthy_threshold": [3], "interval": [30], "matcher": ["200"], "path": ["/api/health"], "timeout": [5], "unhealthy_threshold": [3]}], "name": ["grafana-tg"], "port": [3000], "protocol": ["HTTP"], "target_type": ["ip"], "vpc_id": ["aws_vpc.vpc.id"], "__address__": "module.ecs_jenkins_github.module.monitoring.aws_lb_target_group.grafana"}}}, "evaluated_keys": ["protocol", "resource_type"]}, "code_block": [[124, "resource \"aws_lb_target_group\" \"grafana\" {\n"], [125, "  name        = \"grafana-tg\"\n"], [126, "  port        = 3000\n"], [127, "  protocol    = \"HTTP\"\n"], [128, "  vpc_id      = var.vpc_id\n"], [129, "  target_type = \"ip\"\n"], [130, "\n"], [131, "  health_check {\n"], [132, "    path                = \"/api/health\"\n"], [133, "    interval            = 30\n"], [134, "    timeout             = 5\n"], [135, "    healthy_threshold   = 3\n"], [136, "    unhealthy_threshold = 3\n"], [137, "    matcher             = \"200\"\n"], [138, "  }\n"], [139, "}\n"]], "file_path": "\\grafana.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf", "repo_file_path": "/modules/monitoring/grafana.tf", "file_line_range": [124, 139], "resource": "module.ecs_jenkins_github.module.monitoring.aws_lb_target_group.grafana", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-378", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf"}, {"check_id": "CKV_AWS_378", "bc_check_id": "BC_AWS_NETWORKING_103", "check_name": "Ensure AWS Load Balancer doesn't use HTTP protocol", "check_result": {"result": "FAILED", "entity": {"aws_lb_target_group": {"grafana": {"__end_line__": 139, "__start_line__": 124, "health_check": [{"healthy_threshold": [3], "interval": [30], "matcher": ["200"], "path": ["/api/health"], "timeout": [5], "unhealthy_threshold": [3]}], "name": ["grafana-tg"], "port": [3000], "protocol": ["HTTP"], "target_type": ["ip"], "vpc_id": ["aws_vpc.vpc.id"], "__address__": "module.ecs_jenkins_github_dr.module.monitoring.aws_lb_target_group.grafana"}}}, "evaluated_keys": ["protocol", "resource_type"]}, "code_block": [[124, "resource \"aws_lb_target_group\" \"grafana\" {\n"], [125, "  name        = \"grafana-tg\"\n"], [126, "  port        = 3000\n"], [127, "  protocol    = \"HTTP\"\n"], [128, "  vpc_id      = var.vpc_id\n"], [129, "  target_type = \"ip\"\n"], [130, "\n"], [131, "  health_check {\n"], [132, "    path                = \"/api/health\"\n"], [133, "    interval            = 30\n"], [134, "    timeout             = 5\n"], [135, "    healthy_threshold   = 3\n"], [136, "    unhealthy_threshold = 3\n"], [137, "    matcher             = \"200\"\n"], [138, "  }\n"], [139, "}\n"]], "file_path": "\\grafana.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf", "repo_file_path": "/modules/monitoring/grafana.tf", "file_line_range": [124, 139], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_lb_target_group.grafana", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-378", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\grafana.tf"}, {"check_id": "CKV_AWS_378", "bc_check_id": "BC_AWS_NETWORKING_103", "check_name": "Ensure AWS Load Balancer doesn't use HTTP protocol", "check_result": {"result": "FAILED", "entity": {"aws_lb_target_group": {"prometheus": {"__end_line__": 108, "__start_line__": 93, "health_check": [{"healthy_threshold": [3], "interval": [30], "matcher": ["200"], "path": ["/-/healthy"], "timeout": [5], "unhealthy_threshold": [3]}], "name": ["prometheus-tg"], "port": [9090], "protocol": ["HTTP"], "target_type": ["ip"], "vpc_id": ["aws_vpc.vpc.id"], "__address__": "module.ecs_jenkins_github_dr.module.monitoring.aws_lb_target_group.prometheus"}}}, "evaluated_keys": ["protocol", "resource_type"]}, "code_block": [[93, "resource \"aws_lb_target_group\" \"prometheus\" {\n"], [94, "  name        = \"prometheus-tg\"\n"], [95, "  port        = 9090\n"], [96, "  protocol    = \"HTTP\"\n"], [97, "  vpc_id      = var.vpc_id\n"], [98, "  target_type = \"ip\"\n"], [99, "\n"], [100, "  health_check {\n"], [101, "    path                = \"/-/healthy\"\n"], [102, "    interval            = 30\n"], [103, "    timeout             = 5\n"], [104, "    healthy_threshold   = 3\n"], [105, "    unhealthy_threshold = 3\n"], [106, "    matcher             = \"200\"\n"], [107, "  }\n"], [108, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [93, 108], "resource": "module.ecs_jenkins_github_dr.module.monitoring.aws_lb_target_group.prometheus", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-378", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_378", "bc_check_id": "BC_AWS_NETWORKING_103", "check_name": "Ensure AWS Load Balancer doesn't use HTTP protocol", "check_result": {"result": "FAILED", "entity": {"aws_lb_target_group": {"prometheus": {"__end_line__": 108, "__start_line__": 93, "health_check": [{"healthy_threshold": [3], "interval": [30], "matcher": ["200"], "path": ["/-/healthy"], "timeout": [5], "unhealthy_threshold": [3]}], "name": ["prometheus-tg"], "port": [9090], "protocol": ["HTTP"], "target_type": ["ip"], "vpc_id": ["aws_vpc.vpc.id"], "__address__": "module.ecs_jenkins_github.module.monitoring.aws_lb_target_group.prometheus"}}}, "evaluated_keys": ["protocol", "resource_type"]}, "code_block": [[93, "resource \"aws_lb_target_group\" \"prometheus\" {\n"], [94, "  name        = \"prometheus-tg\"\n"], [95, "  port        = 9090\n"], [96, "  protocol    = \"HTTP\"\n"], [97, "  vpc_id      = var.vpc_id\n"], [98, "  target_type = \"ip\"\n"], [99, "\n"], [100, "  health_check {\n"], [101, "    path                = \"/-/healthy\"\n"], [102, "    interval            = 30\n"], [103, "    timeout             = 5\n"], [104, "    healthy_threshold   = 3\n"], [105, "    unhealthy_threshold = 3\n"], [106, "    matcher             = \"200\"\n"], [107, "  }\n"], [108, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf", "repo_file_path": "/modules/monitoring/main.tf", "file_line_range": [93, 108], "resource": "module.ecs_jenkins_github.module.monitoring.aws_lb_target_group.prometheus", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-378", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\monitoring\\main.tf"}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"patch_logs": {"__end_line__": 207, "__start_line__": 199, "bucket": ["ecs-jenkins-prod-patch-logs-${random_string.suffix.result}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-patch-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.ec2.aws_s3_bucket.patch_logs"}}}, "evaluated_keys": ["resource_type", "logging"]}, "code_block": [[199, "resource \"aws_s3_bucket\" \"patch_logs\" {\n"], [200, "  bucket = \"${var.project}-${var.environment}-patch-logs-${random_string.suffix.result}\"\n"], [201, "\n"], [202, "  tags = {\n"], [203, "    Name        = \"${var.project}-${var.environment}-patch-logs\"\n"], [204, "    Environment = var.environment\n"], [205, "    Project     = var.project\n"], [206, "  }\n"], [207, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [199, 207], "resource": "module.ecs_jenkins_github.module.ec2.aws_s3_bucket.patch_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-patch-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"patch_logs": {"__end_line__": 207, "__start_line__": 199, "bucket": ["ecs-jenkins-dr-patch-logs-${random_string.suffix.result}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-patch-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.ec2.aws_s3_bucket.patch_logs"}}}, "evaluated_keys": ["resource_type", "logging"]}, "code_block": [[199, "resource \"aws_s3_bucket\" \"patch_logs\" {\n"], [200, "  bucket = \"${var.project}-${var.environment}-patch-logs-${random_string.suffix.result}\"\n"], [201, "\n"], [202, "  tags = {\n"], [203, "    Name        = \"${var.project}-${var.environment}-patch-logs\"\n"], [204, "    Environment = var.environment\n"], [205, "    Project     = var.project\n"], [206, "  }\n"], [207, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [199, 207], "resource": "module.ecs_jenkins_github_dr.module.ec2.aws_s3_bucket.patch_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-patch-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"lambda_code": {"__end_line__": 18, "__start_line__": 10, "bucket": ["${var.project}-${var.environment}-lambda-${random_string.bucket_suffix.result}"], "tags": [{"Environment": "var.environment", "Name": "${var.project}-${var.environment}-lambda", "Project": "var.project"}], "__address__": "module.lambda_failover.aws_s3_bucket.lambda_code"}}}, "evaluated_keys": ["resource_type", "logging"]}, "code_block": [[10, "resource \"aws_s3_bucket\" \"lambda_code\" {\n"], [11, "  bucket = \"${var.project}-${var.environment}-lambda-${random_string.bucket_suffix.result}\"\n"], [12, "\n"], [13, "  tags = {\n"], [14, "    Name        = \"${var.project}-${var.environment}-lambda\"\n"], [15, "    Environment = var.environment\n"], [16, "    Project     = var.project\n"], [17, "  }\n"], [18, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [10, 18], "resource": "module.lambda_failover.aws_s3_bucket.lambda_code", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Name": "${var.project}-${var.environment}-lambda", "Project": "var.project"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"config_bucket": {"__end_line__": 339, "__start_line__": 330, "bucket": ["ecs-jenkins-prod-config-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-config-bucket", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.security.aws_s3_bucket.config_bucket"}}}, "evaluated_keys": ["resource_type", "logging"]}, "code_block": [[330, "resource \"aws_s3_bucket\" \"config_bucket\" {\n"], [331, "  bucket        = \"${var.project}-${var.environment}-config-${random_string.bucket_suffix.result}\"\n"], [332, "  force_destroy = var.environment != \"prod\"\n"], [333, "\n"], [334, "  tags = {\n"], [335, "    Name        = \"${var.project}-${var.environment}-config-bucket\"\n"], [336, "    Environment = var.environment\n"], [337, "    Project     = var.project\n"], [338, "  }\n"], [339, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [330, 339], "resource": "module.ecs_jenkins_github.module.security.aws_s3_bucket.config_bucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-config-bucket", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"waf_logs": {"__end_line__": 568, "__start_line__": 559, "bucket": ["ecs-jenkins-prod-waf-logs-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-waf-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.security.aws_s3_bucket.waf_logs"}}}, "evaluated_keys": ["resource_type", "logging"]}, "code_block": [[559, "resource \"aws_s3_bucket\" \"waf_logs\" {\n"], [560, "  bucket        = \"${var.project}-${var.environment}-waf-logs-${random_string.bucket_suffix.result}\"\n"], [561, "  force_destroy = var.environment != \"prod\"\n"], [562, "\n"], [563, "  tags = {\n"], [564, "    Name        = \"${var.project}-${var.environment}-waf-logs\"\n"], [565, "    Environment = var.environment\n"], [566, "    Project     = var.project\n"], [567, "  }\n"], [568, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [559, 568], "resource": "module.ecs_jenkins_github.module.security.aws_s3_bucket.waf_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-waf-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"config_bucket": {"__end_line__": 339, "__start_line__": 330, "bucket": ["ecs-jenkins-dr-config-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-config-bucket", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.config_bucket"}}}, "evaluated_keys": ["resource_type", "logging"]}, "code_block": [[330, "resource \"aws_s3_bucket\" \"config_bucket\" {\n"], [331, "  bucket        = \"${var.project}-${var.environment}-config-${random_string.bucket_suffix.result}\"\n"], [332, "  force_destroy = var.environment != \"prod\"\n"], [333, "\n"], [334, "  tags = {\n"], [335, "    Name        = \"${var.project}-${var.environment}-config-bucket\"\n"], [336, "    Environment = var.environment\n"], [337, "    Project     = var.project\n"], [338, "  }\n"], [339, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [330, 339], "resource": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.config_bucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-config-bucket", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"waf_logs": {"__end_line__": 568, "__start_line__": 559, "bucket": ["ecs-jenkins-dr-waf-logs-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-waf-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.waf_logs"}}}, "evaluated_keys": ["resource_type", "logging"]}, "code_block": [[559, "resource \"aws_s3_bucket\" \"waf_logs\" {\n"], [560, "  bucket        = \"${var.project}-${var.environment}-waf-logs-${random_string.bucket_suffix.result}\"\n"], [561, "  force_destroy = var.environment != \"prod\"\n"], [562, "\n"], [563, "  tags = {\n"], [564, "    Name        = \"${var.project}-${var.environment}-waf-logs\"\n"], [565, "    Environment = var.environment\n"], [566, "    Project     = var.project\n"], [567, "  }\n"], [568, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [559, 568], "resource": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.waf_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-waf-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"patch_logs": {"__end_line__": 207, "__start_line__": 199, "bucket": ["ecs-jenkins-prod-patch-logs-${random_string.suffix.result}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-patch-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.ec2.aws_s3_bucket.patch_logs"}}}, "evaluated_keys": ["replication_configuration/rules/*/status", "resource_type", "rule/*/status"]}, "code_block": [[199, "resource \"aws_s3_bucket\" \"patch_logs\" {\n"], [200, "  bucket = \"${var.project}-${var.environment}-patch-logs-${random_string.suffix.result}\"\n"], [201, "\n"], [202, "  tags = {\n"], [203, "    Name        = \"${var.project}-${var.environment}-patch-logs\"\n"], [204, "    Environment = var.environment\n"], [205, "    Project     = var.project\n"], [206, "  }\n"], [207, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [199, 207], "resource": "module.ecs_jenkins_github.module.ec2.aws_s3_bucket.patch_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-patch-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"patch_logs": {"__end_line__": 207, "__start_line__": 199, "bucket": ["ecs-jenkins-dr-patch-logs-${random_string.suffix.result}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-patch-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.ec2.aws_s3_bucket.patch_logs"}}}, "evaluated_keys": ["replication_configuration/rules/*/status", "resource_type", "rule/*/status"]}, "code_block": [[199, "resource \"aws_s3_bucket\" \"patch_logs\" {\n"], [200, "  bucket = \"${var.project}-${var.environment}-patch-logs-${random_string.suffix.result}\"\n"], [201, "\n"], [202, "  tags = {\n"], [203, "    Name        = \"${var.project}-${var.environment}-patch-logs\"\n"], [204, "    Environment = var.environment\n"], [205, "    Project     = var.project\n"], [206, "  }\n"], [207, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [199, 207], "resource": "module.ecs_jenkins_github_dr.module.ec2.aws_s3_bucket.patch_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-patch-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"lambda_code": {"__end_line__": 18, "__start_line__": 10, "bucket": ["${var.project}-${var.environment}-lambda-${random_string.bucket_suffix.result}"], "tags": [{"Environment": "var.environment", "Name": "${var.project}-${var.environment}-lambda", "Project": "var.project"}], "__address__": "module.lambda_failover.aws_s3_bucket.lambda_code"}}}, "evaluated_keys": ["replication_configuration/rules/*/status", "resource_type", "rule/*/status"]}, "code_block": [[10, "resource \"aws_s3_bucket\" \"lambda_code\" {\n"], [11, "  bucket = \"${var.project}-${var.environment}-lambda-${random_string.bucket_suffix.result}\"\n"], [12, "\n"], [13, "  tags = {\n"], [14, "    Name        = \"${var.project}-${var.environment}-lambda\"\n"], [15, "    Environment = var.environment\n"], [16, "    Project     = var.project\n"], [17, "  }\n"], [18, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [10, 18], "resource": "module.lambda_failover.aws_s3_bucket.lambda_code", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Name": "${var.project}-${var.environment}-lambda", "Project": "var.project"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"alb_logs": {"__end_line__": 134, "__start_line__": 126, "bucket": ["alb-logs-prod-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "prod", "Name": "alb-access-logs"}], "__address__": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs"}}}, "evaluated_keys": ["replication_configuration/rules/*/status", "resource_type", "rule/*/status"]}, "code_block": [[126, "resource \"aws_s3_bucket\" \"alb_logs\" {\n"], [127, "  bucket        = \"alb-logs-${var.environment}-${random_string.suffix.result}\"\n"], [128, "  force_destroy = true\n"], [129, "\n"], [130, "  tags = {\n"], [131, "    Name        = \"alb-access-logs\"\n"], [132, "    Environment = var.environment\n"], [133, "  }\n"], [134, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [126, 134], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "alb-access-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"alb_logs_access_logs": {"__end_line__": 145, "__start_line__": 137, "bucket": ["alb-logs-access-prod-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "prod", "Name": "alb-access-logs-access"}], "__address__": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs_access_logs"}}}, "evaluated_keys": ["replication_configuration/rules/*/status", "resource_type", "rule/*/status"]}, "code_block": [[137, "resource \"aws_s3_bucket\" \"alb_logs_access_logs\" {\n"], [138, "  bucket        = \"alb-logs-access-${var.environment}-${random_string.suffix.result}\"\n"], [139, "  force_destroy = true\n"], [140, "\n"], [141, "  tags = {\n"], [142, "    Name        = \"alb-access-logs-access\"\n"], [143, "    Environment = var.environment\n"], [144, "  }\n"], [145, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [137, 145], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.alb_logs_access_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "alb-access-logs-access"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"replication_logs": {"__end_line__": 156, "__start_line__": 148, "bucket": ["replication-logs-prod-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "prod", "Name": "replication-logs"}], "__address__": "module.ecs_jenkins_github.module.network.aws_s3_bucket.replication_logs"}}}, "evaluated_keys": ["replication_configuration/rules/*/status", "resource_type", "rule/*/status"]}, "code_block": [[148, "resource \"aws_s3_bucket\" \"replication_logs\" {\n"], [149, "  bucket        = \"replication-logs-${var.environment}-${random_string.suffix.result}\"\n"], [150, "  force_destroy = true\n"], [151, "\n"], [152, "  tags = {\n"], [153, "    Name        = \"replication-logs\"\n"], [154, "    Environment = var.environment\n"], [155, "  }\n"], [156, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [148, 156], "resource": "module.ecs_jenkins_github.module.network.aws_s3_bucket.replication_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "replication-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"alb_logs": {"__end_line__": 134, "__start_line__": 126, "bucket": ["alb-logs-dr-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "dr", "Name": "alb-access-logs"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs"}}}, "evaluated_keys": ["replication_configuration/rules/*/status", "resource_type", "rule/*/status"]}, "code_block": [[126, "resource \"aws_s3_bucket\" \"alb_logs\" {\n"], [127, "  bucket        = \"alb-logs-${var.environment}-${random_string.suffix.result}\"\n"], [128, "  force_destroy = true\n"], [129, "\n"], [130, "  tags = {\n"], [131, "    Name        = \"alb-access-logs\"\n"], [132, "    Environment = var.environment\n"], [133, "  }\n"], [134, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [126, 134], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "alb-access-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"alb_logs_access_logs": {"__end_line__": 145, "__start_line__": 137, "bucket": ["alb-logs-access-dr-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "dr", "Name": "alb-access-logs-access"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs_access_logs"}}}, "evaluated_keys": ["replication_configuration/rules/*/status", "resource_type", "rule/*/status"]}, "code_block": [[137, "resource \"aws_s3_bucket\" \"alb_logs_access_logs\" {\n"], [138, "  bucket        = \"alb-logs-access-${var.environment}-${random_string.suffix.result}\"\n"], [139, "  force_destroy = true\n"], [140, "\n"], [141, "  tags = {\n"], [142, "    Name        = \"alb-access-logs-access\"\n"], [143, "    Environment = var.environment\n"], [144, "  }\n"], [145, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [137, 145], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.alb_logs_access_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "alb-access-logs-access"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"replication_logs": {"__end_line__": 156, "__start_line__": 148, "bucket": ["replication-logs-dr-${random_string.suffix.result}"], "force_destroy": [true], "tags": [{"Environment": "dr", "Name": "replication-logs"}], "__address__": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.replication_logs"}}}, "evaluated_keys": ["replication_configuration/rules/*/status", "resource_type", "rule/*/status"]}, "code_block": [[148, "resource \"aws_s3_bucket\" \"replication_logs\" {\n"], [149, "  bucket        = \"replication-logs-${var.environment}-${random_string.suffix.result}\"\n"], [150, "  force_destroy = true\n"], [151, "\n"], [152, "  tags = {\n"], [153, "    Name        = \"replication-logs\"\n"], [154, "    Environment = var.environment\n"], [155, "  }\n"], [156, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [148, 156], "resource": "module.ecs_jenkins_github_dr.module.network.aws_s3_bucket.replication_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "replication-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\network\\main.tf"}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"config_bucket": {"__end_line__": 339, "__start_line__": 330, "bucket": ["ecs-jenkins-prod-config-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-config-bucket", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.security.aws_s3_bucket.config_bucket"}}}, "evaluated_keys": ["replication_configuration/rules/*/status", "resource_type", "rule/*/status"]}, "code_block": [[330, "resource \"aws_s3_bucket\" \"config_bucket\" {\n"], [331, "  bucket        = \"${var.project}-${var.environment}-config-${random_string.bucket_suffix.result}\"\n"], [332, "  force_destroy = var.environment != \"prod\"\n"], [333, "\n"], [334, "  tags = {\n"], [335, "    Name        = \"${var.project}-${var.environment}-config-bucket\"\n"], [336, "    Environment = var.environment\n"], [337, "    Project     = var.project\n"], [338, "  }\n"], [339, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [330, 339], "resource": "module.ecs_jenkins_github.module.security.aws_s3_bucket.config_bucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-config-bucket", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"waf_logs": {"__end_line__": 568, "__start_line__": 559, "bucket": ["ecs-jenkins-prod-waf-logs-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-waf-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.security.aws_s3_bucket.waf_logs"}}}, "evaluated_keys": ["replication_configuration/rules/*/status", "resource_type", "rule/*/status"]}, "code_block": [[559, "resource \"aws_s3_bucket\" \"waf_logs\" {\n"], [560, "  bucket        = \"${var.project}-${var.environment}-waf-logs-${random_string.bucket_suffix.result}\"\n"], [561, "  force_destroy = var.environment != \"prod\"\n"], [562, "\n"], [563, "  tags = {\n"], [564, "    Name        = \"${var.project}-${var.environment}-waf-logs\"\n"], [565, "    Environment = var.environment\n"], [566, "    Project     = var.project\n"], [567, "  }\n"], [568, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [559, 568], "resource": "module.ecs_jenkins_github.module.security.aws_s3_bucket.waf_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-waf-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"config_bucket": {"__end_line__": 339, "__start_line__": 330, "bucket": ["ecs-jenkins-dr-config-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-config-bucket", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.config_bucket"}}}, "evaluated_keys": ["replication_configuration/rules/*/status", "resource_type", "rule/*/status"]}, "code_block": [[330, "resource \"aws_s3_bucket\" \"config_bucket\" {\n"], [331, "  bucket        = \"${var.project}-${var.environment}-config-${random_string.bucket_suffix.result}\"\n"], [332, "  force_destroy = var.environment != \"prod\"\n"], [333, "\n"], [334, "  tags = {\n"], [335, "    Name        = \"${var.project}-${var.environment}-config-bucket\"\n"], [336, "    Environment = var.environment\n"], [337, "    Project     = var.project\n"], [338, "  }\n"], [339, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [330, 339], "resource": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.config_bucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-config-bucket", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"waf_logs": {"__end_line__": 568, "__start_line__": 559, "bucket": ["ecs-jenkins-dr-waf-logs-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-waf-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.waf_logs"}}}, "evaluated_keys": ["replication_configuration/rules/*/status", "resource_type", "rule/*/status"]}, "code_block": [[559, "resource \"aws_s3_bucket\" \"waf_logs\" {\n"], [560, "  bucket        = \"${var.project}-${var.environment}-waf-logs-${random_string.bucket_suffix.result}\"\n"], [561, "  force_destroy = var.environment != \"prod\"\n"], [562, "\n"], [563, "  tags = {\n"], [564, "    Name        = \"${var.project}-${var.environment}-waf-logs\"\n"], [565, "    Environment = var.environment\n"], [566, "    Project     = var.project\n"], [567, "  }\n"], [568, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [559, 568], "resource": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.waf_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-waf-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV2_AWS_61", "bc_check_id": "BC_AWS_LOGGING_35", "check_name": "Ensure that an S3 bucket has a lifecycle configuration", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"lambda_code": {"__end_line__": 18, "__start_line__": 10, "bucket": ["${var.project}-${var.environment}-lambda-${random_string.bucket_suffix.result}"], "tags": [{"Environment": "var.environment", "Name": "${var.project}-${var.environment}-lambda", "Project": "var.project"}], "__address__": "module.lambda_failover.aws_s3_bucket.lambda_code"}}}, "evaluated_keys": ["lifecycle_rule", "resource_type"]}, "code_block": [[10, "resource \"aws_s3_bucket\" \"lambda_code\" {\n"], [11, "  bucket = \"${var.project}-${var.environment}-lambda-${random_string.bucket_suffix.result}\"\n"], [12, "\n"], [13, "  tags = {\n"], [14, "    Name        = \"${var.project}-${var.environment}-lambda\"\n"], [15, "    Environment = var.environment\n"], [16, "    Project     = var.project\n"], [17, "  }\n"], [18, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [10, 18], "resource": "module.lambda_failover.aws_s3_bucket.lambda_code", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Name": "${var.project}-${var.environment}-lambda", "Project": "var.project"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV2_AWS_61", "bc_check_id": "BC_AWS_LOGGING_35", "check_name": "Ensure that an S3 bucket has a lifecycle configuration", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"config_bucket": {"__end_line__": 339, "__start_line__": 330, "bucket": ["ecs-jenkins-prod-config-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-config-bucket", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.security.aws_s3_bucket.config_bucket"}}}, "evaluated_keys": ["lifecycle_rule", "resource_type"]}, "code_block": [[330, "resource \"aws_s3_bucket\" \"config_bucket\" {\n"], [331, "  bucket        = \"${var.project}-${var.environment}-config-${random_string.bucket_suffix.result}\"\n"], [332, "  force_destroy = var.environment != \"prod\"\n"], [333, "\n"], [334, "  tags = {\n"], [335, "    Name        = \"${var.project}-${var.environment}-config-bucket\"\n"], [336, "    Environment = var.environment\n"], [337, "    Project     = var.project\n"], [338, "  }\n"], [339, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [330, 339], "resource": "module.ecs_jenkins_github.module.security.aws_s3_bucket.config_bucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-config-bucket", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV2_AWS_61", "bc_check_id": "BC_AWS_LOGGING_35", "check_name": "Ensure that an S3 bucket has a lifecycle configuration", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"waf_logs": {"__end_line__": 568, "__start_line__": 559, "bucket": ["ecs-jenkins-prod-waf-logs-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-waf-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.security.aws_s3_bucket.waf_logs"}}}, "evaluated_keys": ["lifecycle_rule", "resource_type"]}, "code_block": [[559, "resource \"aws_s3_bucket\" \"waf_logs\" {\n"], [560, "  bucket        = \"${var.project}-${var.environment}-waf-logs-${random_string.bucket_suffix.result}\"\n"], [561, "  force_destroy = var.environment != \"prod\"\n"], [562, "\n"], [563, "  tags = {\n"], [564, "    Name        = \"${var.project}-${var.environment}-waf-logs\"\n"], [565, "    Environment = var.environment\n"], [566, "    Project     = var.project\n"], [567, "  }\n"], [568, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [559, 568], "resource": "module.ecs_jenkins_github.module.security.aws_s3_bucket.waf_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-waf-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV2_AWS_61", "bc_check_id": "BC_AWS_LOGGING_35", "check_name": "Ensure that an S3 bucket has a lifecycle configuration", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"config_bucket": {"__end_line__": 339, "__start_line__": 330, "bucket": ["ecs-jenkins-dr-config-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-config-bucket", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.config_bucket"}}}, "evaluated_keys": ["lifecycle_rule", "resource_type"]}, "code_block": [[330, "resource \"aws_s3_bucket\" \"config_bucket\" {\n"], [331, "  bucket        = \"${var.project}-${var.environment}-config-${random_string.bucket_suffix.result}\"\n"], [332, "  force_destroy = var.environment != \"prod\"\n"], [333, "\n"], [334, "  tags = {\n"], [335, "    Name        = \"${var.project}-${var.environment}-config-bucket\"\n"], [336, "    Environment = var.environment\n"], [337, "    Project     = var.project\n"], [338, "  }\n"], [339, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [330, 339], "resource": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.config_bucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-config-bucket", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV2_AWS_61", "bc_check_id": "BC_AWS_LOGGING_35", "check_name": "Ensure that an S3 bucket has a lifecycle configuration", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"waf_logs": {"__end_line__": 568, "__start_line__": 559, "bucket": ["ecs-jenkins-dr-waf-logs-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-waf-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.waf_logs"}}}, "evaluated_keys": ["lifecycle_rule", "resource_type"]}, "code_block": [[559, "resource \"aws_s3_bucket\" \"waf_logs\" {\n"], [560, "  bucket        = \"${var.project}-${var.environment}-waf-logs-${random_string.bucket_suffix.result}\"\n"], [561, "  force_destroy = var.environment != \"prod\"\n"], [562, "\n"], [563, "  tags = {\n"], [564, "    Name        = \"${var.project}-${var.environment}-waf-logs\"\n"], [565, "    Environment = var.environment\n"], [566, "    Project     = var.project\n"], [567, "  }\n"], [568, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [559, 568], "resource": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.waf_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-waf-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_21", "bc_check_id": "BC_AWS_S3_16", "check_name": "Ensure all data stored in the S3 bucket have versioning enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"patch_logs": {"__end_line__": 207, "__start_line__": 199, "bucket": ["ecs-jenkins-prod-patch-logs-${random_string.suffix.result}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-patch-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.ec2.aws_s3_bucket.patch_logs"}}}, "evaluated_keys": ["versioning_configuration/status", "resource_type", "versioning/enabled"]}, "code_block": [[199, "resource \"aws_s3_bucket\" \"patch_logs\" {\n"], [200, "  bucket = \"${var.project}-${var.environment}-patch-logs-${random_string.suffix.result}\"\n"], [201, "\n"], [202, "  tags = {\n"], [203, "    Name        = \"${var.project}-${var.environment}-patch-logs\"\n"], [204, "    Environment = var.environment\n"], [205, "    Project     = var.project\n"], [206, "  }\n"], [207, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [199, 207], "resource": "module.ecs_jenkins_github.module.ec2.aws_s3_bucket.patch_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-patch-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_21", "bc_check_id": "BC_AWS_S3_16", "check_name": "Ensure all data stored in the S3 bucket have versioning enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"patch_logs": {"__end_line__": 207, "__start_line__": 199, "bucket": ["ecs-jenkins-dr-patch-logs-${random_string.suffix.result}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-patch-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.ec2.aws_s3_bucket.patch_logs"}}}, "evaluated_keys": ["versioning_configuration/status", "resource_type", "versioning/enabled"]}, "code_block": [[199, "resource \"aws_s3_bucket\" \"patch_logs\" {\n"], [200, "  bucket = \"${var.project}-${var.environment}-patch-logs-${random_string.suffix.result}\"\n"], [201, "\n"], [202, "  tags = {\n"], [203, "    Name        = \"${var.project}-${var.environment}-patch-logs\"\n"], [204, "    Environment = var.environment\n"], [205, "    Project     = var.project\n"], [206, "  }\n"], [207, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [199, 207], "resource": "module.ecs_jenkins_github_dr.module.ec2.aws_s3_bucket.patch_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-patch-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_21", "bc_check_id": "BC_AWS_S3_16", "check_name": "Ensure all data stored in the S3 bucket have versioning enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"lambda_code": {"__end_line__": 18, "__start_line__": 10, "bucket": ["${var.project}-${var.environment}-lambda-${random_string.bucket_suffix.result}"], "tags": [{"Environment": "var.environment", "Name": "${var.project}-${var.environment}-lambda", "Project": "var.project"}], "__address__": "module.lambda_failover.aws_s3_bucket.lambda_code"}}}, "evaluated_keys": ["versioning_configuration/status", "resource_type", "versioning/enabled"]}, "code_block": [[10, "resource \"aws_s3_bucket\" \"lambda_code\" {\n"], [11, "  bucket = \"${var.project}-${var.environment}-lambda-${random_string.bucket_suffix.result}\"\n"], [12, "\n"], [13, "  tags = {\n"], [14, "    Name        = \"${var.project}-${var.environment}-lambda\"\n"], [15, "    Environment = var.environment\n"], [16, "    Project     = var.project\n"], [17, "  }\n"], [18, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [10, 18], "resource": "module.lambda_failover.aws_s3_bucket.lambda_code", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Name": "${var.project}-${var.environment}-lambda", "Project": "var.project"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_21", "bc_check_id": "BC_AWS_S3_16", "check_name": "Ensure all data stored in the S3 bucket have versioning enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"config_bucket": {"__end_line__": 339, "__start_line__": 330, "bucket": ["ecs-jenkins-prod-config-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-config-bucket", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.security.aws_s3_bucket.config_bucket"}}}, "evaluated_keys": ["versioning_configuration/status", "resource_type", "versioning/enabled"]}, "code_block": [[330, "resource \"aws_s3_bucket\" \"config_bucket\" {\n"], [331, "  bucket        = \"${var.project}-${var.environment}-config-${random_string.bucket_suffix.result}\"\n"], [332, "  force_destroy = var.environment != \"prod\"\n"], [333, "\n"], [334, "  tags = {\n"], [335, "    Name        = \"${var.project}-${var.environment}-config-bucket\"\n"], [336, "    Environment = var.environment\n"], [337, "    Project     = var.project\n"], [338, "  }\n"], [339, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [330, 339], "resource": "module.ecs_jenkins_github.module.security.aws_s3_bucket.config_bucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-config-bucket", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_21", "bc_check_id": "BC_AWS_S3_16", "check_name": "Ensure all data stored in the S3 bucket have versioning enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"waf_logs": {"__end_line__": 568, "__start_line__": 559, "bucket": ["ecs-jenkins-prod-waf-logs-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-waf-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.security.aws_s3_bucket.waf_logs"}}}, "evaluated_keys": ["versioning_configuration/status", "resource_type", "versioning/enabled"]}, "code_block": [[559, "resource \"aws_s3_bucket\" \"waf_logs\" {\n"], [560, "  bucket        = \"${var.project}-${var.environment}-waf-logs-${random_string.bucket_suffix.result}\"\n"], [561, "  force_destroy = var.environment != \"prod\"\n"], [562, "\n"], [563, "  tags = {\n"], [564, "    Name        = \"${var.project}-${var.environment}-waf-logs\"\n"], [565, "    Environment = var.environment\n"], [566, "    Project     = var.project\n"], [567, "  }\n"], [568, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [559, 568], "resource": "module.ecs_jenkins_github.module.security.aws_s3_bucket.waf_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-waf-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_21", "bc_check_id": "BC_AWS_S3_16", "check_name": "Ensure all data stored in the S3 bucket have versioning enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"config_bucket": {"__end_line__": 339, "__start_line__": 330, "bucket": ["ecs-jenkins-dr-config-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-config-bucket", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.config_bucket"}}}, "evaluated_keys": ["versioning_configuration/status", "resource_type", "versioning/enabled"]}, "code_block": [[330, "resource \"aws_s3_bucket\" \"config_bucket\" {\n"], [331, "  bucket        = \"${var.project}-${var.environment}-config-${random_string.bucket_suffix.result}\"\n"], [332, "  force_destroy = var.environment != \"prod\"\n"], [333, "\n"], [334, "  tags = {\n"], [335, "    Name        = \"${var.project}-${var.environment}-config-bucket\"\n"], [336, "    Environment = var.environment\n"], [337, "    Project     = var.project\n"], [338, "  }\n"], [339, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [330, 339], "resource": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.config_bucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-config-bucket", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_21", "bc_check_id": "BC_AWS_S3_16", "check_name": "Ensure all data stored in the S3 bucket have versioning enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"waf_logs": {"__end_line__": 568, "__start_line__": 559, "bucket": ["ecs-jenkins-dr-waf-logs-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-waf-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.waf_logs"}}}, "evaluated_keys": ["versioning_configuration/status", "resource_type", "versioning/enabled"]}, "code_block": [[559, "resource \"aws_s3_bucket\" \"waf_logs\" {\n"], [560, "  bucket        = \"${var.project}-${var.environment}-waf-logs-${random_string.bucket_suffix.result}\"\n"], [561, "  force_destroy = var.environment != \"prod\"\n"], [562, "\n"], [563, "  tags = {\n"], [564, "    Name        = \"${var.project}-${var.environment}-waf-logs\"\n"], [565, "    Environment = var.environment\n"], [566, "    Project     = var.project\n"], [567, "  }\n"], [568, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [559, 568], "resource": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.waf_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-waf-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV2_AWS_6", "bc_check_id": "BC_AWS_NETWORKING_52", "check_name": "Ensure that S3 bucket has a Public Access block", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"patch_logs": {"__end_line__": 207, "__start_line__": 199, "bucket": ["ecs-jenkins-prod-patch-logs-${random_string.suffix.result}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-patch-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.ec2.aws_s3_bucket.patch_logs"}}}, "evaluated_keys": ["block_public_acls", "block_public_policy", "resource_type"]}, "code_block": [[199, "resource \"aws_s3_bucket\" \"patch_logs\" {\n"], [200, "  bucket = \"${var.project}-${var.environment}-patch-logs-${random_string.suffix.result}\"\n"], [201, "\n"], [202, "  tags = {\n"], [203, "    Name        = \"${var.project}-${var.environment}-patch-logs\"\n"], [204, "    Environment = var.environment\n"], [205, "    Project     = var.project\n"], [206, "  }\n"], [207, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [199, 207], "resource": "module.ecs_jenkins_github.module.ec2.aws_s3_bucket.patch_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-patch-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV2_AWS_6", "bc_check_id": "BC_AWS_NETWORKING_52", "check_name": "Ensure that S3 bucket has a Public Access block", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"patch_logs": {"__end_line__": 207, "__start_line__": 199, "bucket": ["ecs-jenkins-dr-patch-logs-${random_string.suffix.result}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-patch-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.ec2.aws_s3_bucket.patch_logs"}}}, "evaluated_keys": ["block_public_acls", "block_public_policy", "resource_type"]}, "code_block": [[199, "resource \"aws_s3_bucket\" \"patch_logs\" {\n"], [200, "  bucket = \"${var.project}-${var.environment}-patch-logs-${random_string.suffix.result}\"\n"], [201, "\n"], [202, "  tags = {\n"], [203, "    Name        = \"${var.project}-${var.environment}-patch-logs\"\n"], [204, "    Environment = var.environment\n"], [205, "    Project     = var.project\n"], [206, "  }\n"], [207, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [199, 207], "resource": "module.ecs_jenkins_github_dr.module.ec2.aws_s3_bucket.patch_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-patch-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV2_AWS_6", "bc_check_id": "BC_AWS_NETWORKING_52", "check_name": "Ensure that S3 bucket has a Public Access block", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"lambda_code": {"__end_line__": 18, "__start_line__": 10, "bucket": ["${var.project}-${var.environment}-lambda-${random_string.bucket_suffix.result}"], "tags": [{"Environment": "var.environment", "Name": "${var.project}-${var.environment}-lambda", "Project": "var.project"}], "__address__": "module.lambda_failover.aws_s3_bucket.lambda_code"}}}, "evaluated_keys": ["block_public_acls", "block_public_policy", "resource_type"]}, "code_block": [[10, "resource \"aws_s3_bucket\" \"lambda_code\" {\n"], [11, "  bucket = \"${var.project}-${var.environment}-lambda-${random_string.bucket_suffix.result}\"\n"], [12, "\n"], [13, "  tags = {\n"], [14, "    Name        = \"${var.project}-${var.environment}-lambda\"\n"], [15, "    Environment = var.environment\n"], [16, "    Project     = var.project\n"], [17, "  }\n"], [18, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [10, 18], "resource": "module.lambda_failover.aws_s3_bucket.lambda_code", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Name": "${var.project}-${var.environment}-lambda", "Project": "var.project"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"patch_logs": {"__end_line__": 207, "__start_line__": 199, "bucket": ["ecs-jenkins-prod-patch-logs-${random_string.suffix.result}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-patch-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.ec2.aws_s3_bucket.patch_logs"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[199, "resource \"aws_s3_bucket\" \"patch_logs\" {\n"], [200, "  bucket = \"${var.project}-${var.environment}-patch-logs-${random_string.suffix.result}\"\n"], [201, "\n"], [202, "  tags = {\n"], [203, "    Name        = \"${var.project}-${var.environment}-patch-logs\"\n"], [204, "    Environment = var.environment\n"], [205, "    Project     = var.project\n"], [206, "  }\n"], [207, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [199, 207], "resource": "module.ecs_jenkins_github.module.ec2.aws_s3_bucket.patch_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-patch-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"patch_logs": {"__end_line__": 207, "__start_line__": 199, "bucket": ["ecs-jenkins-dr-patch-logs-${random_string.suffix.result}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-patch-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.ec2.aws_s3_bucket.patch_logs"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[199, "resource \"aws_s3_bucket\" \"patch_logs\" {\n"], [200, "  bucket = \"${var.project}-${var.environment}-patch-logs-${random_string.suffix.result}\"\n"], [201, "\n"], [202, "  tags = {\n"], [203, "    Name        = \"${var.project}-${var.environment}-patch-logs\"\n"], [204, "    Environment = var.environment\n"], [205, "    Project     = var.project\n"], [206, "  }\n"], [207, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [199, 207], "resource": "module.ecs_jenkins_github_dr.module.ec2.aws_s3_bucket.patch_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-patch-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\ec2\\main.tf"}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"lambda_code": {"__end_line__": 18, "__start_line__": 10, "bucket": ["${var.project}-${var.environment}-lambda-${random_string.bucket_suffix.result}"], "tags": [{"Environment": "var.environment", "Name": "${var.project}-${var.environment}-lambda", "Project": "var.project"}], "__address__": "module.lambda_failover.aws_s3_bucket.lambda_code"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[10, "resource \"aws_s3_bucket\" \"lambda_code\" {\n"], [11, "  bucket = \"${var.project}-${var.environment}-lambda-${random_string.bucket_suffix.result}\"\n"], [12, "\n"], [13, "  tags = {\n"], [14, "    Name        = \"${var.project}-${var.environment}-lambda\"\n"], [15, "    Environment = var.environment\n"], [16, "    Project     = var.project\n"], [17, "  }\n"], [18, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf", "repo_file_path": "/modules/lambda/main.tf", "file_line_range": [10, 18], "resource": "module.lambda_failover.aws_s3_bucket.lambda_code", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Name": "${var.project}-${var.environment}-lambda", "Project": "var.project"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\lambda\\main.tf"}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"config_bucket": {"__end_line__": 339, "__start_line__": 330, "bucket": ["ecs-jenkins-prod-config-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-config-bucket", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.security.aws_s3_bucket.config_bucket"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[330, "resource \"aws_s3_bucket\" \"config_bucket\" {\n"], [331, "  bucket        = \"${var.project}-${var.environment}-config-${random_string.bucket_suffix.result}\"\n"], [332, "  force_destroy = var.environment != \"prod\"\n"], [333, "\n"], [334, "  tags = {\n"], [335, "    Name        = \"${var.project}-${var.environment}-config-bucket\"\n"], [336, "    Environment = var.environment\n"], [337, "    Project     = var.project\n"], [338, "  }\n"], [339, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [330, 339], "resource": "module.ecs_jenkins_github.module.security.aws_s3_bucket.config_bucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-config-bucket", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[351, "resource \"aws_s3_bucket_server_side_encryption_configuration\" \"config_bucket_encryption\" {\n"], [352, "  bucket = aws_s3_bucket.config_bucket.id\n"], [353, "\n"], [354, "  rule {\n"], [355, "    apply_server_side_encryption_by_default {\n"], [356, "      sse_algorithm = \"AES256\"\n"], [357, "    }\n"], [358, "  }\n"], [359, "}\n"]], "file_path": "\\..\\security\\main.tf", "file_line_range": [351, 359], "resource": "aws_s3_bucket_server_side_encryption_configuration.config_bucket_encryption", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"waf_logs": {"__end_line__": 568, "__start_line__": 559, "bucket": ["ecs-jenkins-prod-waf-logs-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "prod", "Name": "ecs-jenkins-prod-waf-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github.module.security.aws_s3_bucket.waf_logs"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[559, "resource \"aws_s3_bucket\" \"waf_logs\" {\n"], [560, "  bucket        = \"${var.project}-${var.environment}-waf-logs-${random_string.bucket_suffix.result}\"\n"], [561, "  force_destroy = var.environment != \"prod\"\n"], [562, "\n"], [563, "  tags = {\n"], [564, "    Name        = \"${var.project}-${var.environment}-waf-logs\"\n"], [565, "    Environment = var.environment\n"], [566, "    Project     = var.project\n"], [567, "  }\n"], [568, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [559, 568], "resource": "module.ecs_jenkins_github.module.security.aws_s3_bucket.waf_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "ecs-jenkins-prod-waf-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[578, "resource \"aws_s3_bucket_server_side_encryption_configuration\" \"waf_logs_encryption\" {\n"], [579, "  bucket = aws_s3_bucket.waf_logs.id\n"], [580, "\n"], [581, "  rule {\n"], [582, "    apply_server_side_encryption_by_default {\n"], [583, "      sse_algorithm = \"AES256\"\n"], [584, "    }\n"], [585, "  }\n"], [586, "}\n"]], "file_path": "\\main.tf", "file_line_range": [578, 586], "resource": "aws_s3_bucket_server_side_encryption_configuration.waf_logs_encryption", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"waf_logs": {"__end_line__": 568, "__start_line__": 559, "bucket": ["ecs-jenkins-dr-waf-logs-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-waf-logs", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.waf_logs"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[559, "resource \"aws_s3_bucket\" \"waf_logs\" {\n"], [560, "  bucket        = \"${var.project}-${var.environment}-waf-logs-${random_string.bucket_suffix.result}\"\n"], [561, "  force_destroy = var.environment != \"prod\"\n"], [562, "\n"], [563, "  tags = {\n"], [564, "    Name        = \"${var.project}-${var.environment}-waf-logs\"\n"], [565, "    Environment = var.environment\n"], [566, "    Project     = var.project\n"], [567, "  }\n"], [568, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [559, 568], "resource": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.waf_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-waf-logs", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[578, "resource \"aws_s3_bucket_server_side_encryption_configuration\" \"waf_logs_encryption\" {\n"], [579, "  bucket = aws_s3_bucket.waf_logs.id\n"], [580, "\n"], [581, "  rule {\n"], [582, "    apply_server_side_encryption_by_default {\n"], [583, "      sse_algorithm = \"AES256\"\n"], [584, "    }\n"], [585, "  }\n"], [586, "}\n"]], "file_path": "\\main.tf", "file_line_range": [578, 586], "resource": "aws_s3_bucket_server_side_encryption_configuration.waf_logs_encryption", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"config_bucket": {"__end_line__": 339, "__start_line__": 330, "bucket": ["ecs-jenkins-dr-config-${random_string.bucket_suffix.result}"], "force_destroy": ["${var.environment != \"prod\"}"], "tags": [{"Environment": "dr", "Name": "ecs-jenkins-dr-config-bucket", "Project": "ecs-jenkins"}], "__address__": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.config_bucket"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[330, "resource \"aws_s3_bucket\" \"config_bucket\" {\n"], [331, "  bucket        = \"${var.project}-${var.environment}-config-${random_string.bucket_suffix.result}\"\n"], [332, "  force_destroy = var.environment != \"prod\"\n"], [333, "\n"], [334, "  tags = {\n"], [335, "    Name        = \"${var.project}-${var.environment}-config-bucket\"\n"], [336, "    Environment = var.environment\n"], [337, "    Project     = var.project\n"], [338, "  }\n"], [339, "}\n"]], "file_path": "\\main.tf", "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "repo_file_path": "/modules/security/main.tf", "file_line_range": [330, 339], "resource": "module.ecs_jenkins_github_dr.module.security.aws_s3_bucket.config_bucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dr", "Name": "ecs-jenkins-dr-config-bucket", "Project": "ecs-jenkins"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[351, "resource \"aws_s3_bucket_server_side_encryption_configuration\" \"config_bucket_encryption\" {\n"], [352, "  bucket = aws_s3_bucket.config_bucket.id\n"], [353, "\n"], [354, "  rule {\n"], [355, "    apply_server_side_encryption_by_default {\n"], [356, "      sse_algorithm = \"AES256\"\n"], [357, "    }\n"], [358, "  }\n"], [359, "}\n"]], "file_path": "\\main.tf", "file_line_range": [351, 359], "resource": "aws_s3_bucket_server_side_encryption_configuration.config_bucket_encryption", "entity_tags": {}, "evaluations": null, "file_abs_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default", "details": [], "check_len": null, "definition_context_file_path": "D:\\Terraform Playground\\ECS_Jenkins_Github\\modules\\security\\main.tf"}], "skipped_checks": [], "parsing_errors": []}, "summary": {"passed": 603, "failed": 174, "skipped": 0, "parsing_errors": 0, "resource_count": 328, "checkov_version": "3.2.490"}, "url": "Add an api key '--bc-api-key <api-key>' to see more detailed insights via https://bridgecrew.cloud"}